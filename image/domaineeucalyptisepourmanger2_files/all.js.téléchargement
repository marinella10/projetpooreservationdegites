
var Prototype={Version:'1.7.2',Browser:(function(){var ua=navigator.userAgent;var isOpera=Object.prototype.toString.call(window.opera)=='[object Opera]';return{IE:!!window.attachEvent&&!isOpera,Opera:isOpera,WebKit:ua.indexOf('AppleWebKit/')>-1,Gecko:ua.indexOf('Gecko')>-1&&ua.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile/.test(ua)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var constructor=window.Element||window.HTMLElement;return!!(constructor&&constructor.prototype);})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=='undefined')
return true;var div=document.createElement('div'),form=document.createElement('form'),isSupported=false;if(div['__proto__']&&(div['__proto__']!==form['__proto__'])){isSupported=true;}
div=form=null;return isSupported;})()},ScriptFragment:'<script[^>]*>([\\S\\s]*?)<\/script\\s*>',JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(x){return x}};if(Prototype.Browser.MobileSafari)
Prototype.BrowserFeatures.SpecificElementExtensions=false;var Class=(function(){var IS_DONTENUM_BUGGY=(function(){for(var p in{toString:1}){if(p==='toString')return false;}
return true;})();function subclass(){};function create(){var parent=null,properties=$A(arguments);if(Object.isFunction(properties[0]))
parent=properties.shift();function klass(){this.initialize.apply(this,arguments);}
Object.extend(klass,Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass);}
for(var i=0,length=properties.length;i<length;i++)
klass.addMethods(properties[i]);if(!klass.prototype.initialize)
klass.prototype.initialize=Prototype.emptyFunction;klass.prototype.constructor=klass;return klass;}
function addMethods(source){var ancestor=this.superclass&&this.superclass.prototype,properties=Object.keys(source);if(IS_DONTENUM_BUGGY){if(source.toString!=Object.prototype.toString)
properties.push("toString");if(source.valueOf!=Object.prototype.valueOf)
properties.push("valueOf");}
for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&Object.isFunction(value)&&value.argumentNames()[0]=="$super"){var method=value;value=(function(m){return function(){return ancestor[m].apply(this,arguments);};})(property).wrap(method);value.valueOf=(function(method){return function(){return method.valueOf.call(method);};})(method);value.toString=(function(method){return function(){return method.toString.call(method);};})(method);}
this.prototype[property]=value;}
return this;}
return{create:create,Methods:{addMethods:addMethods}};})();(function(){var _toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,NULL_TYPE='Null',UNDEFINED_TYPE='Undefined',BOOLEAN_TYPE='Boolean',NUMBER_TYPE='Number',STRING_TYPE='String',OBJECT_TYPE='Object',FUNCTION_CLASS='[object Function]',BOOLEAN_CLASS='[object Boolean]',NUMBER_CLASS='[object Number]',STRING_CLASS='[object String]',ARRAY_CLASS='[object Array]',DATE_CLASS='[object Date]',NATIVE_JSON_STRINGIFY_SUPPORT=window.JSON&&typeof JSON.stringify==='function'&&JSON.stringify(0)==='0'&&typeof JSON.stringify(Prototype.K)==='undefined';var DONT_ENUMS=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'];var IS_DONTENUM_BUGGY=(function(){for(var p in{toString:1}){if(p==='toString')return false;}
return true;})();function Type(o){switch(o){case null:return NULL_TYPE;case(void 0):return UNDEFINED_TYPE;}
var type=typeof o;switch(type){case'boolean':return BOOLEAN_TYPE;case'number':return NUMBER_TYPE;case'string':return STRING_TYPE;}
return OBJECT_TYPE;}
function extend(destination,source){for(var property in source)
destination[property]=source[property];return destination;}
function inspect(object){try{if(isUndefined(object))return'undefined';if(object===null)return'null';return object.inspect?object.inspect():String(object);}catch(e){if(e instanceof RangeError)return'...';throw e;}}
function toJSON(value){return Str('',{'':value},[]);}
function Str(key,holder,stack){var value=holder[key];if(Type(value)===OBJECT_TYPE&&typeof value.toJSON==='function'){value=value.toJSON(key);}
var _class=_toString.call(value);switch(_class){case NUMBER_CLASS:case BOOLEAN_CLASS:case STRING_CLASS:value=value.valueOf();}
switch(value){case null:return'null';case true:return'true';case false:return'false';}
var type=typeof value;switch(type){case'string':return value.inspect(true);case'number':return isFinite(value)?String(value):'null';case'object':for(var i=0,length=stack.length;i<length;i++){if(stack[i]===value){throw new TypeError("Cyclic reference to '"+value+"' in object");}}
stack.push(value);var partial=[];if(_class===ARRAY_CLASS){for(var i=0,length=value.length;i<length;i++){var str=Str(i,value,stack);partial.push(typeof str==='undefined'?'null':str);}
partial='['+partial.join(',')+']';}else{var keys=Object.keys(value);for(var i=0,length=keys.length;i<length;i++){var key=keys[i],str=Str(key,value,stack);if(typeof str!=="undefined"){partial.push(key.inspect(true)+':'+str);}}
partial='{'+partial.join(',')+'}';}
stack.pop();return partial;}}
function stringify(object){return JSON.stringify(object);}
function toQueryString(object){return $H(object).toQueryString();}
function toHTML(object){return object&&object.toHTML?object.toHTML():String.interpret(object);}
function keys(object){if(Type(object)!==OBJECT_TYPE){throw new TypeError();}
var results=[];for(var property in object){if(_hasOwnProperty.call(object,property))
results.push(property);}
if(IS_DONTENUM_BUGGY){for(var i=0;property=DONT_ENUMS[i];i++){if(_hasOwnProperty.call(object,property))
results.push(property);}}
return results;}
function values(object){var results=[];for(var property in object)
results.push(object[property]);return results;}
function clone(object){return extend({},object);}
function isElement(object){return!!(object&&object.nodeType==1);}
function isArray(object){return _toString.call(object)===ARRAY_CLASS;}
var hasNativeIsArray=(typeof Array.isArray=='function')&&Array.isArray([])&&!Array.isArray({});if(hasNativeIsArray){isArray=Array.isArray;}
function isHash(object){return object instanceof Hash;}
function isFunction(object){return _toString.call(object)===FUNCTION_CLASS;}
function isString(object){return _toString.call(object)===STRING_CLASS;}
function isNumber(object){return _toString.call(object)===NUMBER_CLASS;}
function isDate(object){return _toString.call(object)===DATE_CLASS;}
function isUndefined(object){return typeof object==="undefined";}
extend(Object,{extend:extend,inspect:inspect,toJSON:NATIVE_JSON_STRINGIFY_SUPPORT?stringify:toJSON,toQueryString:toQueryString,toHTML:toHTML,keys:Object.keys||keys,values:values,clone:clone,isElement:isElement,isArray:isArray,isHash:isHash,isFunction:isFunction,isString:isString,isNumber:isNumber,isDate:isDate,isUndefined:isUndefined});})();Object.extend(Function.prototype,(function(){var slice=Array.prototype.slice;function update(array,args){var arrayLength=array.length,length=args.length;while(length--)array[arrayLength+length]=args[length];return array;}
function merge(array,args){array=slice.call(array,0);return update(array,args);}
function argumentNames(){var names=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,'').replace(/\s+/g,'').split(',');return names.length==1&&!names[0]?[]:names;}
function bind(context){if(arguments.length<2&&Object.isUndefined(arguments[0]))
return this;if(!Object.isFunction(this))
throw new TypeError("The object is not callable.");var nop=function(){};var __method=this,args=slice.call(arguments,1);var bound=function(){var a=merge(args,arguments);var c=this instanceof bound?this:context;return __method.apply(c,a);};nop.prototype=this.prototype;bound.prototype=new nop();return bound;}
function bindAsEventListener(context){var __method=this,args=slice.call(arguments,1);return function(event){var a=update([event||window.event],args);return __method.apply(context,a);}}
function curry(){if(!arguments.length)return this;var __method=this,args=slice.call(arguments,0);return function(){var a=merge(args,arguments);return __method.apply(this,a);}}
function delay(timeout){var __method=this,args=slice.call(arguments,1);timeout=timeout*1000;return window.setTimeout(function(){return __method.apply(__method,args);},timeout);}
function defer(){var args=update([0.01],arguments);return this.delay.apply(this,args);}
function wrap(wrapper){var __method=this;return function(){var a=update([__method.bind(this)],arguments);return wrapper.apply(this,a);}}
function methodize(){if(this._methodized)return this._methodized;var __method=this;return this._methodized=function(){var a=update([this],arguments);return __method.apply(null,a);};}
var extensions={argumentNames:argumentNames,bindAsEventListener:bindAsEventListener,curry:curry,delay:delay,defer:defer,wrap:wrap,methodize:methodize};if(!Function.prototype.bind)
extensions.bind=bind;return extensions;})());(function(proto){function toISOString(){return this.getUTCFullYear()+'-'+
(this.getUTCMonth()+1).toPaddedString(2)+'-'+
this.getUTCDate().toPaddedString(2)+'T'+
this.getUTCHours().toPaddedString(2)+':'+
this.getUTCMinutes().toPaddedString(2)+':'+
this.getUTCSeconds().toPaddedString(2)+'Z';}
function toJSON(){return this.toISOString();}
if(!proto.toISOString)proto.toISOString=toISOString;if(!proto.toJSON)proto.toJSON=toJSON;})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(str){return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1');};var PeriodicalExecuter=Class.create({initialize:function(callback,frequency){this.callback=callback;this.frequency=frequency;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},execute:function(){this.callback(this);},stop:function(){if(!this.timer)return;clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false;}catch(e){this.currentlyExecuting=false;throw e;}}}});Object.extend(String,{interpret:function(value){return value==null?'':String(value);},specialChar:{'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','\\':'\\\\'}});Object.extend(String.prototype,(function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse==='function'&&JSON.parse('{"test": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement))return replacement;var template=new Template(replacement);return function(match){return template.evaluate(match)};}
function isNonEmptyRegExp(regexp){return regexp.source&&regexp.source!=='(?:)';}
function gsub(pattern,replacement){var result='',source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern))
pattern=RegExp.escape(pattern);if(!(pattern.length||isNonEmptyRegExp(pattern))){replacement=replacement('');return replacement+source.split('').join(replacement)+replacement;}
while(source.length>0){match=source.match(pattern)
if(match&&match[0].length>0){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length);}else{result+=source,source='';}}
return result;}
function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0)return match[0];return replacement(match);});}
function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this);}
function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?'...':truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this);}
function strip(){return this.replace(/^\s+/,'').replace(/\s+$/,'');}
function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,'');}
function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,'img'),'');}
function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,'img'),matchOne=new RegExp(Prototype.ScriptFragment,'im');return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||['',''])[1];});}
function evalScripts(){return this.extractScripts().map(function(script){return eval(script);});}
function escapeHTML(){return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function unescapeHTML(){return this.stripTags().replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&amp;/g,'&');}
function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match)return{};return match[1].split(separator||'&').inject({},function(hash,pair){if((pair=pair.split('='))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join('='):pair[0];if(value!=undefined){value=value.gsub('+',' ');value=decodeURIComponent(value);}
if(key in hash){if(!Object.isArray(hash[key]))hash[key]=[hash[key]];hash[key].push(value);}
else hash[key]=value;}
return hash;});}
function toArray(){return this.split('');}
function succ(){return this.slice(0,this.length-1)+
String.fromCharCode(this.charCodeAt(this.length-1)+1);}
function times(count){return count<1?'':new Array(count+1).join(this);}
function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():'';});}
function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();}
function underscore(){return this.replace(/::/g,'/').replace(/([A-Z]+)([A-Z][a-z])/g,'$1_$2').replace(/([a-z\d])([A-Z])/g,'$1_$2').replace(/-/g,'_').toLowerCase();}
function dasherize(){return this.replace(/_/g,'-');}
function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character];}
return'\\u00'+character.charCodeAt().toPaddedString(2,16);});if(useDoubleQuotes)return'"'+escapedString.replace(/"/g,'\\"')+'"';return"'"+escapedString.replace(/'/g,'\\\'')+"'";}
function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,'$1');}
function isJSON(){var str=this;if(str.blank())return false;str=str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@');str=str.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');str=str.replace(/(?:^|:|,)(?:\s*\[)+/g,'');return(/^[\],:{}\s]*$/).test(str);}
function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(cx.test(json)){json=json.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
try{if(!sanitize||json.isJSON())return eval('('+json+')');}catch(e){}
throw new SyntaxError('Badly formed JSON string: '+this.inspect());}
function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json);}
function include(pattern){return this.indexOf(pattern)>-1;}
function startsWith(pattern,position){position=Object.isNumber(position)?position:0;return this.lastIndexOf(pattern,position)===position;}
function endsWith(pattern,position){pattern=String(pattern);position=Object.isNumber(position)?position:this.length;if(position<0)position=0;if(position>this.length)position=this.length;var d=position-pattern.length;return d>=0&&this.indexOf(pattern,d)===d;}
function empty(){return this=='';}
function blank(){return/^\s*$/.test(this);}
function interpolate(object,pattern){return new Template(this,pattern).evaluate(object);}
return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:String.prototype.startsWith||startsWith,endsWith:String.prototype.endsWith||endsWith,empty:empty,blank:blank,interpolate:interpolate};})());var Template=Class.create({initialize:function(template,pattern){this.template=template.toString();this.pattern=pattern||Template.Pattern;},evaluate:function(object){if(object&&Object.isFunction(object.toTemplateReplacements))
object=object.toTemplateReplacements();return this.template.gsub(this.pattern,function(match){if(object==null)return(match[1]+'');var before=match[1]||'';if(before=='\\')return match[2];var ctx=object,expr=match[3],pattern=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;match=pattern.exec(expr);if(match==null)return before;while(match!=null){var comp=match[1].startsWith('[')?match[2].replace(/\\\\]/g,']'):match[1];ctx=ctx[comp];if(null==ctx||''==match[3])break;expr=expr.substring('['==match[3]?match[1].length:match[0].length);match=pattern.exec(expr);}
return before+String.interpret(ctx);});}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function each(iterator,context){try{this._each(iterator,context);}catch(e){if(e!=$break)throw e;}
return this;}
function eachSlice(number,iterator,context){var index=-number,slices=[],array=this.toArray();if(number<1)return array;while((index+=number)<array.length)
slices.push(array.slice(index,index+number));return slices.collect(iterator,context);}
function all(iterator,context){iterator=iterator||Prototype.K;var result=true;this.each(function(value,index){result=result&&!!iterator.call(context,value,index,this);if(!result)throw $break;},this);return result;}
function any(iterator,context){iterator=iterator||Prototype.K;var result=false;this.each(function(value,index){if(result=!!iterator.call(context,value,index,this))
throw $break;},this);return result;}
function collect(iterator,context){iterator=iterator||Prototype.K;var results=[];this.each(function(value,index){results.push(iterator.call(context,value,index,this));},this);return results;}
function detect(iterator,context){var result;this.each(function(value,index){if(iterator.call(context,value,index,this)){result=value;throw $break;}},this);return result;}
function findAll(iterator,context){var results=[];this.each(function(value,index){if(iterator.call(context,value,index,this))
results.push(value);},this);return results;}
function grep(filter,iterator,context){iterator=iterator||Prototype.K;var results=[];if(Object.isString(filter))
filter=new RegExp(RegExp.escape(filter));this.each(function(value,index){if(filter.match(value))
results.push(iterator.call(context,value,index,this));},this);return results;}
function include(object){if(Object.isFunction(this.indexOf)&&this.indexOf(object)!=-1)
return true;var found=false;this.each(function(value){if(value==object){found=true;throw $break;}});return found;}
function inGroupsOf(number,fillWith){fillWith=Object.isUndefined(fillWith)?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number)slice.push(fillWith);return slice;});}
function inject(memo,iterator,context){this.each(function(value,index){memo=iterator.call(context,memo,value,index,this);},this);return memo;}
function invoke(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args);});}
function max(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index,this);if(result==null||value>=result)
result=value;},this);return result;}
function min(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index,this);if(result==null||value<result)
result=value;},this);return result;}
function partition(iterator,context){iterator=iterator||Prototype.K;var trues=[],falses=[];this.each(function(value,index){(iterator.call(context,value,index,this)?trues:falses).push(value);},this);return[trues,falses];}
function pluck(property){var results=[];this.each(function(value){results.push(value[property]);});return results;}
function reject(iterator,context){var results=[];this.each(function(value,index){if(!iterator.call(context,value,index,this))
results.push(value);},this);return results;}
function sortBy(iterator,context){return this.map(function(value,index){return{value:value,criteria:iterator.call(context,value,index,this)};},this).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0;}).pluck('value');}
function toArray(){return this.map();}
function zip(){var iterator=Prototype.K,args=$A(arguments);if(Object.isFunction(args.last()))
iterator=args.pop();var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index));});}
function size(){return this.toArray().length;}
function inspect(){return'#<Enumerable:'+this.toArray().inspect()+'>';}
return{each:each,eachSlice:eachSlice,all:all,every:all,any:any,some:any,collect:collect,map:collect,detect:detect,findAll:findAll,select:findAll,filter:findAll,grep:grep,include:include,member:include,inGroupsOf:inGroupsOf,inject:inject,invoke:invoke,max:max,min:min,partition:partition,pluck:pluck,reject:reject,sortBy:sortBy,toArray:toArray,entries:toArray,zip:zip,size:size,inspect:inspect,find:detect};})();function $A(iterable){if(!iterable)return[];if('toArray'in Object(iterable))return iterable.toArray();var length=iterable.length||0,results=new Array(length);while(length--)results[length]=iterable[length];return results;}
function $w(string){if(!Object.isString(string))return[];string=string.strip();return string?string.split(/\s+/):[];}
Array.from=$A;(function(){var arrayProto=Array.prototype,slice=arrayProto.slice,_each=arrayProto.forEach;function each(iterator,context){for(var i=0,length=this.length>>>0;i<length;i++){if(i in this)iterator.call(context,this[i],i,this);}}
if(!_each)_each=each;function clear(){this.length=0;return this;}
function first(){return this[0];}
function last(){return this[this.length-1];}
function compact(){return this.select(function(value){return value!=null;});}
function flatten(){return this.inject([],function(array,value){if(Object.isArray(value))
return array.concat(value.flatten());array.push(value);return array;});}
function without(){var values=slice.call(arguments,0);return this.select(function(value){return!values.include(value);});}
function reverse(inline){return(inline===false?this.toArray():this)._reverse();}
function uniq(sorted){return this.inject([],function(array,value,index){if(0==index||(sorted?array.last()!=value:!array.include(value)))
array.push(value);return array;});}
function intersect(array){return this.uniq().findAll(function(item){return array.indexOf(item)!==-1;});}
function clone(){return slice.call(this,0);}
function size(){return this.length;}
function inspect(){return'['+this.map(Object.inspect).join(', ')+']';}
function indexOf(item,i){if(this==null)throw new TypeError();var array=Object(this),length=array.length>>>0;if(length===0)return-1;i=Number(i);if(isNaN(i)){i=0;}else if(i!==0&&isFinite(i)){i=(i>0?1:-1)*Math.floor(Math.abs(i));}
if(i>length)return-1;var k=i>=0?i:Math.max(length-Math.abs(i),0);for(;k<length;k++)
if(k in array&&array[k]===item)return k;return-1;}
function lastIndexOf(item,i){if(this==null)throw new TypeError();var array=Object(this),length=array.length>>>0;if(length===0)return-1;if(!Object.isUndefined(i)){i=Number(i);if(isNaN(i)){i=0;}else if(i!==0&&isFinite(i)){i=(i>0?1:-1)*Math.floor(Math.abs(i));}}else{i=length;}
var k=i>=0?Math.min(i,length-1):length-Math.abs(i);for(;k>=0;k--)
if(k in array&&array[k]===item)return k;return-1;}
function concat(_){var array=[],items=slice.call(arguments,0),item,n=0;items.unshift(this);for(var i=0,length=items.length;i<length;i++){item=items[i];if(Object.isArray(item)&&!('callee'in item)){for(var j=0,arrayLength=item.length;j<arrayLength;j++){if(j in item)array[n]=item[j];n++;}}else{array[n++]=item;}}
array.length=n;return array;}
function wrapNative(method){return function(){if(arguments.length===0){return method.call(this,Prototype.K);}else if(arguments[0]===undefined){var args=slice.call(arguments,1);args.unshift(Prototype.K);return method.apply(this,args);}else{return method.apply(this,arguments);}};}
function map(iterator){if(this==null)throw new TypeError();iterator=iterator||Prototype.K;var object=Object(this);var results=[],context=arguments[1],n=0;for(var i=0,length=object.length>>>0;i<length;i++){if(i in object){results[n]=iterator.call(context,object[i],i,object);}
n++;}
results.length=n;return results;}
if(arrayProto.map){map=wrapNative(Array.prototype.map);}
function filter(iterator){if(this==null||!Object.isFunction(iterator))
throw new TypeError();var object=Object(this);var results=[],context=arguments[1],value;for(var i=0,length=object.length>>>0;i<length;i++){if(i in object){value=object[i];if(iterator.call(context,value,i,object)){results.push(value);}}}
return results;}
if(arrayProto.filter){filter=Array.prototype.filter;}
function some(iterator){if(this==null)throw new TypeError();iterator=iterator||Prototype.K;var context=arguments[1];var object=Object(this);for(var i=0,length=object.length>>>0;i<length;i++){if(i in object&&iterator.call(context,object[i],i,object)){return true;}}
return false;}
if(arrayProto.some){var some=wrapNative(Array.prototype.some);}
function every(iterator){if(this==null)throw new TypeError();iterator=iterator||Prototype.K;var context=arguments[1];var object=Object(this);for(var i=0,length=object.length>>>0;i<length;i++){if(i in object&&!iterator.call(context,object[i],i,object)){return false;}}
return true;}
if(arrayProto.every){var every=wrapNative(Array.prototype.every);}
var _reduce=arrayProto.reduce;function inject(memo,iterator){iterator=iterator||Prototype.K;var context=arguments[2];return _reduce.call(this,iterator.bind(context),memo);}
if(!arrayProto.reduce){var inject=Enumerable.inject;}
Object.extend(arrayProto,Enumerable);if(!arrayProto._reverse)
arrayProto._reverse=arrayProto.reverse;Object.extend(arrayProto,{_each:_each,map:map,collect:map,select:filter,filter:filter,findAll:filter,some:some,any:some,every:every,all:every,inject:inject,clear:clear,first:first,last:last,compact:compact,flatten:flatten,without:without,reverse:reverse,uniq:uniq,intersect:intersect,clone:clone,toArray:clone,size:size,inspect:inspect});var CONCAT_ARGUMENTS_BUGGY=(function(){return[].concat(arguments)[0][0]!==1;})(1,2);if(CONCAT_ARGUMENTS_BUGGY)arrayProto.concat=concat;if(!arrayProto.indexOf)arrayProto.indexOf=indexOf;if(!arrayProto.lastIndexOf)arrayProto.lastIndexOf=lastIndexOf;})();function $H(object){return new Hash(object);};var Hash=Class.create(Enumerable,(function(){function initialize(object){this._object=Object.isHash(object)?object.toObject():Object.clone(object);}
function _each(iterator,context){var i=0;for(var key in this._object){var value=this._object[key],pair=[key,value];pair.key=key;pair.value=value;iterator.call(context,pair,i);i++;}}
function set(key,value){return this._object[key]=value;}
function get(key){if(this._object[key]!==Object.prototype[key])
return this._object[key];}
function unset(key){var value=this._object[key];delete this._object[key];return value;}
function toObject(){return Object.clone(this._object);}
function keys(){return this.pluck('key');}
function values(){return this.pluck('value');}
function index(value){var match=this.detect(function(pair){return pair.value===value;});return match&&match.key;}
function merge(object){return this.clone().update(object);}
function update(object){return new Hash(object).inject(this,function(result,pair){result.set(pair.key,pair.value);return result;});}
function toQueryPair(key,value){if(Object.isUndefined(value))return key;value=String.interpret(value);value=value.gsub(/(\r)?\n/,'\r\n');value=encodeURIComponent(value);value=value.gsub(/%20/,'+');return key+'='+value;}
function toQueryString(){return this.inject([],function(results,pair){var key=encodeURIComponent(pair.key),values=pair.value;if(values&&typeof values=='object'){if(Object.isArray(values)){var queryValues=[];for(var i=0,len=values.length,value;i<len;i++){value=values[i];queryValues.push(toQueryPair(key,value));}
return results.concat(queryValues);}}else results.push(toQueryPair(key,values));return results;}).join('&');}
function inspect(){return'#<Hash:{'+this.map(function(pair){return pair.map(Object.inspect).join(': ');}).join(', ')+'}>';}
function clone(){return new Hash(this);}
return{initialize:initialize,_each:_each,set:set,get:get,unset:unset,toObject:toObject,toTemplateReplacements:toObject,keys:keys,values:values,index:index,merge:merge,update:update,toQueryString:toQueryString,inspect:inspect,toJSON:toObject,clone:clone};})());Hash.from=$H;Object.extend(Number.prototype,(function(){function toColorPart(){return this.toPaddedString(2,16);}
function succ(){return this+1;}
function times(iterator,context){$R(0,this,true).each(iterator,context);return this;}
function toPaddedString(length,radix){var string=this.toString(radix||10);return'0'.times(length-string.length)+string;}
function abs(){return Math.abs(this);}
function round(){return Math.round(this);}
function ceil(){return Math.ceil(this);}
function floor(){return Math.floor(this);}
return{toColorPart:toColorPart,succ:succ,times:times,toPaddedString:toPaddedString,abs:abs,round:round,ceil:ceil,floor:floor};})());function $R(start,end,exclusive){return new ObjectRange(start,end,exclusive);}
var ObjectRange=Class.create(Enumerable,(function(){function initialize(start,end,exclusive){this.start=start;this.end=end;this.exclusive=exclusive;}
function _each(iterator,context){var value=this.start,i;for(i=0;this.include(value);i++){iterator.call(context,value,i);value=value.succ();}}
function include(value){if(value<this.start)
return false;if(this.exclusive)
return value<this.end;return value<=this.end;}
return{initialize:initialize,_each:_each,include:include};})());var Abstract={};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break;}catch(e){}}
return returnValue;}};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject('Msxml2.XMLHTTP')},function(){return new ActiveXObject('Microsoft.XMLHTTP')})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator,context){this.responders._each(iterator,context);},register:function(responder){if(!this.include(responder))
this.responders.push(responder);},unregister:function(responder){this.responders=this.responders.without(responder);},dispatch:function(callback,request,transport,json){this.each(function(responder){if(Object.isFunction(responder[callback])){try{responder[callback].apply(responder,[request,transport,json]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(options){this.options={method:'post',asynchronous:true,contentType:'application/x-www-form-urlencoded',encoding:'UTF-8',parameters:'',evalJSON:true,evalJS:true};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))
this.options.parameters=this.options.parameters.toObject();}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,url,options){$super(options);this.transport=Ajax.getTransport();this.request(url);},request:function(url){this.url=url;this.method=this.options.method;var params=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!['get','post'].include(this.method)){params+=(params?'&':'')+"_method="+this.method;this.method='post';}
if(params&&this.method==='get'){this.url+=(this.url.include('?')?'&':'?')+params;}
this.parameters=params.toQueryParams();try{var response=new Ajax.Response(this);if(this.options.onCreate)this.options.onCreate(response);Ajax.Responders.dispatch('onCreate',this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous)this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=='post'?(this.options.postBody||params):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)
this.onStateChange();}
catch(e){this.dispatchException(e);}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!((readyState==4)&&this._complete))
this.respondToReadyState(this.transport.readyState);},setRequestHeaders:function(){var headers={'X-Requested-With':'XMLHttpRequest','X-Prototype-Version':Prototype.Version,'Accept':'text/javascript, text/html, application/xml, text/xml, */*'};if(this.method=='post'){headers['Content-type']=this.options.contentType+
(this.options.encoding?'; charset='+this.options.encoding:'');if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)
headers['Connection']='close';}
if(typeof this.options.requestHeaders=='object'){var extras=this.options.requestHeaders;if(Object.isFunction(extras.push))
for(var i=0,length=extras.length;i<length;i+=2)
headers[extras[i]]=extras[i+1];else
$H(extras).each(function(pair){headers[pair.key]=pair.value});}
for(var name in headers)
if(headers[name]!=null)
this.transport.setRequestHeader(name,headers[name]);},success:function(){var status=this.getStatus();return!status||(status>=200&&status<300)||status==304;},getStatus:function(){try{if(this.transport.status===1223)return 204;return this.transport.status||0;}catch(e){return 0}},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(state=='Complete'){try{this._complete=true;(this.options['on'+response.status]||this.options['on'+(this.success()?'Success':'Failure')]||Prototype.emptyFunction)(response,response.headerJSON);}catch(e){this.dispatchException(e);}
var contentType=response.getHeader('Content-type');if(this.options.evalJS=='force'||(this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))
this.evalResponse();}
try{(this.options['on'+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch('on'+state,this,response,response.headerJSON);}catch(e){this.dispatchException(e);}
if(state=='Complete'){this.transport.onreadystatechange=Prototype.emptyFunction;}},isSameOrigin:function(){var m=this.url.match(/^\s*https?:\/\/[^\/]*/);return!m||(m[0]=='#{protocol}//#{domain}#{port}'.interpolate({protocol:location.protocol,domain:document.domain,port:location.port?':'+location.port:''}));},getHeader:function(name){try{return this.transport.getResponseHeader(name)||null;}catch(e){return null;}},evalResponse:function(){try{return eval((this.transport.responseText||'').unfilterJSON());}catch(e){this.dispatchException(e);}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch('onException',this,exception);}});Ajax.Request.Events=['Uninitialized','Loading','Loaded','Interactive','Complete'];Ajax.Response=Class.create({initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if((readyState>2&&!Prototype.Browser.IE)||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(transport.responseText);this.headerJSON=this._getHeaderJSON();}
if(readyState==4){var xml=transport.responseXML;this.responseXML=Object.isUndefined(xml)?null:xml;this.responseJSON=this._getResponseJSON();}},status:0,statusText:'',getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||'';}catch(e){return''}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders();}catch(e){return null}},getResponseHeader:function(name){return this.transport.getResponseHeader(name);},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders();},_getHeaderJSON:function(){var json=this.getHeader('X-JSON');if(!json)return null;try{json=decodeURIComponent(escape(json));}catch(e){}
try{return json.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}},_getResponseJSON:function(){var options=this.request.options;if(!options.evalJSON||(options.evalJSON!='force'&&!(this.getHeader('Content-type')||'').include('application/json'))||this.responseText.blank())
return null;try{return this.responseText.evalJSON(options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,container,url,options){this.container={success:(container.success||container),failure:(container.failure||(container.success?null:container))};options=Object.clone(options);var onComplete=options.onComplete;options.onComplete=(function(response,json){this.updateContent(response.responseText);if(Object.isFunction(onComplete))onComplete(response,json);}).bind(this);$super(url,options);},updateContent:function(responseText){var receiver=this.container[this.success()?'success':'failure'],options=this.options;if(!options.evalScripts)responseText=responseText.stripScripts();if(receiver=$(receiver)){if(options.insertion){if(Object.isString(options.insertion)){var insertion={};insertion[options.insertion]=responseText;receiver.insert(insertion);}
else options.insertion(receiver,responseText);}
else receiver.update(responseText);}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,container,url,options){$super(options);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=container;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(response){if(this.options.decay){this.decay=(response.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=response.responseText;}
this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});(function(GLOBAL){var UNDEFINED;var SLICE=Array.prototype.slice;var DIV=document.createElement('div');function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++)
elements.push($(arguments[i]));return elements;}
if(Object.isString(element))
element=document.getElementById(element);return Element.extend(element);}
GLOBAL.$=$;if(!GLOBAL.Node)GLOBAL.Node={};if(!GLOBAL.Node.ELEMENT_NODE){Object.extend(GLOBAL.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});}
var ELEMENT_CACHE={};function shouldUseCreationCache(tagName,attributes){if(tagName==='select')return false;if('type'in attributes)return false;return true;}
var HAS_EXTENDED_CREATE_ELEMENT_SYNTAX=(function(){try{var el=document.createElement('<input name="x">');return el.tagName.toLowerCase()==='input'&&el.name==='x';}
catch(err){return false;}})();var oldElement=GLOBAL.Element;function Element(tagName,attributes){attributes=attributes||{};tagName=tagName.toLowerCase();if(HAS_EXTENDED_CREATE_ELEMENT_SYNTAX&&attributes.name){tagName='<'+tagName+' name="'+attributes.name+'">';delete attributes.name;return Element.writeAttribute(document.createElement(tagName),attributes);}
if(!ELEMENT_CACHE[tagName])
ELEMENT_CACHE[tagName]=Element.extend(document.createElement(tagName));var node=shouldUseCreationCache(tagName,attributes)?ELEMENT_CACHE[tagName].cloneNode(false):document.createElement(tagName);return Element.writeAttribute(node,attributes);}
GLOBAL.Element=Element;Object.extend(GLOBAL.Element,oldElement||{});if(oldElement)GLOBAL.Element.prototype=oldElement.prototype;Element.Methods={ByTag:{},Simulated:{}};var methods={};var INSPECT_ATTRIBUTES={id:'id',className:'class'};function inspect(element){element=$(element);var result='<'+element.tagName.toLowerCase();var attribute,value;for(var property in INSPECT_ATTRIBUTES){attribute=INSPECT_ATTRIBUTES[property];value=(element[property]||'').toString();if(value)result+=' '+attribute+'='+value.inspect(true);}
return result+'>';}
methods.inspect=inspect;function visible(element){return $(element).style.display!=='none';}
function toggle(element,bool){element=$(element);if(Object.isUndefined(bool))
bool=!Element.visible(element);Element[bool?'show':'hide'](element);return element;}
function hide(element){element=$(element);element.style.display='none';return element;}
function show(element){element=$(element);element.style.display='';return element;}
Object.extend(methods,{visible:visible,toggle:toggle,hide:hide,show:show});function remove(element){element=$(element);element.parentNode.removeChild(element);return element;}
var SELECT_ELEMENT_INNERHTML_BUGGY=(function(){var el=document.createElement("select"),isBuggy=true;el.innerHTML="<option value=\"test\">test</option>";if(el.options&&el.options[0]){isBuggy=el.options[0].nodeName.toUpperCase()!=="OPTION";}
el=null;return isBuggy;})();var TABLE_ELEMENT_INNERHTML_BUGGY=(function(){try{var el=document.createElement("table");if(el&&el.tBodies){el.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var isBuggy=typeof el.tBodies[0]=="undefined";el=null;return isBuggy;}}catch(e){return true;}})();var LINK_ELEMENT_INNERHTML_BUGGY=(function(){try{var el=document.createElement('div');el.innerHTML="<link />";var isBuggy=(el.childNodes.length===0);el=null;return isBuggy;}catch(e){return true;}})();var ANY_INNERHTML_BUGGY=SELECT_ELEMENT_INNERHTML_BUGGY||TABLE_ELEMENT_INNERHTML_BUGGY||LINK_ELEMENT_INNERHTML_BUGGY;var SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING=(function(){var s=document.createElement("script"),isBuggy=false;try{s.appendChild(document.createTextNode(""));isBuggy=!s.firstChild||s.firstChild&&s.firstChild.nodeType!==3;}catch(e){isBuggy=true;}
s=null;return isBuggy;})();function update(element,content){element=$(element);var descendants=element.getElementsByTagName('*'),i=descendants.length;while(i--)purgeElement(descendants[i]);if(content&&content.toElement)
content=content.toElement();if(Object.isElement(content))
return element.update().insert(content);content=Object.toHTML(content);var tagName=element.tagName.toUpperCase();if(tagName==='SCRIPT'&&SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING){element.text=content;return element;}
if(ANY_INNERHTML_BUGGY){if(tagName in INSERTION_TRANSLATIONS.tags){while(element.firstChild)
element.removeChild(element.firstChild);var nodes=getContentFromAnonymousElement(tagName,content.stripScripts());for(var i=0,node;node=nodes[i];i++)
element.appendChild(node);}else if(LINK_ELEMENT_INNERHTML_BUGGY&&Object.isString(content)&&content.indexOf('<link')>-1){while(element.firstChild)
element.removeChild(element.firstChild);var nodes=getContentFromAnonymousElement(tagName,content.stripScripts(),true);for(var i=0,node;node=nodes[i];i++)
element.appendChild(node);}else{element.innerHTML=content.stripScripts();}}else{element.innerHTML=content.stripScripts();}
content.evalScripts.bind(content).defer();return element;}
function replace(element,content){element=$(element);if(content&&content.toElement){content=content.toElement();}else if(!Object.isElement(content)){content=Object.toHTML(content);var range=element.ownerDocument.createRange();range.selectNode(element);content.evalScripts.bind(content).defer();content=range.createContextualFragment(content.stripScripts());}
element.parentNode.replaceChild(content,element);return element;}
var INSERTION_TRANSLATIONS={before:function(element,node){element.parentNode.insertBefore(node,element);},top:function(element,node){element.insertBefore(node,element.firstChild);},bottom:function(element,node){element.appendChild(node);},after:function(element,node){element.parentNode.insertBefore(node,element.nextSibling);},tags:{TABLE:['<table>','</table>',1],TBODY:['<table><tbody>','</tbody></table>',2],TR:['<table><tbody><tr>','</tr></tbody></table>',3],TD:['<table><tbody><tr><td>','</td></tr></tbody></table>',4],SELECT:['<select>','</select>',1]}};var tags=INSERTION_TRANSLATIONS.tags;Object.extend(tags,{THEAD:tags.TBODY,TFOOT:tags.TBODY,TH:tags.TD});function replace_IE(element,content){element=$(element);if(content&&content.toElement)
content=content.toElement();if(Object.isElement(content)){element.parentNode.replaceChild(content,element);return element;}
content=Object.toHTML(content);var parent=element.parentNode,tagName=parent.tagName.toUpperCase();if(tagName in INSERTION_TRANSLATIONS.tags){var nextSibling=Element.next(element);var fragments=getContentFromAnonymousElement(tagName,content.stripScripts());parent.removeChild(element);var iterator;if(nextSibling)
iterator=function(node){parent.insertBefore(node,nextSibling)};else
iterator=function(node){parent.appendChild(node);}
fragments.each(iterator);}else{element.outerHTML=content.stripScripts();}
content.evalScripts.bind(content).defer();return element;}
if('outerHTML'in document.documentElement)
replace=replace_IE;function isContent(content){if(Object.isUndefined(content)||content===null)return false;if(Object.isString(content)||Object.isNumber(content))return true;if(Object.isElement(content))return true;if(content.toElement||content.toHTML)return true;return false;}
function insertContentAt(element,content,position){position=position.toLowerCase();var method=INSERTION_TRANSLATIONS[position];if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){method(element,content);return element;}
content=Object.toHTML(content);var tagName=((position==='before'||position==='after')?element.parentNode:element).tagName.toUpperCase();var childNodes=getContentFromAnonymousElement(tagName,content.stripScripts());if(position==='top'||position==='after')childNodes.reverse();for(var i=0,node;node=childNodes[i];i++)
method(element,node);content.evalScripts.bind(content).defer();}
function insert(element,insertions){element=$(element);if(isContent(insertions))
insertions={bottom:insertions};for(var position in insertions)
insertContentAt(element,insertions[position],position);return element;}
function wrap(element,wrapper,attributes){element=$(element);if(Object.isElement(wrapper)){$(wrapper).writeAttribute(attributes||{});}else if(Object.isString(wrapper)){wrapper=new Element(wrapper,attributes);}else{wrapper=new Element('div',wrapper);}
if(element.parentNode)
element.parentNode.replaceChild(wrapper,element);wrapper.appendChild(element);return wrapper;}
function cleanWhitespace(element){element=$(element);var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType===Node.TEXT_NODE&&!/\S/.test(node.nodeValue))
element.removeChild(node);node=nextNode;}
return element;}
function empty(element){return $(element).innerHTML.blank();}
function getContentFromAnonymousElement(tagName,html,force){var t=INSERTION_TRANSLATIONS.tags[tagName],div=DIV;var workaround=!!t;if(!workaround&&force){workaround=true;t=['','',0];}
if(workaround){div.innerHTML='&#160;'+t[0]+html+t[1];div.removeChild(div.firstChild);for(var i=t[2];i--;)
div=div.firstChild;}else{div.innerHTML=html;}
return $A(div.childNodes);}
function clone(element,deep){if(!(element=$(element)))return;var clone=element.cloneNode(deep);if(!HAS_UNIQUE_ID_PROPERTY){clone._prototypeUID=UNDEFINED;if(deep){var descendants=Element.select(clone,'*'),i=descendants.length;while(i--)
descendants[i]._prototypeUID=UNDEFINED;}}
return Element.extend(clone);}
function purgeElement(element){var uid=getUniqueElementID(element);if(uid){Element.stopObserving(element);if(!HAS_UNIQUE_ID_PROPERTY)
element._prototypeUID=UNDEFINED;delete Element.Storage[uid];}}
function purgeCollection(elements){var i=elements.length;while(i--)
purgeElement(elements[i]);}
function purgeCollection_IE(elements){var i=elements.length,element,uid;while(i--){element=elements[i];uid=getUniqueElementID(element);delete Element.Storage[uid];delete Event.cache[uid];}}
if(HAS_UNIQUE_ID_PROPERTY){purgeCollection=purgeCollection_IE;}
function purge(element){if(!(element=$(element)))return;purgeElement(element);var descendants=element.getElementsByTagName('*'),i=descendants.length;while(i--)purgeElement(descendants[i]);return null;}
Object.extend(methods,{remove:remove,update:update,replace:replace,insert:insert,wrap:wrap,cleanWhitespace:cleanWhitespace,empty:empty,clone:clone,purge:purge});function recursivelyCollect(element,property,maximumLength){element=$(element);maximumLength=maximumLength||-1;var elements=[];while(element=element[property]){if(element.nodeType===Node.ELEMENT_NODE)
elements.push(Element.extend(element));if(elements.length===maximumLength)break;}
return elements;}
function ancestors(element){return recursivelyCollect(element,'parentNode');}
function descendants(element){return Element.select(element,'*');}
function firstDescendant(element){element=$(element).firstChild;while(element&&element.nodeType!==Node.ELEMENT_NODE)
element=element.nextSibling;return $(element);}
function immediateDescendants(element){var results=[],child=$(element).firstChild;while(child){if(child.nodeType===Node.ELEMENT_NODE)
results.push(Element.extend(child));child=child.nextSibling;}
return results;}
function previousSiblings(element){return recursivelyCollect(element,'previousSibling');}
function nextSiblings(element){return recursivelyCollect(element,'nextSibling');}
function siblings(element){element=$(element);var previous=previousSiblings(element),next=nextSiblings(element);return previous.reverse().concat(next);}
function match(element,selector){element=$(element);if(Object.isString(selector))
return Prototype.Selector.match(element,selector);return selector.match(element);}
function _recursivelyFind(element,property,expression,index){element=$(element),expression=expression||0,index=index||0;if(Object.isNumber(expression)){index=expression,expression=null;}
while(element=element[property]){if(element.nodeType!==1)continue;if(expression&&!Prototype.Selector.match(element,expression))
continue;if(--index>=0)continue;return Element.extend(element);}}
function up(element,expression,index){element=$(element);if(arguments.length===1)return $(element.parentNode);return _recursivelyFind(element,'parentNode',expression,index);}
function down(element,expression,index){if(arguments.length===1)return firstDescendant(element);element=$(element),expression=expression||0,index=index||0;if(Object.isNumber(expression))
index=expression,expression='*';var node=Prototype.Selector.select(expression,element)[index];return Element.extend(node);}
function previous(element,expression,index){return _recursivelyFind(element,'previousSibling',expression,index);}
function next(element,expression,index){return _recursivelyFind(element,'nextSibling',expression,index);}
function select(element){element=$(element);var expressions=SLICE.call(arguments,1).join(', ');return Prototype.Selector.select(expressions,element);}
function adjacent(element){element=$(element);var expressions=SLICE.call(arguments,1).join(', ');var siblings=Element.siblings(element),results=[];for(var i=0,sibling;sibling=siblings[i];i++){if(Prototype.Selector.match(sibling,expressions))
results.push(sibling);}
return results;}
function descendantOf_DOM(element,ancestor){element=$(element),ancestor=$(ancestor);while(element=element.parentNode)
if(element===ancestor)return true;return false;}
function descendantOf_contains(element,ancestor){element=$(element),ancestor=$(ancestor);if(!ancestor.contains)return descendantOf_DOM(element,ancestor);return ancestor.contains(element)&&ancestor!==element;}
function descendantOf_compareDocumentPosition(element,ancestor){element=$(element),ancestor=$(ancestor);return(element.compareDocumentPosition(ancestor)&8)===8;}
var descendantOf;if(DIV.compareDocumentPosition){descendantOf=descendantOf_compareDocumentPosition;}else if(DIV.contains){descendantOf=descendantOf_contains;}else{descendantOf=descendantOf_DOM;}
Object.extend(methods,{recursivelyCollect:recursivelyCollect,ancestors:ancestors,descendants:descendants,firstDescendant:firstDescendant,immediateDescendants:immediateDescendants,previousSiblings:previousSiblings,nextSiblings:nextSiblings,siblings:siblings,match:match,up:up,down:down,previous:previous,next:next,select:select,adjacent:adjacent,descendantOf:descendantOf,getElementsBySelector:select,childElements:immediateDescendants});var idCounter=1;function identify(element){element=$(element);var id=Element.readAttribute(element,'id');if(id)return id;do{id='anonymous_element_'+idCounter++}while($(id));Element.writeAttribute(element,'id',id);return id;}
function readAttribute(element,name){return $(element).getAttribute(name);}
function readAttribute_IE(element,name){element=$(element);var table=ATTRIBUTE_TRANSLATIONS.read;if(table.values[name])
return table.values[name](element,name);if(table.names[name])name=table.names[name];if(name.include(':')){if(!element.attributes||!element.attributes[name])return null;return element.attributes[name].value;}
return element.getAttribute(name);}
function readAttribute_Opera(element,name){if(name==='title')return element.title;return element.getAttribute(name);}
var PROBLEMATIC_ATTRIBUTE_READING=(function(){DIV.setAttribute('onclick',[]);var value=DIV.getAttribute('onclick');var isFunction=Object.isArray(value);DIV.removeAttribute('onclick');return isFunction;})();if(PROBLEMATIC_ATTRIBUTE_READING){readAttribute=readAttribute_IE;}else if(Prototype.Browser.Opera){readAttribute=readAttribute_Opera;}
function writeAttribute(element,name,value){element=$(element);var attributes={},table=ATTRIBUTE_TRANSLATIONS.write;if(typeof name==='object'){attributes=name;}else{attributes[name]=Object.isUndefined(value)?true:value;}
for(var attr in attributes){name=table.names[attr]||attr;value=attributes[attr];if(table.values[attr])
name=table.values[attr](element,value)||name;if(value===false||value===null)
element.removeAttribute(name);else if(value===true)
element.setAttribute(name,name);else element.setAttribute(name,value);}
return element;}
var PROBLEMATIC_HAS_ATTRIBUTE_WITH_CHECKBOXES=(function(){if(!HAS_EXTENDED_CREATE_ELEMENT_SYNTAX){return false;}
var checkbox=document.createElement('<input type="checkbox">');checkbox.checked=true;var node=checkbox.getAttributeNode('checked');return!node||!node.specified;})();function hasAttribute(element,attribute){attribute=ATTRIBUTE_TRANSLATIONS.has[attribute]||attribute;var node=$(element).getAttributeNode(attribute);return!!(node&&node.specified);}
function hasAttribute_IE(element,attribute){if(attribute==='checked'){return element.checked;}
return hasAttribute(element,attribute);}
GLOBAL.Element.Methods.Simulated.hasAttribute=PROBLEMATIC_HAS_ATTRIBUTE_WITH_CHECKBOXES?hasAttribute_IE:hasAttribute;function classNames(element){return new Element.ClassNames(element);}
var regExpCache={};function getRegExpForClassName(className){if(regExpCache[className])return regExpCache[className];var re=new RegExp("(^|\\s+)"+className+"(\\s+|$)");regExpCache[className]=re;return re;}
function hasClassName(element,className){if(!(element=$(element)))return;var elementClassName=element.className;if(elementClassName.length===0)return false;if(elementClassName===className)return true;return getRegExpForClassName(className).test(elementClassName);}
function addClassName(element,className){if(!(element=$(element)))return;if(!hasClassName(element,className))
element.className+=(element.className?' ':'')+className;return element;}
function removeClassName(element,className){if(!(element=$(element)))return;element.className=element.className.replace(getRegExpForClassName(className),' ').strip();return element;}
function toggleClassName(element,className,bool){if(!(element=$(element)))return;if(Object.isUndefined(bool))
bool=!hasClassName(element,className);var method=Element[bool?'addClassName':'removeClassName'];return method(element,className);}
var ATTRIBUTE_TRANSLATIONS={};var classProp='className',forProp='for';DIV.setAttribute(classProp,'x');if(DIV.className!=='x'){DIV.setAttribute('class','x');if(DIV.className==='x')
classProp='class';}
var LABEL=document.createElement('label');LABEL.setAttribute(forProp,'x');if(LABEL.htmlFor!=='x'){LABEL.setAttribute('htmlFor','x');if(LABEL.htmlFor==='x')
forProp='htmlFor';}
LABEL=null;function _getAttr(element,attribute){return element.getAttribute(attribute);}
function _getAttr2(element,attribute){return element.getAttribute(attribute,2);}
function _getAttrNode(element,attribute){var node=element.getAttributeNode(attribute);return node?node.value:'';}
function _getFlag(element,attribute){return $(element).hasAttribute(attribute)?attribute:null;}
DIV.onclick=Prototype.emptyFunction;var onclickValue=DIV.getAttribute('onclick');var _getEv;if(String(onclickValue).indexOf('{')>-1){_getEv=function(element,attribute){var value=element.getAttribute(attribute);if(!value)return null;value=value.toString();value=value.split('{')[1];value=value.split('}')[0];return value.strip();};}
else if(onclickValue===''){_getEv=function(element,attribute){var value=element.getAttribute(attribute);if(!value)return null;return value.strip();};}
ATTRIBUTE_TRANSLATIONS.read={names:{'class':classProp,'className':classProp,'for':forProp,'htmlFor':forProp},values:{style:function(element){return element.style.cssText.toLowerCase();},title:function(element){return element.title;}}};ATTRIBUTE_TRANSLATIONS.write={names:{className:'class',htmlFor:'for',cellpadding:'cellPadding',cellspacing:'cellSpacing'},values:{checked:function(element,value){element.checked=!!value;},style:function(element,value){element.style.cssText=value?value:'';}}};ATTRIBUTE_TRANSLATIONS.has={names:{}};Object.extend(ATTRIBUTE_TRANSLATIONS.write.names,ATTRIBUTE_TRANSLATIONS.read.names);var CAMEL_CASED_ATTRIBUTE_NAMES=$w('colSpan rowSpan vAlign dateTime '+'accessKey tabIndex encType maxLength readOnly longDesc frameBorder');for(var i=0,attr;attr=CAMEL_CASED_ATTRIBUTE_NAMES[i];i++){ATTRIBUTE_TRANSLATIONS.write.names[attr.toLowerCase()]=attr;ATTRIBUTE_TRANSLATIONS.has.names[attr.toLowerCase()]=attr;}
Object.extend(ATTRIBUTE_TRANSLATIONS.read.values,{href:_getAttr2,src:_getAttr2,type:_getAttr,action:_getAttrNode,disabled:_getFlag,checked:_getFlag,readonly:_getFlag,multiple:_getFlag,onload:_getEv,onunload:_getEv,onclick:_getEv,ondblclick:_getEv,onmousedown:_getEv,onmouseup:_getEv,onmouseover:_getEv,onmousemove:_getEv,onmouseout:_getEv,onfocus:_getEv,onblur:_getEv,onkeypress:_getEv,onkeydown:_getEv,onkeyup:_getEv,onsubmit:_getEv,onreset:_getEv,onselect:_getEv,onchange:_getEv});Object.extend(methods,{identify:identify,readAttribute:readAttribute,writeAttribute:writeAttribute,classNames:classNames,hasClassName:hasClassName,addClassName:addClassName,removeClassName:removeClassName,toggleClassName:toggleClassName});function normalizeStyleName(style){if(style==='float'||style==='styleFloat')
return'cssFloat';return style.camelize();}
function normalizeStyleName_IE(style){if(style==='float'||style==='cssFloat')
return'styleFloat';return style.camelize();}
function setStyle(element,styles){element=$(element);var elementStyle=element.style,match;if(Object.isString(styles)){elementStyle.cssText+=';'+styles;if(styles.include('opacity')){var opacity=styles.match(/opacity:\s*(\d?\.?\d*)/)[1];Element.setOpacity(element,opacity);}
return element;}
for(var property in styles){if(property==='opacity'){Element.setOpacity(element,styles[property]);}else{var value=styles[property];if(property==='float'||property==='cssFloat'){property=Object.isUndefined(elementStyle.styleFloat)?'cssFloat':'styleFloat';}
elementStyle[property]=value;}}
return element;}
function getStyle(element,style){element=$(element);style=normalizeStyleName(style);var value=element.style[style];if(!value||value==='auto'){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null;}
if(style==='opacity')return value?parseFloat(value):1.0;return value==='auto'?null:value;}
function getStyle_Opera(element,style){switch(style){case'height':case'width':if(!Element.visible(element))return null;var dim=parseInt(getStyle(element,style),10);if(dim!==element['offset'+style.capitalize()])
return dim+'px';return Element.measure(element,style);default:return getStyle(element,style);}}
function getStyle_IE(element,style){element=$(element);style=normalizeStyleName_IE(style);var value=element.style[style];if(!value&&element.currentStyle){value=element.currentStyle[style];}
if(style==='opacity'&&!STANDARD_CSS_OPACITY_SUPPORTED)
return getOpacity_IE(element);if(value==='auto'){if((style==='width'||style==='height')&&Element.visible(element))
return Element.measure(element,style)+'px';return null;}
return value;}
function stripAlphaFromFilter_IE(filter){return(filter||'').replace(/alpha\([^\)]*\)/gi,'');}
function hasLayout_IE(element){if(!element.currentStyle||!element.currentStyle.hasLayout)
element.style.zoom=1;return element;}
var STANDARD_CSS_OPACITY_SUPPORTED=(function(){DIV.style.cssText="opacity:.55";return/^0.55/.test(DIV.style.opacity);})();function setOpacity(element,value){element=$(element);if(value==1||value==='')value='';else if(value<0.00001)value=0;element.style.opacity=value;return element;}
function setOpacity_IE(element,value){if(STANDARD_CSS_OPACITY_SUPPORTED)
return setOpacity(element,value);element=hasLayout_IE($(element));var filter=Element.getStyle(element,'filter'),style=element.style;if(value==1||value===''){filter=stripAlphaFromFilter_IE(filter);if(filter)style.filter=filter;else style.removeAttribute('filter');return element;}
if(value<0.00001)value=0;style.filter=stripAlphaFromFilter_IE(filter)+'alpha(opacity='+(value*100)+')';return element;}
function getOpacity(element){return Element.getStyle(element,'opacity');}
function getOpacity_IE(element){if(STANDARD_CSS_OPACITY_SUPPORTED)
return getOpacity(element);var filter=Element.getStyle(element,'filter');if(filter.length===0)return 1.0;var match=(filter||'').match(/alpha\(opacity=(.*)\)/);if(match&&match[1])return parseFloat(match[1])/100;return 1.0;}
Object.extend(methods,{setStyle:setStyle,getStyle:getStyle,setOpacity:setOpacity,getOpacity:getOpacity});if('styleFloat'in DIV.style){methods.getStyle=getStyle_IE;methods.setOpacity=setOpacity_IE;methods.getOpacity=getOpacity_IE;}
var UID=0;GLOBAL.Element.Storage={UID:1};function getUniqueElementID(element){if(element===window)return 0;if(typeof element._prototypeUID==='undefined')
element._prototypeUID=Element.Storage.UID++;return element._prototypeUID;}
function getUniqueElementID_IE(element){if(element===window)return 0;if(element==document)return 1;return element.uniqueID;}
var HAS_UNIQUE_ID_PROPERTY=('uniqueID'in DIV);if(HAS_UNIQUE_ID_PROPERTY)
getUniqueElementID=getUniqueElementID_IE;function getStorage(element){if(!(element=$(element)))return;var uid=getUniqueElementID(element);if(!Element.Storage[uid])
Element.Storage[uid]=$H();return Element.Storage[uid];}
function store(element,key,value){if(!(element=$(element)))return;var storage=getStorage(element);if(arguments.length===2){storage.update(key);}else{storage.set(key,value);}
return element;}
function retrieve(element,key,defaultValue){if(!(element=$(element)))return;var storage=getStorage(element),value=storage.get(key);if(Object.isUndefined(value)){storage.set(key,defaultValue);value=defaultValue;}
return value;}
Object.extend(methods,{getStorage:getStorage,store:store,retrieve:retrieve});var Methods={},ByTag=Element.Methods.ByTag,F=Prototype.BrowserFeatures;if(!F.ElementExtensions&&('__proto__'in DIV)){GLOBAL.HTMLElement={};GLOBAL.HTMLElement.prototype=DIV['__proto__'];F.ElementExtensions=true;}
function checkElementPrototypeDeficiency(tagName){if(typeof window.Element==='undefined')return false;if(!HAS_EXTENDED_CREATE_ELEMENT_SYNTAX)return false;var proto=window.Element.prototype;if(proto){var id='_'+(Math.random()+'').slice(2),el=document.createElement(tagName);proto[id]='x';var isBuggy=(el[id]!=='x');delete proto[id];el=null;return isBuggy;}
return false;}
var HTMLOBJECTELEMENT_PROTOTYPE_BUGGY=checkElementPrototypeDeficiency('object');function extendElementWith(element,methods){for(var property in methods){var value=methods[property];if(Object.isFunction(value)&&!(property in element))
element[property]=value.methodize();}}
var EXTENDED={};function elementIsExtended(element){var uid=getUniqueElementID(element);return(uid in EXTENDED);}
function extend(element){if(!element||elementIsExtended(element))return element;if(element.nodeType!==Node.ELEMENT_NODE||element==window)
return element;var methods=Object.clone(Methods),tagName=element.tagName.toUpperCase();if(ByTag[tagName])Object.extend(methods,ByTag[tagName]);extendElementWith(element,methods);EXTENDED[getUniqueElementID(element)]=true;return element;}
function extend_IE8(element){if(!element||elementIsExtended(element))return element;var t=element.tagName;if(t&&(/^(?:object|applet|embed)$/i.test(t))){extendElementWith(element,Element.Methods);extendElementWith(element,Element.Methods.Simulated);extendElementWith(element,Element.Methods.ByTag[t.toUpperCase()]);}
return element;}
if(F.SpecificElementExtensions){extend=HTMLOBJECTELEMENT_PROTOTYPE_BUGGY?extend_IE8:Prototype.K;}
function addMethodsToTagName(tagName,methods){tagName=tagName.toUpperCase();if(!ByTag[tagName])ByTag[tagName]={};Object.extend(ByTag[tagName],methods);}
function mergeMethods(destination,methods,onlyIfAbsent){if(Object.isUndefined(onlyIfAbsent))onlyIfAbsent=false;for(var property in methods){var value=methods[property];if(!Object.isFunction(value))continue;if(!onlyIfAbsent||!(property in destination))
destination[property]=value.methodize();}}
function findDOMClass(tagName){var klass;var trans={"OPTGROUP":"OptGroup","TEXTAREA":"TextArea","P":"Paragraph","FIELDSET":"FieldSet","UL":"UList","OL":"OList","DL":"DList","DIR":"Directory","H1":"Heading","H2":"Heading","H3":"Heading","H4":"Heading","H5":"Heading","H6":"Heading","Q":"Quote","INS":"Mod","DEL":"Mod","A":"Anchor","IMG":"Image","CAPTION":"TableCaption","COL":"TableCol","COLGROUP":"TableCol","THEAD":"TableSection","TFOOT":"TableSection","TBODY":"TableSection","TR":"TableRow","TH":"TableCell","TD":"TableCell","FRAMESET":"FrameSet","IFRAME":"IFrame"};if(trans[tagName])klass='HTML'+trans[tagName]+'Element';if(window[klass])return window[klass];klass='HTML'+tagName+'Element';if(window[klass])return window[klass];klass='HTML'+tagName.capitalize()+'Element';if(window[klass])return window[klass];var element=document.createElement(tagName),proto=element['__proto__']||element.constructor.prototype;element=null;return proto;}
function addMethods(methods){if(arguments.length===0)addFormMethods();if(arguments.length===2){var tagName=methods;methods=arguments[1];}
if(!tagName){Object.extend(Element.Methods,methods||{});}else{if(Object.isArray(tagName)){for(var i=0,tag;tag=tagName[i];i++)
addMethodsToTagName(tag,methods);}else{addMethodsToTagName(tagName,methods);}}
var ELEMENT_PROTOTYPE=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(F.ElementExtensions){mergeMethods(ELEMENT_PROTOTYPE,Element.Methods);mergeMethods(ELEMENT_PROTOTYPE,Element.Methods.Simulated,true);}
if(F.SpecificElementExtensions){for(var tag in Element.Methods.ByTag){var klass=findDOMClass(tag);if(Object.isUndefined(klass))continue;mergeMethods(klass.prototype,ByTag[tag]);}}
Object.extend(Element,Element.Methods);Object.extend(Element,Element.Methods.Simulated);delete Element.ByTag;delete Element.Simulated;Element.extend.refresh();ELEMENT_CACHE={};}
Object.extend(GLOBAL.Element,{extend:extend,addMethods:addMethods});if(extend===Prototype.K){GLOBAL.Element.extend.refresh=Prototype.emptyFunction;}else{GLOBAL.Element.extend.refresh=function(){if(Prototype.BrowserFeatures.ElementExtensions)return;Object.extend(Methods,Element.Methods);Object.extend(Methods,Element.Methods.Simulated);EXTENDED={};};}
function addFormMethods(){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{"FORM":Object.clone(Form.Methods),"INPUT":Object.clone(Form.Element.Methods),"SELECT":Object.clone(Form.Element.Methods),"TEXTAREA":Object.clone(Form.Element.Methods),"BUTTON":Object.clone(Form.Element.Methods)});}
Element.addMethods(methods);function destroyCache_IE(){DIV=null;ELEMENT_CACHE=null;}
if(window.attachEvent)
window.attachEvent('onunload',destroyCache_IE);})(this);(function(){function toDecimal(pctString){var match=pctString.match(/^(\d+)%?$/i);if(!match)return null;return(Number(match[1])/100);}
function getRawStyle(element,style){element=$(element);var value=element.style[style];if(!value||value==='auto'){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null;}
if(style==='opacity')return value?parseFloat(value):1.0;return value==='auto'?null:value;}
function getRawStyle_IE(element,style){var value=element.style[style];if(!value&&element.currentStyle){value=element.currentStyle[style];}
return value;}
function getContentWidth(element,context){var boxWidth=element.offsetWidth;var bl=getPixelValue(element,'borderLeftWidth',context)||0;var br=getPixelValue(element,'borderRightWidth',context)||0;var pl=getPixelValue(element,'paddingLeft',context)||0;var pr=getPixelValue(element,'paddingRight',context)||0;return boxWidth-bl-br-pl-pr;}
if('currentStyle'in document.documentElement){getRawStyle=getRawStyle_IE;}
function getPixelValue(value,property,context){var element=null;if(Object.isElement(value)){element=value;value=getRawStyle(element,property);}
if(value===null||Object.isUndefined(value)){return null;}
if((/^(?:-)?\d+(\.\d+)?(px)?$/i).test(value)){return window.parseFloat(value);}
var isPercentage=value.include('%'),isViewport=(context===document.viewport);if(/\d/.test(value)&&element&&element.runtimeStyle&&!(isPercentage&&isViewport)){var style=element.style.left,rStyle=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=value||0;value=element.style.pixelLeft;element.style.left=style;element.runtimeStyle.left=rStyle;return value;}
if(element&&isPercentage){context=context||element.parentNode;var decimal=toDecimal(value),whole=null;var isHorizontal=property.include('left')||property.include('right')||property.include('width');var isVertical=property.include('top')||property.include('bottom')||property.include('height');if(context===document.viewport){if(isHorizontal){whole=document.viewport.getWidth();}else if(isVertical){whole=document.viewport.getHeight();}}else{if(isHorizontal){whole=$(context).measure('width');}else if(isVertical){whole=$(context).measure('height');}}
return(whole===null)?0:whole*decimal;}
return 0;}
function toCSSPixels(number){if(Object.isString(number)&&number.endsWith('px'))
return number;return number+'px';}
function isDisplayed(element){while(element&&element.parentNode){var display=element.getStyle('display');if(display==='none'){return false;}
element=$(element.parentNode);}
return true;}
var hasLayout=Prototype.K;if('currentStyle'in document.documentElement){hasLayout=function(element){if(!element.currentStyle.hasLayout){element.style.zoom=1;}
return element;};}
function cssNameFor(key){if(key.include('border'))key=key+'-width';return key.camelize();}
Element.Layout=Class.create(Hash,{initialize:function($super,element,preCompute){$super();this.element=$(element);Element.Layout.PROPERTIES.each(function(property){this._set(property,null);},this);if(preCompute){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false;}},_set:function(property,value){return Hash.prototype.set.call(this,property,value);},set:function(property,value){throw"Properties of Element.Layout are read-only.";},get:function($super,property){var value=$super(property);return value===null?this._compute(property):value;},_begin:function(){if(this._isPrepared())return;var element=this.element;if(isDisplayed(element)){this._setPrepared(true);return;}
var originalStyles={position:element.style.position||'',width:element.style.width||'',visibility:element.style.visibility||'',display:element.style.display||''};element.store('prototype_original_styles',originalStyles);var position=getRawStyle(element,'position'),width=element.offsetWidth;if(width===0||width===null){element.style.display='block';width=element.offsetWidth;}
var context=(position==='fixed')?document.viewport:element.parentNode;var tempStyles={visibility:'hidden',display:'block'};if(position!=='fixed')tempStyles.position='absolute';element.setStyle(tempStyles);var positionedWidth=element.offsetWidth,newWidth;if(width&&(positionedWidth===width)){newWidth=getContentWidth(element,context);}else if(position==='absolute'||position==='fixed'){newWidth=getContentWidth(element,context);}else{var parent=element.parentNode,pLayout=$(parent).getLayout();newWidth=pLayout.get('width')-
this.get('margin-left')-
this.get('border-left')-
this.get('padding-left')-
this.get('padding-right')-
this.get('border-right')-
this.get('margin-right');}
element.setStyle({width:newWidth+'px'});this._setPrepared(true);},_end:function(){var element=this.element;var originalStyles=element.retrieve('prototype_original_styles');element.store('prototype_original_styles',null);element.setStyle(originalStyles);this._setPrepared(false);},_compute:function(property){var COMPUTATIONS=Element.Layout.COMPUTATIONS;if(!(property in COMPUTATIONS)){throw"Property not found.";}
return this._set(property,COMPUTATIONS[property].call(this,this.element));},_isPrepared:function(){return this.element.retrieve('prototype_element_layout_prepared',false);},_setPrepared:function(bool){return this.element.store('prototype_element_layout_prepared',bool);},toObject:function(){var args=$A(arguments);var keys=(args.length===0)?Element.Layout.PROPERTIES:args.join(' ').split(' ');var obj={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)obj[key]=value;},this);return obj;},toHash:function(){var obj=this.toObject.apply(this,arguments);return new Hash(obj);},toCSS:function(){var args=$A(arguments);var keys=(args.length===0)?Element.Layout.PROPERTIES:args.join(' ').split(' ');var css={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;if(Element.Layout.COMPOSITE_PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)css[cssNameFor(key)]=value+'px';},this);return css;},inspect:function(){return"#<Element.Layout>";}});Object.extend(Element.Layout,{PROPERTIES:$w('height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height'),COMPOSITE_PROPERTIES:$w('padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height'),COMPUTATIONS:{'height':function(element){if(!this._preComputing)this._begin();var bHeight=this.get('border-box-height');if(bHeight<=0){if(!this._preComputing)this._end();return 0;}
var bTop=this.get('border-top'),bBottom=this.get('border-bottom');var pTop=this.get('padding-top'),pBottom=this.get('padding-bottom');if(!this._preComputing)this._end();return bHeight-bTop-bBottom-pTop-pBottom;},'width':function(element){if(!this._preComputing)this._begin();var bWidth=this.get('border-box-width');if(bWidth<=0){if(!this._preComputing)this._end();return 0;}
var bLeft=this.get('border-left'),bRight=this.get('border-right');var pLeft=this.get('padding-left'),pRight=this.get('padding-right');if(!this._preComputing)this._end();return bWidth-bLeft-bRight-pLeft-pRight;},'padding-box-height':function(element){var height=this.get('height'),pTop=this.get('padding-top'),pBottom=this.get('padding-bottom');return height+pTop+pBottom;},'padding-box-width':function(element){var width=this.get('width'),pLeft=this.get('padding-left'),pRight=this.get('padding-right');return width+pLeft+pRight;},'border-box-height':function(element){if(!this._preComputing)this._begin();var height=element.offsetHeight;if(!this._preComputing)this._end();return height;},'border-box-width':function(element){if(!this._preComputing)this._begin();var width=element.offsetWidth;if(!this._preComputing)this._end();return width;},'margin-box-height':function(element){var bHeight=this.get('border-box-height'),mTop=this.get('margin-top'),mBottom=this.get('margin-bottom');if(bHeight<=0)return 0;return bHeight+mTop+mBottom;},'margin-box-width':function(element){var bWidth=this.get('border-box-width'),mLeft=this.get('margin-left'),mRight=this.get('margin-right');if(bWidth<=0)return 0;return bWidth+mLeft+mRight;},'top':function(element){var offset=element.positionedOffset();return offset.top;},'bottom':function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pHeight=parent.measure('height');var mHeight=this.get('border-box-height');return pHeight-mHeight-offset.top;},'left':function(element){var offset=element.positionedOffset();return offset.left;},'right':function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pWidth=parent.measure('width');var mWidth=this.get('border-box-width');return pWidth-mWidth-offset.left;},'padding-top':function(element){return getPixelValue(element,'paddingTop');},'padding-bottom':function(element){return getPixelValue(element,'paddingBottom');},'padding-left':function(element){return getPixelValue(element,'paddingLeft');},'padding-right':function(element){return getPixelValue(element,'paddingRight');},'border-top':function(element){return getPixelValue(element,'borderTopWidth');},'border-bottom':function(element){return getPixelValue(element,'borderBottomWidth');},'border-left':function(element){return getPixelValue(element,'borderLeftWidth');},'border-right':function(element){return getPixelValue(element,'borderRightWidth');},'margin-top':function(element){return getPixelValue(element,'marginTop');},'margin-bottom':function(element){return getPixelValue(element,'marginBottom');},'margin-left':function(element){return getPixelValue(element,'marginLeft');},'margin-right':function(element){return getPixelValue(element,'marginRight');}}});if('getBoundingClientRect'in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{'right':function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.right-rect.right).round();},'bottom':function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.bottom-rect.bottom).round();}});}
Element.Offset=Class.create({initialize:function(left,top){this.left=left.round();this.top=top.round();this[0]=this.left;this[1]=this.top;},relativeTo:function(offset){return new Element.Offset(this.left-offset.left,this.top-offset.top);},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this);},toString:function(){return"[#{left}, #{top}]".interpolate(this);},toArray:function(){return[this.left,this.top];}});function getLayout(element,preCompute){return new Element.Layout(element,preCompute);}
function measure(element,property){return $(element).getLayout().get(property);}
function getHeight(element){return Element.getDimensions(element).height;}
function getWidth(element){return Element.getDimensions(element).width;}
function getDimensions(element){element=$(element);var display=Element.getStyle(element,'display');if(display&&display!=='none'){return{width:element.offsetWidth,height:element.offsetHeight};}
var style=element.style;var originalStyles={visibility:style.visibility,position:style.position,display:style.display};var newStyles={visibility:'hidden',display:'block'};if(originalStyles.position!=='fixed')
newStyles.position='absolute';Element.setStyle(element,newStyles);var dimensions={width:element.offsetWidth,height:element.offsetHeight};Element.setStyle(element,originalStyles);return dimensions;}
function getOffsetParent(element){element=$(element);if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))
return $(document.body);var isInline=(Element.getStyle(element,'display')==='inline');if(!isInline&&element.offsetParent)return $(element.offsetParent);while((element=element.parentNode)&&element!==document.body){if(Element.getStyle(element,'position')!=='static'){return isHtml(element)?$(document.body):$(element);}}
return $(document.body);}
function cumulativeOffset(element){element=$(element);var valueT=0,valueL=0;if(element.parentNode){do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;}while(element);}
return new Element.Offset(valueL,valueT);}
function positionedOffset(element){element=$(element);var layout=element.getLayout();var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;if(element){if(isBody(element))break;var p=Element.getStyle(element,'position');if(p!=='static')break;}}while(element);valueL-=layout.get('margin-top');valueT-=layout.get('margin-left');return new Element.Offset(valueL,valueT);}
function cumulativeScrollOffset(element){var valueT=0,valueL=0;do{if(element===document.body){var bodyScrollNode=document.documentElement||document.body.parentNode||document.body;valueT+=!Object.isUndefined(window.pageYOffset)?window.pageYOffset:bodyScrollNode.scrollTop||0;valueL+=!Object.isUndefined(window.pageXOffset)?window.pageXOffset:bodyScrollNode.scrollLeft||0;break;}else{valueT+=element.scrollTop||0;valueL+=element.scrollLeft||0;element=element.parentNode;}}while(element);return new Element.Offset(valueL,valueT);}
function viewportOffset(forElement){var valueT=0,valueL=0,docBody=document.body;forElement=$(forElement);var element=forElement;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==docBody&&Element.getStyle(element,'position')=='absolute')break;}while(element=element.offsetParent);element=forElement;do{if(element!=docBody){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0;}}while(element=element.parentNode);return new Element.Offset(valueL,valueT);}
function absolutize(element){element=$(element);if(Element.getStyle(element,'position')==='absolute'){return element;}
var offsetParent=getOffsetParent(element);var eOffset=element.viewportOffset(),pOffset=offsetParent.viewportOffset();var offset=eOffset.relativeTo(pOffset);var layout=element.getLayout();element.store('prototype_absolutize_original_styles',{position:element.getStyle('position'),left:element.getStyle('left'),top:element.getStyle('top'),width:element.getStyle('width'),height:element.getStyle('height')});element.setStyle({position:'absolute',top:offset.top+'px',left:offset.left+'px',width:layout.get('width')+'px',height:layout.get('height')+'px'});return element;}
function relativize(element){element=$(element);if(Element.getStyle(element,'position')==='relative'){return element;}
var originalStyles=element.retrieve('prototype_absolutize_original_styles');if(originalStyles)element.setStyle(originalStyles);return element;}
function scrollTo(element){element=$(element);var pos=Element.cumulativeOffset(element);window.scrollTo(pos.left,pos.top);return element;}
function makePositioned(element){element=$(element);var position=Element.getStyle(element,'position'),styles={};if(position==='static'||!position){styles.position='relative';if(Prototype.Browser.Opera){styles.top=0;styles.left=0;}
Element.setStyle(element,styles);Element.store(element,'prototype_made_positioned',true);}
return element;}
function undoPositioned(element){element=$(element);var storage=Element.getStorage(element),madePositioned=storage.get('prototype_made_positioned');if(madePositioned){storage.unset('prototype_made_positioned');Element.setStyle(element,{position:'',top:'',bottom:'',left:'',right:''});}
return element;}
function makeClipping(element){element=$(element);var storage=Element.getStorage(element),madeClipping=storage.get('prototype_made_clipping');if(Object.isUndefined(madeClipping)){var overflow=Element.getStyle(element,'overflow');storage.set('prototype_made_clipping',overflow);if(overflow!=='hidden')
element.style.overflow='hidden';}
return element;}
function undoClipping(element){element=$(element);var storage=Element.getStorage(element),overflow=storage.get('prototype_made_clipping');if(!Object.isUndefined(overflow)){storage.unset('prototype_made_clipping');element.style.overflow=overflow||'';}
return element;}
function clonePosition(element,source,options){options=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},options||{});source=$(source);element=$(element);var p,delta,layout,styles={};if(options.setLeft||options.setTop){p=Element.viewportOffset(source);delta=[0,0];if(Element.getStyle(element,'position')==='absolute'){var parent=Element.getOffsetParent(element);if(parent!==document.body)delta=Element.viewportOffset(parent);}}
if(options.setWidth||options.setHeight){layout=Element.getLayout(source);}
if(options.setLeft)
styles.left=(p[0]-delta[0]+options.offsetLeft)+'px';if(options.setTop)
styles.top=(p[1]-delta[1]+options.offsetTop)+'px';if(options.setWidth)
styles.width=layout.get('border-box-width')+'px';if(options.setHeight)
styles.height=layout.get('border-box-height')+'px';return Element.setStyle(element,styles);}
if(Prototype.Browser.IE){getOffsetParent=getOffsetParent.wrap(function(proceed,element){element=$(element);if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))
return $(document.body);var position=element.getStyle('position');if(position!=='static')return proceed(element);element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});positionedOffset=positionedOffset.wrap(function(proceed,element){element=$(element);if(!element.parentNode)return new Element.Offset(0,0);var position=element.getStyle('position');if(position!=='static')return proceed(element);var offsetParent=element.getOffsetParent();if(offsetParent&&offsetParent.getStyle('position')==='fixed')
hasLayout(offsetParent);element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});}else if(Prototype.Browser.Webkit){cumulativeOffset=function(element){element=$(element);var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body){if(Element.getStyle(element,'position')=='absolute')break;}
element=element.offsetParent;}while(element);return new Element.Offset(valueL,valueT);};}
Element.addMethods({getLayout:getLayout,measure:measure,getWidth:getWidth,getHeight:getHeight,getDimensions:getDimensions,getOffsetParent:getOffsetParent,cumulativeOffset:cumulativeOffset,positionedOffset:positionedOffset,cumulativeScrollOffset:cumulativeScrollOffset,viewportOffset:viewportOffset,absolutize:absolutize,relativize:relativize,scrollTo:scrollTo,makePositioned:makePositioned,undoPositioned:undoPositioned,makeClipping:makeClipping,undoClipping:undoClipping,clonePosition:clonePosition});function isBody(element){return element.nodeName.toUpperCase()==='BODY';}
function isHtml(element){return element.nodeName.toUpperCase()==='HTML';}
function isDocument(element){return element.nodeType===Node.DOCUMENT_NODE;}
function isDetached(element){return element!==document.body&&!Element.descendantOf(element,document.body);}
if('getBoundingClientRect'in document.documentElement){Element.addMethods({viewportOffset:function(element){element=$(element);if(isDetached(element))return new Element.Offset(0,0);var rect=element.getBoundingClientRect(),docEl=document.documentElement;return new Element.Offset(rect.left-docEl.clientLeft,rect.top-docEl.clientTop);}});}})();(function(){var IS_OLD_OPERA=Prototype.Browser.Opera&&(window.parseFloat(window.opera.version())<9.5);var ROOT=null;function getRootElement(){if(ROOT)return ROOT;ROOT=IS_OLD_OPERA?document.body:document.documentElement;return ROOT;}
function getDimensions(){return{width:this.getWidth(),height:this.getHeight()};}
function getWidth(){return getRootElement().clientWidth;}
function getHeight(){return getRootElement().clientHeight;}
function getScrollOffsets(){var x=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;var y=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return new Element.Offset(x,y);}
document.viewport={getDimensions:getDimensions,getWidth:getWidth,getHeight:getHeight,getScrollOffsets:getScrollOffsets};})();window.$$=function(){var expression=$A(arguments).join(', ');return Prototype.Selector.select(expression,document);};Prototype.Selector=(function(){function select(){throw new Error('Method "Prototype.Selector.select" must be defined.');}
function match(){throw new Error('Method "Prototype.Selector.match" must be defined.');}
function find(elements,expression,index){index=index||0;var match=Prototype.Selector.match,length=elements.length,matchIndex=0,i;for(i=0;i<length;i++){if(match(elements[i],expression)&&index==matchIndex++){return Element.extend(elements[i]);}}}
function extendElements(elements){for(var i=0,length=elements.length;i<length;i++){Element.extend(elements[i]);}
return elements;}
var K=Prototype.K;return{select:select,match:match,find:find,extendElements:(Element.extend===K)?K:extendElements,extendElement:Element.extend};})();Prototype._original_property=window.Sizzle;(function(window){var i,support,Expr,getText,isXML,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true;}
return 0;},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i;}}
return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+
whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-0x10000;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1;}};}
function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context);}
context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results;}
if((nodeType=context.nodeType)!==1&&nodeType!==9){return[];}
if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&");}else{context.setAttribute("id",nid);}
nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}
newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",");}
if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}
return(cache[key+" "]=value);}
return cache;}
function markFunction(fn){fn[expando]=true;return fn;}
function assert(fn){var div=document.createElement("div");try{return!!fn(div);}catch(e){return false;}finally{if(div.parentNode){div.parentNode.removeChild(div);}
div=null;}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-
(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1;}}}
return a?1:-1;}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}
function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context;}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument();},false);}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument();});}}
support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className");});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2;});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length;});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId;};};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}
return tmp;}
return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>";if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}
if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled");}
div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}
if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}
return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}
compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1;}
if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1;}
return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}
return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}
var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}
return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}
return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context);}
return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}
while(j--){results.splice(duplicates[j],1);}}
sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}
return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}
return match;},"PSEUDO":function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]&&match[4]!==undefined){match[2]=match[4];}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}
if(!operator){return true;}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}
return true;}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}
if(node===elem){break;}}}}
diff-=last;return diff===first||(diff%first===0&&diff/first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}
return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":function(elem){return elem.disabled===false;},"disabled":function(elem){return elem.disabled===true;},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}
return true;},"parent":function(elem){return!Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}
return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}
return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}
for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}
groups.push((tokens=[]));}
matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}
if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);}
function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}
return selector;}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2]);}else{outerCache[dir]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true;}}}}}};}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}
return true;}:matchers[0];}
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}
return results;}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}
return newUnmatched;}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}
postFinder(null,(matcherOut=[]),temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}
matchers.push(matcher);}}
return elementMatcher(matchers);}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context!==document&&context;}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break;}}
if(outermost){dirruns=dirrunsUnique;}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}
return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}
compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}
i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}
return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}
selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}
break;}}}}
(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1;});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(div){return div.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}
if(typeof define==="function"&&define.amd){define(function(){return Sizzle;});}else if(typeof module!=="undefined"&&module.exports){module.exports=Sizzle;}else{window.Sizzle=Sizzle;}})(window);;(function(engine){var extendElements=Prototype.Selector.extendElements;function select(selector,scope){return extendElements(engine(selector,scope||document));}
function match(element,selector){return engine.matches(selector,[element]).length==1;}
Prototype.Selector.engine=engine;Prototype.Selector.select=select;Prototype.Selector.match=match;})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(form){form=$(form);form.reset();return form;},serializeElements:function(elements,options){if(typeof options!='object')options={hash:!!options};else if(Object.isUndefined(options.hash))options.hash=true;var key,value,submitted=false,submit=options.submit,accumulator,initial;if(options.hash){initial={};accumulator=function(result,key,value){if(key in result){if(!Object.isArray(result[key]))result[key]=[result[key]];result[key]=result[key].concat(value);}else result[key]=value;return result;};}else{initial='';accumulator=function(result,key,values){if(!Object.isArray(values)){values=[values];}
if(!values.length){return result;}
var encodedKey=encodeURIComponent(key).gsub(/%20/,'+');return result+(result?"&":"")+values.map(function(value){value=value.gsub(/(\r)?\n/,'\r\n');value=encodeURIComponent(value);value=value.gsub(/%20/,'+');return encodedKey+"="+value;}).join("&");};}
return elements.inject(initial,function(result,element){if(!element.disabled&&element.name){key=element.name;value=$(element).getValue();if(value!=null&&element.type!='file'&&(element.type!='submit'||(!submitted&&submit!==false&&(!submit||key==submit)&&(submitted=true)))){result=accumulator(result,key,value);}}
return result;});}};Form.Methods={serialize:function(form,options){return Form.serializeElements(Form.getElements(form),options);},getElements:function(form){var elements=$(form).getElementsByTagName('*');var element,results=[],serializers=Form.Element.Serializers;for(var i=0;element=elements[i];i++){if(serializers[element.tagName.toLowerCase()])
results.push(Element.extend(element));}
return results;},getInputs:function(form,typeName,name){form=$(form);var inputs=form.getElementsByTagName('input');if(!typeName&&!name)return $A(inputs).map(Element.extend);for(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){var input=inputs[i];if((typeName&&input.type!=typeName)||(name&&input.name!=name))
continue;matchingInputs.push(Element.extend(input));}
return matchingInputs;},disable:function(form){form=$(form);Form.getElements(form).invoke('disable');return form;},enable:function(form){form=$(form);Form.getElements(form).invoke('enable');return form;},findFirstElement:function(form){var elements=$(form).getElements().findAll(function(element){return'hidden'!=element.type&&!element.disabled;});var firstByIndex=elements.findAll(function(element){return element.hasAttribute('tabIndex')&&element.tabIndex>=0;}).sortBy(function(element){return element.tabIndex}).first();return firstByIndex?firstByIndex:elements.find(function(element){return/^(?:input|select|textarea)$/i.test(element.tagName);});},focusFirstElement:function(form){form=$(form);var element=form.findFirstElement();if(element)element.activate();return form;},request:function(form,options){form=$(form),options=Object.clone(options||{});var params=options.parameters,action=form.readAttribute('action')||'';if(action.blank())action=window.location.href;options.parameters=form.serialize(true);if(params){if(Object.isString(params))params=params.toQueryParams();Object.extend(options.parameters,params);}
if(form.hasAttribute('method')&&!options.method)
options.method=form.method;return new Ajax.Request(action,options);}};Form.Element={focus:function(element){$(element).focus();return element;},select:function(element){$(element).select();return element;}};Form.Element.Methods={serialize:function(element){element=$(element);if(!element.disabled&&element.name){var value=element.getValue();if(value!=undefined){var pair={};pair[element.name]=value;return Object.toQueryString(pair);}}
return'';},getValue:function(element){element=$(element);var method=element.tagName.toLowerCase();return Form.Element.Serializers[method](element);},setValue:function(element,value){element=$(element);var method=element.tagName.toLowerCase();Form.Element.Serializers[method](element,value);return element;},clear:function(element){$(element).value='';return element;},present:function(element){return $(element).value!='';},activate:function(element){element=$(element);try{element.focus();if(element.select&&(element.tagName.toLowerCase()!='input'||!(/^(?:button|reset|submit)$/i.test(element.type))))
element.select();}catch(e){}
return element;},disable:function(element){element=$(element);element.disabled=true;return element;},enable:function(element){element=$(element);element.disabled=false;return element;}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=(function(){function input(element,value){switch(element.type.toLowerCase()){case'checkbox':case'radio':return inputSelector(element,value);default:return valueSelector(element,value);}}
function inputSelector(element,value){if(Object.isUndefined(value))
return element.checked?element.value:null;else element.checked=!!value;}
function valueSelector(element,value){if(Object.isUndefined(value))return element.value;else element.value=value;}
function select(element,value){if(Object.isUndefined(value))
return(element.type==='select-one'?selectOne:selectMany)(element);var opt,currentValue,single=!Object.isArray(value);for(var i=0,length=element.length;i<length;i++){opt=element.options[i];currentValue=this.optionValue(opt);if(single){if(currentValue==value){opt.selected=true;return;}}
else opt.selected=value.include(currentValue);}}
function selectOne(element){var index=element.selectedIndex;return index>=0?optionValue(element.options[index]):null;}
function selectMany(element){var values,length=element.length;if(!length)return null;for(var i=0,values=[];i<length;i++){var opt=element.options[i];if(opt.selected)values.push(optionValue(opt));}
return values;}
function optionValue(opt){return Element.hasAttribute(opt,'value')?opt.value:opt.text;}
return{input:input,inputSelector:inputSelector,textarea:valueSelector,select:select,selectOne:selectOne,selectMany:selectMany,optionValue:optionValue,button:valueSelector};})();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,element,frequency,callback){$super(callback,frequency);this.element=$(element);this.lastValue=this.getValue();},execute:function(){var value=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(value)?this.lastValue!=value:String(this.lastValue)!=String(value)){this.callback(this.element,value);this.lastValue=value;}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=Class.create({initialize:function(element,callback){this.element=$(element);this.callback=callback;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=='form')
this.registerFormCallbacks();else
this.registerCallback(this.element);},onElementEvent:function(){var value=this.getValue();if(this.lastValue!=value){this.callback(this.element,value);this.lastValue=value;}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this);},registerCallback:function(element){if(element.type){switch(element.type.toLowerCase()){case'checkbox':case'radio':Event.observe(element,'click',this.onElementEvent.bind(this));break;default:Event.observe(element,'change',this.onElementEvent.bind(this));break;}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element);}});(function(GLOBAL){var DIV=document.createElement('div');var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED='onmouseenter'in docEl&&'onmouseleave'in docEl;var Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};var isIELegacyEvent=function(event){return false;};if(window.attachEvent){if(window.addEventListener){isIELegacyEvent=function(event){return!(event instanceof window.Event);};}else{isIELegacyEvent=function(event){return true;};}}
var _isButton;function _isButtonForDOMEvents(event,code){return event.which?(event.which===code+1):(event.button===code);}
var legacyButtonMap={0:1,1:4,2:2};function _isButtonForLegacyEvents(event,code){return event.button===legacyButtonMap[code];}
function _isButtonForWebKit(event,code){switch(code){case 0:return event.which==1&&!event.metaKey;case 1:return event.which==2||(event.which==1&&event.metaKey);case 2:return event.which==3;default:return false;}}
if(window.attachEvent){if(!window.addEventListener){_isButton=_isButtonForLegacyEvents;}else{_isButton=function(event,code){return isIELegacyEvent(event)?_isButtonForLegacyEvents(event,code):_isButtonForDOMEvents(event,code);}}}else if(Prototype.Browser.WebKit){_isButton=_isButtonForWebKit;}else{_isButton=_isButtonForDOMEvents;}
function isLeftClick(event){return _isButton(event,0)}
function isMiddleClick(event){return _isButton(event,1)}
function isRightClick(event){return _isButton(event,2)}
function element(event){return Element.extend(_element(event));}
function _element(event){event=Event.extend(event);var node=event.target,type=event.type,currentTarget=event.currentTarget;if(currentTarget&&currentTarget.tagName){if(type==='load'||type==='error'||(type==='click'&&currentTarget.tagName.toLowerCase()==='input'&&currentTarget.type==='radio'))
node=currentTarget;}
return node.nodeType==Node.TEXT_NODE?node.parentNode:node;}
function findElement(event,expression){var element=_element(event),selector=Prototype.Selector;if(!expression)return Element.extend(element);while(element){if(Object.isElement(element)&&selector.match(element,expression))
return Element.extend(element);element=element.parentNode;}}
function pointer(event){return{x:pointerX(event),y:pointerY(event)};}
function pointerX(event){var docElement=document.documentElement,body=document.body||{scrollLeft:0};return event.pageX||(event.clientX+
(docElement.scrollLeft||body.scrollLeft)-
(docElement.clientLeft||0));}
function pointerY(event){var docElement=document.documentElement,body=document.body||{scrollTop:0};return event.pageY||(event.clientY+
(docElement.scrollTop||body.scrollTop)-
(docElement.clientTop||0));}
function stop(event){Event.extend(event);event.preventDefault();event.stopPropagation();event.stopped=true;}
Event.Methods={isLeftClick:isLeftClick,isMiddleClick:isMiddleClick,isRightClick:isRightClick,element:element,findElement:findElement,pointer:pointer,pointerX:pointerX,pointerY:pointerY,stop:stop};var methods=Object.keys(Event.Methods).inject({},function(m,name){m[name]=Event.Methods[name].methodize();return m;});if(window.attachEvent){function _relatedTarget(event){var element;switch(event.type){case'mouseover':case'mouseenter':element=event.fromElement;break;case'mouseout':case'mouseleave':element=event.toElement;break;default:return null;}
return Element.extend(element);}
var additionalMethods={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return'[object Event]'}};Event.extend=function(event,element){if(!event)return false;if(!isIELegacyEvent(event))return event;if(event._extendedByPrototype)return event;event._extendedByPrototype=Prototype.emptyFunction;var pointer=Event.pointer(event);Object.extend(event,{target:event.srcElement||element,relatedTarget:_relatedTarget(event),pageX:pointer.x,pageY:pointer.y});Object.extend(event,methods);Object.extend(event,additionalMethods);return event;};}else{Event.extend=Prototype.K;}
if(window.addEventListener){Event.prototype=window.Event.prototype||document.createEvent('HTMLEvents').__proto__;Object.extend(Event.prototype,methods);}
var EVENT_TRANSLATIONS={mouseenter:'mouseover',mouseleave:'mouseout'};function getDOMEventName(eventName){return EVENT_TRANSLATIONS[eventName]||eventName;}
if(MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED)
getDOMEventName=Prototype.K;function getUniqueElementID(element){if(element===window)return 0;if(typeof element._prototypeUID==='undefined')
element._prototypeUID=Element.Storage.UID++;return element._prototypeUID;}
function getUniqueElementID_IE(element){if(element===window)return 0;if(element==document)return 1;return element.uniqueID;}
if('uniqueID'in DIV)
getUniqueElementID=getUniqueElementID_IE;function isCustomEvent(eventName){return eventName.include(':');}
Event._isCustomEvent=isCustomEvent;function getRegistryForElement(element,uid){var CACHE=GLOBAL.Event.cache;if(Object.isUndefined(uid))
uid=getUniqueElementID(element);if(!CACHE[uid])CACHE[uid]={element:element};return CACHE[uid];}
function destroyRegistryForElement(element,uid){if(Object.isUndefined(uid))
uid=getUniqueElementID(element);delete GLOBAL.Event.cache[uid];}
function register(element,eventName,handler){var registry=getRegistryForElement(element);if(!registry[eventName])registry[eventName]=[];var entries=registry[eventName];var i=entries.length;while(i--)
if(entries[i].handler===handler)return null;var uid=getUniqueElementID(element);var responder=GLOBAL.Event._createResponder(uid,eventName,handler);var entry={responder:responder,handler:handler};entries.push(entry);return entry;}
function unregister(element,eventName,handler){var registry=getRegistryForElement(element);var entries=registry[eventName];if(!entries)return;var i=entries.length,entry;while(i--){if(entries[i].handler===handler){entry=entries[i];break;}}
if(!entry)return;var index=entries.indexOf(entry);entries.splice(index,1);return entry;}
function observe(element,eventName,handler){element=$(element);var entry=register(element,eventName,handler);if(entry===null)return element;var responder=entry.responder;if(isCustomEvent(eventName))
observeCustomEvent(element,eventName,responder);else
observeStandardEvent(element,eventName,responder);return element;}
function observeStandardEvent(element,eventName,responder){var actualEventName=getDOMEventName(eventName);if(element.addEventListener){element.addEventListener(actualEventName,responder,false);}else{element.attachEvent('on'+actualEventName,responder);}}
function observeCustomEvent(element,eventName,responder){if(element.addEventListener){element.addEventListener('dataavailable',responder,false);}else{element.attachEvent('ondataavailable',responder);element.attachEvent('onlosecapture',responder);}}
function stopObserving(element,eventName,handler){element=$(element);var handlerGiven=!Object.isUndefined(handler),eventNameGiven=!Object.isUndefined(eventName);if(!eventNameGiven&&!handlerGiven){stopObservingElement(element);return element;}
if(!handlerGiven){stopObservingEventName(element,eventName);return element;}
var entry=unregister(element,eventName,handler);if(!entry)return element;removeEvent(element,eventName,entry.responder);return element;}
function stopObservingStandardEvent(element,eventName,responder){var actualEventName=getDOMEventName(eventName);if(element.removeEventListener){element.removeEventListener(actualEventName,responder,false);}else{element.detachEvent('on'+actualEventName,responder);}}
function stopObservingCustomEvent(element,eventName,responder){if(element.removeEventListener){element.removeEventListener('dataavailable',responder,false);}else{element.detachEvent('ondataavailable',responder);element.detachEvent('onlosecapture',responder);}}
function stopObservingElement(element){var uid=getUniqueElementID(element),registry=GLOBAL.Event.cache[uid];if(!registry)return;destroyRegistryForElement(element,uid);var entries,i;for(var eventName in registry){if(eventName==='element')continue;entries=registry[eventName];i=entries.length;while(i--)
removeEvent(element,eventName,entries[i].responder);}}
function stopObservingEventName(element,eventName){var registry=getRegistryForElement(element);var entries=registry[eventName];if(!entries)return;delete registry[eventName];var i=entries.length;while(i--)
removeEvent(element,eventName,entries[i].responder);}
function removeEvent(element,eventName,handler){if(isCustomEvent(eventName))
stopObservingCustomEvent(element,eventName,handler);else
stopObservingStandardEvent(element,eventName,handler);}
function getFireTarget(element){if(element!==document)return element;if(document.createEvent&&!element.dispatchEvent)
return document.documentElement;return element;}
function fire(element,eventName,memo,bubble){element=getFireTarget($(element));if(Object.isUndefined(bubble))bubble=true;memo=memo||{};var event=fireEvent(element,eventName,memo,bubble);return Event.extend(event);}
function fireEvent_DOM(element,eventName,memo,bubble){var event=document.createEvent('HTMLEvents');event.initEvent('dataavailable',bubble,true);event.eventName=eventName;event.memo=memo;element.dispatchEvent(event);return event;}
function fireEvent_IE(element,eventName,memo,bubble){var event=document.createEventObject();event.eventType=bubble?'ondataavailable':'onlosecapture';event.eventName=eventName;event.memo=memo;element.fireEvent(event.eventType,event);return event;}
var fireEvent=document.createEvent?fireEvent_DOM:fireEvent_IE;Event.Handler=Class.create({initialize:function(element,eventName,selector,callback){this.element=$(element);this.eventName=eventName;this.selector=selector;this.callback=callback;this.handler=this.handleEvent.bind(this);},start:function(){Event.observe(this.element,this.eventName,this.handler);return this;},stop:function(){Event.stopObserving(this.element,this.eventName,this.handler);return this;},handleEvent:function(event){var element=Event.findElement(event,this.selector);if(element)this.callback.call(this.element,event,element);}});function on(element,eventName,selector,callback){element=$(element);if(Object.isFunction(selector)&&Object.isUndefined(callback)){callback=selector,selector=null;}
return new Event.Handler(element,eventName,selector,callback).start();}
Object.extend(Event,Event.Methods);Object.extend(Event,{fire:fire,observe:observe,stopObserving:stopObserving,on:on});Element.addMethods({fire:fire,observe:observe,stopObserving:stopObserving,on:on});Object.extend(document,{fire:fire.methodize(),observe:observe.methodize(),stopObserving:stopObserving.methodize(),on:on.methodize(),loaded:false});if(GLOBAL.Event)Object.extend(window.Event,Event);else GLOBAL.Event=Event;GLOBAL.Event.cache={};function destroyCache_IE(){GLOBAL.Event.cache=null;}
if(window.attachEvent)
window.attachEvent('onunload',destroyCache_IE);DIV=null;docEl=null;})(this);(function(GLOBAL){var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED='onmouseenter'in docEl&&'onmouseleave'in docEl;function isSimulatedMouseEnterLeaveEvent(eventName){return!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED&&(eventName==='mouseenter'||eventName==='mouseleave');}
function createResponder(uid,eventName,handler){if(Event._isCustomEvent(eventName))
return createResponderForCustomEvent(uid,eventName,handler);if(isSimulatedMouseEnterLeaveEvent(eventName))
return createMouseEnterLeaveResponder(uid,eventName,handler);return function(event){if(!Event.cache)return;var element=Event.cache[uid].element;Event.extend(event,element);handler.call(element,event);};}
function createResponderForCustomEvent(uid,eventName,handler){return function(event){var element=Event.cache[uid].element;if(Object.isUndefined(event.eventName))
return false;if(event.eventName!==eventName)
return false;Event.extend(event,element);handler.call(element,event);};}
function createMouseEnterLeaveResponder(uid,eventName,handler){return function(event){var element=Event.cache[uid].element;Event.extend(event,element);var parent=event.relatedTarget;while(parent&&parent!==element){try{parent=parent.parentNode;}
catch(e){parent=element;}}
if(parent===element)return;handler.call(element,event);}}
GLOBAL.Event._createResponder=createResponder;docEl=null;})(this);(function(GLOBAL){var TIMER;function fireContentLoadedEvent(){if(document.loaded)return;if(TIMER)window.clearTimeout(TIMER);document.loaded=true;document.fire('dom:loaded');}
function checkReadyState(){if(document.readyState==='complete'){document.detachEvent('onreadystatechange',checkReadyState);fireContentLoadedEvent();}}
function pollDoScroll(){try{document.documentElement.doScroll('left');}catch(e){TIMER=pollDoScroll.defer();return;}
fireContentLoadedEvent();}
if(document.readyState==='complete'){fireContentLoadedEvent();return;}
if(document.addEventListener){document.addEventListener('DOMContentLoaded',fireContentLoadedEvent,false);}else{document.attachEvent('onreadystatechange',checkReadyState);if(window==top)TIMER=pollDoScroll.defer();}
Event.observe(window,'load',fireContentLoadedEvent);})(this);Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(element,content){return Element.insert(element,{before:content});},Top:function(element,content){return Element.insert(element,{top:content});},Bottom:function(element,content){return Element.insert(element,{bottom:content});},After:function(element,content){return Element.insert(element,{after:content});}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},within:function(element,x,y){if(this.includeScrollOffsets)
return this.withinIncludingScrolloffsets(element,x,y);this.xcomp=x;this.ycomp=y;this.offset=Element.cumulativeOffset(element);return(y>=this.offset[1]&&y<this.offset[1]+element.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+element.offsetWidth);},withinIncludingScrolloffsets:function(element,x,y){var offsetcache=Element.cumulativeScrollOffset(element);this.xcomp=x+offsetcache[0]-this.deltaX;this.ycomp=y+offsetcache[1]-this.deltaY;this.offset=Element.cumulativeOffset(element);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+element.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+element.offsetWidth);},overlap:function(mode,element){if(!mode)return 0;if(mode=='vertical')
return((this.offset[1]+element.offsetHeight)-this.ycomp)/element.offsetHeight;if(mode=='horizontal')
return((this.offset[0]+element.offsetWidth)-this.xcomp)/element.offsetWidth;},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(element){Position.prepare();return Element.absolutize(element);},relativize:function(element){Position.prepare();return Element.relativize(element);},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(source,target,options){options=options||{};return Element.clonePosition(target,source,options);}};if(!document.getElementsByClassName)document.getElementsByClassName=function(instanceMethods){function iter(name){return name.blank()?null:"[contains(concat(' ', @class, ' '), ' "+name+" ')]";}
instanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(element,className){className=className.toString().strip();var cond=/\s/.test(className)?$w(className).map(iter).join(''):iter(className);return cond?document._getElementsByXPath('.//*'+cond,element):[];}:function(element,className){className=className.toString().strip();var elements=[],classNames=(/\s/.test(className)?$w(className):null);if(!classNames&&!className)return elements;var nodes=$(element).getElementsByTagName('*');className=' '+className+' ';for(var i=0,child,cn;child=nodes[i];i++){if(child.className&&(cn=' '+child.className+' ')&&(cn.include(className)||(classNames&&classNames.all(function(name){return!name.toString().blank()&&cn.include(' '+name+' ');}))))
elements.push(Element.extend(child));}
return elements;};return function(className,parentElement){return $(parentElement||document.body).getElementsByClassName(className);};}(Element.Methods);Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(element){this.element=$(element);},_each:function(iterator,context){this.element.className.split(/\s+/).select(function(name){return name.length>0;})._each(iterator,context);},set:function(className){this.element.className=className;},add:function(classNameToAdd){if(this.include(classNameToAdd))return;this.set($A(this).concat(classNameToAdd).join(' '));},remove:function(classNameToRemove){if(!this.include(classNameToRemove))return;this.set($A(this).without(classNameToRemove).join(' '));},toString:function(){return $A(this).join(' ');}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(expression){this.expression=expression.strip();},findElements:function(rootElement){return Prototype.Selector.select(this.expression,rootElement);},match:function(element){return Prototype.Selector.match(element,this.expression);},toString:function(){return this.expression;},inspect:function(){return"#<Selector: "+this.expression+">";}});Object.extend(Selector,{matchElements:function(elements,expression){var match=Prototype.Selector.match,results=[];for(var i=0,length=elements.length;i<length;i++){var element=elements[i];if(match(element,expression)){results.push(Element.extend(element));}}
return results;},findElement:function(elements,expression,index){index=index||0;var matchIndex=0,element;for(var i=0,length=elements.length;i<length;i++){element=elements[i];if(Prototype.Selector.match(element,expression)&&index===matchIndex++){return Element.extend(element);}}},findChildElements:function(element,expressions){var selector=expressions.toArray().join(', ');return Prototype.Selector.select(selector,element||document);}});})();String.prototype.parseColor=function(){var color='#';if(this.slice(0,4)=='rgb('){var cols=this.slice(4,this.length-1).split(',');var i=0;do{color+=parseInt(cols[i]).toColorPart()}while(++i<3);}else{if(this.slice(0,1)=='#'){if(this.length==4)for(var i=1;i<4;i++)color+=(this.charAt(i)+this.charAt(i)).toLowerCase();if(this.length==7)color=this.toLowerCase();}}
return(color.length==7?color:(arguments[0]||this));};Element.collectTextNodes=function(element){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):''));}).flatten().join('');};Element.collectTextNodesIgnoreClass=function(element,className){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,className))?Element.collectTextNodesIgnoreClass(node,className):''));}).flatten().join('');};Element.setContentZoom=function(element,percent){element=$(element);element.setStyle({fontSize:(percent/100)+'em'});if(Prototype.Browser.WebKit)window.scrollBy(0,0);return element;};Element.getInlineOpacity=function(element){return $(element).style.opacity||'';};Element.forceRerendering=function(element){try{element=$(element);var n=document.createTextNode(' ');element.appendChild(n);element.removeChild(n);}catch(e){}};var Effect={_elementDoesNotExistError:{name:'ElementDoesNotExistError',message:'The specified DOM element does not exist, but is required for this effect to operate'},Transitions:{linear:Prototype.K,sinoidal:function(pos){return(-Math.cos(pos*Math.PI)/2)+.5;},reverse:function(pos){return 1-pos;},flicker:function(pos){var pos=((-Math.cos(pos*Math.PI)/4)+.75)+Math.random()/4;return pos>1?1:pos;},wobble:function(pos){return(-Math.cos(pos*Math.PI*(9*pos))/2)+.5;},pulse:function(pos,pulses){return(-Math.cos((pos*((pulses||5)-.5)*2)*Math.PI)/2)+.5;},spring:function(pos){return 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6));},none:function(pos){return 0;},full:function(pos){return 1;}},DefaultOptions:{duration:1.0,fps:100,sync:false,from:0.0,to:1.0,delay:0.0,queue:'parallel'},tagifyText:function(element){var tagifyStyle='position:relative';if(Prototype.Browser.IE)tagifyStyle+=';zoom:1';element=$(element);$A(element.childNodes).each(function(child){if(child.nodeType==3){child.nodeValue.toArray().each(function(character){element.insertBefore(new Element('span',{style:tagifyStyle}).update(character==' '?String.fromCharCode(160):character),child);});Element.remove(child);}});},multiple:function(element,effect){var elements;if(((typeof element=='object')||Object.isFunction(element))&&(element.length))
elements=element;else
elements=$(element).childNodes;var options=Object.extend({speed:0.1,delay:0.0},arguments[2]||{});var masterDelay=options.delay;$A(elements).each(function(element,index){new effect(element,Object.extend(options,{delay:index*options.speed+masterDelay}));});},PAIRS:{'slide':['SlideDown','SlideUp'],'blind':['BlindDown','BlindUp'],'appear':['Appear','Fade']},toggle:function(element,effect,options){element=$(element);effect=(effect||'appear').toLowerCase();return Effect[Effect.PAIRS[effect][element.visible()?1:0]](element,Object.extend({queue:{position:'end',scope:(element.id||'global'),limit:1}},options||{}));}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null;},_each:function(iterator){this.effects._each(iterator);},add:function(effect){var timestamp=new Date().getTime();var position=Object.isString(effect.options.queue)?effect.options.queue:effect.options.queue.position;switch(position){case'front':this.effects.findAll(function(e){return e.state=='idle'}).each(function(e){e.startOn+=effect.finishOn;e.finishOn+=effect.finishOn;});break;case'with-last':timestamp=this.effects.pluck('startOn').max()||timestamp;break;case'end':timestamp=this.effects.pluck('finishOn').max()||timestamp;break;}
effect.startOn+=timestamp;effect.finishOn+=timestamp;if(!effect.options.queue.limit||(this.effects.length<effect.options.queue.limit))
this.effects.push(effect);if(!this.interval)
this.interval=setInterval(this.loop.bind(this),15);},remove:function(effect){this.effects=this.effects.reject(function(e){return e==effect});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var timePos=new Date().getTime();for(var i=0,len=this.effects.length;i<len;i++)
this.effects[i]&&this.effects[i].loop(timePos);}});Effect.Queues={instances:$H(),get:function(queueName){if(!Object.isString(queueName))return queueName;return this.instances.get(queueName)||this.instances.set(queueName,new Effect.ScopedQueue());}};Effect.Queue=Effect.Queues.get('global');Effect.Base=Class.create({position:null,start:function(options){if(options&&options.transition===false)options.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state='idle';this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function dispatch(effect,eventName){if(effect.options[eventName+'Internal'])
effect.options[eventName+'Internal'](effect);if(effect.options[eventName])
effect.options[eventName](effect);}
return function(pos){if(this.state==="idle"){this.state="running";dispatch(this,'beforeSetup');if(this.setup)this.setup();dispatch(this,'afterSetup');}
if(this.state==="running"){pos=(this.options.transition(pos)*this.fromToDelta)+this.options.from;this.position=pos;dispatch(this,'beforeUpdate');if(this.update)this.update(pos);dispatch(this,'afterUpdate');}};})();this.event('beforeStart');if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).add(this);},loop:function(timePos){if(timePos>=this.startOn){if(timePos>=this.finishOn){this.render(1.0);this.cancel();this.event('beforeFinish');if(this.finish)this.finish();this.event('afterFinish');return;}
var pos=(timePos-this.startOn)/this.totalTime,frame=(pos*this.totalFrames).round();if(frame>this.currentFrame){this.render(pos);this.currentFrame=frame;}}},cancel:function(){if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).remove(this);this.state='finished';},event:function(eventName){if(this.options[eventName+'Internal'])this.options[eventName+'Internal'](this);if(this.options[eventName])this.options[eventName](this);},inspect:function(){var data=$H();for(property in this)
if(!Object.isFunction(this[property]))data.set(property,this[property]);return'#<Effect:'+data.inspect()+',options:'+$H(this.options).inspect()+'>';}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(effects){this.effects=effects||[];this.start(arguments[1]);},update:function(position){this.effects.invoke('render',position);},finish:function(position){this.effects.each(function(effect){effect.render(1.0);effect.cancel();effect.event('beforeFinish');if(effect.finish)effect.finish(position);effect.event('afterFinish');});}});Effect.Tween=Class.create(Effect.Base,{initialize:function(object,from,to){object=Object.isString(object)?$(object):object;var args=$A(arguments),method=args.last(),options=args.length==5?args[3]:null;this.method=Object.isFunction(method)?method.bind(object):Object.isFunction(object[method])?object[method].bind(object):function(value){object[method]=value};this.start(Object.extend({from:from,to:to},options||{}));},update:function(position){this.method(position);}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}));},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});var options=Object.extend({from:this.element.getOpacity()||0.0,to:1.0},arguments[1]||{});this.start(options);},update:function(position){this.element.setOpacity(position);}});Effect.Move=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({x:0,y:0,mode:'relative'},arguments[1]||{});this.start(options);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle('left')||'0');this.originalTop=parseFloat(this.element.getStyle('top')||'0');if(this.options.mode=='absolute'){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(position){this.element.setStyle({left:(this.options.x*position+this.originalLeft).round()+'px',top:(this.options.y*position+this.originalTop).round()+'px'});}});Effect.MoveBy=function(element,toTop,toLeft){return new Effect.Move(element,Object.extend({x:toLeft,y:toTop},arguments[3]||{}));};Effect.Scale=Class.create(Effect.Base,{initialize:function(element,percent){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100.0,scaleTo:percent},arguments[2]||{});this.start(options);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle('position');this.originalStyle={};['top','left','width','height','fontSize'].each(function(k){this.originalStyle[k]=this.element.style[k];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var fontSize=this.element.getStyle('font-size')||'100%';['em','px','%','pt'].each(function(fontSizeType){if(fontSize.indexOf(fontSizeType)>0){this.fontSize=parseFloat(fontSize);this.fontSizeType=fontSizeType;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=='box')
this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))
this.dims=[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)
this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];},update:function(position){var currentScale=(this.options.scaleFrom/100.0)+(this.factor*position);if(this.options.scaleContent&&this.fontSize)
this.element.setStyle({fontSize:this.fontSize*currentScale+this.fontSizeType});this.setDimensions(this.dims[0]*currentScale,this.dims[1]*currentScale);},finish:function(position){if(this.restoreAfterFinish)this.element.setStyle(this.originalStyle);},setDimensions:function(height,width){var d={};if(this.options.scaleX)d.width=width.round()+'px';if(this.options.scaleY)d.height=height.round()+'px';if(this.options.scaleFromCenter){var topd=(height-this.dims[0])/2;var leftd=(width-this.dims[1])/2;if(this.elementPositioning=='absolute'){if(this.options.scaleY)d.top=this.originalTop-topd+'px';if(this.options.scaleX)d.left=this.originalLeft-leftd+'px';}else{if(this.options.scaleY)d.top=-topd+'px';if(this.options.scaleX)d.left=-leftd+'px';}}
this.element.setStyle(d);}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({startcolor:'#ffff99'},arguments[1]||{});this.start(options);},setup:function(){if(this.element.getStyle('display')=='none'){this.cancel();return;}
this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle('background-image');this.element.setStyle({backgroundImage:'none'});}
if(!this.options.endcolor)
this.options.endcolor=this.element.getStyle('background-color').parseColor('#ffffff');if(!this.options.restorecolor)
this.options.restorecolor=this.element.getStyle('background-color');this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i]}.bind(this));},update:function(position){this.element.setStyle({backgroundColor:$R(0,2).inject('#',function(m,v,i){return m+((this._base[i]+(this._delta[i]*position)).round().toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=function(element){var options=arguments[1]||{},scrollOffsets=document.viewport.getScrollOffsets(),elementOffsets=$(element).cumulativeOffset();if(options.offset)elementOffsets[1]+=options.offset;return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1],options,function(p){scrollTo(scrollOffsets.left,p.round());});};Effect.Fade=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1.0,to:0.0,afterFinishInternal:function(effect){if(effect.options.to!=0)return;effect.element.hide().setStyle({opacity:oldOpacity});}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Appear=function(element){element=$(element);var options=Object.extend({from:(element.getStyle('display')=='none'?0.0:element.getOpacity()||0.0),to:1.0,afterFinishInternal:function(effect){effect.element.forceRerendering();},beforeSetup:function(effect){effect.element.setOpacity(effect.options.from).show();}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Puff=function(element){element=$(element);var oldStyle={opacity:element.getInlineOpacity(),position:element.getStyle('position'),top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};return new Effect.Parallel([new Effect.Scale(element,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:1.0,beforeSetupInternal:function(effect){Position.absolutize(effect.effects[0].element);},afterFinishInternal:function(effect){effect.effects[0].element.hide().setStyle(oldStyle);}},arguments[1]||{}));};Effect.BlindUp=function(element){element=$(element);element.makeClipping();return new Effect.Scale(element,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(effect){effect.element.hide().undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(element){element=$(element);var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makeClipping().setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();return new Effect.Appear(element,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(effect){new Effect.Scale(effect.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned().setStyle({opacity:oldOpacity});}});}},arguments[1]||{}));};Effect.DropOut=function(element){element=$(element);var oldStyle={top:element.getStyle('top'),left:element.getStyle('left'),opacity:element.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(element,{x:0,y:100,sync:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:0.5,beforeSetup:function(effect){effect.effects[0].element.makePositioned();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoPositioned().setStyle(oldStyle);}},arguments[1]||{}));};Effect.Shake=function(element){element=$(element);var options=Object.extend({distance:20,duration:0.5},arguments[1]||{});var distance=parseFloat(options.distance);var split=parseFloat(options.duration)/10.0;var oldStyle={top:element.getStyle('top'),left:element.getStyle('left')};return new Effect.Move(element,{x:distance,y:0,duration:split,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance,y:0,duration:split,afterFinishInternal:function(effect){effect.element.undoPositioned().setStyle(oldStyle);}});}});}});}});}});}});};Effect.SlideDown=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().setStyle({height:'0px'}).show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.SlideUp=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:'box',scaleFrom:100,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.Squish=function(element){return new Effect.Scale(element,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping();}});};Effect.Grow=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var initialMoveX,initialMoveY;var moveX,moveY;switch(options.direction){case'top-left':initialMoveX=initialMoveY=moveX=moveY=0;break;case'top-right':initialMoveX=dims.width;initialMoveY=moveY=0;moveX=-dims.width;break;case'bottom-left':initialMoveX=moveX=0;initialMoveY=dims.height;moveY=-dims.height;break;case'bottom-right':initialMoveX=dims.width;initialMoveY=dims.height;moveX=-dims.width;moveY=-dims.height;break;case'center':initialMoveX=dims.width/2;initialMoveY=dims.height/2;moveX=-dims.width/2;moveY=-dims.height/2;break;}
return new Effect.Move(element,{x:initialMoveX,y:initialMoveY,duration:0.01,beforeSetup:function(effect){effect.element.hide().makeClipping().makePositioned();},afterFinishInternal:function(effect){new Effect.Parallel([new Effect.Opacity(effect.element,{sync:true,to:1.0,from:0.0,transition:options.opacityTransition}),new Effect.Move(effect.element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition}),new Effect.Scale(effect.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(effect){effect.effects[0].element.setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle);}},options));}});};Effect.Shrink=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var moveX,moveY;switch(options.direction){case'top-left':moveX=moveY=0;break;case'top-right':moveX=dims.width;moveY=0;break;case'bottom-left':moveX=0;moveY=dims.height;break;case'bottom-right':moveX=dims.width;moveY=dims.height;break;case'center':moveX=dims.width/2;moveY=dims.height/2;break;}
return new Effect.Parallel([new Effect.Opacity(element,{sync:true,to:0.0,from:1.0,transition:options.opacityTransition}),new Effect.Scale(element,window.opera?1:0,{sync:true,transition:options.scaleTransition,restoreAfterFinish:true}),new Effect.Move(element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition})],Object.extend({beforeStartInternal:function(effect){effect.effects[0].element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle);}},options));};Effect.Pulsate=function(element){element=$(element);var options=arguments[1]||{},oldOpacity=element.getInlineOpacity(),transition=options.transition||Effect.Transitions.linear,reverser=function(pos){return 1-transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2)+.5);};return new Effect.Opacity(element,Object.extend(Object.extend({duration:2.0,from:0,afterFinishInternal:function(effect){effect.element.setStyle({opacity:oldOpacity});}},options),{transition:reverser}));};Effect.Fold=function(element){element=$(element);var oldStyle={top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};element.makeClipping();return new Effect.Scale(element,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(effect){new Effect.Scale(element,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(effect){effect.element.hide().undoClipping().setStyle(oldStyle);}});}},arguments[1]||{}));};Effect.Morph=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(options.style))this.style=$H(options.style);else{if(options.style.include(':'))
this.style=options.style.parseStyle();else{this.element.addClassName(options.style);this.style=$H(this.element.getStyles());this.element.removeClassName(options.style);var css=this.element.getStyles();this.style=this.style.reject(function(style){return style.value==css[style.key];});options.afterFinishInternal=function(effect){effect.element.addClassName(effect.options.style);effect.transforms.each(function(transform){effect.element.style[transform.style]='';});};}}
this.start(options);},setup:function(){function parseColor(color){if(!color||['rgba(0, 0, 0, 0)','transparent'].include(color))color='#ffffff';color=color.parseColor();return $R(0,2).map(function(i){return parseInt(color.slice(i*2+1,i*2+3),16);});}
this.transforms=this.style.map(function(pair){var property=pair[0],value=pair[1],unit=null;if(value.parseColor('#zzzzzz')!='#zzzzzz'){value=value.parseColor();unit='color';}else if(property=='opacity'){value=parseFloat(value);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});}else if(Element.CSS_LENGTH.test(value)){var components=value.match(/^([\+\-]?[0-9\.]+)(.*)$/);value=parseFloat(components[1]);unit=(components.length==3)?components[2]:null;}
var originalValue=this.element.getStyle(property);return{style:property.camelize(),originalValue:unit=='color'?parseColor(originalValue):parseFloat(originalValue||0),targetValue:unit=='color'?parseColor(value):value,unit:unit};}.bind(this)).reject(function(transform){return((transform.originalValue==transform.targetValue)||(transform.unit!='color'&&(isNaN(transform.originalValue)||isNaN(transform.targetValue))));});},update:function(position){var style={},transform,i=this.transforms.length;while(i--)
style[(transform=this.transforms[i]).style]=transform.unit=='color'?'#'+
(Math.round(transform.originalValue[0]+
(transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart()+
(Math.round(transform.originalValue[1]+
(transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart()+
(Math.round(transform.originalValue[2]+
(transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart():(transform.originalValue+
(transform.targetValue-transform.originalValue)*position).toFixed(3)+
(transform.unit===null?'':transform.unit);this.element.setStyle(style,true);}});Effect.Transform=Class.create({initialize:function(tracks){this.tracks=[];this.options=arguments[1]||{};this.addTracks(tracks);},addTracks:function(tracks){tracks.each(function(track){track=$H(track);var data=track.values().first();this.tracks.push($H({ids:track.keys().first(),effect:Effect.Morph,options:{style:data}}));}.bind(this));return this;},play:function(){return new Effect.Parallel(this.tracks.map(function(track){var ids=track.get('ids'),effect=track.get('effect'),options=track.get('options');var elements=[$(ids)||$$(ids)].flatten();return elements.map(function(e){return new effect(e,Object.extend({sync:true},options))});}).flatten(),this.options);}});Element.CSS_PROPERTIES=$w('backgroundColor backgroundPosition borderBottomColor borderBottomStyle '+'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth '+'borderRightColor borderRightStyle borderRightWidth borderSpacing '+'borderTopColor borderTopStyle borderTopWidth bottom clip color '+'fontSize fontWeight height left letterSpacing lineHeight '+'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+'maxWidth minHeight minWidth opacity outlineColor outlineOffset '+'outlineWidth paddingBottom paddingLeft paddingRight paddingTop '+'right textIndent top width wordSpacing zIndex');Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement('div');String.prototype.parseStyle=function(){var style,styleRules=$H();if(Prototype.Browser.WebKit)
style=new Element('div',{style:this}).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';style=String.__parseStyleElement.childNodes[0].style;}
Element.CSS_PROPERTIES.each(function(property){if(style[property])styleRules.set(property,style[property]);});if(Prototype.Browser.IE&&this.include('opacity'))
styleRules.set('opacity',this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return styleRules;};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(element){var css=document.defaultView.getComputedStyle($(element),null);return Element.CSS_PROPERTIES.inject({},function(styles,property){styles[property]=css[property];return styles;});};}else{Element.getStyles=function(element){element=$(element);var css=element.currentStyle,styles;styles=Element.CSS_PROPERTIES.inject({},function(results,property){results[property]=css[property];return results;});if(!styles.opacity)styles.opacity=element.getOpacity();return styles;};}
Effect.Methods={morph:function(element,style){element=$(element);new Effect.Morph(element,Object.extend({style:style},arguments[2]||{}));return element;},visualEffect:function(element,effect,options){element=$(element);var s=effect.dasherize().camelize(),klass=s.charAt(0).toUpperCase()+s.substring(1);new Effect[klass](element,options);return element;},highlight:function(element,options){element=$(element);new Effect.Highlight(element,options);return element;}};$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+'pulsate shake puff squish switchOff dropOut').each(function(effect){Effect.Methods[effect]=function(element,options){element=$(element);Effect[effect.charAt(0).toUpperCase()+effect.substring(1)](element,options);return element;};});$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(function(f){Effect.Methods[f]=Element[f];});Element.addMethods(Effect.Methods);var Builder={NODEMAP:{AREA:'map',CAPTION:'table',COL:'table',COLGROUP:'table',LEGEND:'fieldset',OPTGROUP:'select',OPTION:'select',PARAM:'object',TBODY:'table',TD:'table',TFOOT:'table',TH:'table',THEAD:'table',TR:'table'},node:function(elementName){elementName=elementName.toUpperCase();var parentTag=this.NODEMAP[elementName]||'div';var parentElement=document.createElement(parentTag);try{parentElement.innerHTML="<"+elementName+"></"+elementName+">";}catch(e){}
var element=parentElement.firstChild||null;if(element&&(element.tagName.toUpperCase()!=elementName))
element=element.getElementsByTagName(elementName)[0];if(!element)element=document.createElement(elementName);if(!element)return;if(arguments[1])
if(this._isStringOrNumber(arguments[1])||(arguments[1]instanceof Array)||arguments[1].tagName){this._children(element,arguments[1]);}else{var attrs=this._attributes(arguments[1]);if(attrs.length){try{parentElement.innerHTML="<"+elementName+" "+
attrs+"></"+elementName+">";}catch(e){}
element=parentElement.firstChild||null;if(!element){element=document.createElement(elementName);for(attr in arguments[1])
element[attr=='class'?'className':attr]=arguments[1][attr];}
if(element.tagName.toUpperCase()!=elementName)
element=parentElement.getElementsByTagName(elementName)[0];}}
if(arguments[2])
this._children(element,arguments[2]);return $(element);},_text:function(text){return document.createTextNode(text);},ATTR_MAP:{'className':'class','htmlFor':'for'},_attributes:function(attributes){var attrs=[];for(attribute in attributes)
attrs.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+attributes[attribute].toString().escapeHTML().gsub(/"/,'&quot;')+'"');return attrs.join(" ");},_children:function(element,children){if(children.tagName){element.appendChild(children);return;}
if(typeof children=='object'){children.flatten().each(function(e){if(typeof e=='object')
element.appendChild(e);else
if(Builder._isStringOrNumber(e))
element.appendChild(Builder._text(e));});}else
if(Builder._isStringOrNumber(children))
element.appendChild(Builder._text(children));},_isStringOrNumber:function(param){return(typeof param=='string'||typeof param=='number');},build:function(html){var element=this.node('div');$(element).update(html.strip());return element.down();},dump:function(scope){if(typeof scope!='object'&&typeof scope!='function')scope=window;var tags=("A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY "+"BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET "+"FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX "+"KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P "+"PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD "+"TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR").split(/\s+/);tags.each(function(tag){scope[tag]=function(){return Builder.node.apply(Builder,[tag].concat($A(arguments)));};});}};if(typeof Effect=='undefined')
throw("controls.js requires including script.aculo.us' effects.js library");var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(element,update,options){element=$(element);this.element=element;this.update=$(update);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions)
this.setOptions(options);else
this.options=options||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=='absolute'){update.style.position='absolute';Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight});}
Effect.Appear(update,{duration:0.15});};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};if(typeof(this.options.tokens)=='string')
this.options.tokens=new Array(this.options.tokens);if(!this.options.tokens.include('\n'))
this.options.tokens.push('\n');this.observer=null;this.element.setAttribute('autocomplete','off');Element.hide(this.update);Event.observe(this.element,'blur',this.onBlur.bindAsEventListener(this));Event.observe(this.element,'keydown',this.onKeyPress.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,'display')=='none')this.options.onShow(this.element,this.update);if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,'position')=='absolute')){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" '+'style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" '+'src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+'_iefix');}
if(this.iefix)setTimeout(this.fixIEOverlapping.bind(this),50);},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,'display')!='none')this.options.onHide(this.element,this.update);if(this.iefix)Element.hide(this.iefix);},startIndicator:function(){if(this.options.indicator)Element.show(this.options.indicator);},stopIndicator:function(){if(this.options.indicator)Element.hide(this.options.indicator);},onKeyPress:function(event){if(this.active)
switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(event);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(event);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(event);return;}
else
if(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&event.keyCode==0))return;this.changed=true;this.hasFocus=true;if(this.observer)clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(event){var element=Event.findElement(event,'LI');if(this.index!=element.autocompleteIndex)
{this.index=element.autocompleteIndex;this.render();}
Event.stop(event);},onClick:function(event){var element=Event.findElement(event,'LI');this.index=element.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(event){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++)
this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected");if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0)this.index--;else this.index=this.entryCount-1;this.getEntry(this.index).scrollIntoView(false);},markNext:function(){if(this.index<this.entryCount-1)this.index++;else this.index=0;this.getEntry(this.index).scrollIntoView(false);},getEntry:function(index){return this.update.firstChild.childNodes[index];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(selectedElement){if(this.options.updateElement){this.options.updateElement(selectedElement);return;}
var value='';if(this.options.select){var nodes=$(selectedElement).select('.'+this.options.select)||[];if(nodes.length>0)value=Element.collectTextNodes(nodes[0],this.options.select);}else
value=Element.collectTextNodesIgnoreClass(selectedElement,'informal');var bounds=this.getTokenBounds();if(bounds[0]!=-1){var newValue=this.element.value.substr(0,bounds[0]);var whitespace=this.element.value.substr(bounds[0]).match(/^\s+/);if(whitespace)
newValue+=whitespace[0];this.element.value=newValue+value+this.element.value.substr(bounds[1]);}else{this.element.value=value;}
this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement)
this.options.afterUpdateElement(this.element,selectedElement);},updateChoices:function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry);}}else{this.entryCount=0;}
this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(element){Event.observe(element,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(element,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices();}else{this.active=false;this.hide();}
this.oldElementValue=this.element.value;},getToken:function(){var bounds=this.getTokenBounds();return this.element.value.substring(bounds[0],bounds[1]).strip();},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var value=this.element.value;if(value.strip().empty())return[-1,0];var diff=arguments.callee.getFirstDifferencePos(value,this.oldElementValue);var offset=(diff==this.oldElementValue.length?1:0);var prevTokenPos=-1,nextTokenPos=value.length;var tp;for(var index=0,l=this.options.tokens.length;index<l;++index){tp=value.lastIndexOf(this.options.tokens[index],diff+offset-1);if(tp>prevTokenPos)prevTokenPos=tp;tp=value.indexOf(this.options.tokens[index],diff+offset);if(-1!=tp&&tp<nextTokenPos)nextTokenPos=tp;}
return(this.tokenBounds=[prevTokenPos+1,nextTokenPos]);}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(newS,oldS){var boundary=Math.min(newS.length,oldS.length);for(var index=0;index<boundary;++index)
if(newS[index]!=oldS[index])
return index;return boundary;};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(element,update,url,options){this.baseInitialize(element,update,options);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){this.startIndicator();var entry=encodeURIComponent(this.options.paramName)+'='+
encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)
this.options.parameters+='&'+this.options.defaultParams;new Ajax.Request(this.url,this.options);},onComplete:function(request){this.updateChoices(request.responseText);}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(element,update,array,options){this.baseInitialize(element,update,options);this.options.array=array;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(options){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(instance){var ret=[];var partial=[];var entry=instance.getToken();var count=0;for(var i=0;i<instance.options.array.length&&ret.length<instance.options.choices;i++){var elem=instance.options.array[i];var foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase()):elem.indexOf(entry);while(foundPos!=-1){if(foundPos==0&&elem.length!=entry.length){ret.push("<li><strong>"+elem.substr(0,entry.length)+"</strong>"+
elem.substr(entry.length)+"</li>");break;}else if(entry.length>=instance.options.partialChars&&instance.options.partialSearch&&foundPos!=-1){if(instance.options.fullSearch||/\s/.test(elem.substr(foundPos-1,1))){partial.push("<li>"+elem.substr(0,foundPos)+"<strong>"+
elem.substr(foundPos,entry.length)+"</strong>"+elem.substr(foundPos+entry.length)+"</li>");break;}}
foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase(),foundPos+1):elem.indexOf(entry,foundPos+1);}}
if(partial.length)
ret=ret.concat(partial.slice(0,instance.options.choices-ret.length));return"<ul>"+ret.join('')+"</ul>";}},options||{});}});Field.scrollFreeActivate=function(field){setTimeout(function(){Field.activate(field);},1);};Ajax.InPlaceEditor=Class.create({initialize:function(element,url,options){this.url=url;this.element=element=$(element);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(options);Object.extend(this.options,options||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+'-inplaceeditor';if($(this.options.formId))
this.options.formId='';}
if(this.options.externalControl)
this.options.externalControl=$(this.options.externalControl);if(!this.options.externalControl)
this.options.externalControlOnly=false;this._originalBackground=this.element.getStyle('background-color')||'transparent';this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners();},checkForEscapeOrReturn:function(e){if(!this._editing||e.ctrlKey||e.altKey||e.shiftKey)return;if(Event.KEY_ESC==e.keyCode)
this.handleFormCancellation(e);else if(Event.KEY_RETURN==e.keyCode)
this.handleFormSubmission(e);},createControl:function(mode,handler,extraClasses){var control=this.options[mode+'Control'];var text=this.options[mode+'Text'];if('button'==control){var btn=document.createElement('input');btn.type='submit';btn.value=text;btn.className='editor_'+mode+'_button';if('cancel'==mode)
btn.onclick=this._boundCancelHandler;this._form.appendChild(btn);this._controls[mode]=btn;}else if('link'==control){var link=document.createElement('a');link.href='#';link.appendChild(document.createTextNode(text));link.onclick='cancel'==mode?this._boundCancelHandler:this._boundSubmitHandler;link.className='editor_'+mode+'_link';if(extraClasses)
link.className+=' '+extraClasses;this._form.appendChild(link);this._controls[mode]=link;}},createEditField:function(){var text=(this.options.loadTextURL?this.options.loadingText:this.getText());var fld;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){fld=document.createElement('input');fld.type='text';var size=this.options.size||this.options.cols||0;if(0<size)fld.size=size;}else{fld=document.createElement('textarea');fld.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);fld.cols=this.options.cols||40;}
fld.name=this.options.paramName;fld.value=text;fld.className='editor_field';if(this.options.submitOnBlur)
fld.onblur=this._boundSubmitHandler;this._controls.editor=fld;if(this.options.loadTextURL)
this.loadExternalText();this._form.appendChild(this._controls.editor);},createForm:function(){var ipe=this;function addText(mode,condition){var text=ipe.options['text'+mode+'Controls'];if(!text||condition===false)return;ipe._form.appendChild(document.createTextNode(text));};this._form=$(document.createElement('form'));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if('textarea'==this._controls.editor.tagName.toLowerCase())
this._form.appendChild(document.createElement('br'));if(this.options.onFormCustomization)
this.options.onFormCustomization(this,this._form);addText('Before',this.options.okControl||this.options.cancelControl);this.createControl('ok',this._boundSubmitHandler);addText('Between',this.options.okControl&&this.options.cancelControl);this.createControl('cancel',this._boundCancelHandler,'editor_cancel');addText('After',this.options.okControl||this.options.cancelControl);},destroy:function(){if(this._oldInnerHTML)
this.element.innerHTML=this._oldInnerHTML;this.leaveEditMode();this.unregisterListeners();},enterEditMode:function(e){if(this._saving||this._editing)return;this._editing=true;this.triggerCallback('onEnterEditMode');if(this.options.externalControl)
this.options.externalControl.hide();this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL)
this.postProcessEditField();if(e)Event.stop(e);},enterHover:function(e){if(this.options.hoverClassName)
this.element.addClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onEnterHover');},getText:function(){return this.element.innerHTML.unescapeHTML();},handleAJAXFailure:function(transport){this.triggerCallback('onFailure',transport);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null;}},handleFormCancellation:function(e){this.wrapUp();if(e)Event.stop(e);},handleFormSubmission:function(e){var form=this._form;var value=$F(this._controls.editor);this.prepareSubmission();var params=this.options.callback(form,value)||'';if(Object.isString(params))
params=params.toQueryParams();params.editorId=this.element.id;if(this.options.htmlResponse){var options=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,options);}else{var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,options);}
if(e)Event.stop(e);},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl)
this.options.externalControl.show();this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback('onLeaveEditMode');},leaveHover:function(e){if(this.options.hoverClassName)
this.element.removeClassName(this.options.hoverClassName);if(this._saving)return;this.triggerCallback('onLeaveHover');},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._form.removeClassName(this.options.loadingClassName);var text=transport.responseText;if(this.options.stripLoadedTextTags)
text=text.stripTags();this._controls.editor.value=text;this._controls.editor.disabled=false;this.postProcessEditField();}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,options);},postProcessEditField:function(){var fpc=this.options.fieldPostCreation;if(fpc)
$(this._controls.editor)['focus'==fpc?'focus':'activate']();},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(defs){Object.extend(this.options,defs);}.bind(this));},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving();},registerListeners:function(){this._listeners={};var listener;$H(Ajax.InPlaceEditor.Listeners).each(function(pair){listener=this[pair.value].bind(this);this._listeners[pair.key]=listener;if(!this.options.externalControlOnly)
this.element.observe(pair.key,listener);if(this.options.externalControl)
this.options.externalControl.observe(pair.key,listener);}.bind(this));},removeForm:function(){if(!this._form)return;this._form.remove();this._form=null;this._controls={};},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show();},triggerCallback:function(cbName,arg){if('function'==typeof this.options[cbName]){this.options[cbName](this,arg);}},unregisterListeners:function(){$H(this._listeners).each(function(pair){if(!this.options.externalControlOnly)
this.element.stopObserving(pair.key,pair.value);if(this.options.externalControl)
this.options.externalControl.stopObserving(pair.key,pair.value);}.bind(this));},wrapUp:function(transport){this.leaveEditMode();this._boundComplete(transport,this.element);}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,element,url,options){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(element,url,options);},createEditField:function(){var list=document.createElement('select');list.name=this.options.paramName;list.size=1;this._controls.editor=list;this._collection=this.options.collection||[];if(this.options.loadCollectionURL)
this.loadCollection();else
this.checkForExternalText();this._form.appendChild(this._controls.editor);},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js))
throw('Server returned an invalid collection representation.');this._collection=eval(js);this.checkForExternalText();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options);},showLoadingText:function(text){this._controls.editor.disabled=true;var tempOption=this._controls.editor.firstChild;if(!tempOption){tempOption=document.createElement('option');tempOption.value='';this._controls.editor.appendChild(tempOption);tempOption.selected=true;}
tempOption.update((text||'').stripScripts().stripTags());},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL)
this.loadExternalText();else
this.buildOptionList();},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var options=Object.extend({method:'get'},this.options.ajaxOptions);Object.extend(options,{parameters:'editorId='+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._text=transport.responseText.strip();this.buildOptionList();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,options);},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(entry){return 2===entry.length?entry:[entry,entry].flatten();});var marker=('value'in this.options)?this.options.value:this._text;var textFound=this._collection.any(function(entry){return entry[0]==marker;}.bind(this));this._controls.editor.update('');var option;this._collection.each(function(entry,index){option=document.createElement('option');option.value=entry[0];option.selected=textFound?entry[0]==marker:0==index;option.appendChild(document.createTextNode(entry[1]));this._controls.editor.appendChild(option);}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor);}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(options){if(!options)return;function fallback(name,expr){if(name in options||expr===undefined)return;options[name]=expr;};fallback('cancelControl',(options.cancelLink?'link':(options.cancelButton?'button':options.cancelLink==options.cancelButton==false?false:undefined)));fallback('okControl',(options.okLink?'link':(options.okButton?'button':options.okLink==options.okButton==false?false:undefined)));fallback('highlightColor',options.highlightcolor);fallback('highlightEndColor',options.highlightendcolor);};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:'link',cancelText:'cancel',clickToEditText:'Click to edit',externalControl:null,externalControlOnly:false,fieldPostCreation:'activate',formClassName:'inplaceeditor-form',formId:null,highlightColor:'#ffff99',highlightEndColor:'#ffffff',hoverClassName:'',htmlResponse:true,loadingClassName:'inplaceeditor-loading',loadingText:'Loading...',okControl:'button',okText:'ok',paramName:'value',rows:1,savingClassName:'inplaceeditor-saving',savingText:'Saving...',size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:'',textBeforeControls:'',textBetweenControls:''},DefaultCallbacks:{callback:function(form){return Form.serialize(form);},onComplete:function(transport,element){new Effect.Highlight(element,{startcolor:this.options.highlightColor,keepBackgroundImage:true});},onEnterEditMode:null,onEnterHover:function(ipe){ipe.element.style.backgroundColor=ipe.options.highlightColor;if(ipe._effect)
ipe._effect.cancel();},onFailure:function(transport,ipe){alert('Error communication with the server: '+transport.responseText.stripTags());},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(ipe){ipe._effect=new Effect.Highlight(ipe.element,{startcolor:ipe.options.highlightColor,endcolor:ipe.options.highlightEndColor,restorecolor:ipe._originalBackground,keepBackgroundImage:true});}},Listeners:{click:'enterEditMode',keydown:'checkForEscapeOrReturn',mouseover:'enterHover',mouseout:'leaveHover'}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:'Loading options...'};Form.Element.DelayedObserver=Class.create({initialize:function(element,delay,callback){this.delay=delay||0.5;this.element=$(element);this.callback=callback;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,'keyup',this.delayedListener.bindAsEventListener(this));},delayedListener:function(event){if(this.lastValue==$F(this.element))return;if(this.timer)clearTimeout(this.timer);this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}});if(Object.isUndefined(Effect))
throw("dragdrop.js requires including script.aculo.us' effects.js library");var Droppables={drops:[],remove:function(element){this.drops=this.drops.reject(function(d){return d.element==$(element)});},add:function(element){element=$(element);var options=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(options.containment){options._containers=[];var containment=options.containment;if(Object.isArray(containment)){containment.each(function(c){options._containers.push($(c))});}else{options._containers.push($(containment));}}
if(options.accept)options.accept=[options.accept].flatten();Element.makePositioned(element);options.element=element;this.drops.push(options);},findDeepestChild:function(drops){deepest=drops[0];for(i=1;i<drops.length;++i)
if(Element.isParent(drops[i].element,deepest.element))
deepest=drops[i];return deepest;},isContained:function(element,drop){var containmentNode;if(drop.tree){containmentNode=element.treeNode;}else{containmentNode=element.parentNode;}
return drop._containers.detect(function(c){return containmentNode==c});},isAffected:function(point,element,drop){return((drop.element!=element)&&((!drop._containers)||this.isContained(element,drop))&&((!drop.accept)||(Element.classNames(element).detect(function(v){return drop.accept.include(v)})))&&Position.within(drop.element,point[0],point[1]));},deactivate:function(drop){if(drop.hoverclass)
Element.removeClassName(drop.element,drop.hoverclass);this.last_active=null;},activate:function(drop){if(drop.hoverclass)
Element.addClassName(drop.element,drop.hoverclass);this.last_active=drop;},show:function(point,element){if(!this.drops.length)return;var drop,affected=[];this.drops.each(function(drop){if(Droppables.isAffected(point,element,drop))
affected.push(drop);});if(affected.length>0)
drop=Droppables.findDeepestChild(affected);if(this.last_active&&this.last_active!=drop)this.deactivate(this.last_active);if(drop){Position.within(drop.element,point[0],point[1]);if(drop.onHover)
drop.onHover(element,drop.element,Position.overlap(drop.overlap,drop.element));if(drop!=this.last_active)Droppables.activate(drop);}},fire:function(event,element){if(!this.last_active)return;Position.prepare();if(this.isAffected([Event.pointerX(event),Event.pointerY(event)],element,this.last_active))
if(this.last_active.onDrop){this.last_active.onDrop(element,this.last_active.element,event);return true;}},reset:function(){if(this.last_active)
this.deactivate(this.last_active);}};var Draggables={drags:[],observers:[],register:function(draggable){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress);}
this.drags.push(draggable);},unregister:function(draggable){this.drags=this.drags.reject(function(d){return d==draggable});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress);}},activate:function(draggable){if(draggable.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=draggable;}.bind(this),draggable.options.delay);}else{window.focus();this.activeDraggable=draggable;}},deactivate:function(){this.activeDraggable=null;},updateDrag:function(event){if(!this.activeDraggable)return;var pointer=[Event.pointerX(event),Event.pointerY(event)];if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect()))return;this._lastPointer=pointer;this.activeDraggable.updateDrag(event,pointer);},endDrag:function(event){if(this._timeout){clearTimeout(this._timeout);this._timeout=null;}
if(!this.activeDraggable)return;this._lastPointer=null;this.activeDraggable.endDrag(event);this.activeDraggable=null;},keyPress:function(event){if(this.activeDraggable)
this.activeDraggable.keyPress(event);},addObserver:function(observer){this.observers.push(observer);this._cacheObserverCallbacks();},removeObserver:function(element){this.observers=this.observers.reject(function(o){return o.element==element});this._cacheObserverCallbacks();},notify:function(eventName,draggable,event){if(this[eventName+'Count']>0)
this.observers.each(function(o){if(o[eventName])o[eventName](eventName,draggable,event);});if(draggable.options[eventName])draggable.options[eventName](draggable,event);},_cacheObserverCallbacks:function(){['onStart','onEnd','onDrag'].each(function(eventName){Draggables[eventName+'Count']=Draggables.observers.select(function(o){return o[eventName];}).length;});}};var Draggable=Class.create({initialize:function(element){var defaults={handle:false,reverteffect:function(element,top_offset,left_offset){var dur=Math.sqrt(Math.abs(top_offset^2)+Math.abs(left_offset^2))*0.02;new Effect.Move(element,{x:-left_offset,y:-top_offset,duration:dur,queue:{scope:'_draggable',position:'end'}});},endeffect:function(element){var toOpacity=Object.isNumber(element._opacity)?element._opacity:1.0;new Effect.Opacity(element,{duration:0.2,from:0.7,to:toOpacity,queue:{scope:'_draggable',position:'end'},afterFinish:function(){Draggable._dragging[element]=false}});},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect))
Object.extend(defaults,{starteffect:function(element){element._opacity=Element.getOpacity(element);Draggable._dragging[element]=true;new Effect.Opacity(element,{duration:0.2,from:element._opacity,to:0.7});}});var options=Object.extend(defaults,arguments[1]||{});this.element=$(element);if(options.handle&&Object.isString(options.handle))
this.handle=this.element.down('.'+options.handle,0);if(!this.handle)this.handle=$(options.handle);if(!this.handle)this.handle=this.element;if(options.scroll&&!options.scroll.scrollTo&&!options.scroll.outerHTML){options.scroll=$(options.scroll);this._isScrollChild=Element.childOf(this.element,options.scroll);}
Element.makePositioned(this.element);this.options=options;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this);},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this);},currentDelta:function(){return([parseInt(Element.getStyle(this.element,'left')||'0'),parseInt(Element.getStyle(this.element,'top')||'0')]);},initDrag:function(event){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element])return;if(Event.isLeftClick(event)){var src=Event.element(event);if((tag_name=src.tagName.toUpperCase())&&(tag_name=='INPUT'||tag_name=='SELECT'||tag_name=='OPTION'||tag_name=='BUTTON'||tag_name=='TEXTAREA'))return;var pointer=[Event.pointerX(event),Event.pointerY(event)];var pos=this.element.cumulativeOffset();this.offset=[0,1].map(function(i){return(pointer[i]-pos[i])});Draggables.activate(this);Event.stop(event);}},startDrag:function(event){this.dragging=true;if(!this.delta)
this.delta=this.currentDelta();if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,'z-index')||0);this.element.style.zIndex=this.options.zindex;}
if(this.options.ghosting){this._clone=this.element.cloneNode(true);this._originallyAbsolute=(this.element.getStyle('position')=='absolute');if(!this._originallyAbsolute)
Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element);}
if(this.options.scroll){if(this.options.scroll==window){var where=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=where.left;this.originalScrollTop=where.top;}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop;}}
Draggables.notify('onStart',this,event);if(this.options.starteffect)this.options.starteffect(this.element);},updateDrag:function(event,pointer){if(!this.dragging)this.startDrag(event);if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element);}
Draggables.notify('onDrag',this,event);this.draw(pointer);if(this.options.change)this.options.change(this);if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height];}}else{p=Position.page(this.options.scroll).toArray();p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight);}
var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity))speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity);if(pointer[1]<(p[1]+this.options.scrollSensitivity))speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity);if(pointer[0]>(p[2]-this.options.scrollSensitivity))speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity);if(pointer[1]>(p[3]-this.options.scrollSensitivity))speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity);this.startScrolling(speed);}
if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);},finishDrag:function(event,success){this.dragging=false;if(this.options.quiet){Position.prepare();var pointer=[Event.pointerX(event),Event.pointerY(event)];Droppables.show(pointer,this.element);}
if(this.options.ghosting){if(!this._originallyAbsolute)
Position.relativize(this.element);delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null;}
var dropped=false;if(success){dropped=Droppables.fire(event,this.element);if(!dropped)dropped=false;}
if(dropped&&this.options.onDropped)this.options.onDropped(this.element);Draggables.notify('onEnd',this,event);var revert=this.options.revert;if(revert&&Object.isFunction(revert))revert=revert(this.element);var d=this.currentDelta();if(revert&&this.options.reverteffect){if(dropped==0||revert!='failure')
this.options.reverteffect(this.element,d[1]-this.delta[1],d[0]-this.delta[0]);}else{this.delta=d;}
if(this.options.zindex)
this.element.style.zIndex=this.originalZ;if(this.options.endeffect)
this.options.endeffect(this.element);Draggables.deactivate(this);Droppables.reset();},keyPress:function(event){if(event.keyCode!=Event.KEY_ESC)return;this.finishDrag(event,false);Event.stop(event);},endDrag:function(event){if(!this.dragging)return;this.stopScrolling();this.finishDrag(event,true);Event.stop(event);},draw:function(point){var pos=this.element.cumulativeOffset();if(this.options.ghosting){var r=Position.realOffset(this.element);pos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY;}
var d=this.currentDelta();pos[0]-=d[0];pos[1]-=d[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){pos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;pos[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}
var p=[0,1].map(function(i){return(point[i]-pos[i]-this.offset[i])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){p=this.options.snap(p[0],p[1],this);}else{if(Object.isArray(this.options.snap)){p=p.map(function(v,i){return(v/this.options.snap[i]).round()*this.options.snap[i]}.bind(this));}else{p=p.map(function(v){return(v/this.options.snap).round()*this.options.snap}.bind(this));}}}
var style=this.element.style;if((!this.options.constraint)||(this.options.constraint=='horizontal'))
style.left=p[0]+"px";if((!this.options.constraint)||(this.options.constraint=='vertical'))
style.top=p[1]+"px";if(style.visibility=="hidden")style.visibility="";},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null;}},startScrolling:function(speed){if(!(speed[0]||speed[1]))return;this.scrollSpeed=[speed[0]*this.options.scrollSpeed,speed[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10);},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1]);}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000;}
Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify('onDrag',this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0)
Draggables._lastScrollPointer[0]=0;if(Draggables._lastScrollPointer[1]<0)
Draggables._lastScrollPointer[1]=0;this.draw(Draggables._lastScrollPointer);}
if(this.options.change)this.options.change(this);},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft;}else if(w.document.body){T=body.scrollTop;L=body.scrollLeft;}
if(w.innerWidth){W=w.innerWidth;H=w.innerHeight;}else if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight;}else{W=body.offsetWidth;H=body.offsetHeight;}}
return{top:T,left:L,width:W,height:H};}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(element,observer){this.element=$(element);this.observer=observer;this.lastValue=Sortable.serialize(this.element);},onStart:function(){this.lastValue=Sortable.serialize(this.element);},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element))
this.observer(this.element)}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(element){while(element.tagName.toUpperCase()!="BODY"){if(element.id&&Sortable.sortables[element.id])return element;element=element.parentNode;}},options:function(element){element=Sortable._findRootElement($(element));if(!element)return;return Sortable.sortables[element.id];},destroy:function(element){element=$(element);var s=Sortable.sortables[element.id];if(s){Draggables.removeObserver(s.element);s.droppables.each(function(d){Droppables.remove(d)});s.draggables.invoke('destroy');delete Sortable.sortables[s.element.id];}},create:function(element){element=$(element);var options=Object.extend({element:element,tag:'li',dropOnEmpty:false,tree:false,treeTag:'ul',overlap:'vertical',constraint:'vertical',containment:element,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(element);var options_for_draggable={revert:true,quiet:options.quiet,scroll:options.scroll,scrollSpeed:options.scrollSpeed,scrollSensitivity:options.scrollSensitivity,delay:options.delay,ghosting:options.ghosting,constraint:options.constraint,handle:options.handle};if(options.starteffect)
options_for_draggable.starteffect=options.starteffect;if(options.reverteffect)
options_for_draggable.reverteffect=options.reverteffect;else
if(options.ghosting)options_for_draggable.reverteffect=function(element){element.style.top=0;element.style.left=0;};if(options.endeffect)
options_for_draggable.endeffect=options.endeffect;if(options.zindex)
options_for_draggable.zindex=options.zindex;var options_for_droppable={overlap:options.overlap,containment:options.containment,tree:options.tree,hoverclass:options.hoverclass,onHover:Sortable.onHover};var options_for_tree={onHover:Sortable.onEmptyHover,overlap:options.overlap,containment:options.containment,hoverclass:options.hoverclass};Element.cleanWhitespace(element);options.draggables=[];options.droppables=[];if(options.dropOnEmpty||options.tree){Droppables.add(element,options_for_tree);options.droppables.push(element);}
(options.elements||this.findElements(element,options)||[]).each(function(e,i){var handle=options.handles?$(options.handles[i]):(options.handle?$(e).select('.'+options.handle)[0]:e);options.draggables.push(new Draggable(e,Object.extend(options_for_draggable,{handle:handle})));Droppables.add(e,options_for_droppable);if(options.tree)e.treeNode=element;options.droppables.push(e);});if(options.tree){(Sortable.findTreeElements(element,options)||[]).each(function(e){Droppables.add(e,options_for_tree);e.treeNode=element;options.droppables.push(e);});}
this.sortables[element.identify()]=options;Draggables.addObserver(new SortableObserver(element,options.onUpdate));},findElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.tag);},findTreeElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.treeTag);},onHover:function(element,dropon,overlap){if(Element.isParent(dropon,element))return;if(overlap>.33&&overlap<.66&&Sortable.options(dropon).tree){return;}else if(overlap>0.5){Sortable.mark(dropon,'before');if(dropon.previousSibling!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,dropon);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}else{Sortable.mark(dropon,'after');var nextElement=dropon.nextSibling||null;if(nextElement!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,nextElement);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}},onEmptyHover:function(element,dropon,overlap){var oldParentNode=element.parentNode;var droponOptions=Sortable.options(dropon);if(!Element.isParent(dropon,element)){var index;var children=Sortable.findElements(dropon,{tag:droponOptions.tag,only:droponOptions.only});var child=null;if(children){var offset=Element.offsetSize(dropon,droponOptions.overlap)*(1.0-overlap);for(index=0;index<children.length;index+=1){if(offset-Element.offsetSize(children[index],droponOptions.overlap)>=0){offset-=Element.offsetSize(children[index],droponOptions.overlap);}else if(offset-(Element.offsetSize(children[index],droponOptions.overlap)/2)>=0){child=index+1<children.length?children[index+1]:null;break;}else{child=children[index];break;}}}
dropon.insertBefore(element,child);Sortable.options(oldParentNode).onChange(element);droponOptions.onChange(element);}},unmark:function(){if(Sortable._marker)Sortable._marker.hide();},mark:function(dropon,position){var sortable=Sortable.options(dropon.parentNode);if(sortable&&!sortable.ghosting)return;if(!Sortable._marker){Sortable._marker=($('dropmarker')||Element.extend(document.createElement('DIV'))).hide().addClassName('dropmarker').setStyle({position:'absolute'});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker);}
var offsets=dropon.cumulativeOffset();Sortable._marker.setStyle({left:offsets[0]+'px',top:offsets[1]+'px'});if(position=='after')
if(sortable.overlap=='horizontal')
Sortable._marker.setStyle({left:(offsets[0]+dropon.clientWidth)+'px'});else
Sortable._marker.setStyle({top:(offsets[1]+dropon.clientHeight)+'px'});Sortable._marker.show();},_tree:function(element,options,parent){var children=Sortable.findElements(element,options)||[];for(var i=0;i<children.length;++i){var match=children[i].id.match(options.format);if(!match)continue;var child={id:encodeURIComponent(match?match[1]:null),element:element,parent:parent,children:[],position:parent.children.length,container:$(children[i]).down(options.treeTag)};if(child.container)
this._tree(child.container,options,child);parent.children.push(child);}
return parent;},tree:function(element){element=$(element);var sortableOptions=this.options(element);var options=Object.extend({tag:sortableOptions.tag,treeTag:sortableOptions.treeTag,only:sortableOptions.only,name:element.id,format:sortableOptions.format},arguments[1]||{});var root={id:null,parent:null,children:[],container:element,position:0};return Sortable._tree(element,options,root);},_constructIndex:function(node){var index='';do{if(node.id)index='['+node.position+']'+index;}while((node=node.parent)!=null);return index;},sequence:function(element){element=$(element);var options=Object.extend(this.options(element),arguments[1]||{});return $(this.findElements(element,options)||[]).map(function(item){return item.id.match(options.format)?item.id.match(options.format)[1]:'';});},setSequence:function(element,new_sequence){element=$(element);var options=Object.extend(this.options(element),arguments[2]||{});var nodeMap={};this.findElements(element,options).each(function(n){if(n.id.match(options.format))
nodeMap[n.id.match(options.format)[1]]=[n,n.parentNode];n.parentNode.removeChild(n);});new_sequence.each(function(ident){var n=nodeMap[ident];if(n){n[1].appendChild(n[0]);delete nodeMap[ident];}});},serialize:function(element){element=$(element);var options=Object.extend(Sortable.options(element),arguments[1]||{});var name=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:element.id);if(options.tree){return Sortable.tree(element,arguments[1]).children.map(function(item){return[name+Sortable._constructIndex(item)+"[id]="+
encodeURIComponent(item.id)].concat(item.children.map(arguments.callee));}).flatten().join('&');}else{return Sortable.sequence(element,arguments[1]).map(function(item){return name+"[]="+encodeURIComponent(item);}).join('&');}}};Element.isParent=function(child,element){if(!child.parentNode||child==element)return false;if(child.parentNode==element)return true;return Element.isParent(child.parentNode,element);};Element.findChildren=function(element,only,recursive,tagName){if(!element.hasChildNodes())return null;tagName=tagName.toUpperCase();if(only)only=[only].flatten();var elements=[];$A(element.childNodes).each(function(e){if(e.tagName&&e.tagName.toUpperCase()==tagName&&(!only||(Element.classNames(e).detect(function(v){return only.include(v)}))))
elements.push(e);if(recursive){var grandchildren=Element.findChildren(e,only,recursive,tagName);if(grandchildren)elements.push(grandchildren);}});return(elements.length>0?elements.flatten():[]);};Element.offsetSize=function(element,type){return element['offset'+((type=='vertical'||type=='height')?'Height':'Width')];};if(!Control)var Control={};Control.Slider=Class.create({initialize:function(handle,track,options){var slider=this;if(Object.isArray(handle)){this.handles=handle.collect(function(e){return $(e)});}else{this.handles=[$(handle)];}
this.track=$(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1');this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(s){return $(s)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0');this.alignY=parseInt(this.options.alignY||'0');this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled)this.setDisabled();this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}
this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((Object.isArray(slider.options.sliderValue)?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);h.makePositioned().observe("mousedown",slider.eventMouseDown);});this.track.observe("mousedown",this.eventMouseDown);document.observe("mouseup",this.eventMouseUp);document.observe("mousemove",this.eventMouseMove);this.initialized=true;},dispose:function(){var slider=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);this.handles.each(function(h){Event.stopObserving(h,"mousedown",slider.eventMouseDown);});},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){if(value>=this.allowedValues.max())return(this.allowedValues.max());if(value<=this.allowedValues.min())return(this.allowedValues.min());var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];this.allowedValues.each(function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end)return this.range.end;if(value<this.range.start)return this.range.start;return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandleIdx=handleIdx||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1]))
sliderValue=this.values[handleIdx-1];if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1]))
sliderValue=this.values[handleIdx+1];}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue);this.drawSpans();if(!this.dragging||!this.event)this.updateFinished();},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";},translateToValue:function(offset){return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(range){var v=this.values.sortBy(Prototype.K);range=range||0;return $R(v[range],v[range+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans)
$R(0,this.spans.length-1).each(function(r){slider.setSpan(slider.spans[r],slider.getRange(r))});if(this.options.startSpan)
this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));if(this.options.endSpan)
this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start);span.style.height=this.translateToPx(range.end-range.start+this.range.start);}else{span.style.left=this.translateToPx(range.start);span.style.width=this.translateToPx(range.end-range.start+this.range.start);}},updateStyles:function(){this.handles.each(function(h){Element.removeClassName(h,'selected')});Element.addClassName(this.activeHandle,'selected');},startDrag:function(event){if(Event.isLeftClick(event)){if(!this.disabled){this.active=true;var handle=Event.element(event);var pointer=[Event.pointerX(event),Event.pointerY(event)];var track=handle;if(track==this.track){var offsets=this.track.cumulativeOffset();this.event=event;this.setValue(this.translateToValue((this.isVertical()?pointer[1]-offsets[1]:pointer[0]-offsets[0])-(this.handleLength/2)));var offsets=this.activeHandle.cumulativeOffset();this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}else{while((this.handles.indexOf(handle)==-1)&&handle.parentNode)
handle=handle.parentNode;if(this.handles.indexOf(handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var offsets=this.activeHandle.cumulativeOffset();this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}}}
Event.stop(event);}},update:function(event){if(this.active){if(!this.dragging)this.dragging=true;this.draw(event);if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);}},draw:function(event){var pointer=[Event.pointerX(event),Event.pointerY(event)];var offsets=this.track.cumulativeOffset();pointer[0]-=this.offsetX+offsets[0];pointer[1]-=this.offsetY+offsets[1];this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide)
this.options.onSlide(this.values.length>1?this.values:this.value,this);},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);Event.stop(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange)
this.options.onChange(this.values.length>1?this.values:this.value,this);this.event=null;}});Sound={tracks:{},_enabled:true,template:new Template('<embed style="height:0" id="sound_#{track}_#{id}" src="#{url}" loop="false" autostart="true" hidden="true"/>'),enable:function(){Sound._enabled=true;},disable:function(){Sound._enabled=false;},play:function(url){if(!Sound._enabled)return;var options=Object.extend({track:'global',url:url,replace:false},arguments[1]||{});if(options.replace&&this.tracks[options.track]){$R(0,this.tracks[options.track].id).each(function(id){var sound=$('sound_'+options.track+'_'+id);sound.Stop&&sound.Stop();sound.remove();});this.tracks[options.track]=null;}
if(!this.tracks[options.track])
this.tracks[options.track]={id:0};else
this.tracks[options.track].id++;options.id=this.tracks[options.track].id;$$('body')[0].insert(Prototype.Browser.IE?new Element('bgsound',{id:'sound_'+options.track+'_'+options.id,src:options.url,loop:1,autostart:true}):Sound.template.evaluate(options));}};if(Prototype.Browser.Gecko&&navigator.userAgent.indexOf("Win")>0){if(navigator.plugins&&$A(navigator.plugins).detect(function(p){return p.name.indexOf('QuickTime')!=-1}))
Sound.template=new Template('<object id="sound_#{track}_#{id}" width="0" height="0" type="audio/mpeg" data="#{url}"/>');else if(navigator.plugins&&$A(navigator.plugins).detect(function(p){return p.name.indexOf('Windows Media')!=-1}))
Sound.template=new Template('<object id="sound_#{track}_#{id}" type="application/x-mplayer2" data="#{url}"></object>');else if(navigator.plugins&&$A(navigator.plugins).detect(function(p){return p.name.indexOf('RealPlayer')!=-1}))
Sound.template=new Template('<embed type="audio/x-pn-realaudio-plugin" style="height:0" id="sound_#{track}_#{id}" src="#{url}" loop="false" autostart="true" hidden="true"/>');else
Sound.play=function(){};}
Event.simulateMouse=function(element,eventName){var options=Object.extend({pointerX:0,pointerY:0,buttons:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},arguments[2]||{});var oEvent=document.createEvent("MouseEvents");oEvent.initMouseEvent(eventName,true,true,document.defaultView,options.buttons,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,0,$(element));if(this.mark)Element.remove(this.mark);this.mark=document.createElement('div');this.mark.appendChild(document.createTextNode(" "));document.body.appendChild(this.mark);this.mark.style.position='absolute';this.mark.style.top=options.pointerY+"px";this.mark.style.left=options.pointerX+"px";this.mark.style.width="5px";this.mark.style.height="5px;";this.mark.style.borderTop="1px solid red;";this.mark.style.borderLeft="1px solid red;";if(this.step)
alert('['+new Date().getTime().toString()+'] '+eventName+'/'+Test.Unit.inspect(options));$(element).dispatchEvent(oEvent);};Event.simulateKey=function(element,eventName){var options=Object.extend({ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0},arguments[2]||{});var oEvent=document.createEvent("KeyEvents");oEvent.initKeyEvent(eventName,true,true,window,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.keyCode,options.charCode);$(element).dispatchEvent(oEvent);};Event.simulateKeys=function(element,command){for(var i=0;i<command.length;i++){Event.simulateKey(element,'keypress',{charCode:command.charCodeAt(i)});}};var Test={};Test.Unit={};Test.Unit.inspect=Object.inspect;Test.Unit.Logger=Class.create();Test.Unit.Logger.prototype={initialize:function(log){this.log=$(log);if(this.log){this._createLogTable();}},start:function(testName){if(!this.log)return;this.testName=testName;this.lastLogLine=document.createElement('tr');this.statusCell=document.createElement('td');this.nameCell=document.createElement('td');this.nameCell.className="nameCell";this.nameCell.appendChild(document.createTextNode(testName));this.messageCell=document.createElement('td');this.lastLogLine.appendChild(this.statusCell);this.lastLogLine.appendChild(this.nameCell);this.lastLogLine.appendChild(this.messageCell);this.loglines.appendChild(this.lastLogLine);},finish:function(status,summary){if(!this.log)return;this.lastLogLine.className=status;this.statusCell.innerHTML=status;this.messageCell.innerHTML=this._toHTML(summary);this.addLinksToResults();},message:function(message){if(!this.log)return;this.messageCell.innerHTML=this._toHTML(message);},summary:function(summary){if(!this.log)return;this.logsummary.innerHTML=this._toHTML(summary);},_createLogTable:function(){this.log.innerHTML='<div id="logsummary"></div>'+'<table id="logtable">'+'<thead><tr><th>Status</th><th>Test</th><th>Message</th></tr></thead>'+'<tbody id="loglines"></tbody>'+'</table>';this.logsummary=$('logsummary');this.loglines=$('loglines');},_toHTML:function(txt){return txt.escapeHTML().replace(/\n/g,"<br/>");},addLinksToResults:function(){$$("tr.failed .nameCell").each(function(td){td.title="Run only this test";Event.observe(td,'click',function(){window.location.search="?tests="+td.innerHTML;});});$$("tr.passed .nameCell").each(function(td){td.title="Run all tests";Event.observe(td,'click',function(){window.location.search="";});});}};Test.Unit.Runner=Class.create();Test.Unit.Runner.prototype={initialize:function(testcases){this.options=Object.extend({testLog:'testlog'},arguments[1]||{});this.options.resultsURL=this.parseResultsURLQueryParameter();this.options.tests=this.parseTestsQueryParameter();if(this.options.testLog){this.options.testLog=$(this.options.testLog)||null;}
if(this.options.tests){this.tests=[];for(var i=0;i<this.options.tests.length;i++){if(/^test/.test(this.options.tests[i])){this.tests.push(new Test.Unit.Testcase(this.options.tests[i],testcases[this.options.tests[i]],testcases["setup"],testcases["teardown"]));}}}else{if(this.options.test){this.tests=[new Test.Unit.Testcase(this.options.test,testcases[this.options.test],testcases["setup"],testcases["teardown"])];}else{this.tests=[];for(var testcase in testcases){if(/^test/.test(testcase)){this.tests.push(new Test.Unit.Testcase(this.options.context?' -> '+this.options.titles[testcase]:testcase,testcases[testcase],testcases["setup"],testcases["teardown"]));}}}}
this.currentTest=0;this.logger=new Test.Unit.Logger(this.options.testLog);setTimeout(this.runTests.bind(this),1000);},parseResultsURLQueryParameter:function(){return window.location.search.parseQuery()["resultsURL"];},parseTestsQueryParameter:function(){if(window.location.search.parseQuery()["tests"]){return window.location.search.parseQuery()["tests"].split(',');};},getResult:function(){var hasFailure=false;for(var i=0;i<this.tests.length;i++){if(this.tests[i].errors>0){return"ERROR";}
if(this.tests[i].failures>0){hasFailure=true;}}
if(hasFailure){return"FAILURE";}else{return"SUCCESS";}},postResults:function(){if(this.options.resultsURL){new Ajax.Request(this.options.resultsURL,{method:'get',parameters:'result='+this.getResult(),asynchronous:false});}},runTests:function(){var test=this.tests[this.currentTest];if(!test){this.postResults();this.logger.summary(this.summary());return;}
if(!test.isWaiting){this.logger.start(test.name);}
test.run();if(test.isWaiting){this.logger.message("Waiting for "+test.timeToWait+"ms");setTimeout(this.runTests.bind(this),test.timeToWait||1000);}else{this.logger.finish(test.status(),test.summary());this.currentTest++;this.runTests();}},summary:function(){var assertions=0;var failures=0;var errors=0;var messages=[];for(var i=0;i<this.tests.length;i++){assertions+=this.tests[i].assertions;failures+=this.tests[i].failures;errors+=this.tests[i].errors;}
return((this.options.context?this.options.context+': ':'')+
this.tests.length+" tests, "+
assertions+" assertions, "+
failures+" failures, "+
errors+" errors");}};Test.Unit.Assertions=Class.create();Test.Unit.Assertions.prototype={initialize:function(){this.assertions=0;this.failures=0;this.errors=0;this.messages=[];},summary:function(){return(this.assertions+" assertions, "+
this.failures+" failures, "+
this.errors+" errors"+"\n"+
this.messages.join("\n"));},pass:function(){this.assertions++;},fail:function(message){this.failures++;this.messages.push("Failure: "+message);},info:function(message){this.messages.push("Info: "+message);},error:function(error){this.errors++;this.messages.push(error.name+": "+error.message+"("+Test.Unit.inspect(error)+")");},status:function(){if(this.failures>0)return'failed';if(this.errors>0)return'error';return'passed';},assert:function(expression){var message=arguments[1]||'assert: got "'+Test.Unit.inspect(expression)+'"';try{expression?this.pass():this.fail(message);}
catch(e){this.error(e);}},assertEqual:function(expected,actual){var message=arguments[2]||"assertEqual";try{(expected==actual)?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertInspect:function(expected,actual){var message=arguments[2]||"assertInspect";try{(expected==actual.inspect())?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertEnumEqual:function(expected,actual){var message=arguments[2]||"assertEnumEqual";try{$A(expected).length==$A(actual).length&&expected.zip(actual).all(function(pair){return pair[0]==pair[1]})?this.pass():this.fail(message+': expected '+Test.Unit.inspect(expected)+', actual '+Test.Unit.inspect(actual));}
catch(e){this.error(e);}},assertNotEqual:function(expected,actual){var message=arguments[2]||"assertNotEqual";try{(expected!=actual)?this.pass():this.fail(message+': got "'+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertIdentical:function(expected,actual){var message=arguments[2]||"assertIdentical";try{(expected===actual)?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertNotIdentical:function(expected,actual){var message=arguments[2]||"assertNotIdentical";try{!(expected===actual)?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertNull:function(obj){var message=arguments[1]||'assertNull';try{(obj==null)?this.pass():this.fail(message+': got "'+Test.Unit.inspect(obj)+'"');}
catch(e){this.error(e);}},assertMatch:function(expected,actual){var message=arguments[2]||'assertMatch';var regex=new RegExp(expected);try{(regex.exec(actual))?this.pass():this.fail(message+' : regex: "'+Test.Unit.inspect(expected)+' did not match: '+Test.Unit.inspect(actual)+'"');}
catch(e){this.error(e);}},assertHidden:function(element){var message=arguments[1]||'assertHidden';this.assertEqual("none",element.style.display,message);},assertNotNull:function(object){var message=arguments[1]||'assertNotNull';this.assert(object!=null,message);},assertType:function(expected,actual){var message=arguments[2]||'assertType';try{(actual.constructor==expected)?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+(actual.constructor)+'"');}
catch(e){this.error(e);}},assertNotOfType:function(expected,actual){var message=arguments[2]||'assertNotOfType';try{(actual.constructor!=expected)?this.pass():this.fail(message+': expected "'+Test.Unit.inspect(expected)+'", actual "'+(actual.constructor)+'"');}
catch(e){this.error(e);}},assertInstanceOf:function(expected,actual){var message=arguments[2]||'assertInstanceOf';try{(actual instanceof expected)?this.pass():this.fail(message+": object was not an instance of the expected type");}
catch(e){this.error(e);}},assertNotInstanceOf:function(expected,actual){var message=arguments[2]||'assertNotInstanceOf';try{!(actual instanceof expected)?this.pass():this.fail(message+": object was an instance of the not expected type");}
catch(e){this.error(e);}},assertRespondsTo:function(method,obj){var message=arguments[2]||'assertRespondsTo';try{(obj[method]&&typeof obj[method]=='function')?this.pass():this.fail(message+": object doesn't respond to ["+method+"]");}
catch(e){this.error(e);}},assertReturnsTrue:function(method,obj){var message=arguments[2]||'assertReturnsTrue';try{var m=obj[method];if(!m)m=obj['is'+method.charAt(0).toUpperCase()+method.slice(1)];m()?this.pass():this.fail(message+": method returned false");}
catch(e){this.error(e);}},assertReturnsFalse:function(method,obj){var message=arguments[2]||'assertReturnsFalse';try{var m=obj[method];if(!m)m=obj['is'+method.charAt(0).toUpperCase()+method.slice(1)];!m()?this.pass():this.fail(message+": method returned true");}
catch(e){this.error(e);}},assertRaise:function(exceptionName,method){var message=arguments[2]||'assertRaise';try{method();this.fail(message+": exception expected but none was raised");}
catch(e){((exceptionName==null)||(e.name==exceptionName))?this.pass():this.error(e);}},assertElementsMatch:function(){var expressions=$A(arguments),elements=$A(expressions.shift());if(elements.length!=expressions.length){this.fail('assertElementsMatch: size mismatch: '+elements.length+' elements, '+expressions.length+' expressions');return false;}
elements.zip(expressions).all(function(pair,index){var element=$(pair.first()),expression=pair.last();if(element.match(expression))return true;this.fail('assertElementsMatch: (in index '+index+') expected '+expression.inspect()+' but got '+element.inspect());}.bind(this))&&this.pass();},assertElementMatches:function(element,expression){this.assertElementsMatch([element],expression);},benchmark:function(operation,iterations){var startAt=new Date();(iterations||1).times(operation);var timeTaken=((new Date())-startAt);this.info((arguments[2]||'Operation')+' finished '+
iterations+' iterations in '+(timeTaken/1000)+'s');return timeTaken;},_isVisible:function(element){element=$(element);if(!element.parentNode)return true;this.assertNotNull(element);if(element.style&&Element.getStyle(element,'display')=='none')
return false;return this._isVisible(element.parentNode);},assertNotVisible:function(element){this.assert(!this._isVisible(element),Test.Unit.inspect(element)+" was not hidden and didn't have a hidden parent either. "+(""||arguments[1]));},assertVisible:function(element){this.assert(this._isVisible(element),Test.Unit.inspect(element)+" was not visible. "+(""||arguments[1]));},benchmark:function(operation,iterations){var startAt=new Date();(iterations||1).times(operation);var timeTaken=((new Date())-startAt);this.info((arguments[2]||'Operation')+' finished '+
iterations+' iterations in '+(timeTaken/1000)+'s');return timeTaken;}};Test.Unit.Testcase=Class.create();Object.extend(Object.extend(Test.Unit.Testcase.prototype,Test.Unit.Assertions.prototype),{initialize:function(name,test,setup,teardown){Test.Unit.Assertions.prototype.initialize.bind(this)();this.name=name;if(typeof test=='string'){test=test.gsub(/(\.should[^\(]+\()/,'#{0}this,');test=test.gsub(/(\.should[^\(]+)\(this,\)/,'#{1}(this)');this.test=function(){eval('with(this){'+test+'}');}}else{this.test=test||function(){};}
this.setup=setup||function(){};this.teardown=teardown||function(){};this.isWaiting=false;this.timeToWait=1000;},wait:function(time,nextPart){this.isWaiting=true;this.test=nextPart;this.timeToWait=time;},run:function(){try{try{if(!this.isWaiting)this.setup.bind(this)();this.isWaiting=false;this.test.bind(this)();}finally{if(!this.isWaiting){this.teardown.bind(this)();}}}
catch(e){this.error(e);}}});Test.setupBDDExtensionMethods=function(){var METHODMAP={shouldEqual:'assertEqual',shouldNotEqual:'assertNotEqual',shouldEqualEnum:'assertEnumEqual',shouldBeA:'assertType',shouldNotBeA:'assertNotOfType',shouldBeAn:'assertType',shouldNotBeAn:'assertNotOfType',shouldBeNull:'assertNull',shouldNotBeNull:'assertNotNull',shouldBe:'assertReturnsTrue',shouldNotBe:'assertReturnsFalse',shouldRespondTo:'assertRespondsTo'};var makeAssertion=function(assertion,args,object){this[assertion].apply(this,(args||[]).concat([object]));};Test.BDDMethods={};$H(METHODMAP).each(function(pair){Test.BDDMethods[pair.key]=function(){var args=$A(arguments);var scope=args.shift();makeAssertion.apply(scope,[pair.value,args,this]);};});[Array.prototype,String.prototype,Number.prototype,Boolean.prototype].each(function(p){Object.extend(p,Test.BDDMethods)});};Test.context=function(name,spec,log){Test.setupBDDExtensionMethods();var compiledSpec={};var titles={};for(specName in spec){switch(specName){case"setup":case"teardown":compiledSpec[specName]=spec[specName];break;default:var testName='test'+specName.gsub(/\s+/,'-').camelize();var body=spec[specName].toString().split('\n').slice(1);if(/^\{/.test(body[0]))body=body.slice(1);body.pop();body=body.map(function(statement){return statement.strip()});compiledSpec[testName]=body.join('\n');titles[testName]=specName;}}
new Test.Unit.Runner(compiledSpec,{titles:titles,testLog:log||'testlog',context:name});};function OBJDate(chaine){this.jour=null;this.mois=null;this.annee=null;this.str=null;OBJDate.prototype.definition=function(str){if(!str){var dte=new Date();var str=dte.getDate()+"/"+(dte.getMonth()+1)+"/"+dte.getFullYear();}
str=new String(str);if(str.length==6){this.jour=str.substr(0,2);this.mois=str.substr(2,2);this.annee="20"+str.substr(4,2);}else{tab=str.split("/");if(!tab[1]||tab[1].length==0){tab=str.split("-");if(!tab[1]||tab[1].length==0){tab=str.split(".");if(!tab[1]||tab[1].length==0){tab[0]=str.substr(0,2);tab[1]=str.substr(2,2);tab[2]=str.substr(4,4);}}}
if(tab[2].length==2)tab[2]=parseInt(2000+Number(tab[2]));this.str=new String(str);this.jour=tab[0];this.mois=tab[1];this.annee=tab[2];}};this.definition(chaine);OBJDate.prototype.setDateByInfos=function(j,m,a){this.jour=j;this.mois=m;this.annee=a;};OBJDate.prototype.getProchainSamedi=function(){while(this.getJourSemaine()!==5){this.ajoutJour(1);}
this.ajoutJour(1);return this;};OBJDate.prototype.ajoutJour=function(nbj){var msPerDay=24*60*60*1000;var quatreheurePourChgtHr=4*60*60*1000;var d=Date.UTC(this.annee,(Number(this.mois)-1),this.jour);var d=Date.parse(Number(this.mois)+"/"+this.jour+"/"+this.annee);var d2=parseInt(d+(Number(nbj)*msPerDay)+quatreheurePourChgtHr);var dte=new Date();dte.setTime(d2);this.jour=dte.getDate();this.mois=dte.getMonth()+1;this.annee=dte.getFullYear();};OBJDate.prototype.enleveJour=function(nbj){var msPerDay=24*60*60*1000;var quatreheurePourChgtHr=4*60*60*1000;var d=Date.UTC(this.annee,(Number(this.mois)-1),this.jour);var d=Date.parse(Number(this.mois)+"/"+this.jour+"/"+this.annee);var d2=parseInt(d-(Number(nbj)*msPerDay)+quatreheurePourChgtHr);var dte=new Date();dte.setTime(d2);this.jour=dte.getDate();this.mois=dte.getMonth()+1;this.annee=dte.getFullYear();};OBJDate.prototype.getMoisSuivant=function(){if(this.mois==12){this.mois=1;this.annee++;}
else this.mois++;};OBJDate.prototype.getMoisPrecedent=function(){if(this.mois==1){this.mois=12;this.annee--;}
else this.mois--;};OBJDate.prototype.estMoisCourant=function(){var dte=new Date();return(this.mois==(dte.getMonth()+1));};OBJDate.prototype.estAnneeCourante=function(){var dte=new Date();return(this.annee==dte.getFullYear());};OBJDate.prototype.ajoutMois=function(nb){if(nb<0)this.retireMois(nb*(-1));else{for(var i=1;i<=nb;i++){this.getMoisSuivant();}}};OBJDate.prototype.retireMois=function(nb){for(var i=1;i<=nb;i++){this.getMoisPrecedent();}};OBJDate.prototype.getJour=function(){return this.jour;};OBJDate.prototype.getMois=function(){return this.mois;};OBJDate.prototype.getAnnee=function(){return this.annee;};OBJDate.prototype.getLibelleJour=function(){var tabJ=new Array("Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi");return tabJ[this.getJourSemaine()];};OBJDate.prototype.getJourSemaine=function(){return new Date(this.mois+"/"+this.jour+"/"+this.annee).getDay();};OBJDate.prototype.getJSONLblJourWeek=function(langue){var tabJr;switch(langue){case"ANGLAIS":tabJr=[{"libelle":"Sunday","libelle_court":"Su"},{"libelle":"Monday","libelle_court":"Mo"},{"libelle":"Tuesday","libelle_court":"Tu"},{"libelle":"Wednesday","libelle_court":"We"},{"libelle":"Thursday","libelle_court":"Th"},{"libelle":"Friday","libelle_court":"Fr"},{"libelle":"Saturday","libelle_court":"Sa"}];break;case"ALLEMAND":tabJr=[{"libelle":"Sonntag","libelle_court":"So"},{"libelle":"Montag","libelle_court":"Mo"},{"libelle":"Dienstag","libelle_court":"Di"},{"libelle":"Mittwoch","libelle_court":"Mi"},{"libelle":"Donnerstag","libelle_court":"Do"},{"libelle":"Freitag","libelle_court":"Fr"},{"libelle":"Samstag","libelle_court":"Sa"}];break;case"HOLLANDAIS":case"NEERLANDAIS":tabJr=[{"libelle":"Zondag","libelle_court":"Zo"},{"libelle":"Maandag","libelle_court":"Ma"},{"libelle":"Dinsdag","libelle_court":"Di"},{"libelle":"Woensdag","libelle_court":"Wo"},{"libelle":"Donderdag","libelle_court":"Do"},{"libelle":"Vrijdag","libelle_court":"Vr"},{"libelle":"Zaterdag","libelle_court":"Za"}];break;case"ESPAGNOL":tabJr=[{"libelle":"Domingo","libelle_court":"Do"},{"libelle":"Lunes","libelle_court":"Lu"},{"libelle":"Martes","libelle_court":"Ma"},{"libelle":"Mi&eacute;rcoles","libelle_court":"Mi"},{"libelle":"Jueves","libelle_court":"Ju"},{"libelle":"Viernes","libelle_court":"Vi"},{"libelle":"S&aacute;bado","libelle_court":"S&aacute;"}];break;case"ITALIEN":tabJr=[{"libelle":"Domenica","libelle_court":"Do"},{"libelle":"Luned","libelle_court":"Lu"},{"libelle":"Marted","libelle_court":"Ma"},{"libelle":"Mercoled","libelle_court":"Me"},{"libelle":"Gioved","libelle_court":"Gi"},{"libelle":"Venerd","libelle_court":"Ve"},{"libelle":"Sabato","libelle_court":"Sa"}];break;case"PORTUGAIS":tabJr=[{"libelle":"Domingo","libelle_court":"Do"},{"libelle":"Segunda-feira","libelle_court":"Se"},{"libelle":"Ter&ccedil;a-feira","libelle_court":"Te"},{"libelle":"Quarta-feira","libelle_court":"Qu"},{"libelle":"Quinta-feira","libelle_court":"Qu"},{"libelle":"Sexta-feira","libelle_court":"Se"},{"libelle":"S&aacute;bado","libelle_court":"S&aacute;"}];break;case"FRANCAIS":default:tabJr=[{"libelle":"Dimanche","libelle_court":"Di"},{"libelle":"Lundi","libelle_court":"Lu"},{"libelle":"Mardi","libelle_court":"Ma"},{"libelle":"Mercredi","libelle_court":"Me"},{"libelle":"Jeudi","libelle_court":"Je"},{"libelle":"Vendredi","libelle_court":"Ve"},{"libelle":"Samedi","libelle_court":"Sa"}];break;}
return tabJr;};OBJDate.prototype.getTabMois=function(langue){var tabM=new Array();switch(langue){case"ANGLAIS":tabM[1]="January";tabM[2]="February";tabM[3]="March";tabM[4]="April";tabM[5]="May";tabM[6]="June";tabM[7]="July";tabM[8]="August";tabM[9]="September";tabM[10]="October";tabM[11]="November";tabM[12]="December";break;case"ALLEMAND":tabM[1]="Januar";tabM[2]="Februar";tabM[3]="M&auml;rz";tabM[4]="April";tabM[5]="Mai";tabM[6]="Juni";tabM[7]="Juli";tabM[8]="August";tabM[9]="September";tabM[10]="Oktober";tabM[11]="November";tabM[12]="Dezember";break;case"HOLLANDAIS":case"NEERLANDAIS":tabM[1]="Januari";tabM[2]="Februari";tabM[3]="Maart";tabM[4]="April";tabM[5]="Mei";tabM[6]="Juni";tabM[7]="Juli";tabM[8]="Augustus";tabM[9]="September";tabM[10]="Oktober";tabM[11]="November ";tabM[12]="December";break;case"ESPAGNOL":tabM[1]="Eenero ";tabM[2]="Ebrero";tabM[3]="Marzo";tabM[4]="Abril";tabM[5]="Mayo";tabM[6]="Junio";tabM[7]="Julio";tabM[8]="Agosto";tabM[9]="Septiembre";tabM[10]="Octubre";tabM[11]="Noviembre ";tabM[12]="Diciembre";break;case"ITALIEN":tabM[1]="Gennaio";tabM[2]="Febbraio";tabM[3]="Marzo";tabM[4]="Aprile";tabM[5]="Maggio";tabM[6]="Giugno";tabM[7]="Luglio";tabM[8]="Agosto";tabM[9]="Settembre";tabM[10]="Ottobre";tabM[11]="Novembre ";tabM[12]="Dicembre";break;case"PORTUGAIS":tabM[1]="Janeiro";tabM[2]="Fevereiro";tabM[3]="Mar&ccedil;o";tabM[4]="Abril";tabM[5]="Maio";tabM[6]="Junho";tabM[7]="Julho";tabM[8]="Agosto";tabM[9]="Setembro";tabM[10]="Outubro";tabM[11]="Novembro";tabM[12]="Dezembro";break;case"FRANCAIS":default:tabM[1]="Janvier";tabM[2]="F&eacute;vrier";tabM[3]="Mars";tabM[4]="Avril";tabM[5]="Mai";tabM[6]="Juin";tabM[7]="Juillet";tabM[8]="Aout";tabM[9]="Septembre";tabM[10]="Octobre";tabM[11]="Novembre";tabM[12]="D&eacute;cembre";break;}
return tabM;};OBJDate.prototype.getTabMoisCourt=function(langue){var tabM=new Array();switch(langue){case"ANGLAIS":tabM[1]="January";tabM[2]="February";tabM[3]="March";tabM[4]="April";tabM[5]="May";tabM[6]="June";tabM[7]="July";tabM[8]="August";tabM[9]="September";tabM[10]="October";tabM[11]="November";tabM[12]="December";break;case"ALLEMAND":tabM[1]="Januar";tabM[2]="Februar";tabM[3]="M&auml;rz";tabM[4]="April";tabM[5]="Mai";tabM[6]="Juni";tabM[7]="Juli";tabM[8]="August";tabM[9]="September";tabM[10]="Oktober";tabM[11]="November";tabM[12]="Dezember";break;case"HOLLANDAIS":case"NEERLANDAIS":tabM[1]="Januari";tabM[2]="Februari";tabM[3]="Maart";tabM[4]="April";tabM[5]="Mei";tabM[6]="Juni";tabM[7]="Juli";tabM[8]="Augustus";tabM[9]="September";tabM[10]="Oktober";tabM[11]="November ";tabM[12]="December";break;case"ESPAGNOL":tabM[1]="Eenero ";tabM[2]="Ebrero";tabM[3]="Marzo";tabM[4]="Abril";tabM[5]="Mayo";tabM[6]="Junio";tabM[7]="Julio";tabM[8]="Agosto";tabM[9]="Septiembre";tabM[10]="Octubre";tabM[11]="Noviembre ";tabM[12]="Diciembre";break;case"ITALIEN":tabM[1]="Gennaio";tabM[2]="Febbraio";tabM[3]="Marzo";tabM[4]="Aprile";tabM[5]="Maggio";tabM[6]="Giugno";tabM[7]="Luglio";tabM[8]="Agosto";tabM[9]="Settembre";tabM[10]="Ottobre";tabM[11]="Novembre ";tabM[12]="Dicembre";break;case"PORTUGAIS":tabM[1]="Janeiro";tabM[2]="Fevereiro";tabM[3]="Mar&ccedil;o";tabM[4]="Abril";tabM[5]="Maio";tabM[6]="Junho";tabM[7]="Julho";tabM[8]="Agosto";tabM[9]="Setembro";tabM[10]="Outubro";tabM[11]="Novembro";tabM[12]="Dezembro";break;case"FRANCAIS":default:tabM[1]="Janv.";tabM[2]="F&eacute;v.";tabM[3]="Mar.";tabM[4]="Avr.";tabM[5]="Mai";tabM[6]="Juin";tabM[7]="Juil.";tabM[8]="Aout";tabM[9]="Sept.";tabM[10]="Oct.";tabM[11]="Nov.";tabM[12]="D&eacute;c.";break;}
return tabM;};OBJDate.prototype.getLibelleMois=function(langue){if(!langue)langue="FRANCAIS";var tabM=this.getTabMois(langue);return tabM[parseInt(this.getMois())];};OBJDate.prototype.getLibelleMoisCourt=function(langue){if(!langue)langue="FRANCAIS";var tabM=this.getTabMoisCourt(langue);return tabM[parseInt(this.getMois())];};OBJDate.prototype.getDate=function(){return this.toString('dd/mm/yyyy');};OBJDate.prototype.toMySQL=function(){return this.toString('yyyy-mm-dd');};OBJDate.prototype.toString=function(format){if(!format)format="dd/mm/yyyy";var jr=parseInt(this.getJour(),10);var mois=parseInt(this.getMois(),10);var j=new String((jr<10)?"0"+jr:jr);var m=new String((mois<10)?"0"+mois:mois);var a4=new String(this.getAnnee());var a2=new String(parseInt((this.getAnnee()-2000),10));switch(format){case"dd/mm/yyyy":return(j+"/"+m+"/"+a4);case"dd/mm/yy":return(j+"/"+m+"/"+a2);case"ddmmyyyy":return(j+m+a4);case"yyyymmdd":return(a4+m+j);case"yyyy-mm-dd":return(a4+'-'+m+'-'+j);case"ddmmyy":return(j+m+a2);case"dd.mm.yy":return(j+'.'+m+'.'+a2);case"dd":return j;default:return(j+"/"+m+"/"+a4);}};OBJDate.prototype.getNbjMois=function(){return this.getNbjMoisAutre(this.mois);};OBJDate.prototype.getNbjMoisAutre=function(mois){if(mois==1||mois==3||mois==5||mois==7||mois==8||mois==10||mois==12)
return 31;if(mois==4||mois==6||mois==9||mois==11)
return 30;if(mois==2&&this.estBissextile(this.annee))return 29;else return 28;};OBJDate.prototype.estBissextile=function(annee){return(annee%4==0&&(annee%100!=0||(annee%100==0&&annee%400==0)));};OBJDate.prototype.estAvant=function(dte){obj=new OBJDate(dte);return(this.getTimeStamp()<=obj.getTimeStamp());};OBJDate.prototype.estAvantOBJDate=function(dte){return(this.getTimeStamp()<=dte.getTimeStamp());};OBJDate.prototype.estAvantStrictOBJDate=function(dte){return(this.getTimeStamp()<dte.getTimeStamp());};OBJDate.prototype.estEgale=function(dte){obj=new OBJDate();obj.definition(dte);return(this.getTimeStamp()==obj.getTimeStamp());};OBJDate.prototype.estApres=function(dte){obj=new OBJDate(dte);return(this.getTimeStamp()>=obj.getTimeStamp());};OBJDate.prototype.estApresOBJDate=function(dte){return(this.getTimeStamp()>=dte.getTimeStamp());};OBJDate.prototype.estApresStrictOBJDate=function(dte){return(this.getTimeStamp()>dte.getTimeStamp());};OBJDate.prototype.estComprisEntre=function(dteDeb,dteFin){return(this.estAvant(dteFin)&&this.estApres(dteDeb));};OBJDate.prototype.getTimeStamp=function(){return new Date(this.mois+"/"+this.jour+"/"+this.annee).getTime();};OBJDate.prototype.getNbJourEcartWithOBJDate=function(dte,positif){var nbj1=this.getTimeStamp()/86400000;var nbj2=dte.getTimeStamp()/86400000;var nbj=Math.round(nbj1-nbj2);if(positif!="N"&&nbj<0)nbj=nbj*(-1);return nbj;};OBJDate.prototype.retireAnnee=function(nbAnnee){this.annee=this.annee-nbAnnee;return this;};OBJDate.prototype.ajouteAnnee=function(nbAnnee){this.annee=this.annee+nbAnnee;return this;};}
function setCalendrierForResa(divForCalend,ident,typeGite,tabChambre,langue,modeAff,nbMois){var today=new OBJDate();today.definition();var moisCurr=$("mois").value;if(moisCurr==0)moisCurr=today.getMois();if(parseInt(moisCurr,10)<10&&moisCurr.substr(0,1)=="0")moisCurr=moisCurr.substr(1,1);var anneeCurr=$("annee").value;if(anneeCurr==0)anneeCurr=today.getAnnee();var fctClic=function(evt,jour,mois,annee,etat){if(parseInt(jour,10)<10&&jour.substr(0,1)=="0")jour=jour.substr(1,1);$("jour").value=jour;$("mois").value=mois;$("annee").value=annee;Effect.BlindUp(divForCalend);$(divForCalend).showing=false;if(verifSaisieDatesLocation()===false){setHTMLById("div_msgClient_dateSejour",$("id_msgPasDates").value);$("div_msgClient_dateSejour").addClassName("msgClientAffiche");if("div_saisieDatesSejour")effaceEtapesApres("div_saisieDatesSejour");}};if(!typeGite&&tabChambre&&tabChambre.length>0)typeGite="H";if(!typeGite)typeGite="G";if(!tabChambre)tabChambre=new Array();setCalendrierToDiv(divForCalend,{"langue":langue,"moisDebut":moisCurr,"anneeDebut":anneeCurr,"firstWeekDay":2,"nbMois":nbMois,"ident":ident,"typeGite":typeGite,"tabChambre":tabChambre,"afficheJrArrivee":true,"afficheDispos":true,"duree":$("duree").value,"clic":fctClic,"modeAff":modeAff});}
function setCalendrierForResaGP(divForCalend,code,typeProd,langue,modeAff,nbMois,tabStock,instance,request){var today=new OBJDate();today.definition();var moisCurr=$("mois").value;if(moisCurr==0)moisCurr=today.getMois();if(parseInt(moisCurr,10)<10&&moisCurr.substr(0,1)=="0")moisCurr=moisCurr.substr(1,1);var anneeCurr=$("annee").value;if(anneeCurr==0)anneeCurr=today.getAnnee();if($("duree"))var duree=$("duree").value;else var duree=1;if(!tabStock)tabStock={};var fctClic=function(evt,jour,mois,annee,etat){$("jour").value=jour;$("mois").value=mois;$("annee").value=annee;Effect.BlindUp(divForCalend);$(divForCalend).showing=false;if(verifSaisieDatesSejourGP()===false){setHTMLById("div_msgClient_dateSejour",$("id_msgPasDates").value);$("div_msgClient_dateSejour").addClassName("msgClientAffiche");if("div_saisieDatesSejour")effaceEtapesApresGP("div_saisieDatesSejour");}};setCalendrierToDivGP(divForCalend,{"langue":langue,"moisDebut":moisCurr,"anneeDebut":anneeCurr,"firstWeekDay":2,"nbMois":nbMois,"code":code,"instance":instance,"typeProd":typeProd,"tabStock":tabStock,"request":request,"afficheJrArrivee":true,"afficheDispos":true,"duree":duree,"clic":fctClic});}
function setCalendrierToDivForDispoProd(nomdiv,ident,tabStock,nbMois,request,typeProd,linkToResa){if(!$(nomdiv).showing){var fctClic=function(evt,jour,mois,annee,etat){Effect.BlindUp(nomdiv);$(nomdiv).showing=false;if(linkToResa)document.location.href=linkToResa+"&jour_calend="+jour+"&mois_calend="+mois+"&annee_calend="+annee;};$(nomdiv).hide();if(!nbMois)nbMois=3;ident=new String(ident);var tabInfos=ident.split(".");var instance=tabInfos[0];var code=tabInfos[2];setCalendrierToDivGP(nomdiv,{"firstWeekDay":1,"nbMois":nbMois,"code":code,"instance":instance,"typeProd":typeProd,"tabStock":tabStock,"request":request,"afficheJrArrivee":true,"afficheDispos":true,"clic":fctClic});Effect.BlindDown(nomdiv,{duration:0.5});$(nomdiv).showing=true;$(nomdiv).addClassName("div_dispos_showing");}else{Effect.BlindUp(nomdiv);$(nomdiv).showing=false;$(nomdiv).removeClassName("div_dispos_showing");}}
function setCalendrierForRecherche(instance,idf,ident,langue,typeGite){var today=new OBJDate();today.definition();var moisCurr=$("mois").value;if(moisCurr==0)moisCurr=today.getMois();if(parseInt(moisCurr,10)<10&&moisCurr.substr(0,1)=="0")moisCurr=moisCurr.substr(1,1);var anneeCurr=$("annee").value;if(anneeCurr==0)anneeCurr=today.getAnnee();if(!typeGite)typeGite="G";var fctClic=function(evt,jour,mois,annee,etat){if(parseInt(jour,10)<10&&jour.substr(0,1)=="0")jour=jour.substr(1,1);$("jour").value=jour;$("mois").value=mois;$("annee").value=annee;$("calendrierRecherche").style.display="none";};setCalendrierToDiv("calendrierRecherche",{"langue":langue,"moisDebut":moisCurr,"anneeDebut":anneeCurr,"firstWeekDay":2,"nbMois":1,"ident":ident,"instance":instance,"id_famille":idf,"afficheJrArrivee":true,"afficheDispos":true,"typeGite":typeGite,"duree":$("duree").value,"clic":fctClic});}
function setCalendrierGeneral(instance,idf,langue,typeGite,idDivCalend,fctClic,idDate,idMois,idAnnee,idDuree,nbMois,firstWeekDay,jrEnAvant,dateDebSej,nbjSej,fcQdFini){var today=new OBJDate();today.definition();var moisCurr=0;var anneeCurr=0;if(idDate&&$(idDate)&&$(idDate).value!=$(idDate).getAttribute("data-defaut")){var dateCurr=new OBJDate();dateCurr.definition($(idDate).value);moisCurr=dateCurr.getMois();anneeCurr=dateCurr.getAnnee();}else{if(idMois&&$(idMois)&&idAnnee&&$(idAnnee)){moisCurr=$(idMois).value;anneeCurr=$(idAnnee).value;}}
if(idDuree&&$(idDuree))duree=$(idDuree).value;if(moisCurr==0)moisCurr=today.getMois();if(parseInt(moisCurr,10)<10&&moisCurr.substr(0,1)=="0")moisCurr=moisCurr.substr(1,1);if(anneeCurr==0)anneeCurr=today.getAnnee();if(!typeGite)typeGite="G";if(!nbMois)nbMois="1";if(!firstWeekDay)firstWeekDay="2";if(!duree&&typeGite=="G")var duree="7";if(!duree)var duree="1";if(!jrEnAvant)var jrEnAvant=0;if(!dateDebSej)nbjSej=null;setCalendrierToDiv(idDivCalend,{"langue":langue,"moisDebut":moisCurr,"anneeDebut":anneeCurr,"firstWeekDay":firstWeekDay,"nbMois":nbMois,"instance":instance,"id_famille":idf,"afficheJrArrivee":true,"afficheDispos":true,"typeGite":typeGite,"duree":duree,"clic":fctClic,"jrEnAvant":jrEnAvant,"dateDebSej":dateDebSej,"nbjSej":nbjSej,"fcQdFini":fcQdFini});}
function setCalendrierToDivForDispoStruct(nomdiv,ident,tabChambre,linkToResa,nbMois,modeVenteGeGs,afficheDisposParAnnee,tabAnneesActives,reference,afficheNavChambre,langue,cliquable,afficheLegende,modeAff){if(!$(nomdiv).showing){var fctClic;if('function'==typeof(clickSurJourDsPlanningFiche))fctClic=window.clickSurJourDsPlanningFiche;else{}
$(nomdiv).hide();if(!nbMois)nbMois=3;setCalendrierToDiv(nomdiv,{'duree':'0','firstWeekDay':1,'nbMois':nbMois,'ident':ident,'afficheJrArrivee':false,'afficheDispos':true,"tabChambre":tabChambre,"clic":fctClic,"modeVenteGeGs":modeVenteGeGs,"afficheDisposParAnnee":afficheDisposParAnnee,"linkToResa":linkToResa,"langue":langue,"reference":reference,"afficheNavChambre":afficheNavChambre,"tabAnneesActives":tabAnneesActives,"nonCliquable":cliquable,"afficheLegende":afficheLegende,"modeAff":modeAff});Effect.BlindDown(nomdiv,{duration:0.5});$(nomdiv).showing=true;$(nomdiv).addClassName("div_dispos_showing");}else{Effect.BlindUp(nomdiv,{duration:0.5});$(nomdiv).showing=false;$(nomdiv).removeClassName("div_dispos_showing");}}
function initPlanning(nomdiv,titreDivResa,afficheDisposParAnnee,afficheNavChambre,afficheLegende){if(jQuery(".div_fiche_calendrierDispoPHP").length==0){if($(nomdiv)){var obj=$(nomdiv);var ident=obj.getAttribute("ident");var nbMois=obj.getAttribute("nbMois");var langue=obj.getAttribute("langue");var nonCliquable=obj.getAttribute('noncliquable');var tabChambre;if(!obj.getAttribute("tabChambre"))tabChambre=new Array();else tabChambre=eval(obj.getAttribute("tabChambre"));var linkToResa=obj.getAttribute("linkToResa");var modeVenteGeGs=obj.getAttribute("modeVenteGeGs");var afficheLegende=eval(afficheLegende);var tabAnneesActives;if(!obj.getAttribute("tabAnneesActives"))tabAnneesActives=new Array();else tabAnneesActives=eval(obj.getAttribute("tabAnneesActives"));var reference=obj.getAttribute("reference");if(titreDivResa)window.nomDivResaPopIn=titreDivResa;setCalendrierToDivForDispoStruct(nomdiv,ident,tabChambre,linkToResa,nbMois,modeVenteGeGs,afficheDisposParAnnee,tabAnneesActives,reference,afficheNavChambre,langue,nonCliquable,afficheLegende);var idDivGene=obj.getAttribute("idDivGene");if(idDivGene)setActionsSurListeChambres(tabChambre,ident,linkToResa,nbMois,modeVenteGeGs,idDivGene);else setActionsSurListeChambres(tabChambre,ident,linkToResa,nbMois,modeVenteGeGs);}}else{}}
function setActionsSurListeChambres(tabChambre,ident,linkToResa,nbMois,modeVenteGeGs,idDivGene){if(tabChambre.length>0){var objGraph=$("divGraph_fenetre");if(objGraph)var styleDivGraph=objGraph.style.display;else var styleDivGraph=null;if($("select_fiche_dispos_fngf_v4_chmbAnnee")&&styleDivGraph!="none")var id="select_fiche_dispos_fngf_v4_chmbAnnee";else var id="select_fiche_dispos_fngf_v4_chmb";var objId=$(id);if(objId){objId.onchange=function(evt){if(!idDivGene){var idDivGeneForSetClasse=this.nextSibling.firstChild.firstChild.childNodes[1].firstChild.getAttribute("idDivGene");}
else var idDivGeneForSetClasse=idDivGene;if(this.value=="G"){calendrier_setClasseForDispos(idDivGeneForSetClasse);calendrier_setClasseForJourArr(idDivGeneForSetClasse);}
else calendrier_setClasseForDisposForChambre(idDivGeneForSetClasse,tabChambre.length);}}}}
function calendrier_getXHTMLForAfficheInDivAvecTransparenceAvecChargChambres(nomdiv,ident,linkToResa,nbMois,modeVenteGeGs,afficheDisposParAnnee,tabAnneesActives,obj,reference,titreDivResa,langue,duree,afficheLegende){var url="/lib_2/ajax/infosDist.php";var vars;var html_calend;vars="info=TABCHB&ident="+ident;var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;var tabChambre=eval(contenu);html_calend=calendrier_getXHTMLForAfficheInDivAvecTransparence(nomdiv,ident,tabChambre,linkToResa,nbMois,modeVenteGeGs,afficheDisposParAnnee,tabAnneesActives,reference,titreDivResa,langue,duree,afficheLegende);$("divGraph_fenetre").innerHTML=html_calend;}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(vars);}
function calendrier_getXHTMLForAfficheInDivAvecTransparence(nomdiv,ident,tabChambre,linkToResa,nbMois,modeVenteGeGs,afficheDisposParAnnee,tabAnneesActives,reference,titreDivResa,langue,duree,afficheLegende){var fctClic=calendrier_redirectFrmToResa;var html;window.nomDivResaPopIn=titreDivResa;html="<div class='calendIteaBtFermer' id='div_planningBtFermer_calendItea_"+nomdiv+"' onclick=effaceDivAvecTransparence();>Fermer</div>";html+=setCalendrierToDiv(nomdiv,{'moisDebut':1,'firstWeekDay':1,'nePasChargerMotCles':true,'nbMois':nbMois,'ident':ident,'afficheJrArrivee':false,'afficheDispos':true,"tabChambre":tabChambre,"clic":fctClic,"modeVenteGeGs":modeVenteGeGs,"afficheDisposParAnnee":afficheDisposParAnnee,"tabAnneesActives":tabAnneesActives,"linkToResa":linkToResa,"reference":reference,"langue":langue,"duree":duree,"afficheLegende":afficheLegende},true);return html;}
function calendrier_redirectFrmToResa(linkToResa,sending,width,height){if(!sending)sending="";window.popupReservation=window.open(linkToResa+"?"+sending,"blank");}
function setActionsApresChargementDispo(nomdiv,ident,obj,afficheLegende){if(obj){$$('.div_planningSelect').each(function(elt){elt.removeClassName('div_planningSelect');})
if(obj.getAttribute("data-indice")){var indice=obj.getAttribute("data-indice");}
else{var indice=obj.getAttribute("indice");}
var idListe="liLst_elem_"+indice;if($(idListe)){$(idListe).addClassName("div_planningSelect");}}
if(afficheLegende==true){calendrier_chargeMotCleDeLaLegende(nomdiv);}
var idDivForChargeMotCle="calendItea_"+nomdiv;calendrier_chargeMotCleDansCalendrier(idDivForChargeMotCle);ident=new String(ident);var tabInfos=ident.split(".");var typeProd=tabInfos[3];if(typeProd=="G"||typeProd=="H")setActionsSurMois(ident);}
function setCalendrierToDiv(idDiv,params,getXHTML){if(!params.typeGite&&params.tabChambre&&params.tabChambre.length>0&&params.modeVenteGeGs!="G")params.typeGite="H";if(!params.typeGite)params.typeGite="G";if(!params.tabChambre)params.tabChambre=new Array();if(!params.langue)params.langue="FRANCAIS";if(!params.modeAff)params.modeAff="CARRE";if(!params.afficheNavChambre)params.afficheNavChambre=false;if(params.modeVenteGeGs=="?"){if(params.modeAff=="LIGNE")params.typeGite="H";else params.typeGite="G";}
if(!params.tabAnneesActives)params.tabAnneesActives=new Array();var html="";div=$(idDiv);if(div){var changeAff="";if((params.typeGite=="H"||params.modeVenteGeGs=="H"||params.modeVenteGeGs=="?")&&params.ident){var affSelect;if(params.modeAff=="LIGNE")affSelect="CARRE";else affSelect="LIGNE";changeAff="<p class='saisieDatesSejour changeModeAffCalendrier' id='saisieDatesSejour_changeAff_"+idDiv+"'></p>";}
if(getXHTML)html+=calendrier_getXHTML(params,idDiv,true)+changeAff;else{if(params.afficheDisposParAnnee=="true")div.innerHTML=calendrier_getXHTML(params,idDiv,true)+changeAff;else div.innerHTML=calendrier_getXHTML(params,idDiv)+changeAff;}
if(!params.nePasChargerMotCles&&params.afficheLegende)calendrier_chargeMotCleDeLaLegende(idDiv);if(!params.ident&&(params.typeGite=="H"||!params.instance))calendrier_setClasseForJourArrTous("calendItea_"+idDiv);else affMsgAttenteParDessusInDiv(idDiv);if((params.typeGite=="H"||params.modeVenteGeGs=="H"||params.modeVenteGeGs=="?")&&$("saisieDatesSejour_changeAff_"+idDiv)){if(!params.nePasChargerMotCles){if(params.modeVenteGeGs=="?")chargeMotCleDsDiv("saisieDatesSejour_changeAff_"+idDiv,"LBL_AFFCALENDGEGSINCONNU_"+affSelect);else chargeMotCleDsDiv("saisieDatesSejour_changeAff_"+idDiv,"LBL_AFFCALEND_"+affSelect);}
else{var txt="";if(params.modeVenteGeGs=="?"){if(affSelect=="CARRE")txt="Disponibilit&eacute;s de l'h&eacute;bergement complet";else txt="Disponibilit&eacute;s par chambre";}
else{if(affSelect=="CARRE")txt="Affichage cumul&eacute;";else txt="Affichage &agrave; la chambre";}
if(getXHTML)html+=txt;else $("saisieDatesSejour_changeAff_"+idDiv).innerHTML=txt;}
$("saisieDatesSejour_changeAff_"+idDiv).onclick=function(evt){params.modeAff=affSelect;setCalendrierToDiv(idDiv,params);}}
div.firstChild.foncQdClicGauche=params.clic;div.firstChild.foncQdChangeMois=params.foncQdChangeMois;}
if(params.fcQdFini)params.fcQdFini();if(getXHTML)return html;}
function calendrier_getXHTML_Navig(params){var htmlNavig="";var html="<div class='calendIteaDivNavig'>";var nextMonth="{'nbMois':"+params.nbMois+",'mois':"+parseInt(params.moisDebut+1)+",'annee':"+params.annee+",'firstWeekDay':"+params.firstWeekDay+"}";html+="</div>"}
function calendrier_getXHTML(params,idDiv,calendAvecSaison){var html="";if(params.nbMois)nbMois=params.nbMois;else nbMois=1;var today=new OBJDate();today.definition();if(!params.moisDebut)params.moisDebut=today.getMois();if(!params.anneeDebut)params.anneeDebut=today.getAnnee();var mois=params.moisDebut;var annee=params.anneeDebut;if(params.afficheDisposParAnnee=="true"){var mois=1;if(today.getAnnee()==annee)nbMois=12-mois+1;else nbMois=12;var nb_annees=params.tabAnneesActives.length;var annee_prec=0;var annee_suiv=0;var annee_min=0;if(annee_min<=today.getAnnee())annee_min=today.getAnnee();else annee_min=params.tabAnneesActives[0];var annee_max=params.tabAnneesActives[nb_annees-1];if(annee<annee_max&&annee>annee_min){annee_prec=annee-1;annee_suiv=annee-1;}
else if(annee==annee_min)
if(annee_max!=annee_min)annee_suiv=parseInt(annee)+1;else if(annee==annee_max)
if(annee_min!=annee_max)annee_prec=parseInt(annee)-1;}
var langue=params.langue;if(!langue)langue="FRANCAIS";var typeGite=params.typeGite;if(!typeGite)typeGite="G";var nb_chambre=params.tabChambre.length;var classeAlternee;if(params.ident)var ident=params.ident;else var ident="";if(params.instance)var instance=params.instance;else var instance="";if(params.linkToResa)var linkToResa=params.linkToResa;else var linkToResa="";if(calendAvecSaison)html="<div class='calendIteaAvSaison' id='calendItea_"+idDiv+"' ident='"+ident+"' linkToResa='"+linkToResa+"'>";else html="<div class='calendItea calendItea_"+params.modeAff+"' id='calendItea_"+idDiv+"' ident='"+ident+"' linkToResa='"+linkToResa+"'>";if((params.afficheDisposParAnnee||params.afficheNavChambre==true)&&(typeGite=="H"||params.modeVenteGeGs=="?")){if(nb_chambre>1){html+="<select class='fiche_dispos_fngf_v4_chmb' id='select_fiche_dispos_fngf_v4_chmbAnnee'>";if(params.modeVenteGeGs=="?")
html+="<option value='G' class='fiche_dispos_fngf_v4_chmb' id='option_dispo_chmb_G'>A la structure</option>";if(params.langue=="ANGLAIS")html+="<option value='0' class='fiche_dispos_fngf_v4_chmb' id='option_dispo_chmb_0'>All rooms</option>";else html+="<option value='0' class='fiche_dispos_fngf_v4_chmb' id='option_dispo_chmb_0'>Toutes les chambres</option>";for(var j=0;j<nb_chambre;j++){html+="<option value='"+params.tabChambre[j].numero_chambre+"' class='fiche_dispos_fngf_v4_chmb' id='option_dispo_chmb_"+params.tabChambre[j].numero_chambre+"'>"+params.tabChambre[j].nom+"</option>";}
html+="</select>";}}
html+="<div class='calendItea_navigEtCalend'>";html+="<div class='calendItea_navig calendItea_navigGauche' id='calendIteaNavigGauche_calendItea_"+idDiv+"'>";var displayNavigCalendrierdebut='block';if(mois==today.getMois()&&annee==today.getAnnee())displayNavigCalendrierdebut='none';if(!params.afficheDisposParAnnee){html+="<a style='display:"+displayNavigCalendrierdebut+";' data-anneMin='"+today.getAnnee()+"' data-moisMin='"+today.getMois()+"' onclick=calendrier_moisAutre(this.parentNode.nextSibling.firstChild,-1)>";html+="<";html+="</a>";}
else{if(annee_prec!=0){html+="<a style='display:"+displayNavigCalendrierdebut+";' data-anneMin='"+today.getAnnee()+"' data-moisMin='"+today.getMois()+"' class='calendItea_navigGauche_lien' href='#dispoPrecedent' onclick=calendrier_moisAutre(this.parentNode.nextSibling.nextSibling.nextSibling.firstChild,-1)>";html+="<span id='lblDisponibilitesNavigGauche_calendItea_"+idDiv+"'></span>&nbsp;";html+="<span id='valDisponibilitesNavigGauche_calendItea_"+idDiv+"'>"+annee_prec+"</span>";html+="</a>";}}
html+="</div>";if(params.afficheDisposParAnnee=="true"){var identForRef=new String(ident);var tabInfos=identForRef.split(".");var numHeber=tabInfos[2];if(params.reference)numHeber=params.reference;html+="<div class='calendItea_navig calendItea_anneeCourante'>";html+="<span id='lblDisponibilitesRefInterne_calendItea_"+idDiv+"'></span>&nbsp;";html+="<span id='disponibilitesRefInterne_calendItea_"+idDiv+"'>"+numHeber+"</span>&nbsp;";html+="<span id='lblDisponibilitesAnneeCourante_calendItea_"+idDiv+"'></span>&nbsp;";html+="<span id='valDisponibilitesAnneeCourante_calendItea_"+idDiv+"'>"+annee+"</span>";html+="</div>";}
if(params.afficheDisposParAnnee=="true"){html+="<div class='calendItea_navig calendItea_navigDroite' id='calendIteaNavigDroite_calendItea_"+idDiv+"'>";if(annee_suiv!=0){html+="<a class='calendItea_navigDroite_lien' href='#dispoSuivant' onclick=calendrier_moisAutre(this.parentNode.nextSibling.firstChild,1)>";html+="<span id='lblDisponibilitesNavigDroite_calendItea_"+idDiv+"'></span>&nbsp;";html+="<span id='valDisponibilitesNavigDroite_calendItea_"+idDiv+"'>"+annee_suiv+"</span>";html+="</a>";}
html+="</div>";}
html+="<div class=calendItea_listMois>";html+="<ul id='ul_calendItea_"+idDiv+"' class='itea_ul calendItea_ul calendItea_ul_"+params.modeAff+"' moisDeb='"+mois+"' annee='"+annee+"' nbMois='"+nbMois+"' firstWeekDay='"+params.firstWeekDay+"' idDivGene='calendItea_"+idDiv+"' typeGite='"+typeGite+"' nb_chambre='"+nb_chambre+"' langue='"+langue+"' modeAff='"+params.modeAff+"' ident='"+ident+"' instance='"+instance+"' afficheDisposParAnnee='"+params.afficheDisposParAnnee+"' annee_min='"+annee_min+"' annee_max='"+annee_max+"' jrEnAvant='"+params.jrEnAvant+"' dateDebSej='"+params.dateDebSej+"' nbjSej='"+params.nbjSej+"' nonCliquable='"+params.nonCliquable+"' >";moisCurr=mois;anneeCurr=annee;for(var i=0;i<nbMois;i++){if(i%2==0)classeAlternee="calendItea_liPaire";else classeAlternee="calendItea_liImpaire";if(moisCurr<today.getMois()&&anneeCurr<=today.getAnnee())classeInit="moisNonInit";else classeInit="";html+="<li class='calendItea_li "+classeAlternee+" "+classeInit+"'>";params.moisCurr=moisCurr;params.anneeCurr=anneeCurr;params.nb_chambre=nb_chambre;if(params.modeAff=="LIGNE")
html+=calendrier_getXHTML_1moisLineaire(params,"calendItea_"+idDiv);else html+=calendrier_getXHTML_1mois(params,"calendItea_"+idDiv);html+="</li>";moisCurr++;if(moisCurr>12){moisCurr=1;anneeCurr++;}}
html+="</ul>";html+="</div>";if(!params.afficheDisposParAnnee){html+="<div class='calendItea_navig calendItea_navigDroite'>";html+="<a onclick=calendrier_moisAutre(this.parentNode.previousSibling.firstChild,1)>";html+=">";html+="</a>";html+="</div>";}
html+="</div>";if(params.ident&&params.afficheLegende==true){html+="<div class='calendItea_legende'>";html+="<ul class='itea_ul ul_legendeCalend'>";html+="<li class='calendItea_li_legende' id='li_legende_cliquable'>";html+="<span class='spanCalendVisuel spanCalendCliquable'>1</span><span class='spanCalendLibelle definition_legendeCalendCliquable' id='legendeCliquable_"+idDiv+"'></span>";html+="</li>";if(typeGite!="H"){html+="<li class='calendItea_li_legende' id='li_legende_libre'>";html+="<span class='spanCalendVisuel spanCalendJour_libre'>1</span><span class='spanCalendLibelle definition_legendeCalendLibre' id='legendeLibre_"+idDiv+"'></span>";html+="</li>";}
html+="<li class='calendItea_li_legende' id='li_legende_sejour'>";html+="<span class='spanCalendVisuel spanDateSejourSelect'>1</span><span class='spanCalendLibelle definition_legendeCalendSejourSelect' id='legendeSelect_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendItea_li_legende' id='li_legende_occupe'>";html+="<span class='spanCalendVisuel spanCalendJour_occupe'>1</span><span class='spanCalendLibelle definition_legendeCalendSejourOccupe' id='legendeOccupe_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendItea_li_legende' id='li_legende_contact'>";html+="<span class='spanCalendVisuel spanCalendJour_contact'>1</span><span class='spanCalendLibOu' id='legendeContactOu_"+idDiv+"'></span><span class='spanCalendVisuel spanCalendJour_inconnu'>1</span><span class='spanCalendLibelle definition_legendeCalendSejourContactProp' id='legendeContact_"+idDiv+"'></span>";html+="</li>";if(params.modeVenteGeGs=="?"){html+="<li class='calendItea_li_legende' id='li_legende_gegs_mode_vente'>";html+="<span class='spanCalendVisuel spanCalendJour_mode_vte_GEGS_H'>1</span><span class='spanCalendLibelle definition_legendeCalendSejourContactProp' id='legendeModeVenteGeGsChambre_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendItea_li_legende' id='li_legende_cliquable_gegs_mode_vente'>";html+="<span class='spanCalendVisuel spanCalendJour_mode_vte_GEGS_G'>1</span><span class='spanCalendLibelle definition_legendeCalendSejourContactProp' id='legendeModeVenteGeGsGite_"+idDiv+"'></span>";html+="</li>";}
html+="</ul>";html+="</div>";}
if(params.afficheDisposParAnnee=="true"){html+="<div class='calendItea_clicMois' id='legende_clicMois_calendItea_"+idDiv+"'></div>";}
html+="</div>";calendrier_setDispoEtJourArrivee(params,"calendItea_"+idDiv);return html;}
function setActionsSurMois(ident){for(var i=1;i<=12;i++){var idCurr="calendItea_libMois_"+i;if($(idCurr)){$(idCurr).onclick=function(evt){objCaracCal=this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;var paramsSais=new Array();paramsSais.moisCurr=this.parentNode.getAttribute("mois");paramsSais.anneeCurr=this.parentNode.getAttribute("annee");paramsSais.langue="FRANCAIS";afficheDivAvecTransparence(calendrier_getXHTML_1mois_saison(paramsSais.moisCurr,paramsSais.anneeCurr,paramsSais.langue,objCaracCal.id,0,ident),250,180,"sais");var url="/lib_2/ajax/contenuFenetre.php";var vars="element=elemObjProd&typeInfo=afficheTarifParSaison-"+ident+"-"+paramsSais.moisCurr+"-"+paramsSais.anneeCurr;affUrlInDiv("div_tarifSais",url,vars,"aucun",majIdSaisonForUnMois);}}}}
function majIdSaisonForUnMois(){var sais=$("chaine_sais_id").getAttribute("chaineSais");var idDivGene=$("div_tarifSais").getAttribute("idDivGene");var moisCurr=$("div_tarifSais").getAttribute("moisCurr");var anneeCurr=$("div_tarifSais").getAttribute("anneeCurr");calendrier_chargeMotCleDansCalendrierSais(idDivGene);calendrier_setClasseForCalSais(sais,idDivGene,moisCurr,anneeCurr);}
function calendrier_chargeMotCleDeLaLegende(idDiv){chargeMotCleDansDiv("legendeCliquable_"+idDiv,"LBL_LEGENDE_CALEND_ARRIVEE");chargeMotCleDansDiv("legendeLibre_"+idDiv,"LBL_LEGENDE_CALEND_LIBRE");chargeMotCleDansDiv("legendeSelect_"+idDiv,"LBL_LEGENDE_CALEND_SELECT");chargeMotCleDansDiv("legendeOccupe_"+idDiv,"LBL_LEGENDE_CALEND_OCCUPE");chargeMotCleDansDiv("legendeContact_"+idDiv,"LBL_LEGENDE_CALEND_CONTACTPROP");chargeMotCleDansDiv("legendeContactOu_"+idDiv,"LBL_LEGENDE_CALEND_OU");chargeMotCleDansDiv("legendeModeVenteGeGsGite_"+idDiv,"LBL_LEGENDE_MODE_VENTE_GITE");chargeMotCleDansDiv("legendeModeVenteGeGsChambre_"+idDiv,"LBL_LEGENDE_MODE_VENTE_CHAMBRE");}
function calendrier_chargeMotCleDansCalendrier(idDiv){chargeMotCleDansDiv("lblDisponibilitesNavigGauche_"+idDiv,"LBL_DISPONIBILITES");chargeMotCleDansDiv("lblDisponibilitesNavigDroite_"+idDiv,"LBL_DISPONIBILITES");chargeMotCleDansDiv("lblDisponibilitesAnneeCourante_"+idDiv,"LBL_DISPONIBILITES");chargeMotCleDansDiv("lblDisponibilitesRefInterne_"+idDiv,"LBL_NUM_HEBERGEMENT_PLANNING");chargeMotCleDansDiv("legende_clicMois_"+idDiv,"LBL_PLANNINGCLICSURMOIS");chargeMotCleDansDiv("div_planningBtFermer_"+idDiv,"LBL_PLANNINGFERMER");}
function calendrier_chargeMotCleDansCalendrierSais(idDiv){chargeMotCleDansDiv("div_planningBtFermerSais_"+idDiv,"LBL_PLANNINGFERMER");}
function calendrier_moisAutre(tableCal,increment){var obj=$(tableCal);var moisCurr=parseInt(obj.getAttribute("moisDeb"));var anneeCurr=parseInt(obj.getAttribute("annee"));var firstWeekDay=obj.getAttribute("firstWeekDay");var nbMois=parseInt(obj.getAttribute("nbMois"));var idDivGene=obj.getAttribute("idDivGene");var typeGite=obj.getAttribute("typeGite");var nb_chambre=obj.getAttribute("nb_chambre");var langue=obj.getAttribute("langue");var modeAff=obj.getAttribute("modeAff");var ident=obj.getAttribute("ident");var instance=obj.getAttribute("instance");var afficheDisposParAnnee=obj.getAttribute("afficheDisposParAnnee");var annee_min=obj.getAttribute("annee_min");var annee_max=obj.getAttribute("annee_max");var jrEnAvant=obj.getAttribute("jrEnAvant");var dateDebSej=obj.getAttribute("dateDebSej");var nbjSej=obj.getAttribute("nbjSej");var nonCliquable=obj.getAttribute('noncliquable');var classeAlternee;moisCurr+=(nbMois*increment);if(moisCurr>12){moisCurr=moisCurr-12;anneeCurr++;}
if(moisCurr<1){moisCurr=12+moisCurr;anneeCurr--;}
var today=new OBJDate();today.definition();if(afficheDisposParAnnee=="true"){nbMois=12;idDiv="valDisponibilitesAnneeCourante_"+idDivGene;div=$(idDiv);if(div)div.innerHTML=anneeCurr;var annee_prec=0;var annee_suiv=0;if(anneeCurr<annee_max&&anneeCurr>annee_min){annee_prec=anneeCurr-1;annee_suiv=anneeCurr+1;}
else if(anneeCurr==annee_min){if(annee_max!=annee_min)annee_suiv=parseInt(anneeCurr)+1;}
else if(anneeCurr==annee_max){if(annee_min!=annee_max)annee_prec=parseInt(anneeCurr)-1;}
var idDivNavigGauche="calendIteaNavigGauche_"+idDivGene;if($(idDivNavigGauche)){var objG=$(idDivNavigGauche);if(annee_prec!=0){var htmlNavigGauche="<a class='calendItea_navigGauche_lien' href='#dispoPrecedent' onclick='calendrier_moisAutre(this.parentNode.nextSibling.nextSibling.nextSibling.firstChild,-1)'>";htmlNavigGauche+="<span id='lblDisponibilitesNavigGauche_"+idDivGene+"'></span>&nbsp;";htmlNavigGauche+="<span id='valDisponibilitesNavigGauche_"+idDivGene+"'>"+annee_prec+"</span>";htmlNavigGauche+="</a>";objG.innerHTML=htmlNavigGauche;}
else objG.innerHTML="";}
var idDivNavigDroite="calendIteaNavigDroite_"+idDivGene;if($(idDivNavigDroite)){var objD=$(idDivNavigDroite);if(annee_suiv!=0){var htmlNavigDroite="<a class='calendItea_navigDroite_lien' href='#dispoSuivant' onclick=calendrier_moisAutre(this.parentNode.nextSibling.firstChild,1)>";htmlNavigDroite+="<span id='lblDisponibilitesNavigDroite_"+idDivGene+"'></span>&nbsp;";htmlNavigDroite+="<span id='valDisponibilitesNavigDroite_"+idDivGene+"'>"+annee_suiv+"</span>";htmlNavigDroite+="</a>";objD.innerHTML=htmlNavigDroite;}
else objD.innerHTML="";}}
var html="<ul id='ul_"+idDivGene+"' class='itea_ul calendItea_ul calendItea_ul_"+modeAff+"' moisDeb='"+moisCurr+"' annee='"+anneeCurr+"' nbMois='"+nbMois+"' firstWeekDay='"+firstWeekDay+"' idDivGene='"+idDivGene+"' typeGite='"+typeGite+"' nb_chambre='"+nb_chambre+"' langue='"+langue+"' modeAff='"+modeAff+"' ident='"+ident+"' instance='"+instance+"' afficheDisposParAnnee='"+afficheDisposParAnnee+"' annee_min='"+annee_min+"' annee_max='"+annee_max+"' jrEnAvant='"+jrEnAvant+"' dateDebSej='"+dateDebSej+"' nbjSej='"+nbjSej+"' nonCliquable='"+nonCliquable+"'>";var params={"firstWeekDay":firstWeekDay,"nbMois":nbMois,"nonCliquable":nonCliquable};for(var i=0;i<nbMois;i++){if(moisCurr>12){moisCurr=moisCurr-12;anneeCurr++;}
if(moisCurr<1){moisCurr=12+moisCurr;anneeCurr--;}
if(i%2==0)classeAlternee="calendItea_liPaire";else classeAlternee="calendItea_liImpaire";if(moisCurr<today.getMois()&&anneeCurr<=today.getAnnee())classeInit="moisNonInit";else classeInit="";html+="<li class='calendItea_li "+classeAlternee+" "+classeInit+"'>";params.moisCurr=moisCurr;params.anneeCurr=anneeCurr;params.langue=langue;params.nb_chambre=nb_chambre;params.typeGite=typeGite;params.afficheDisposParAnnee=afficheDisposParAnnee;params.jrEnAvant=jrEnAvant;params.dateDebSej=dateDebSej;params.nbjSej=nbjSej;if(modeAff=="LIGNE")html+=calendrier_getXHTML_1moisLineaire(params,idDivGene);else html+=calendrier_getXHTML_1mois(params,idDivGene);html+="</li>";moisCurr++;}
html+="</ul>";obj.parentNode.innerHTML=html;var selectChambre;if($("select_fiche_dispos_fngf_v4_chmbAnnee"))var id="select_fiche_dispos_fngf_v4_chmbAnnee";else var id="select_fiche_dispos_fngf_v4_chmb";var objId=$(id);if(objId)selectChambre=objId.value;if(selectChambre>0||selectChambre==0||typeGite=="H"||(!ident&&!instance)){if(nb_chambre>0)calendrier_setClasseForDisposForChambre(idDivGene,nb_chambre,modeAff);else calendrier_setClasseForJourArrTous(idDivGene);}else{if(ident)calendrier_setClasseForDispos(idDivGene);calendrier_setClasseForJourArr(idDivGene);}
if(afficheDisposParAnnee=="true"){effaceDivAvecTransparence('sais');calendrier_chargeMotCleDansCalendrier(idDivGene);ident=new String(ident);var tabInfos=ident.split(".");var typeProd=tabInfos[3];if(typeProd=="G"||typeProd=="H")setActionsSurMois(ident);}
$$(".calendItea_navigGauche a").each(function(e){if(increment=='1'){e.show();if($(e).up('div').up('div').down('.calendItea_listMois').select('.classeInit').length>27)
$(e).up('div').up('div').down('.calendItea_navigDroite').down('a').hide()}
else{$(e).up('div').up('div').down('.calendItea_navigDroite').down('a').show()
if(((e.getAttribute("data-anneMin")==anneeCurr))&&((e.getAttribute("data-moisMin")==(moisCurr-1)))){e.hide()}}})
if($(idDivGene).foncQdChangeMois)$(idDivGene).foncQdChangeMois(moisCurr,anneeCurr);}
function calendrier_moisAllerA(tableCal,moisDemande,anneeDemandee){var obj=$(tableCal);var moisCurr=parseInt(obj.getAttribute("moisDeb"));var anneeCurr=parseInt(obj.getAttribute("annee"));var firstWeekDay=obj.getAttribute("firstWeekDay");var nbMois=parseInt(obj.getAttribute("nbMois"));var idDivGene=obj.getAttribute("idDivGene");var typeGite=obj.getAttribute("typeGite");var nb_chambre=obj.getAttribute("nb_chambre");var langue=obj.getAttribute("langue");var modeAff=obj.getAttribute("modeAff");var ident=obj.getAttribute("ident");var instance=obj.getAttribute("instance");var classeAlternee;moisCurr=moisDemande;anneeCurr=anneeDemandee;var html="<ul id='ul_"+idDivGene+"' class='itea_ul calendItea_ul calendItea_ul_"+modeAff+"' moisDeb='"+moisCurr+"' annee='"+anneeCurr+"' nbMois='"+nbMois+"' firstWeekDay='"+firstWeekDay+"' idDivGene='"+idDivGene+"' typeGite='"+typeGite+"' nb_chambre='"+nb_chambre+"' langue='"+langue+"' modeAff='"+modeAff+"' ident='"+ident+"' instance='"+instance+"'>";var params={"firstWeekDay":firstWeekDay,"nbMois":nbMois};for(var i=0;i<nbMois;i++){if(moisCurr>12){moisCurr=moisCurr-12;anneeCurr++;}
if(moisCurr<1){moisCurr=12+moisCurr;anneeCurr--;}
if(i%2==0)classeAlternee="calendItea_liPaire";else classeAlternee="calendItea_liImpaire";html+="<li class='calendItea_li "+classeAlternee+"'>";params.moisCurr=moisCurr;params.anneeCurr=anneeCurr;params.langue=langue;params.nb_chambre=nb_chambre;params.typeGite=typeGite;if(modeAff=="LIGNE")html+=calendrier_getXHTML_1moisLineaire(params,idDivGene);else html+=calendrier_getXHTML_1mois(params,idDivGene);html+="</li>";moisCurr++;}
html+="</ul>";obj.parentNode.innerHTML=html;if(typeGite=="H"||(!ident&&!instance)){if(nb_chambre>0)calendrier_setClasseForDisposForChambre(idDivGene,nb_chambre,modeAff);else calendrier_setClasseForJourArrTous(idDivGene);}else{if(ident)calendrier_setClasseForDispos(idDivGene);calendrier_setClasseForJourArr(idDivGene);}}
function calendrier_getXHTML_1mois(params,idDivGene){var date=new OBJDate("15/"+params.moisCurr+"/"+params.anneeCurr);var html="";var tabLbl=date.getJSONLblJourWeek(params.langue,1);if(params.firstDayWeek)var idJour=params.firstDayWeek;var idJour=1;var mois=params.moisCurr;var annee=params.anneeCurr;var dateCurr;var jourSelect=0;var moisSelect=0;var anneeSelect=0;var dureeSelect=0;if($("mois"))moisSelect=$("mois").value;if($("annee"))anneeSelect=$("annee").value;if($("jour"))jourSelect=$("jour").value;if($("duree"))dureeSelect=$("duree").value;var dateSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);var dateFinSejourSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);dateFinSejourSelect.ajoutJour(dureeSelect);html+="<table class='calend' mois='"+mois+"' annee='"+annee+"' firstWeekDay='"+params.firstWeekDay+"' nbMois='"+params.nbMois+"'>";if(params.afficheDisposParAnnee=="true")html+="<caption id='calendItea_libMois_"+mois+"'>"+date.getLibelleMois(params.langue)+"</caption>";else html+="<caption>"+date.getLibelleMois(params.langue)+" "+annee+"</caption>";html+="<thead>";html+="<tr>";var j_curr=idJour;do{html+="<th class='calend_jour_"+j_curr+"'>";html+=tabLbl[j_curr].libelle_court.charAt(0);html+="</th>";j_curr=(j_curr+1)%7;}while(j_curr!=idJour);html+="</tr>";html+="</thead>";html+="<tbody>";var grille=calendrier_getTabGrille(params);for(var i=0;i<grille.length;i++){html+="<tr>";for(j=0;j<grille[i].length;j++){var jr=grille[i][j];html+="<td class='calend_jour_"+idJour+"'>";if(jr){jr=parseInt(jr);var j2=new String((jr<10)?"0"+jr:jr);var m2=new String((mois<10)?"0"+mois:mois);var a2=new String(annee);dateCurr=new OBJDate(j2+"/"+m2+"/"+a2);if(params.nonCliquable==1){html+="<span id='"+idDivGene+"_id_"+j2+m2+a2+"' etat='"+"' class='";}else{html+="<span id='"+idDivGene+"_id_"+j2+m2+a2+"' etat='"+"' class='classeInit";}
var dateduJour=new OBJDate();dateduJour.definition()
if(dateCurr.getJourSemaine()==params.jrEnAvant){if(dateduJour.estAvantOBJDate(dateCurr))html+=" spanDateSejourMiseEnAvant";}
if(params.dateDebSej){dateSelect=new OBJDate(params.dateDebSej);dateFinSejourSelect=new OBJDate(params.dateDebSej);}
if(params.nbjSej&&dateFinSejourSelect)dateFinSejourSelect.ajoutJour(params.nbjSej);if(dateFinSejourSelect.toString()==dateCurr.toString())html+=" spanDateFinSelect";if(dateSelect.toString("ddmmyyyy")==(j2+m2+a2))html+=" spanDateArriveeSelect";else{if(dateCurr.estComprisEntre(dateSelect,dateFinSejourSelect))html+=" spanDateSejourSelect";}
html+="'>";html+=jr;html+="</span>";idJour=(idJour+1)%7;}else html+="&nbsp;";html+="</td>";}
html+="</tr>";}
html+="</tbody>";html+="</table>";return html;}
function calendrier_getXHTML_1moisLineaire(params,idDivGene){var date=new OBJDate("15/"+params.moisCurr+"/"+params.anneeCurr);var html="";var mois=params.moisCurr;var annee=params.anneeCurr;var dateCurr;var jourSelect=0;var moisSelect=0;var anneeSelect=0;var dureeSelect=0;if($("mois"))moisSelect=$("mois").value;if($("annee"))anneeSelect=$("annee").value;if($("jour"))jourSelect=$("jour").value;if($("duree"))dureeSelect=$("duree").value;var dateSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);var dateFinSejourSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);dateFinSejourSelect.ajoutJour(dureeSelect);html+="<table class='calend' mois='"+mois+"' annee='"+annee+"' firstWeekDay='"+params.firstWeekDay+"' nbMois='"+params.nbMois+"'>";if(params.afficheDisposParAnnee=="true")html+="<caption>"+date.getLibelleMois(params.langue)+"</caption>";else html+="<caption>"+date.getLibelleMois(params.langue)+" "+annee+"</caption>";html+="<thead>";html+="<tr>";if(params.typeGite=="H")html+="<th class='calend_idLigne'></th>";var j_curr=1;do{html+="<th class='calend_jour_"+j_curr+"'>";html+=j_curr;html+="</th>";j_curr++;}while(j_curr<=date.getNbjMois());html+="</tr>";html+="</thead>";html+="<tbody>";var nb_chambre=params.nb_chambre;if(!nb_chambre)nb_chambre=1;for(var i=1;i<=nb_chambre;i++){html+="<tr>";if(params.typeGite=="H")html+="<th class='calend_idLigne'>Chambre n"+i+"</th>";for(j=1;j<=date.getNbjMois();j++){html+="<td class='calend_jour_"+j+"'>";jr=parseInt(j);var j2=(jr<10)?"0"+jr:jr;var m2=(mois<10)?"0"+mois:mois;var a2=annee;if(params.typeGite=="H")var idCurr=idDivGene+"_id_"+j2+m2+a2+"_"+i;else var idCurr=idDivGene+"_id_"+j2+m2+a2;html+="<span id='"+idCurr+"' etat='' class='classeInit";if(dateSelect.toString("ddmmyyyy")==(j2+m2+a2))html+=" spanDateArriveeSelect";else{dateCurr=new OBJDate(j2+"/"+m2+"/"+a2);if(dateCurr.estComprisEntre(dateSelect,dateFinSejourSelect))html+=" spanDateSejourSelect";}
html+="'> </span>";html+="</td>";}
html+="</tr>";}
html+="</tbody>";html+="</table>";return html;}
function calendrier_getXHTML_1mois_saison(moisCurr,anneeCurr,langueCurr,idDivGene,increment,ident){var date=new OBJDate("15/"+moisCurr+"/"+anneeCurr);var html="";var tabLbl=date.getJSONLblJourWeek(langueCurr);var idJour=1;var mois=moisCurr;var annee=anneeCurr;var dateCurr;var jourSelect=0;var moisSelect=0;var anneeSelect=0;var dureeSelect=0;if($("mois"))moisSelect=$("mois").value;if($("annee"))anneeSelect=$("annee").value;if($("jour"))jourSelect=$("jour").value;if($("duree"))dureeSelect=$("duree").value;var dateSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);var dateFinSejourSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);dateFinSejourSelect.ajoutJour(dureeSelect);html+="<div id='div_calend_sais_1'></div>";html+="<div id='div_calend_sais_2'></div>";html+="<div id='div_calendSais_content'>";html+="<div id='titre_tarif_calend_saison'><span id='sp_titre_tarif_calend_saison'>Dtail des tarifs</span></div>";html+="<div class='calendItea_navig calendItea_navigGauche' id='calendIteaNavigGauche_calendItea_"+idDivGene+"'>";html+="<a id='a_click_navig_gauche_saison' onClick=actionSurNavigCalendSaison('"+moisCurr+"','"+anneeCurr+"','"+langueCurr+"','"+idDivGene+"',-1,'"+ident+"');>";html+="<";html+="</a>";html+="</div>";html+="<div class='calendItea_navig calendItea_navigDroite' id='calendIteaNavigDroite_calendItea_"+idDivGene+"'>";html+="<a id='a_click_navig_droite_saison' onClick=actionSurNavigCalendSaison('"+moisCurr+"','"+anneeCurr+"','"+langueCurr+"','"+idDivGene+"',1,'"+ident+"');>";html+=">";html+="</a>";html+="</div>";html+="<div class='calendIteaBtFermer' id='div_planningBtFermerSais_"+idDivGene+"' onclick=effaceDivAvecTransparence('sais');></div>";html+="<table class='calend' mois='"+mois+"' annee='"+annee+"' firstWeekDay='' nbMois=''>";html+="<caption>"+date.getLibelleMois(langueCurr)+" "+annee+"</caption>";html+="<thead>";html+="<tr>";var j_curr=idJour;do{html+="<th class='calend_jour_"+j_curr+"'>";html+=tabLbl[j_curr].libelle_court[0];html+="</th>";j_curr=(j_curr+1)%7;}while(j_curr!=idJour);html+="</tr>";html+="</thead>";html+="<tbody>";var paramsSais=new Array();paramsSais.moisCurr=moisCurr;paramsSais.anneeCurr=anneeCurr;paramsSais.langue=langueCurr;var grille=calendrier_getTabGrille(paramsSais);for(var i=0;i<grille.length;i++){html+="<tr>";for(j=0;j<grille[i].length;j++){var jr=grille[i][j];html+="<td class='calend_jourSais_"+idJour+"'>";if(jr){jr=parseInt(jr);var j2=(jr<10)?"0"+jr:jr;var m2=(mois<10)?"0"+mois:mois;var a2=annee;html+="<span id='sais_"+idDivGene+"_id_"+j2+m2+a2+"' saison='"+"' class='classeInit";if(dateSelect.toString("ddmmyyyy")==(j2+m2+a2))html+=" spanDateArriveeSelect";else{dateCurr=new OBJDate(j2+"/"+m2+"/"+a2);if(dateCurr.estComprisEntre(dateSelect,dateFinSejourSelect))html+=" spanDateSejourSelect";}
html+="'>";html+=jr;html+="</span>";idJour=(idJour+1)%7;}else html+="&nbsp;";html+="</td>";}
html+="</tr>";}
html+="</tbody>";html+="</table>";html+="<div class='tarifSais' moisCurr='"+mois+"' anneeCurr='"+annee+"' idDivGene='"+idDivGene+"' id='div_tarifSais'></div>";html+="</div>";html+="<div id='div_calend_sais_3'></div>";html+="<div id='div_calend_sais_4'></div>";return html;}
function actionSurNavigCalendSaison(moisCurr,anneeCurr,langueCurr,idDivGene,increment,ident){var moisTmp=parseInt(moisCurr)+increment;if(moisTmp>12){moisCurr=1;anneeCurr++;}
else if(moisTmp<1){moisCurr=12;anneeCurr--;}
else moisCurr=moisTmp;$("divGraph_fenetresais").innerHTML=calendrier_getXHTML_1mois_saison(moisCurr,anneeCurr,langueCurr,idDivGene,increment,ident);var url="/lib_2/ajax/contenuFenetre.php";var vars="element=elemObjProd&typeInfo=afficheTarifParSaison-"+ident+"-"+moisCurr+"-"+anneeCurr;affUrlInDiv("div_tarifSais",url,vars,"aucun",majIdSaisonForUnMois);}
function calendrier_getTabGrille(params){if(params.firstWeekDay)var premJour=params.firstWeekDay;var premJour=1;var date=new OBJDate("01/"+params.moisCurr+"/"+params.anneeCurr);var numJrDebut=date.getJourSemaine();var nbVideDebut=numJrDebut-premJour;if(nbVideDebut<0)nbVideDebut+=7;var nbjMois=date.getNbjMois();var nb_ln=parseInt(nbjMois/7)+2;var tabGrilleMois=new Array();var jour=1;for(var i=0;i<nb_ln&&jour<=nbjMois;i++){if(!tabGrilleMois[i])tabGrilleMois[i]=new Array();for(j=0;j<7&&jour<=nbjMois;j++){if(j<nbVideDebut)tabGrilleMois[i][j]=null;else{tabGrilleMois[i][j]=jour;jour++;}}
nbVideDebut=-1;}
return tabGrilleMois;}
function calendrier_setDispoEtJourArrivee(params,idDivGene){var url="/lib_2/ajax/infosDist.php";if(params.ident){if(params.typeGite=="H"){var sending="info=DISPOS&ident="+params.ident;if(params.apresToday)sending+="&apresToday="+params.apresToday;else sending+="&apresToday=true";var vars;var nb_planningRecupere=0;var nb_chambre=params.tabChambre.length;for(var i=0;i<nb_chambre;i++){vars=sending+"&numero_chambre="+params.tabChambre[i].numero_chambre;appelAjaxToFunc(url,vars,function(reponseAjax){calendrier_recupDisposForChambre(reponseAjax,idDivGene);nb_planningRecupere++;if(nb_chambre==nb_planningRecupere){if(params.afficheDisposParAnnee||params.afficheNavChamvre)
setActionsSurListeChambres(params.tabChambre,params.ident,params.linkToResa,nbMois,params.modeVenteGeGs,idDivGene);calendrier_setClasseForDisposForChambre(idDivGene,nb_chambre,params.modeAff);}});}}else{var sending="info=DISPOS&ident="+params.ident;if(params.apresToday)sending+="&apresToday="+params.apresToday;else sending+="&apresToday=true";appelAjaxToFunc(url,sending,function(reponseAjax){calendrier_recupDispos(reponseAjax,idDivGene);calendrier_setClasseForDispos(idDivGene);calendrier_recupByAjaxEtAffJourArrivee(params,idDivGene);});if(params.modeVenteGeGs=="?"){var vars;var nb_planningRecupere=0;var nb_chambre=params.tabChambre.length;for(var i=0;i<nb_chambre;i++){vars=sending+"&numero_chambre="+params.tabChambre[i].numero_chambre;appelAjaxToFunc(url,vars,function(reponseAjax){calendrier_recupDisposForChambre(reponseAjax,idDivGene);nb_planningRecupere++;if(nb_chambre==nb_planningRecupere){if(params.afficheDisposParAnnee)
setActionsSurListeChambres(params.tabChambre,params.ident,params.linkToResa,nbMois,params.modeVenteGeGs,idDivGene);}});}}}}else if(params.typeGite!="H"){calendrier_recupByAjaxEtAffJourArrivee(params,idDivGene);}}
function calendrier_recupByAjaxEtAffJourArrivee(params,idDivGene){var url="/lib_2/ajax/infosDist.php";var sending="info=JOURARR";if(params.ident)sending+="&ident="+params.ident;if(params.instance)sending+="&instance="+params.instance;if(params.id_famille)sending+="&id_famille="+params.id_famille;if(params.duree)sending+="&nbj="+params.duree;if(params.apresToday)sending+="&apresToday="+params.apresToday;else sending+="&apresToday=false";if(params.instance||params.ident){appelAjaxToFunc(url,sending,function(reponseAjax){calendrier_recupJourArr(reponseAjax,idDivGene);calendrier_setClasseForJourArr(idDivGene);});}}
function calendrier_recupDispos(tabDispo,idDivGene){eval("var infosDispo="+tabDispo);var dte=new String(infosDispo.date_deb);var dispos=new String(infosDispo.chaineDispo);var apresToday=infosDispo.apresToday;if($(idDivGene)){$(idDivGene).setAttribute("dispos",dispos);$(idDivGene).setAttribute("dteDispos",dte);$(idDivGene).setAttribute("apresToday",apresToday);}}
function calendrier_recupDisposForChambre(tabDispo,idDivGene){eval("var infosDispo="+tabDispo);var dte=new String(infosDispo.date_deb);var dispos=new String(infosDispo.chaineDispo);var apresToday=infosDispo.apresToday;var numero_chambre=infosDispo.numero_chambre;if($(idDivGene)){$(idDivGene).setAttribute("dispos_"+numero_chambre,dispos);$(idDivGene).setAttribute("dteDispos",dte);$(idDivGene).setAttribute("apresToday",apresToday);}}
function calendrier_setClasseForDispos(idDivGene){effaceMsgAttenteParDessus();var cliquable;var idCurr;var dispo;if($(idDivGene)){var dispos=$(idDivGene).getAttribute("dispos");var dte=new OBJDate($(idDivGene).getAttribute("dteDispos"));var apresToday=$(idDivGene).getAttribute("apresToday");}
var today=new OBJDate();today.definition();if(dispos){for(var i=0;i<dispos.length;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");if($(idCurr)){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){dispo=dispos.charAt(i);if($(idCurr).hasClassName("classeInit")&&dispo==".")cliquable=true;else{cliquable=false;if(dispo!="."&&$(idCurr).hasClassName("spanCalendCliquable")){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}
if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");$(idCurr).setAttribute("etat",dispo);if(dispo=="X")$(idCurr).addClassName("spanCalendJour_mode_vte_GEGS_H");else $(idCurr).addClassName(calendrier_getClassForJour(dispo,false,cliquable));if(dispo=="n")$(idCurr).addClassName("spanCalendJour_ferme");if($(idCurr).hasClassName("classeMobile")&&cliquable){cliquable=false;$(idCurr).removeClassName("classeMobile");}
if(cliquable)$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this);}}}
dte.ajoutJour(1);}}}
function calendrier_setClasseForCalSais(calsais,idDivGene,moisCurr,anneeCurr){effaceMsgAttenteParDessus();var idCurr;var idDivDispo;var calsais;var dteCurr="01/"+moisCurr+"/"+anneeCurr;var dte=new OBJDate(dteCurr);var classeSaison;var periodeIndispo;if(calsais){for(var i=0;i<=calsais.length;i++){idCurr="sais_"+idDivGene+"_id_"+dte.toString("ddmmyyyy");if($(idCurr)){sais=calsais.charAt(i);$(idCurr).setAttribute("saison",sais);classeSaison="jour_saison_"+sais;idDivDispo=idDivGene+"_id_"+dte.toString("ddmmyyyy");if($(idDivDispo)){if(($(idDivDispo).getAttribute("etat")=="n"||$(idDivDispo).getAttribute("etat")=="r")&&!$(idDivDispo).hasClassName("spanCalendJour_libre")){classeSaison="jour_saison_n";periodeIndispo=true;}}
$(idCurr).addClassName(classeSaison);}
dte.ajoutJour(1);}}
if($("div_legende_indispo_saison_unMois")){if(!(periodeIndispo))$("div_legende_indispo_saison_unMois").style.display="none";}}
function calendrier_setClasseForDisposForChambre(idDivGene,nb_chambre,modeAff){effaceMsgAttenteParDessus();var objGraph=$("divGraph_fenetre");if(objGraph)var styleDivGraph=objGraph.style.display;else var styleDivGraph=null;if($("select_fiche_dispos_fngf_v4_chmbAnnee")&&styleDivGraph!="none")var id="select_fiche_dispos_fngf_v4_chmbAnnee";else var id="select_fiche_dispos_fngf_v4_chmb";var objId=$(id);if(objId&&objId.value>0){calendrier_setClasseForDisposForChoixChambre(idDivGene,objId.value);}
else{var cliquable;var idCurr;var dispo;var numero_chambre;for(var c=1;c<=nb_chambre;c++){numero_chambre=c;if($(idDivGene)){var dispos=$(idDivGene).getAttribute("dispos_"+numero_chambre);var dte=new OBJDate($(idDivGene).getAttribute("dteDispos"));var apresToday=$(idDivGene).getAttribute("apresToday");}
var today=new OBJDate();today.definition();if(dispos){for(var i=0;i<dispos.length;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");if(modeAff=="LIGNE")idCurr+="_"+numero_chambre;cliquable=false;if($(idCurr)){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){dispo=dispos.charAt(i);if(dispo==".")cliquable=true;if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");var planningMobile=false;if($(idCurr).hasClassName("classeMobile")&&cliquable){var planningMobile=true;}
$(idCurr).setAttribute("etat",dispo);if(cliquable||dispo=="X"){setClassForObj($(idCurr),"");}
if(!$(idCurr).hasClassName("spanCalendCliquable")){if(dispo=="X")$(idCurr).addClassName("spanCalendJour_mode_vte_GEGS_G");else $(idCurr).addClassName(calendrier_getClassForJour(dispo,false,cliquable));if(dispo=="r")$(idCurr).addClassName("spanCalendJour_ferme");}
if(planningMobile){$(idCurr).addClassName("smart_jourCalendrier");$(idCurr).addClassName("classeMobile");cliquable=false;}
if(cliquable){$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this,modeAff);}}}}
dte.ajoutJour(1);}}}}}
function calendrier_setClasseForDisposForChoixChambre(idDivGene,numero_chambre){effaceMsgAttenteParDessus();var cliquable;var idCurr;var dispo;if($(idDivGene)){var dispos=$(idDivGene).getAttribute("dispos_"+numero_chambre);var dte=new OBJDate($(idDivGene).getAttribute("dteDispos"));var apresToday=$(idDivGene).getAttribute("apresToday");}
var today=new OBJDate();today.definition();if(dispos){for(var i=0;i<dispos.length;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");cliquable=false;if($(idCurr)){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){dispo=dispos.charAt(i);if(dispo==".")cliquable=true;$(idCurr).setAttribute("class","classeInit");if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");$(idCurr).setAttribute("etat",dispo);if(dispo=="X")$(idCurr).addClassName("spanCalendJour_mode_vte_GEGS_G");else $(idCurr).addClassName(calendrier_getClassForJour(dispo,false,cliquable));if(cliquable){setClassForObj($(idCurr),"");}
if(!$(idCurr).hasClassName("spanCalendCliquable")){if(dispo=="X")$(idCurr).addClassName("spanCalendJour_mode_vte_GEGS_G");else $(idCurr).addClassName(calendrier_getClassForJour(dispo,false,cliquable));}
if(cliquable){$(idCurr).onclick=function(evt){var modeAff="CARRE";calendrier_clicDate(evt,this,modeAff);}}}}
dte.ajoutJour(1);}}}
function calendrier_recupJourArr(tabJourArr,idDivGene){effaceMsgAttenteParDessus();eval("var infosJrArr="+tabJourArr);var dte=new String(infosJrArr.date_deb);var jourArr=new String(infosJrArr.chaineJourArr);var nbjMini=parseInt(infosJrArr.nbjMini,10);var apresToday=infosJrArr.apresToday;if(infosJrArr.duree){var duree=parseInt(infosJrArr.duree,10);var chaineWE=new String(infosJrArr.chaineWE);var nbjminWE=new String(infosJrArr.nbjminWE);var nbjmaxWE=new String(infosJrArr.nbjmaxWE);}
if($(idDivGene)){$(idDivGene).setAttribute("jourArr",jourArr);$(idDivGene).setAttribute("dteJrArr",dte);$(idDivGene).setAttribute("nbjMini",nbjMini);$(idDivGene).setAttribute("apresToday",apresToday);$(idDivGene).setAttribute("duree",duree);$(idDivGene).setAttribute("chaineWE",chaineWE);$(idDivGene).setAttribute("nbjminWE",nbjminWE);$(idDivGene).setAttribute("nbjmaxWE",nbjmaxWE);}}
function calendrier_setClasseForJourArr(idDivGene){var jourArr=$(idDivGene).getAttribute("jourArr");var dte=new OBJDate($(idDivGene).getAttribute("dteJrArr"));var nbjMini=$(idDivGene).getAttribute("nbjMini");var duree=$(idDivGene).getAttribute("duree");var apresToday=$(idDivGene).getAttribute("apresToday");var ident=$(idDivGene).getAttribute("ident");if(duree){var chaineWE=$(idDivGene).getAttribute("chaineWE");var nbjminWE=$(idDivGene).getAttribute("nbjminWE");var nbjmaxWE=$(idDivGene).getAttribute("nbjmaxWE");}else duree=7;var idCurr;var idJour;var jr_arr;var we_nbjMin;var we_nbjMax;var jr_WE;var today=new OBJDate();today.definition();if(nbjMini)today.ajoutJour(nbjMini);if(duree<7&&chaineWE){var dateMiniWE=new OBJDate();dateMiniWE.definition();if(nbjminWE)we_nbjMin=nbjminWE;else we_nbjMin=0;dateMiniWE.ajoutJour(we_nbjMin);var dateMaxiWE=new OBJDate();dateMaxiWE.definition();if(nbjmaxWE>0)we_nbjMax=nbjmaxWE;else we_nbjMax=999;dateMaxiWE.ajoutJour(we_nbjMax);}
if(jourArr)
for(var i=0;i<jourArr.length;i++){idJour=dte.getJourSemaine();idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");if($(idCurr)){var etat_curr=$(idCurr).getAttribute("etat");jr_arr=jourArr.charAt(i);if(duree<7&&chaineWE){jr_WE=chaineWE.charAt(i);if(dte.estComprisEntre(dateMiniWE.toString(),dateMaxiWE.toString())){duree=parseInt(duree,10);switch(duree){case 0:if((!ident||(ident&&etat_curr))&&$(idCurr).hasClassName("classeInit")&&(idJour=="1"||idJour=="5"||jr_arr==idJour||jr_arr=="7")&&(jr_WE=="O"||jr_WE=="W"||jr_WE=="M"||jr_WE=="T"||jr_WE=="N")){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).onmousedown=function(evt){calendrier_clicDate(evt,this);}}else{if($(idCurr).hasClassName("spanCalendCliquable")&&jr_arr!=idJour&&jr_arr!="7"){switch(idJour){case 1:if(jr_WE!="O"&&jr_WE!="M"&&jr_WE!="T"&&jr_WE!="X"){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onmousedown=null;}
break;case 5:if(jr_WE!="O"&&jr_WE!="M"&&jr_WE!="W"&&jr_WE!="T"&&jr_WE!="X"){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onmousedown=null;}
break;case 0:if(jr_WE!="O"&&jr_WE!="W"&&jr_WE!="T"&&jr_WE!="X"){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onmousedown=null;}else{$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onmousedown=null;}
break;default:$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onmousedown=null;break;}}}
break;case 2:if((!ident||(ident&&etat_curr))&&$(idCurr).hasClassName("classeInit")&&(idJour=="5"||jr_arr==idJour||jr_arr=="7")&&(jr_WE=="O"||jr_WE=="W"||jr_WE=="T")){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this);}}else{if($(idCurr).hasClassName("spanCalendCliquable")&&((idJour!="5"&&jr_arr!=idJour&&jr_arr!="7")||(jr_WE!="O"&&jr_WE!="W"&&jr_WE!="T"))){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}
break;case 4:if((!ident||(ident&&etat_curr))&&$(idCurr).hasClassName("classeInit")&&(idJour=="1"||jr_arr==idJour||jr_arr=="7")&&(jr_WE=="O"||jr_WE=="M"||jr_WE=="T")){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this);}}else{if($(idCurr).hasClassName("spanCalendCliquable")&&((idJour!="1"&&jr_arr!=idJour&&jr_arr!="7")||(jr_WE!="O"&&jr_WE!="M"&&jr_WE!="T"))){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}
break;default:if($(idCurr).hasClassName("spanCalendCliquable")&&(jr_arr==idJour||jr_arr=="7")&&jr_WE=="T"){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this);}}else{if($(idCurr).hasClassName("spanCalendCliquable")&&((jr_arr!=idJour&&jr_arr!="7")||jr_WE!="T")){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}
break;}}
else if($(idCurr).hasClassName("spanCalendCliquable")&&jr_arr!=idJour&&jr_arr!="7"){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}else{if((!ident||(ident&&etat_curr))&&$(idCurr).hasClassName("classeInit")&&(jr_arr==idJour||jr_arr=="7")){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).onclick=function(evt){calendrier_clicDate(evt,this);}}}else{if((jr_arr!=idJour&&jr_arr!="7")&&$(idCurr).hasClassName("spanCalendCliquable")){$(idCurr).removeClassName("spanCalendCliquable");$(idCurr).onclick=null;}}}
if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");}
dte.ajoutJour(1);}}
function calendrier_setClasseForJourArrTous(idDivGene){var dte=new OBJDate();dte.definition();var idCurr;var today=new OBJDate();today.definition();var paramsJoursArrivee=window.paramsJoursArriveeGeneral||false;var indice=0;if(paramsJoursArrivee){var chaineJoursArrivee=paramsJoursArrivee.chaineJoursArrivee;var dateDebChaineJoursArrivee=new OBJDate(paramsJoursArrivee.dateDebChaineJoursArrivee);indice=dateDebChaineJoursArrivee.getNbJourEcartWithOBJDate(dte);}
for(var i=0;i<731;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");(function($){if($('#'+idCurr)){if($('#'+idCurr).hasClass("classeInit")&&dte.estApresOBJDate(today)){if((!navigator.userAgent.match(/MSIE 7/)&&!navigator.userAgent.match(/MSIE 6/))&&paramsJoursArrivee&&chaineJoursArrivee[indice]!='1'){$('#'+idCurr).removeClass("classeInit");}
else{$('#'+idCurr).addClass("spanCalendCliquable");$('#'+idCurr).removeClass("classeInit");$('#'+idCurr).click(function(evt){calendrier_clicDate(evt,this);});}}}})(jQuery)
indice++;dte.ajoutJour(1);}}
function calendrier_setClasseForJourArrTousGP(idDivGene){var dte=new OBJDate();dte.definition();var idCurr;var today=new OBJDate();today.definition();for(var i=0;i<731;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");if($(idCurr)){if($(idCurr).hasClassName("classeInit")&&dte.estApresOBJDate(today)){$(idCurr).addClassName("spanCalendCliquable");$(idCurr).removeClassName("classeInit");$(idCurr).onclick=function(evt){calendrier_clicDateGP(evt,this,false);}}}
dte.ajoutJour(1);}}
function calendrier_getClassForJour(etat,differencieEtats,cliquable){var tabClass;var classEtat;if(differencieEtats)tabClass=calendrier_getTabClassEtatsDifferencies();else tabClass=calendrier_getTabClassEtat();var classe="spanCalendJour_"+tabClass.getEtatLong(etat);if(cliquable&&etat==".")classe+=" spanCalendCliquable";return classe;}
function calendrier_getClassForJourForParamSais(etat,differencieEtats,cliquable){var tabClass;var classEtat;if(differencieEtats)tabClass=calendrier_getTabClassEtatsDifferencies();else tabClass=calendrier_getTabClassEtat();var classe="spanCalendJour_"+tabClass.getEtatLong(etat);if(cliquable&&etat==".")classe+=" spanCalendCliquable";return classe;}
function calendrier_getTabClassEtatsDifferencies(){var tabEtat={"getEtatLong":function(etat){switch(etat){case"i":return"intention";case"o":return"option";case"O":return"option";case"O":return"preoption";case"r":return"resa";case"R":return"resa";case"R":return"preresa";case"I":return"preintention";case"n":return"ferme";case"N":return"nonautorise";case"a":return"allotement";case"L":return"limite";case".":return"libre";case"?":return"inconnu";case"G":return"modeVenteGEGS_G";case"H":return"modeVenteGEGS_H";case"X":return"bloque";}}};return tabEtat;}
function calendrier_getTabClassEtat(){var tabEtat={"getEtatLong":function(etat){switch(etat){case"i":return"contact";case"o":return"option";case"r":return"occupe";case"I":return"contact";case"O":return"option";case"R":return"occupe";case"n":return"occupe";case"N":return"occupe";case"a":return"contact";case"L":return"contact";case".":return"libre";case"?":return"inconnu";case"X":return"mode_vte_GEGS";}}};return tabEtat;}
function calendrier_clicDate(evt,obj,modeAff){if(!modeAff)modeAff="CARRE";var tabClass=calendrier_getTabClassEtatsDifferencies();var etat=tabClass.getEtatLong(obj.getAttribute("etat"));var tabId=obj.id.split("_");if(modeAff=="LIGNE")var chaine=new String(tabId[tabId.length-2]);else var chaine=new String(tabId[tabId.length-1]);var jour=chaine.substr(0,2);var mois=chaine.substr(2,2);var annee=chaine.substr(4,4);var objetDate=new OBJDate(chaine);var jrSemaine=objetDate.getJourSemaine();var linkToResa=obj.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute('linkToResa');if(obj.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.foncQdClicGauche){obj.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.foncQdClicGauche(evt,jour,mois,annee,etat,jrSemaine);}else if(linkToResa){var parts=linkToResa.split("?");var adr=parts[0];var sending=parts[1];var reg1=new RegExp("(resaGl/sejour.php)","g");if(adr.match(reg1)){if(jour)sending+="&jour="+jour;if(mois)sending+="&mois="+mois;if(annee)sending+="&annee="+annee;}
var reg2=new RegExp("(reservation-externe.php)","g");if(adr.match(reg2)){sending+="&reinit=O";if(jour)sending+="&jour="+jour;if(mois)sending+="&mois="+mois;if(annee)sending+="&annee="+annee;}
calendrier_redirectFrmToResa(adr,sending);}}
function setCalendrierToDivGP(idDiv,params){if(!params.langue)params.langue="FRANCAIS";div=$(idDiv);if(div){div.innerHTML=calendrier_getXHTMLForGP(params,idDiv);if(!params.nePasChargerMotCles)calendrier_chargeMotCleDeLaLegendeGP(idDiv);affMsgAttenteParDessusInDiv(idDiv);div.firstChild.foncQdClicGauche=params.clic;}}
function calendrier_getXHTMLForGP(params,idDiv){var html="";if(params.nbMois)nbMois=params.nbMois;else nbMois=1;var today=new OBJDate();today.definition();if(!params.moisDebut)params.moisDebut=today.getMois();if(!params.anneeDebut)params.anneeDebut=today.getAnnee();var mois=params.moisDebut;var annee=params.anneeDebut;var langue=params.langue;if(!langue)langue="FRANCAIS";var classeAlternee;if(params.code)var code=params.code;else var code="";var request=params.request;if(!params.request)request="N";var nb_stock=params.tabStock.length;html="<div class='calendItea calendIteaGP' id='calendItea_"+idDiv+"'>";html+="<div class='calendItea_navig calendItea_navigGauche'>";html+="<a onclick=calendrier_moisAutreGP(this.parentNode.nextSibling.firstChild,-1)><</a>";html+="</div>";html+="<div class=calendIteaGP_listMois>";html+="<ul class='itea_ul calendIteaGP_ul calendItea_ul' moisDeb='"+mois+"' annee='"+annee+"' nbMois='"+nbMois+"' firstWeekDay='"+params.firstWeekDay+"' idDivGene='calendItea_"+idDiv+"' nb_stock='"+nb_stock+"' langue='"+langue+"' code='"+code+"' instance='"+params.instance+"'  request='"+request+"' tabStock='"+params.tabStock.toJSON()+"'>";moisCurr=mois;anneeCurr=annee;for(var i=0;i<nbMois;i++){if(i%2==0)classeAlternee="calendIteaGP_liPaire";else classeAlternee="calendIteaGP_liImpaire";html+="<li class='calendIteaGP_li "+classeAlternee+"'>";params.moisCurr=moisCurr;params.anneeCurr=anneeCurr;params.nb_stock=nb_stock;html+=calendrier_getXHTML_1moisLineaireGP(params,"calendItea_"+idDiv);html+="</li>";moisCurr++;if(moisCurr>12){moisCurr=1;anneeCurr++;}}
html+="</ul>";html+="</div>";html+="<div class='calendIteaGP_navig calendItea_navigDroite'>";html+="<a onclick=calendrier_moisAutreGP(this.parentNode.previousSibling.firstChild,1)>></a>";html+="</div>";if(params.code){html+="<div class='calendIteaGP_legende'>";html+="<ul class='itea_ul ul_legendeCalendGP'>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanCalendCliquableResaGP'>&nbsp;</span><span class='definition_legendeCalendCliquableResaGP' id='legendeCliquableResa_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanCalendJourGP_libre'>&nbsp;</span><span class='definition_legendeCalendLibreGP' id='legendeLibre_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanDateSejourOccupeGP'>&nbsp;</span><span class='definition_legendeCalendSejourOccupeGP' id='legendeOccupe_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanCalendCliquableDevisGP'>&nbsp;</span><span class='definition_legendeCalendCliquableDevisGP' id='legendeCliquableDevis_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanDateSejourDevisGP'>&nbsp;</span><span class='definition_legendeCalendSejourDevisGP' id='legendeDevis_"+idDiv+"'></span>";html+="</li>";html+="<li class='calendIteaGP_li_legende'>";html+="<span class='spanDateSejourSelectGP'>&nbsp;</span><span class='definition_legendeCalendSejourSelectGP' id='legendeSelect_"+idDiv+"'></span>";html+="</li>";html+="</ul>";html+="</div>";}
html+="</div>";calendrier_setDispoEtJourArriveeGP(params,"calendItea_"+idDiv);return html;}
function calendrier_chargeMotCleDeLaLegendeGP(idDiv){chargeMotCleDsDiv("legendeCliquableResa_"+idDiv,"LBL_LEGENDE_CALEND_ARRIVEE_RESA");chargeMotCleDsDiv("legendeLibre_"+idDiv,"LBL_LEGENDE_CALEND_LIBRE");chargeMotCleDsDiv("legendeOccupe_"+idDiv,"LBL_LEGENDE_CALEND_OCCUPE");chargeMotCleDsDiv("legendeCliquableDevis_"+idDiv,"LBL_LEGENDE_CALEND_ARRIVEE_DEVIS");chargeMotCleDsDiv("legendeDevis_"+idDiv,"LBL_LEGENDE_CALEND_DEVIS");chargeMotCleDsDiv("legendeSelect_"+idDiv,"LBL_LEGENDE_CALEND_SELECT");}
function calendrier_setPeriodeInClass(idDiv,classname,jdeb,mdeb,adeb,jfin,mfin,afin){var dteDeb=new OBJDate();dteDeb.definition();dteDeb.setDateByInfos(jdeb,mdeb,adeb);var dteFin=new OBJDate();dteFin.definition();dteFin.setDateByInfos(jfin,mfin,afin);$$("."+classname).each(function(obj){obj.removeClassName(classname)});var idCurr;for(var i=0;i<731;i++){idCurr="calendItea_"+idDiv+"_id_"+dteDeb.toString("ddmmyyyy");if($(idCurr)){if(dteFin.estApresOBJDate(dteDeb)){$(idCurr).addClassName(classname);}}
dteDeb.ajoutJour(1);}}
function calendrier_getXHTML_1moisLineaireGP(params,idDivGene){var date=new OBJDate("15/"+params.moisCurr+"/"+params.anneeCurr);var html="";var mois=params.moisCurr;var annee=params.anneeCurr;var dateCurr;var jourSelect=0;var moisSelect=0;var anneeSelect=0;var dureeSelect=0;if($("mois"))moisSelect=$("mois").value;if($("annee"))anneeSelect=$("annee").value;if($("jour"))jourSelect=$("jour").value;if($("duree"))dureeSelect=$("duree").value;var dateSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);var dateFinSejourSelect=new OBJDate(jourSelect+"/"+moisSelect+"/"+anneeSelect);dateFinSejourSelect.ajoutJour(dureeSelect);html+="<table class='calendGP' mois='"+mois+"' annee='"+annee+"' firstWeekDay='"+params.firstWeekDay+"' nbMois='"+params.nbMois+"'>";html+="<caption>"+date.getLibelleMois(params.langue)+" "+annee+"</caption>";html+="<thead>";html+="<tr>";html+="<th class='calend_idLigne'></th>";var j_curr=1;var tabJour=date.getJSONLblJourWeek(params.langue);do{var j1=(j_curr<10)?"0"+j_curr:j_curr;var m1=(mois<10)?"0"+mois:mois;var a1=annee;dateCurr=new OBJDate(j1+"/"+m1+"/"+a1);lblJour=tabJour[dateCurr.getJourSemaine()].libelle_court;html+="<th class='calend_jour_"+j_curr+"'>";html+="<span class='calend_jour_lbl'>"+lblJour+"</span>";html+="<span class='calend_jour_numero'>"+j_curr+"</span>";html+="</th>";j_curr++;}while(j_curr<=date.getNbjMois());html+="</tr>";html+="</thead>";html+="<tbody>";var nb_stock=params.nb_stock;for(var i=0;i<nb_stock;i++){html+="<tr>";html+="<th class='calendGP_idLigne'>"+params.tabStock[i].lbl+"</th>";for(j=1;j<=date.getNbjMois();j++){html+="<td class='calendGP_jour_"+j+"'>";jr=parseInt(j);var j2=(jr<10)?"0"+jr:jr;var m2=(mois<10)?"0"+mois:mois;var a2=annee;var code_stock=new String(params.tabStock[i].code);var idCurr=idDivGene+"_id_"+j2+m2+a2+"_"+code_stock.replace("/","_slash_");html+="<span id='"+idCurr+"' etat='' class='classeInit";if(dateSelect.toString("ddmmyyyy")==(j2+m2+a2))html+=" spanDateArriveeSelect";else{dateCurr=new OBJDate(j2+"/"+m2+"/"+a2);if(dateCurr.estComprisEntre(dateSelect,dateFinSejourSelect))html+=" spanDateSejourSelect";}
html+="'> </span>";html+="</td>";}
html+="</tr>";}
html+="</tbody>";html+="</table>";return html;}
function calendrier_moisAutreGP(tableCal,increment){var obj=$(tableCal);var moisCurr=parseInt(obj.getAttribute("moisDeb"));var anneeCurr=parseInt(obj.getAttribute("annee"));var firstWeekDay=obj.getAttribute("firstWeekDay");var nbMois=parseInt(obj.getAttribute("nbMois"));var idDivGene=obj.getAttribute("idDivGene");var nb_stock=obj.getAttribute("nb_stock");var langue=obj.getAttribute("langue");var instance=obj.getAttribute("instance");var code=obj.getAttribute("code");var request=obj.getAttribute("request");eval("var tabStock="+obj.getAttribute("tabStock"));var classeAlternee;moisCurr+=(nbMois*increment);if(moisCurr>12){moisCurr=moisCurr-12;anneeCurr++;}
if(moisCurr<1){moisCurr=12+moisCurr;anneeCurr--;}
var html="<ul class='itea_ul calendIteaGP_ul calendItea_ul' moisDeb='"+moisCurr+"' annee='"+anneeCurr+"' nbMois='"+nbMois+"' firstWeekDay='"+firstWeekDay+"' idDivGene='"+idDivGene+"' nb_stock='"+nb_stock+"' langue='"+langue+"' code='"+code+"' instance='"+instance+"' request='"+request+"' tabStock='"+tabStock.toJSON()+"'>";var params={"firstWeekDay":firstWeekDay,"nbMois":nbMois};for(var i=0;i<nbMois;i++){if(moisCurr>12){moisCurr=moisCurr-12;anneeCurr++;}
if(moisCurr<1){moisCurr=12+moisCurr;anneeCurr--;}
if(i%2==0)classeAlternee="calendIteaGP_liPaire";else classeAlternee="calendIteaGP_liImpaire";html+="<li class='calendIteaGP_li "+classeAlternee+"'>";params.moisCurr=moisCurr;params.anneeCurr=anneeCurr;params.langue=langue;params.nb_stock=nb_stock;params.instance=instance;params.tabStock=tabStock;params.code=code;params.request=request;html+=calendrier_getXHTML_1moisLineaireGP(params,idDivGene);html+="</li>";moisCurr++;}
html+="</ul>";obj.parentNode.innerHTML=html;calendrier_setClasseForDisposForProd(idDivGene,nb_stock,tabStock,request);calendrier_setClasseForJourArrGP(idDivGene,nb_stock,tabStock,request);}
function calendrier_setDispoEtJourArriveeGP(params,idDivGene){var url="/lib_2/ajax/infosDist.php";if(params.code){var sending="info=DISPOS_GP&code="+params.code+"&instance="+params.instance;if(params.apresToday)sending+="&apresToday="+params.apresToday;else sending+="&apresToday=true";var vars;var nb_planningRecupere=0;var nb_stock=params.tabStock.length;for(var i=0;i<nb_stock;i++){vars=sending+"&code_stock="+params.tabStock[i].code;appelAjaxToFunc(url,vars,function(reponseAjax){calendrier_recupDisposForProd(reponseAjax,idDivGene);nb_planningRecupere++;if(nb_stock==nb_planningRecupere)calendrier_setClasseForDisposForProd(idDivGene,nb_stock,params.tabStock,params.request);});}}
if(params.code){var sending="info=JOURARR_GP&instance="+params.instance+"&code="+params.code;if(params.apresToday)sending+="&apresToday="+params.apresToday;else sending+="&apresToday=true";appelAjaxToFunc(url,sending,function(reponseAjax){calendrier_recupJourArrGP(reponseAjax,idDivGene);calendrier_setClasseForJourArrGP(idDivGene,nb_stock,params.tabStock,params.request);});}}
function calendrier_recupDisposForProd(tabDispo,idDivGene){eval("var infosDispo="+tabDispo);var dte=new String(infosDispo.date_deb);var dispos=new String(infosDispo.chaineDispo);var apresToday=infosDispo.apresToday;var code_stock=new String(infosDispo.code_stock);if($(idDivGene)){$(idDivGene).setAttribute("dispos_"+code_stock.replace("/","_slash_"),dispos);$(idDivGene).setAttribute("dteDispos",dte);$(idDivGene).setAttribute("apresToday",apresToday);}}
function calendrier_recupJourArrGP(tabJourArr,idDivGene){effaceMsgAttenteParDessus();eval("var infosJrArr="+tabJourArr);var dte=new String(infosJrArr.date_deb);var jourArr=new String(infosJrArr.jourArr);var apresToday=infosJrArr.apresToday;var nbjMini=infosJrArr.nbjMini;if($(idDivGene)){$(idDivGene).setAttribute("jourArr",jourArr);$(idDivGene).setAttribute("dteJrArr",dte);$(idDivGene).setAttribute("apresToday",apresToday);$(idDivGene).setAttribute("nbjMini",nbjMini);}}
function calendrier_setClasseForDisposForProd(idDivGene,nb_stock,tabStock,request){effaceMsgAttenteParDessus();var cliquable;var idCurr;var dispo;var code_stock;for(var c=0;c<nb_stock;c++){code_stock=new String(tabStock[c].code);code_stock=code_stock.replace("/","_slash_");if($(idDivGene)){var dispos=$(idDivGene).getAttribute("dispos_"+code_stock);var dte=new OBJDate($(idDivGene).getAttribute("dteDispos"));var apresToday=$(idDivGene).getAttribute("apresToday");}
var today=new OBJDate();today.definition();if(dispos){for(var i=0;i<dispos.length;i++){idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy");idCurr+="_"+code_stock;cliquable=false;if($(idCurr)){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){dispo=dispos.charAt(i);if($(idCurr).hasClassName("classeInit")&&(dispo=="1"||(dispo=="0"&&request=="O")))cliquable=true;else{cliquable=false;if(dispo!="1"&&request!="O"&&$(idCurr).hasClassName("spanCalendCliquableGP")){$(idCurr).removeClassName("spanCalendCliquableGP");$(idCurr).onclick=null;}}
if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");$(idCurr).setAttribute("etat",dispo);$(idCurr).addClassName(calendrier_getClassForJourGP(dispo,request,cliquable));if(cliquable){$(idCurr).onclick=function(evt){calendrier_clicDateGP(evt,this,request);}}}}
dte.ajoutJour(1);}}}}
function calendrier_setClasseForJourArrGP(idDivGene,nb_stock,tabStock,request){var jourArr=$(idDivGene).getAttribute("jourArr");var dte=new OBJDate($(idDivGene).getAttribute("dteJrArr"));var nbjMini=$(idDivGene).getAttribute("nbjMini");var apresToday=$(idDivGene).getAttribute("apresToday");var idCurr;var jr_arr;var today=new OBJDate();today.definition();if(nbjMini)today.ajoutJour(nbjMini);for(var i=0;i<jourArr.length;i++){for(var j=0;j<nb_stock;j++){var code_stock=new String(tabStock[j].code);idCurr=idDivGene+"_id_"+dte.toString("ddmmyyyy")+"_"+code_stock.replace("/","_slash_");if($(idCurr)){jr_arr=jourArr.charAt(i);if($(idCurr).hasClassName("classeInit")&&jr_arr=="A"){if((apresToday&&dte.estApresOBJDate(today))||!apresToday){$(idCurr).addClassName("spanCalendCliquableGP");$(idCurr).onclick=function(evt){calendrier_clicDateGP(evt,this,request);}}}else{if(jr_arr!="A"&&$(idCurr).hasClassName("spanCalendCliquableGP")){$(idCurr).removeClassName("spanCalendCliquableGP");$(idCurr).onclick=null;}}
if($(idCurr).hasClassName("classeInit"))$(idCurr).removeClassName("classeInit");}}
dte.ajoutJour(1);}}
function calendrier_getClassForJourGP(etat,request,cliquable){var classEtat;var tabClass=calendrier_getTabClassEtatsGP(request);var classe="spanCalendJourGP_"+tabClass.getEtatLong(etat);if(cliquable&&(etat=="1"||(etat=="0"&&request=="O")))classe+=" spanCalendCliquableGP";return classe;}
function calendrier_getTabClassEtatsGP(request){var tabClass={"getEtatLong":function(etat){switch(etat){case"1":return"libre";case"0":if(request=="O")return"devis";else return"occupe";}}};return tabClass;}
function calendrier_clicDateGP(evt,obj,request){var tabClass=calendrier_getTabClassEtatsGP(request);var etat=tabClass.getEtatLong(obj.getAttribute("etat"));var idCurr=new String(obj.id);idCurr=idCurr.replace("_slash_","/");var tabId=idCurr.split("_");var chaine=new String(tabId[tabId.length-2]);var jour=chaine.substr(0,2);var mois=chaine.substr(2,2);var annee=chaine.substr(4,4);obj.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.foncQdClicGauche(evt,jour,mois,annee,etat);}
jQuery(document).ready(function(){if(jQuery(".div_fiche_calendrierDispoPHP").length>0){lanceCalendrier();if(jQuery(".div_fiche_calendrierDispo_detailCH").attr('data-gite')){jQuery(".div_fiche_calendrierDispo_detailCH").css('cursor','pointer');jQuery(".div_fiche_calendrierDispo_detailCH").bind('click',function(){var myElement=jQuery(".div_fiche_calendrierDispo_detailCH");if(myElement.parent().children(".div_fiche_calendrierDispoLIGNE").is(':visible')){myElement.parent().children(".div_fiche_calendrierDispoLIGNE").hide();myElement.parent().children(".div_fiche_calendrierDispoCARRE").show();jQuery(".div_fiche_calendrierDispo_detailCH").html(jQuery(".div_fiche_calendrierDispo_detailCH").attr('data-ch'))}else{myElement.parent().children(".div_fiche_calendrierDispoCARRE").hide();myElement.parent().children(".div_fiche_calendrierDispoLIGNE").show();jQuery(".div_fiche_calendrierDispo_detailCH").html(jQuery(".div_fiche_calendrierDispo_detailCH").attr('data-gite'))}})}
if(jQuery("#div_fiche_btnDispo").length>0){jQuery("#div_fiche_btnDispo a").removeAttr('onclick');jQuery("#div_dispo").hide();jQuery("#div_dispo").slideUp();jQuery("#div_fiche_btnDispo a").bind('click',function(){if(jQuery("#div_dispo").is(':visible')){jQuery("#div_dispo").slideUp();}else{jQuery("#div_dispo").slideDown();}})}}
if(estSurBureauITEA()){ajoutCalendrierPourBureauITEA();}});function ajoutCalendrierPourBureauITEA(){console.log('ajoutCalendrierPourBureauITEA');if(!yaDateAGererBureauITEA()){return;}
(function($){var deb=getParamFromURL('deb');if(deb===undefined){deb=getParamFromURL('debutsejour');}
var nbj=getParamFromURL('duree');if(nbj===undefined){nbj=getParamFromURL('nbj');}
if(nbj===undefined){nbj=getParamFromURL('dureesejour');}
var ObjDate=new OBJDate(deb);deb=ObjDate.toMySQL();var moisAffiche=[];for(var i=0;i<=nbj;i++){var date=ObjDate.toMySQL();console.log('ajoutCalendrierPourBureauITEA '+date);$('span[data-date='+date+']').attr('title',function(){return $(this).attr('title')+' - Sjour recherch (*)';});$('span[data-date='+date+']').addClass('spanCalendJour_periodeRecherchee');if(moisAffiche.indexOf(date.substring(0,7))===-1){moisAffiche.push(date.substring(0,7));}
ObjDate.ajoutJour(1);}
console.log('ajoutCalendrierPourBureauITEA moisAffiche',moisAffiche);if(moisAffiche.length===2){$('div.div_lst_divDispo_v3').attr('nbmois','2');}else{$('div.div_lst_divDispo_v3').attr('nbmois','1');}
$('.calendItea_li').hide();$('.calendItea_li').attr('data-estaffiche','false');moisAffiche.forEach(function(to){var mois=to.split('-')[1];var annee=to.split('-')[0];$('.calendItea_li[data-mois='+mois+'][data-annee='+annee+']').show();$('.calendItea_li[data-mois='+mois+'][data-annee='+annee+']').attr('data-estaffiche','true');});afficheMasqueFlechesNavigation('.div_dispos_showing');$('a.a_BoutonResaBureau').data('deb',deb);$('a.a_BoutonResaBureau').data('duree',nbj);})(jQuery);}
function lanceCalendrier(maDiv){if(maDiv)maDiv="#"+maDiv;else maDiv=".div_dispos_showing";if(jQuery(maDiv).length==0)maDiv=".calendIteaAvSaison";if(jQuery(maDiv).length<=1){var modeCalendrierMultiple=false;}else{var modeCalendrierMultiple=true;}
var nbMois=jQuery(maDiv).attr('nbmois');if(!nbMois&&jQuery(".div_btnsGauche"))nbMois="12";jQuery(maDiv+" .calendItea_navigGauche").css("cursor","pointer");jQuery(maDiv+" .calendItea_navigDroite").css("cursor","pointer");afficheMasqueFlechesNavigation(maDiv);jQuery(maDiv+" .calendItea_navigGauche").bind('click',function(){if(jQuery(this).children('a').is(':visible')||(jQuery(this).is(':visible')&&jQuery(this).children('a').length===0)){if(!modeCalendrierMultiple){var madivCurrent=jQuery(maDiv);}else{var madivCurrent=jQuery(this).parent(maDiv);}
var elementFirstPositionToShow=jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:visible')[0];elementFirstPositionToShow=parseInt(jQuery(elementFirstPositionToShow).index());var elementFirstPositionToHide=parseInt(elementFirstPositionToShow)+parseInt(nbMois);for(var i=-parseInt(nbMois);i<0;i++){if(jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToShow+i)+')').length>0){jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToShow+i)+')').show();}
jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToHide+i)+')').hide();}
jQuery(madivCurrent).find(" .calendItea_navigDroite").show();jQuery(madivCurrent).find(" .calendItea_navigDroite a").show();if(elementFirstPositionToShow<=nbMois){if(jQuery(this).parent().children(maDiv+" .calendItea_navigGauche").children('a').length>0){jQuery(this).children('a').hide();jQuery(this).hide();}else{jQuery(this).parent().children(maDiv+" a.calendItea_navigGauche").hide();jQuery(this).parent().children(maDiv+" .calendItea_navigGauche").hide();}}
if(jQuery(maDiv+" .calendItea_navigEtCalend")){var anneeActu=jQuery(maDiv+" .calendItea_navigEtCalend [class=annee1]").html();var annee1=parseInt(anneeActu)-1;var annee0=parseInt(annee1)-1;var annee2=parseInt(annee1)+1;jQuery(maDiv+" .calendItea_navigEtCalend [class=annee0]").html(annee0);jQuery(maDiv+" .calendItea_navigEtCalend [class=annee1]").html(annee1);jQuery(maDiv+" .calendItea_navigEtCalend [class=annee2]").html(annee2);}}});jQuery(maDiv+" .calendItea_navigDroite").bind('click',function(){if(jQuery(this).children('a').is(':visible')||(jQuery(this).is(':visible')&&jQuery(this).children('a').length===0)){if(!modeCalendrierMultiple){var madivCurrent=jQuery(maDiv);}else{var madivCurrent=jQuery(this).parent(maDiv);}
var elementFirstPositionToHide=jQuery(madivCurrent).find(".div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:visible')[0];elementFirstPositionToHide=parseInt(jQuery(elementFirstPositionToHide).index());var elementFirstPositionToShow=parseInt(elementFirstPositionToHide)+parseInt(nbMois);for(var i=0;i<parseInt(nbMois);i++){if(jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToShow+i)+')').length>0){jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToShow+i)+')').show();}
jQuery(madivCurrent).find(" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(elementFirstPositionToHide+i)+')').hide();}
jQuery(madivCurrent).find(" .calendItea_navigGauche a").css("display","block");jQuery(madivCurrent).find(" .calendItea_navigGauche").show();if((elementFirstPositionToShow+i)>=parseInt(jQuery(this).parent().children(maDiv+" .div_fiche_calendrierDispoCARRE").children(".calendItea_listMois").children("ul").children("li").size())){if(jQuery(this).children("a").length>0){jQuery(this).children("a").hide();}
jQuery(this).hide();}
if(jQuery(maDiv+" .calendItea_navigEtCalend")){var anneeActu=jQuery(maDiv+" .calendItea_navigEtCalend [class=annee1]").html();var annee1=parseInt(anneeActu)+1;var annee0=parseInt(annee1)-1;var annee2=parseInt(annee1)+1;jQuery(maDiv+" .calendItea_navigEtCalend [class=annee0]").html(annee0);jQuery(maDiv+" .calendItea_navigEtCalend [class=annee1]").html(annee1);jQuery(maDiv+" .calendItea_navigEtCalend [class=annee2]").html(annee2);}}});if(jQuery(maDiv+" caption").length>0){jQuery(maDiv+" caption").live('click',function(){var typeProd=jQuery(maDiv+" [class=annee1]").attr('data-type');if((typeProd=="G"||typeProd=="H")&&jQuery(this).closest(maDiv).hasClass('calendIteaAvSaison')){var ident=(jQuery(maDiv+" [class=annee1]").attr('data-ident'));var moisCurr=jQuery(this).attr('data-mois');var anneeCurr=jQuery(this).attr('data-annee');afficheDivAvecTransparence(calendrier_getXHTML_1mois_saison(moisCurr,anneeCurr,"fr","saisons","",ident),250,180,"sais");var url="/lib_2/ajax/contenuFenetre.php";var vars="element=elemObjProd&typeInfo=afficheTarifParSaison-"+ident+"-"+moisCurr+"-"+anneeCurr;affUrlInDiv("div_tarifSais",url,vars,"aucun",majIdSaisonForUnMois);}});}
if(jQuery(maDiv).parent().find(".ficheSelectDisposBychmb").length>0){jQuery(maDiv).parent().find(".ficheSelectDisposBychmb").bind('change',function(){showDisposChambre(this);});jQuery.each(jQuery(maDiv).parent().find(".ficheSelectDisposBychmb"),function(){if(jQuery(this).attr('data-valuedefaut')!='0'){jQuery(this).trigger('change')}})}}
function showDisposChambre(selectElement){var classe_a_afficher=jQuery('option:selected',selectElement).attr('data-classe_a_afficher');jQuery(selectElement).parent().find(".calendItea_ul_CARRE td").children("span").css('display','none');jQuery(selectElement).parent().find(".calendItea_ul_CARRE td").children("a").css('display','none');jQuery(selectElement).parent().find(".calendItea_ul_CARRE td").children('.'+classe_a_afficher).css('display','block');jQuery(selectElement).parent().find(".calendItea_ul_CARRE td").children('.'+classe_a_afficher).children().css('display','block');}
function calendrierPHP_getXHTMLForAfficheInDivAvecTransparence(nomdiv,ident,titreDivResa,typegite){var html;window.nomDivResaPopIn=titreDivResa;html="<div class='calendIteaBtFermer' id='div_planningBtFermer_calendItea_"+nomdiv+"' onclick=effaceDivAvecTransparence();>Fermer</div>";var htmlBase="<div class='calendIteaBtFermer' id='div_planningBtFermer_calendItea_"+nomdiv+"' onclick=effaceDivAvecTransparence();>Fermer</div>";html=htmlBase+"<img src='/config_v3/imgs_defaut/v5/ajax-loader.gif' alt='Chargement en cours...' />";var url="/lib_2/ajax/infosDist.php";var vars="info=DISPOSxHTML&ident="+ident+"&type_gite="+typegite;var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;$("divGraph_fenetre").innerHTML=htmlBase+contenu;lanceCalendrier("calendrierAnnuel");}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(vars);return html;}
function calendrierPHP_chargerEnAjax(instance,reference){if($("calendrierPHP_Ajax_"+instance+"_"+reference)){var idDiv=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-iddiv");if(!$(idDiv)){var nomClass=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-class");var nbMois=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-nbmois");var suffixeId=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-suffixeId");var ident=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-ident");var typegite=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-typeGite");var ope=$("calendrierPHP_Ajax_"+instance+"_"+reference).getAttribute("data-ope");var url="/lib_2/ajax/infosDist.php";var vars="info=DISPOSxHTMLauMois&ident="+ident+"&type_gite="+typegite+"&nbMois="+nbMois+"&idDiv="+idDiv+"&classDiv="+nomClass+"&ope="+ope+"&suffixeId="+suffixeId
var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;$("calendrierPHP_Ajax_"+instance+"_"+reference).innerHTML=contenu;lanceCalendrier(idDiv);}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(vars);}}}
function changeMoisCalendrierPHP(divCalendrier,dateDebut){(function($){var date=new OBJDate(dateDebut);var liMois=$('li.calendItea_li[data-annee="'+date.getAnnee()+'"]',divCalendrier).filter('[data-mois="'+date.getMois()+'"]');if(liMois.length===0){console.log('pas de mois  afficher, on est hors cadre');}
$('.calendItea_navigGauche a',divCalendrier).hide();$('.calendItea_navigDroite a',divCalendrier).hide();if(liMois.prev().length>0){$('.calendItea_navigGauche a',divCalendrier).show();}
if(liMois.next().length>0){$('.calendItea_navigDroite a',divCalendrier).show();}
$('li.calendItea_li',divCalendrier).hide('fast');liMois.show('fast');})(jQuery);}
function afficheMasqueFlechesNavigation(maDiv){var nbMois=jQuery(maDiv).attr('nbmois');if(!nbMois&&jQuery(".div_btnsGauche")){nbMois="12";}
if(jQuery(maDiv+" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:first-child').attr("data-estaffiche")=="true"){if(jQuery(maDiv+" .calendItea_navigGauche").children('a').length>0){jQuery(maDiv+" .calendItea_navigGauche a").hide();}else if(jQuery(maDiv+" a.calendItea_navigGauche").length>0){jQuery(maDiv+" a.calendItea_navigGauche").hide();}else{jQuery(maDiv+" .calendItea_navigGauche").hide();}}else{if(jQuery(maDiv+" .calendItea_navigGauche").children('a').length>0){jQuery(maDiv+" .calendItea_navigGauche a").show();}else if(jQuery(maDiv+" a.calendItea_navigGauche").length>0){jQuery(maDiv+" a.calendItea_navigGauche").show();}else{jQuery(maDiv+" .calendItea_navigGauche").show();}}
if(jQuery(maDiv+" .div_fiche_calendrierDispo").children(".calendItea_listMois").find('li:eq('+(parseInt(nbMois))+')').length==0){jQuery(maDiv+" .calendItea_navigDroite").hide();}else{jQuery(maDiv+" .calendItea_navigDroite").show();}}function creeObjHttpRequest(){var xhr_local=null;if(window.XMLHttpRequest)
xhr_local=new XMLHttpRequest();else if(window.ActiveXObject){try{xhr_local=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){xhr_local=new ActiveXObject("Microsoft.XMLHTTP");}}
return xhr_local;}
function go(c){if(!c.data.replace(/\s/g,""))
c.parentNode.removeChild(c);}
function clean(d){var bal=d.getElementsByTagName("*");for(i=0;i<bal.length;i++){a=bal[i].previousSibling;if(a&&a.nodeType==3)
go(a);b=bal[i].nextSibling;if(b&&b.nodeType==3)
go(b);}
return d;}
function urlCentreByAjaxFromCGI(url,cgis,htmlAttente){debugLogJS('urlCentreByAjaxFromCGI');}
function listeByAjaxFromCGI(cgis,htmlAttente){debugLogJS('listeByAjaxFromCGI');urlCentreByAjaxFromCGI("/liste",cgis,htmlAttente);}
function listeByAjaxFromForm(idForm,htmlAttente){debugLogJS('listeByAjaxFromForm');var objForm=document.getElementById(idForm);if(!objForm)return;var tabForm=getTabChmpForm(objForm);var query="";for(var i=0;i<tabForm.length;i++){query+="&"+tabForm[i].id+"="+tabForm[i].value;}
urlCentreByAjaxFromCGI("/liste",query,htmlAttente);}
function urlDsPageCurrByAjaxAvecMsgAttente(url,cgi,htmlAttente){}
function affUrlInDiv(nomDiv,url,vars,msgAttente,foncQdFini){var idx=url.indexOf("?");if(idx>0){vars+=url.substr(idx+1);url=url.substr(0,idx);}
vars+=getInfoSession("PHPSESSID");var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var reponse=xhr_local.responseText;var elem=$(nomDiv);if(elem)elem.innerHTML=reponse;if(foncQdFini)foncQdFini(elem);}
if(xhr_local.readyState==4&&xhr_local.status!=200){if(foncQdFini)foncQdFini(elem);}}
if(msgAttente!="aucun"){var elem=document.getElementById(nomDiv);if(elem&&msgAttente)elem.innerHTML=msgAttente;else affMsgAttenteInDiv(nomDiv);}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(vars);}
function affUrlInDivFromHtml(html,foncQdFini){var data=html;var idx_debhtml=data.indexOf("-->");if(idx_debhtml>0){var js=data.substr(4,idx_debhtml-4);if(js.substr(0,14)=="JS_affUrlInDiv"){var tabInfos=js.split("&#164;");affUrlInDiv(tabInfos[1],tabInfos[2],tabInfos[3],"",foncQdFini);}else{if(window.foncQdFini)window.foncQdFini(false);}}}
function affUrlSsTourInDivAvecMsgAttente(nomDiv,url,query_string,html_attente){var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;document.getElementById(nomdiv).innerHTML=contenu;}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(query_string);}
function chargeAdresseHTMLDansDiv(nomdiv,url,query_string){var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;document.getElementById(nomdiv).innerHTML=contenu;}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(query_string);}
function appelAjaxToFunc(url,query_string,foncQdFini){var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=xhr_local.responseText;if(foncQdFini)foncQdFini(contenu);}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(query_string);}
function appelAjaxXMLToFunc(url,query_string,foncQdFini){var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var contenu=clean(xhr_local.responseXML.documentElement);if(foncQdFini)foncQdFini(contenu);}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(query_string);}
function appelAdrAjaxInDivAvecTransparence(adr,sending,msg,w,h,effacerDivChargementApresReponse,foncQdFini){var html_init="<div id='divChargementAjx'><div class='divChargementAjxContent'<img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br />"+msg+"</div></div>";if(!w)w=200;if(!h)h=150;afficheDivAvecTransparence(html_init,w,h);var objStatus=document.getElementById("divChargementAjx");var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){reponse=xhr_local.responseText;if(effacerDivChargementApresReponse)afficheDivAvecTransparence(reponse,w,h);else objStatus.innerHTML=reponse;if(foncQdFini)foncQdFini();}}
xhr_local.open("POST",adr,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(sending);}
function appelCalendrierAnnuelGP(adr,sending,msg,w,h){appelAdrAjaxInDivAvecTransparence(adr,sending,msg,w,h,true,initCalendrierAnnuelGP);}
function affParamCGICurrInObjById(idDiv,param,acc,chaineAvant,chaineApres){debugLogJS('affParamCGICurrInObjById');}
function setCGIByAjax(querystring,rechargeListe,foncQdFini,paramFcQdFini){debugLogJS('setCGIByAjax');}
function chargeMotCleDsDiv(idDiv,motCle){if(!window.jsonMotcle)window.jsonMotcle=[];for(var i=0;i<window.jsonMotcle.length;i++){if(window.jsonMotcle[i].motcle==motCle){if($(idDiv))$(idDiv).innerHTML=window.jsonMotcle[i].content;return;}}
var adr="/lib_2/ajax/contenuFenetre.php";var sending=getInfoSession()+"&element=motCle&typeInfo=motcle&val="+motCle;appelAjaxToFunc(adr,sending,function(reponse){window.jsonMotcle.push({'motcle':motCle,'content':reponse});window.jsonMotcle.uniq();if($(idDiv))$(idDiv).innerHTML=reponse;});}
function cleanAllAJAXcall(){}
function appelAdrAjaxToFuncXMLAvecAttente(url,query_string,foncQdFini,msg,w,h){if(!msg){var msg='Chargement en cours';}
var html_init="<div id='divChargementAjx'><img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br />"+msg+"</div>";if(!w)w=200;if(!h)h=150;afficheDivAvecTransparence(html_init,w,h);(function($){$.ajax({type:"POST",url:url,data:query_string,dataType:'xml',success:function(reponse){$('#divChargementAjx').hide('slow');if(foncQdFini)foncQdFini(reponse);}});})(jQuery);}
function simpleUploaderAjax(form,fonctionSuccess){(function($){$(form).submit(function(event){event.stopPropagation();event.preventDefault();var files=$('input[type=file]',form)[0].files;var data=new FormData();$.each(files,function(key,value){data.append(key,value);});var queryString='?'+$(form).serialize();$.ajax({url:$(form).attr('action')+queryString,type:'POST',data:data,cache:false,dataType:'json',processData:false,contentType:false,success:function(data,textStatus,jqXHR){if(data.code=='OK'){window[fonctionSuccess](data);}
else{}
$('.spinnerAppelAjax',form).remove();},error:function(jqXHR,textStatus,errorThrown){$('.spinnerAppelAjax',form).remove();},beforeSend:function(){$(form).append('<img class="spinnerAppelAjax" src=/config_v3/imgs_defaut/loading/roue16x16.gif />');}});});})(jQuery);}var nbChampVerifie;var urlCptClient='/lib_2/ajax/gereCptClient.php';var elemToClickAfterCnxCptGDF;var playerYoutube;function getVersionIE(){if(navigator.appName=='Microsoft Internet Explorer'){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null){return parseFloat(RegExp.$1);}}
if(navigator.userAgent.indexOf('Trident/7.')>0){if(navigator.userAgent.match(/Trident.*rv[ :]*11\./)){return 11;}else{var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null){return parseFloat(RegExp.$1);}}}
return 999;}
function estSurIE(){return(getVersionIE()!=999);}
function estSurSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent);}
function format_nb(valeur,decimal,separateur){var deci=Math.round(Math.pow(10,decimal)*(Math.abs(valeur)-Math.floor(Math.abs(valeur))));var val=Math.floor(Math.abs(valeur));if((decimal==0)||(deci==Math.pow(10,decimal))){val=Math.floor(Math.abs(valeur));deci=0;}
var val_format=val+"";var nb=val_format.length;for(var i=1;i<4;i++){if(val>=Math.pow(10,(3*i))){val_format=val_format.substring(0,nb-(3*i))+separateur+val_format.substring(nb-(3*i));}}
if(decimal>0){var decim="";for(var j=0;j<(decimal-deci.toString().length);j++){decim+="0";}
deci=decim+deci.toString();val_format=val_format+"."+deci;}
if(parseFloat(valeur)<0){val_format="-"+val_format;}
return val_format;}
function setWindowForInclude(){window.tabFileForInclude=new Array();window.tabFileOfInclude=new Array();window.tabFileForInclude[0]="/lib_2/js/foncs/test.js";}
function execute(nom_function){window.tabFileForInclude.each(function(file){if(!in_array(window.tabFileOfInclude,nom_function)){var res=include(file,"body",nom_function,nom_function);if(res){window.tabFileOfInclude[window.tabFileOfInclude.length+1]=file;window.foncQdLoaded();}}});}
function include(fileName,typeBaliseToAdd,nomFoncToCheck,foncQdLoaded){var retour=false;var objToAdd;if(!typeBaliseToAdd)
typeBaliseToAdd="head";if(document.getElementsByTagName)
objToAdd=document.getElementsByTagName(typeBaliseToAdd);else if(document.$$)
objToAdd=$$(typeBaliseToAdd);if(objToAdd){var script=document.createElement("script");script.type="text/javascript";script.src=fileName;objToAdd[0].appendChild(script);}
if(nomFoncToCheck){var ok=false;eval("ok=window."+nomFoncToCheck);var rep=window.test;rep=window.addfavoris;if(ok){retour=true;}
else{window.optsForInclude={};window.optsForInclude.fileName=fileName;window.optsForInclude.foncQdLoaded=foncQdLoaded;window.optsForInclude.nomFoncToCheck=nomFoncToCheck;window.optsForInclude.intervForInclude=setInterval(function(){eval("ok=window."+window.optsForInclude.nomFoncToCheck);if(ok){clearInterval(window.optsForInclude.intervForInclude);window.optsForInclude.foncQdLoaded();retour=true;}},500);}}
return retour;}
function in_array(array,p_val){for(var i=0,l=array.length;i<l;i++){if(array[i]==p_val){rowid=i;return true;}}
return false;}
function is_array(input){return(typeof(input)=='object'&&(input instanceof Array));}
function array_push(array,vars){if(!is_array(array))
array=new Array();var length=array.length;array[length]=vars;return array;}
function addfavoris(url,title){if(!url){if(document.documentURI)
url=document.documentURI;else
url=document.location;}
if(!title)
title=document.title;if(navigator.userAgent.indexOf('Safari')!=-1){if(navigator.appVersion.indexOf("Mac",0)>0)
alertAMalibu("Utilisez POMME + D \n pour ajouter "+title+" dans vos favoris");else
alertAMalibu("Utilisez CTRL + D \n pour ajouter "+title+" dans vos favoris");}
if(getVersionIE()<9&&window.external)
window.external.AddFavorite(url,title);else if(window.sidebar.addPanel)
window.sidebar.addPanel(title,url,"");}
function printContentObj(obj){var links="";var objLinks=document.getElementsByTagName('link');for(var i=0;i<objLinks.length;i++){links+="<link rel='stylesheet' media='"+objLinks[i].getAttribute("media")+"' href='"+objLinks[i].getAttribute("href")+"' />";}
var contentFrame="<html><head>"+links+"</head><body>"+jQuery(obj).html()+"</body></html>";var windowToPrint=window.open("","windowToPrint");windowToPrint.document.open();windowToPrint.document.write(contentFrame);windowToPrint.document.close();windowToPrint.print();windowToPrint.close();}
function reloadJs(){var i,a,s;a=document.getElementsByTagName('script');for(i=0;i<a.length;i++){s=a[i];if(s.type.toLowerCase().indexOf('text/javascript')>=0&&s.src){var h=s.src.replace(/(&|%5C?)reload=\d+/,'');s.src=h+(h.indexOf('?')>=0?'&':'?')+'reload='+getUniqueId();}}}
function gaTrack(url){if(window.pageTracker)
window.pageTracker.push(['_trackPageview',url]);if(window.pageTrackerItea)
window.pageTrackerItea.push(['_trackPageview',url]);}
function gTracking_addTrans(numero_resa,affiliation,prix_total,prix_taxes,prix_expedition,ville,region,pays){if(window.pageTracker)
window.pageTracker.push(['_addTrans',numero_resa,affiliation,prix_total,prix_taxes,prix_expedition,ville,region,pays]);}
function gTracking_addItem(numero_resa,code_prod,nom_prod,categorie_prod,prix_unit,quantite){if(window.pageTracker)
window.pageTracker.push(['_addItem',numero_resa,code_prod,nom_prod,categorie_prod,prix_unit,quantite]);}
function gTracking_trackTrans(){if(window.pageTracker)
window.pageTracker.push(['_trackTrans']);}
function gTracking_conversionPage(id,langue,format,color,label,mntTotal){if(id){var google_conversion_id=id;var google_conversion_language=langue;var google_conversion_format=format;var google_conversion_color=color;var google_conversion_label=label;if(mntTotal){var google_conversion_value=mntTotal;}
include("https://www.googleadservices.com/pagead/conversion.js","body");}}
function initSiteWeb(){afficheListeByAjx_setTri_bySelect();initChangeNombreElementParPage();moteur_initMoteurCommun();if(window.oninit)
oninit();if(window.oninit1)
oninit1();if(window.oninit2)
oninit2();if(window.oninit3)
oninit3();initAfficheMasqueTexteEntetePage();checkPageSiDivForChargePrixInLst();traiteInformationInfosBulle();verifNavigateur();setActionSurDiaporama();initClicBody();cptGDF_initActionsAjoutFavoriHeber();if(jQuery(".a_canevasAfficheDetail").length>0){jQuery(".a_canevasAfficheDetail").fancybox({maxWidth:800,minWidth:500,maxHeight:600,autoHeight:true,fitToView:false,width:'70%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});}
if(jQuery("a.itea_colorbox").length>0){jQuery("a.itea_colorbox").colorbox({maxHeight:'90%',maxWidth:'90%'});}
if(jQuery('.flash_player').length>0){jQuery.each(jQuery('.flash_player'),function(){jQuery(this).flash(jQuery(this).attr('data-src'));})}
setEventForQtip();if(jQuery('.viewWithQtipBottomRight').length>0){jQuery('.viewWithQtipTohide').hide()
jQuery('.viewWithQtipBottomRight').each(function(){if(jQuery(this).attr('data-qhelp')&&jQuery("#"+jQuery(this).attr('data-qhelp'))){jQuery(this).qtip({content:{text:jQuery("#"+jQuery(this).attr('data-qhelp')).html(),title:{text:jQuery(this).attr('data-qtitle')}},position:{my:'top right',at:'bottom right'},show:'mouseover',hide:'mouseout'})}})}
if(jQuery('.lst_multiple').length>0){jQuery(".lst_multiple").chosen({no_results_text:"Aucun rsultat",allow_single_deselect:true}).change(function(){if(jQuery("#moteur_selectRayon")){var value=jQuery(this).val();tabValue=value.split("-");if(tabValue[0].substr(0,5)=="INSEE"){jQuery("#moteur_selectRayon").attr("disabled",false);}
if(tabValue[1]){tabValue2=tabValue[1].split("_");if(tabValue2[0]=="DISTCOMM"){if(tabValue2[1]){jQuery("#moteur_selectRayon").val(tabValue2[1]);}else{jQuery("#moteur_selectRayon").val("10");}}}}});}
if(jQuery("input[data-valueDefaut]").length>0){jQuery("input[data-valueDefaut]").bind("focus",function(){if(jQuery(this).val()==jQuery(this).attr("data-valueDefaut"))
jQuery(this).val("");});}
if(jQuery("input[data-valueDefaut]").length>0){jQuery("input[data-valueDefaut]").bind("blur",function(){if(jQuery(this).val()=="")
jQuery(this).val(jQuery(this).attr("data-valueDefaut"));});}
if(jQuery("*[data-href]").length>0){jQuery("*[data-href]").bind("click",function(){document.location.href=jQuery(this).attr("data-href");});}
if(jQuery("*[data-href_parent]").length>0){jQuery("*[data-href_parent]").bind("click",function(){document.location.href=jQuery(this).attr("data-href_parent");});}
if(jQuery("*[data-href-blank]").length>0){jQuery("*[data-href-blank]").bind("click",function(){window.open(jQuery(this).attr("data-href-blank"));});}
if(jQuery("*[data-href_blank]").length>0){jQuery("*[data-href_blank]").bind("click",function(){window.open(jQuery(this).attr("data-href_blank"));});}
if(jQuery('.div_disposProd').length>0){initCalendrierDisposGP();}
(function($){if($(".datepicker").length>0){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);$(".datepicker").datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1});}})(jQuery);initFancyBoxDeBase();if(jQuery("#recuperer_localisation").length>0){jQuery("#recuperer_localisation").bind("click",function(){jQuery("#recuperer_localisation").html("<img src='/config_v3/imgs_defaut/rouegrise.gif' alt='Rech. gps...' width='28' height='28' />");var gps=navigator.geolocation;if(gps){gps.getCurrentPosition(recupPositionGps,function(error){erreurGPS(error)});}
else{erreurRecupPositionGps()}
return false});}
if(jQuery.isFunction(window.initInscriptionNewsletter)){initInscriptionNewsletter();}
if(jQuery("#div_choixDates").length>0){if(jQuery('#div_choixDates').attr('data-ident')){var tabParam=new Array();tabParam.ident=jQuery('#div_choixDates').attr('data-ident');tabParam.instance=jQuery('#div_choixDates').attr('data-instance');tabParam.exercice=jQuery('#div_choixDates').attr('data-exercice');tabParam.modefiche=true;afficherMasquerCalendrier(tabParam);}}
if(jQuery("#div_formContactProp").length>0){initFormContactProp(null,jQuery("#inputIdentPourStat").val());}
if(jQuery(".choixMoisPromos select").length>0){jQuery(".choixMoisPromos select").change(function(){if(jQuery(this).val()==''){jQuery(this).parent().next('.ul_widgetPromo').children('li').show()}else{jQuery(this).parent().next('.ul_widgetPromo').children('li').hide()
jQuery(this).parent().next('.ul_widgetPromo').children('li.'+jQuery(this).val()).show()}});}
if(jQuery('img[data-srcdiffere]').length>0){setTimeout(function(){jQuery('img[data-srcdiffere]').each(function(){if(jQuery(this).attr('src').length==0){jQuery(this).attr('src',jQuery(this).attr('data-srcdiffere'));}});},2000);}
if(typeof initWidgetTopActivites==="function"){initWidgetTopActivites();}
initFormContactRgpd();initAlerteGeneral();}
function setEventForQtip(){(function($){if($('.viewWithQtip').length>0){$('.viewWithQtipTohide').hide();$('.viewWithQtip').each(function(){if($(this).attr('data-qhelp')&&$("#"+$(this).attr('data-qhelp'))){switch($(this).attr('data-qposition')){case'hautgauche':positionmy='bottom right';positionat='top left';break;case'hautdroite':positionmy='bottom left';positionat='top right';break;case'bas':positionmy='top center';positionat='bottom center';break;case'centredroite':positionmy='center left';positionat='center right';break;case'centregauche':positionmy='top right';positionat='center left';break;default:positionmy='top left';positionat='bottom right';break;}
$(this).qtip({style:{classes:$(this).attr('data-qclasses')},content:{text:$("#"+$(this).attr('data-qhelp')).html(),title:{text:$(this).attr('data-qtitle')}},position:{my:positionmy,at:positionat},show:'mouseover',hide:'mouseout'})}})}})(jQuery);}
function erreurRecupPositionGps(){jQuery("#recuperer_localisation").html(jQuery("#div_recuperer_localisation").attr('data-erreur'));}
function erreurGPS(error){console.log('erreurGPS > ')
console.log(error)
jQuery("#recuperer_localisation").html(jQuery("#div_recuperer_localisation").attr('data-erreurgps'));}
function recupPositionGps(position){console.log('recupPositionGps')
console.log(position)
if(position){jQuery("#recuperer_localisation").unbind()
getNomLieuByPositionCurr(position,recupPositionGpsSetInfos);jQuery("#div_recuperer_localisation input[name=pos_gps_lat]").attr('value',position.coords.latitude);jQuery("#div_recuperer_localisation input[name=pos_gps_lng]").attr('value',position.coords.longitude);}else
erreurRecupPositionGps()}
function recupPositionGpsSetInfos(reponse){var jsonarray=eval(reponse);jQuery("#div_recuperer_localisation input[name=pos_insee]").attr('value',jsonarray[0].insee);jQuery("#div_recuperer_localisation input[name=pos_ville]").attr('value',jsonarray[0].city);var cgiFinal='';if(jQuery('.lst_multiple').length>0){var insee=jsonarray[0].insee;var city=jsonarray[0].city;jQuery.each(jQuery('.lst_multiple'),function(){cgiFinal='INSEE_'+insee;jQuery(this).val(cgiFinal);if(jQuery(this).val()==''||jQuery(this).val()=='%20'||jQuery(this).val()==undefined){cgiFinal='INSEE_'+insee+'-DISTCOMM_10';jQuery(this).val('INSEE_'+insee+'-DISTCOMM_10');}
if(jQuery(this).val()==''||jQuery(this).val()=='%20'||jQuery(this).val()==undefined){jQuery('#div_recuperer_localisation a').html(jQuery('#div_recuperer_localisation a').attr('data-nofound')+' ('+city+'/'+insee+')')
jQuery('#div_recuperer_localisation a').addClass('localisation_nok')}else{jQuery('#div_recuperer_localisation a').html(jQuery('#div_recuperer_localisation a').attr('data-found')+jsonarray[0].city+jQuery('#div_recuperer_localisation a').attr('data-foundapres'))
jQuery('#div_recuperer_localisation a').attr('href','liste.html?lieu='+cgiFinal)
jQuery('#div_recuperer_localisation a').attr('data-found','1')
jQuery('#div_recuperer_localisation a').addClass('localisation_ok')
if(jQuery(this).hasClass('moteur_selectOnChange')){jQuery(this).trigger('change')}else if(jQuery(this).hasClass('lst_multiple')){jQuery(this).trigger('change');jQuery(this).trigger("liszt:updated");}}})}}
function initLangueForDatePicker(){(function($){var langueBody=$("body").attr("data-langue")||'';if(langueBody.length>0||$('#datalangue').length>0){if($('#datalangue').length>0){lang=$('#datalangue').val();}else{lang=$("body").attr("data-langue");}
switch(lang){case'ANGLAIS':lang="en-GB";break;case'ALLEMAND':lang="de";break;case'HOLLANDAIS':case'NEERLANDAIS':lang="nl";break;case'ITALIEN':lang="it";break;case'ESPAGNOL':lang="es";break;case'PORTUGAIS':lang="pt";break;default:lang="fr";}}
else{lang=$("html").attr("lang");}
if(lang==undefined){lang="fr";}})(jQuery);return lang;}
function initClicBody(){var zone="init";var detectTap=false;$(document).on('touchstart',function(){detectTap=true;});$(document).on('touchmove',function(){detectTap=false;});jQuery(".ITEA_clicOutBody").each(function(){jQuery(this).bind("click",function(){zone="init";});jQuery(this).bind("touchend",function(){zone="init";});});jQuery("body").bind("click",function(){if(zone!="init"){jQuery(".ITEA_clicOutBody").each(function(){if(jQuery(this).is(":visible")){jQuery(this).css("display","none").removeClass("open");zone="init";}});}
else{zone="out";}});jQuery("body").bind("touchend",function(){if(detectTap){if(zone!="init"){jQuery(".ITEA_clicOutBody").each(function(){if(jQuery(this).is(":visible")){jQuery(this).css("display","none").removeClass("open");jQuery("input:focus").blur();zone="init";}});}
else{zone="out";}}});(function($){$('.onClickOutHideBlind').each(function(){$(this).onclickout(function(){if($(this).is(":visible")){$(this).hide("blind")}});});})(jQuery);}
function traitePanierGestprod(){if(jQuery('#div_liste_panierBasNonDate').length>0){(function($){$.ajax({type:"POST",url:"/resaGp/contenuPanierBoutique.php",data:{target:"_blank"},beforeSend:function(){},success:function(result){$("#div_liste_panierBasNonDate").html(result);}});})(jQuery);}
if(jQuery("#div_liste_panierHautNonDate").length>0){(function($){$.ajax({type:"POST",url:"/resaGp/contenuPanierBoutique.php",data:{target:"_blank"},beforeSend:function(){},success:function(result){$("#div_liste_panierHautNonDate").html(result);}});})(jQuery);}}
function ajoutPanierGestprod(no_id_tarif,borne_maxi){var quantite=jQuery("#sp_qte_"+no_id_tarif).attr("valeur");var nouvelle_quantite=parseInt(quantite)+1;if(nouvelle_quantite<=borne_maxi){if(nouvelle_quantite<10)
jQuery("#sp_qte_"+no_id_tarif).html("0"+nouvelle_quantite);else
jQuery("#sp_qte_"+no_id_tarif).html(nouvelle_quantite);jQuery("#sp_qte_"+no_id_tarif).attr("valeur",nouvelle_quantite);jQuery("#nbprod_"+no_id_tarif).attr("value",nouvelle_quantite);}}
function retirePanierGestprod(no_id_tarif){var quantite=jQuery("#sp_qte_"+no_id_tarif).attr("valeur");var nouvelle_quantite=parseInt(quantite)-1;if(nouvelle_quantite>=0){if(nouvelle_quantite<10)
jQuery("#sp_qte_"+no_id_tarif).html("0"+nouvelle_quantite);else
jQuery("#sp_qte_"+no_id_tarif).html(nouvelle_quantite);jQuery("#sp_qte_"+no_id_tarif).attr("valeur",nouvelle_quantite);jQuery("#nbprod_"+no_id_tarif).attr("value",nouvelle_quantite);}}
function traiteInformationInfosBulle(){if(jQuery(".itea_survolInfosBulle")){jQuery(".itea_survolInfosBulle").each(function(elt){var id_survol=jquery(this).attr("id_survol");if(id_survol.length>0){jQuery('#'+id_survol).css('position',"absolute");jQuery('#'+id_survol).css('display',"none");jQuery(this).mousein(function(evt){jQuery('#'+id_survol).css('display',"block");});jQuery(this).mouseout(function(evt){jQuery('#'+id_survol).css('display',"none");});}});}}
function traiteInformationByAncre(){var ancre=getAncreInQuery();if(ancre.substr(0,3)=="js:"){var infos=ancre.split(":");var infosAExec=infos[1];eval(infosAExec);}}
function boomEffectSite(){var objs=document.getElementsByTagName("DIV");for(var i=0;i<objs.length;i++){if(objs[i].childNodes&&objs[i].childNodes.length<3){var x,y,duree,multiplicateur;if(i%2==0)
multiplicateur=-1;else
multiplicateur=1
x=Math.random()*500*multiplicateur;y=Math.random()*500*multiplicateur;duree=Math.random()*3;objs[i].setAttribute("x_move",x);objs[i].setAttribute("y_move",y);new Effect.Move(objs[i],{x:x,y:y,duration:duree,mode:'relative'});}}}
function deboomEffectSite(){var objs=document.getElementsByTagName("DIV");for(var i=0;i<objs.length;i++){if(objs[i].childNodes&&objs[i].childNodes.length<3){var x,y,duree,multiplicateur;x=objs[i].getAttribute("x_move")*-1;y=objs[i].getAttribute("y_move")*-1;duree=Math.random()*3;objs[i].setAttribute("x_move","");objs[i].setAttribute("y_move","");new Effect.Move(objs[i],{x:x,y:y,duration:duree,mode:'relative'});}}}
function getUniqueId(max){var deb;if(!max)
deb=0;else
deb=(18-max);return((new Date()).getTime()+""+Math.floor(Math.random()*1000000)).substr(deb,18)}
function afficheNbRepInDivByForm(nomFrm,nomDiv){debugLogJS('afficheNbRepInDivByForm');}
function encodeHTML(html){var encodedHtml=escape(html);encodedHtml=encodedHtml.replace(/\//g,"%2F");encodedHtml=encodedHtml.replace(/\?/g,"%3F");encodedHtml=encodedHtml.replace(/=/g,"%3D");encodedHtml=encodedHtml.replace(/&/g,"%26");encodedHtml=encodedHtml.replace(/@/g,"%40");return encodedHtml;}
function getInfoSession(nomvar){var vars="";if(!nomvar)
nomvar="SESSID";var sess=getQueryStringVal("PHPSESSID");tabSess=sess.split("#");sess=tabSess[0];if(sess)
vars+="&"+nomvar+"="+sess;else{vars="";var info=document.cookie;}
return vars;}
function setVarEnSessionAjx(tag,val){debugLogJS('setVarEnSessionAjx');}
function setClassForObj(obj,classe){if(obj){obj.setAttribute("class",classe);obj.setAttribute("className",classe);}}
function setClassForObj_uniqClass(obj,classe){if(obj){var classAvant=obj.getAttribute("class");var objs=$$("."+classe);for(var i=0;i<objs.length;i++)
setClassForObj(objs[i],classAvant);setClassForObj(obj,classe);}}
function getHtmlMessageFromForm(formToTransform){var form=formToTransform.cloneNode(true);form=transformChmpFormToSpan(form);return form.innerHTML;}
function envoiMailByAjaxByForm(nomIdForm,nomIdRetourMsg,transformFormulaire){if(!nomIdRetourMsg){nomIdRetourMsg=nomIdForm;}
var adr="/lib_2/ajax/envoiMail.php";var sending="typeMail=mailContact_DPT";var form=document.getElementById(nomIdForm);if(jQuery('#'+nomIdForm).length>0){jQuery('#'+nomIdForm).find('.LV_validation_message,.LV_valid').remove()
if(jQuery('#'+nomIdForm+' input[name=destinataire]').length>0){sending+='&destinataire='+jQuery('#'+nomIdForm+' input[name=destinataire]').val();sending+='&email='+jQuery('#'+nomIdForm+' input[name=mail]').val();}
if(jQuery('#'+nomIdForm+' input[name=expediteur]').length>0){sending+='&expediteur='+jQuery('#'+nomIdForm+' input[name=expediteur]').val();}
if(jQuery('#'+nomIdForm+' input[name=sujet]').length>0){sending+='&sujet='+jQuery('#'+nomIdForm+' input[name=sujet]').val();sending+='&typeDemande='+jQuery('#'+nomIdForm+' input[name=sujet]').val();}
if(jQuery('#'+nomIdForm+' input[name=enteteMessage]').length>0){sending+='&enteteMessage='+jQuery('#'+nomIdForm+' input[name=enteteMessage]').val();}
if(jQuery('#'+nomIdForm+' input[name=numeroResa]').length>0){sending+='&numeroResa='+jQuery('#'+nomIdForm+' input[name=numeroResa]').val();}
if(jQuery('#'+nomIdForm+' input[name=piedMessage]').length>0){sending+='&piedMessage='+jQuery('#'+nomIdForm+' input[name=piedMessage]').val();}
if(jQuery('#'+nomIdForm+' input[name=msgEnvoiOK]').length>0){sending+='&msgEnvoiOK='+jQuery('#'+nomIdForm+' input[name=msgEnvoiOK]').val();}
if(jQuery('#'+nomIdForm+' input[name=msgEnvoiKO]').length>0){sending+='&msgEnvoiKO='+jQuery('#'+nomIdForm+' input[name=msgEnvoiKO]').val();}
if(jQuery('#'+nomIdForm+' input[name=gestionBR]').length>0){sending+='&gestionBR=1'}
if(jQuery('#'+nomIdForm+' input[name=telephone]').length>0){sending+='&telephone='+jQuery('#'+nomIdForm+' input[name=telephone]').val();}
if(jQuery('#'+nomIdForm+' input[name=siteSource]').length>0){sending+='&siteSource='+jQuery('#'+nomIdForm+' input[name=siteSource]').val();}
sending+="&urlCurr="+document.location;if(transformFormulaire){message=getHtmlMessageFromForm(form);sending+='&gestionBR=1';}else{if(form.message){message=form.message.value;}
if(form.messages){for(var i=0;i<form.messages.length;i++){message+=form.messages[i].value;}}}
sending+="&message="+escape(message);var msgOK=jQuery('#'+nomIdForm+' input[name=msgEnvoiOK]').val();var msgKO=jQuery('#'+nomIdForm+' input[name=msgEnvoiKO]').val();jQuery('#'+nomIdRetourMsg).html("<div id='divMsgEnvoiRetour'><img src='/config_v3/imgs_defaut/roue_grise.gif' /></div>");var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var reponse=xhr_local.responseText;if(reponse=='OK'){jQuery('#'+nomIdRetourMsg).addClass("messageAffiche").find('#divMsgEnvoiRetour').html(msgOK)}else{jQuery('#'+nomIdRetourMsg).addClass("messageAffiche messageErreur").find('#divMsgEnvoiRetour').html(msgKO)}
if(jQuery('#'+nomIdRetourMsg).length>0){jQuery.scrollTo(jQuery('#'+nomIdRetourMsg),500,{offset:-100});}
jQuery('#'+nomIdForm+' *').attr("disabled","disabled");}}
xhr_local.open("POST",adr,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(sending);}}
function envoiMailAmiByAjaxByForm(form){var adr="/lib_2/ajax/envoiMail.php";var typeMail="AMI";var prenom_expediteur=$('prenomDeLaPart').value;var email_expediteur=$('emailDeLaPart').value;var sujet_mail=$('emailObjet').value;var message_mail=$('emailMessage').value;var ami1_mail=$('email1').value;var ami2_mail=$('email2').value;var ami3_mail=$('email3').value;var urlPageCurr=$('div_urlPageCourante').innerHTML;var motcleLien=$('div_messageAvantLien').innerHTML;var msgEnvoiOK=$('div_messageEnvoiOK').innerHTML;var msgEnvoiKO=$('div_messageEnvoiKO').innerHTML;if($('div_listeReferenceSelection')){var lstRefs=$('div_listeReferenceSelection').innerHTML;}
if(ami1_mail.length>0){var xhr_local=creeObjHttpRequest();var sending="&typeMail="+typeMail;sending+="&prenomExpediteur="+escape(prenom_expediteur);sending+="&expediteur="+escape(email_expediteur);sending+="&sujet="+escape(sujet_mail);sending+="&messageMail="+escape(message_mail);sending+="&emailDest1="+escape(ami1_mail);sending+="&emailDest2="+escape(ami2_mail);sending+="&emailDest3="+escape(ami3_mail);sending+="&urlCurr="+escape(urlPageCurr);sending+="&motcleLien="+escape(motcleLien);sending+="&msgEnvoiOK="+escape(msgEnvoiOK);sending+="&msgEnvoiKO="+escape(msgEnvoiKO);if(lstRefs){sending+="&lstRefs="+escape(lstRefs);}
if(jQuery('#inputDateDebEnvoiAmi').length>0){sending+="&dateDeb="+jQuery('#inputDateDebEnvoiAmi').val();sending+="&dateFin="+jQuery('#inputDateFinEnvoiAmi').val();}
if(jQuery('#select_typeCentrale').length>0){sending+="&typeCentrale="+jQuery('#select_typeCentrale').val();}
if(jQuery('#div_saisieInfosClientPourMiniCata').length>0){var tabInfosClient=getInfosClientPourMiniCata();if(jQuery('#email1').length===1){tabInfosClient.e_mail=jQuery('#email1').val();}
sending+="&tabInfosClient="+JSON.stringify(tabInfosClient);}
var code=jQuery('#captcha').val();sending+='&codeSecu='+code;jQuery.ajax({url:adr,type:'POST',data:sending,dataType:'json',success:function(json){traiteRetourVerifCaptcha(json);var divReponse=$('div_messageEnvoiMail');divReponse.innerHTML=unescape(json.msg);divReponse.addClassName("messageAffiche");if($('div_messageEnvoiMailRetour')){$('div_messageEnvoiMailRetour').style.display="block";jQuery.scrollTo(jQuery("#div_messageEnvoiMailRetour"),500,{offset:-100});}
jQuery("#div_sendMailToFriend form *").attr("disabled","disabled");jQuery("#div_envoiAmiSubmit").hide();jQuery(".div_messageIntroForm").hide();}});}}
function getInfosClientPourMiniCata(){var tabInfos={};(function($){tabInfos.civilite=$('#div_saisieInfosClientPourMiniCata select.civilite').val();tabInfos.nom=$('#div_saisieInfosClientPourMiniCata input.nom').val();tabInfos.mdp=$('#div_saisieInfosClientPourMiniCata input.mdp').val();tabInfos.prenom=$('#div_saisieInfosClientPourMiniCata input.prenom').val();tabInfos.adresse1=$('#div_saisieInfosClientPourMiniCata input.adresse1').val();tabInfos.adresse2=$('#div_saisieInfosClientPourMiniCata input.adresse2').val();tabInfos.code_postal=$('#div_saisieInfosClientPourMiniCata input.cp').val();tabInfos.ville=$('#div_saisieInfosClientPourMiniCata input.ville').val();tabInfos.pays=$('#div_saisieInfosClientPourMiniCata input.pays').val();tabInfos.tel1=$('#div_saisieInfosClientPourMiniCata input.teldom').val();tabInfos.tel2=$('#div_saisieInfosClientPourMiniCata input.telbur').val();})(jQuery);return tabInfos;}
function envoiMailContactPropByAjaxByForm(){if(typeof(appelApresContactProp)=='function'){appelApresContactProp();}
var adr="/lib_2/ajax/envoiMail.php";var typeMail="CONTACTPROP";var nomExpediteur=jQuery('#inpt_formPropmailNom').val();var prenomExpediteur=jQuery('#inpt_formPropmailPrenom').val();var email_expediteur=jQuery('#inpt_formPropmailFrom').val();var telExpediteur=jQuery('#inpt_formPropmailTel').val();var emailDest1='';var emailDest2='';var paysExpediteur=jQuery('#select_pays').val()||'';if(jQuery('#emailDest1').length>0){if(jQuery('#emailDest1Condition').length>0){if(jQuery('#emailDest1Condition').is(':checked')){emailDest1=jQuery('#emailDest1').val();}}else{emailDest1=jQuery('#emailDest1').val();}}
if(jQuery('#emailDest2').length>0){emailDest2=jQuery('#emailDest2').val();}
var sujet_mail=$('emailObjet').value;var date_deb;var nb_participant;var nb_participant_enfant;if($('inpt_formPropmailDateDeb')){date_deb=$('inpt_formPropmailDateDeb').value;var date_fin=$('inpt_formPropmailDateFin').value;nb_participant=$('select_formPropmailPers').value;if($('select_formPropmailPersEnfant')){nb_participant_enfant=$('select_formPropmailPersEnfant').value;}}
else{date_deb=$('inpt_formPropmailDate').value;var duree_sej=$('inpt_formPropmailDuree').value;nb_participant=$('inpt_formPropmailPers').value;if($('select_formPropmailPersEnfant')){nb_participant_enfant=$('select_formPropmailPersEnfant').value;}}
var message_mail=$('textarea_formPropMessage').value;var destinataire=jQuery('#div_infosEnvoiMail #destinataire').val();var infoProd=$('div_infosSuppStructure').innerHTML;var numheb='';if($('div_infosSuppStructure')&&$('div_infosSuppStructure').getAttribute('data-numheb')){numheb=$('div_infosSuppStructure').getAttribute('data-numHeb')}
var msgEnvoiOK=$('div_messageEnvoiOK').innerHTML;var msgEnvoiKO=$('div_messageEnvoiKO').innerHTML;if(email_expediteur.length>0){var xhr_local=creeObjHttpRequest();var sending="&typeMail="+typeMail;sending+="&prenomExpediteur="+escape(prenomExpediteur);sending+="&nomExpediteur="+escape(nomExpediteur);sending+="&expediteur="+escape(email_expediteur);sending+="&sujet="+escape(sujet_mail);sending+="&dateDeb="+escape(date_deb);if(date_fin){sending+="&dateFin="+escape(date_fin);}
if(duree_sej){sending+="&dureeSej="+escape(duree_sej);}
sending+="&telExpediteur="+escape(telExpediteur);sending+="&nbParticipant="+escape(nb_participant);sending+="&nbParticipantEnfant="+escape(nb_participant_enfant);sending+="&destinataire="+escape(destinataire);if($('inpt_formSendItToMe').checked)
sending+="&copie="+escape(email_expediteur);sending+="&messageMail="+escape(message_mail);sending+="&infoProd="+escape(infoProd);sending+="&msgEnvoiOK="+escape(msgEnvoiOK);sending+="&msgEnvoiKO="+escape(msgEnvoiKO);if(emailDest1.length>0){sending+="&emailDest1="+escape(emailDest1);}
if(emailDest2.length>0){sending+="&emailDest2="+escape(emailDest2);}
if(numheb){sending+="&numheb="+escape(numheb);}
if(paysExpediteur.length>0){sending+="&paysExpediteur="+escape(paysExpediteur);}
if(jQuery('#inputNomStatTracking').length>0){var stat=jQuery('#inputNomStatTracking').val()||'';if(stat){sending+="&statTracking="+stat+'&ident='+jQuery('#inputIdentPourStat').val();}}
var code=jQuery('#captcha').val();sending+='&codeSecu='+code;jQuery.ajax({url:adr,type:'POST',data:sending,dataType:'json',success:function(json){traiteRetourVerifCaptcha(json);if(jQuery('#div_submitForm').data('trackcategory')){if(jQuery('#div_submitForm').data('datalayer')){dataLayer.push({'Label_Event':jQuery('#div_submitForm').data('tracklabel'),'Categorie_Event':jQuery('#div_submitForm').data('trackcategory'),'event':jQuery('#div_submitForm').data('trackaction')});}else{var _gaq=_gaq||[];try{_gaq.push(['wa._trackEvent',jQuery('#div_submitForm').data('trackcategory'),jQuery('#div_submitForm').data('trackaction'),jQuery('#div_submitForm').data('tracklabel')]);}catch(e){console.log('erreur gaq.push :'+e)}}}
if(jQuery('#inputParamsGTM_criteo',jQuery('#form_envoiMailProp')).length>0&&jQuery('#inputParamsGTM_criteo',jQuery('#form_envoiMailProp')).val().length>0){executeGTM_criteo();}
var divReponse=$('div_messageEnvoiMail');divReponse.innerHTML=unescape(json.msg);divReponse.addClassName("messageAffiche");if($('div_messageEnvoiMailRetour')){$('div_messageEnvoiMailRetour').style.display="block";jQuery.scrollTo(jQuery("#div_messageEnvoiMailRetour"),500,{offset:-100});}
jQuery("#div_sendMailToProp form *").attr("disabled","disabled");jQuery(".div_messageIntroForm").hide();}});var divValid=$("div_submitForm");if(divValid)
divValid.style.display="none";}}
function envoiMailByAjax(dest,exp,cc,sujet,body,nomIdRetourMsg,msgEnvoiOK,msgEnvoiKO,sessid){debugLogJS('envoiMailByAjax');}
function changeChoixPaysFormProp(elem){if(jQuery(elem).val()=="FRANCE"){jQuery("#select_dpt").attr("modecheck","checkChpObligatoire");}
else{jQuery("#select_dpt").attr("modecheck");}}
function unsetCookie(name){var date=new Date();date.setTime(date.getTime()+(-1*24*60*60*1000));setCookie(name,"",date);}
function setCookie(name,value,expires,path,domain,secure){document.cookie=name+'='+escape(value)+
((expires)?'; expires='+expires.toGMTString():'')+
((path)?'; path='+path:'')+((domain)?'; domain='+domain:'')+((secure)?'; secure':'');}
function getCookie(name){if(document.cookie.length>0){var deb=document.cookie.indexOf(name+'=');if(deb!=-1){deb=deb+name.length+1;var fin=document.cookie.indexOf(';',deb);if(fin==-1)
fin=document.cookie.length;return unescape(document.cookie.substring(deb,fin));}}
return'';}
function getNbCookies(chaineAtrouver){if(!chaineAtrouver){chaineAtrouver='__panier_';}
var text=document.cookie;var regex=new RegExp(chaineAtrouver,"g");res=text.match(regex);if(res){return res.length;}else{return 0;}}
function getNbelementDansPanier(){return getNbCookies('__panier_');}
function getExisteUnCookieDeValeur(valeur){if(document.cookie.length>0&&valeur){var chaine=document.cookie.indexOf('='+valeur);if(chaine!=-1){return true}}
return false;}
function getQueryString(){var lDoc=String(document.location);var n1=lDoc.indexOf("?");if(n1<=0)
return"";var n2=lDoc.indexOf("#");if(n2<=0)
n2=lDoc.length;var qs=lDoc.substring(n1+1,n2);return qs;}
function getAncreInQuery(){var lDoc=String(document.location);var n2=lDoc.indexOf("#")+1;var ancre=lDoc.substring(n2);return ancre;}
function getQueryStringVal(lQuery){var lDoc=String(document.location);var lSignet="";var n1=lDoc.indexOf("?");if(n1>0){var n2=lDoc.indexOf("?"+lQuery+"=",n1);if(n2<n1)
n2=lDoc.indexOf("&"+lQuery+"=",n1);if(n2>=n1){n2=n2+("?"+lQuery+"=").length;var n3=lDoc.indexOf("&",n2+1);if(n3>n2)
lSignet=lDoc.substring(n2,n3);else
lSignet=lDoc.substring(n2);}}
return lSignet;}
function getTabValInQueryString(){var loc=String(document.location);var n1=loc.indexOf("?");var tabOut=new Array();if(n1<0)
return tabOut;var qs=loc.substring(n1+1);var vars=qs.split("&");for(var i=0;i<vars.length;i++){tabOut.push(vars[i].split("="));}
return tabOut;}
function getQueryStringByForm(form){var sending="";if(form){var elts=form.elements;for(var i=0;i<elts.length;i++){var elt=elts[i];var param=new String(elt.name).toLowerCase();if(param.length>0&&elt&&elt.value&&elt.value.length>0){switch(elt.type){case"radio":case"checkbox":if(elt.checked)
sending+="&"+param+"="+escape(elt.value);break;default:case"select":sending+="&"+param+"="+escape(elt.value);break;}}}}
return sending;}
function getQueryStringByClassName(classe){var sending="";if(classe){$$('.'+classe).each(function(obj){if(obj.tagName=="SELECT")
sending+="&"+obj.getAttribute("cgi")+"="+obj.value;else
sending+="&"+obj.getAttribute("cgi")+"="+obj.getAttribute("valeur");});}
return sending;}
function desactiveForm(form){var suff=form.id;if(!suff)
suff=form.name;affMsgAttenteParDessusInDiv(form,suff);if(form){var objForm=$(form);var elts=objForm.elements;for(var i=0;i<elts.length;i++)
elts[i].disabled=true;}}
function reactiveForm(form){var suff=form.id;if(!suff)
suff=form.name;effaceMsgAttenteParDessus(suff);if(form){var objForm=$(form);var elts=objForm.elements;for(var i=0;i<elts.length;i++)
elts[i].disabled=false;}}
function scrollToAncre(nomAncre){self.location.hash="#"+nomAncre;}
function bloqueTouche(e){var DisableCtrlKeys=Array(67,86);var ie=window.event;if(ie){e=window.event;}
if(e.ctrlKey){for(i=0;i<DisableCtrlKeys.length;i++){if(e.keyCode==DisableCtrlKeys[i]){if((ie&&e.srcElement.id=='eMailConfirm')||(e.target&&e.target.id=='eMailConfirm')){if(ie){e.keyCode=0;e.returnValue=false;}
return false;}}}}}
document.onkeydown=bloqueTouche;function getValueById(id){return document.getElementById(id).value;}
function setHTMLById(id,html){if(id){var obj=document.getElementById(id);if(obj)
obj.innerHTML=html;else
var stop=1;}}
function controleSaisiePaiementCptCli(form,msgPasNumeroCB,msgPasMoisCB,msgPasAnneeCB,msgPasCryptoCB,msgCarteNonValide){var aujourdhui=new Date();if((isNaN(form.numero_cb.value))||(form.numero_cb.value=='')){alertAMalibu(msgPasNumeroCB);return false;}
if((isNaN(form.mois_cb.value))||(form.mois_cb.value<1)||(form.mois_cb.value>12)||((form.mois_cb.value<(aujourdhui.getMonth()+1))&&(form.annee_cb.value==aujourdhui.getFullYear()))){alertAMalibu(msgPasMoisCB);return false;}
if((isNaN(form.annee_cb.value))||(form.annee_cb.value<aujourdhui.getFullYear())||(form.annee_cb.value>2020)){alertAMalibu(msgPasAnneeCB);return false;}
if((isNaN(form.crypto_cb.value))||(form.crypto_cb.value=='')||(form.crypto_cb.value.length!=3)){alertAMalibu(msgPasCryptoCB);return false;}
verif=0;numcb=form.numero_cb.value;for(i=0;i<numcb.length;i=i+2)
{nomb=numcb.substring(i,i+1)*2;if(nomb>9)
{nomb=nomb-9;}
verif=verif+nomb;}
for(i=1;i<(numcb.length+1);i=i+2)
{nomb=eval(numcb.substring(i,i+1));verif=verif+nomb;}
result=verif%10;if(result!=0)
{alertAMalibu(msgCarteNonValide);return false;}
form.submit();return true;}
function jslog(txt){var nomDivLog="div_itea_log_javascript";var objLog=$(nomDivLog);if(!objLog){objLog=getNewDivToBody(nomDivLog,"logItea");objLog.style.position="fixed";objLog.style.overflow="auto";objLog.style.font="10px arial #000000";objLog.style.zIndex="100000";objLog.style.left="10px";objLog.style.top="10px";objLog.style.width="350px";objLog.style.height="180px";objLog.style.border="2px #000000 solid";objLog.style.backgroundColor="#FFFFFF";new Draggable($(objLog));}
var content=objLog.innerHTML;content+="> "+txt+"<br>";objLog.innerHTML=content;}
function setClassForCurr(obj,classname){$$("."+classname).each(function(elem){elem.removeClassName(classname);});$(obj).addClassName(classname);}
function upload_addFileToList(objInptFile,ulLstFile){var e=new Element('li',{'class':'liFileAUpload'});var elemNomfile=new Element('span',{'class':'spanUploadListNomFile'}).update(objInptFile.value.split("/").pop());var elemForSuppr=new Element('span',{'class':'spanUploadListSuppr'}).update("<img src=/config_v3/imgs_defaut/prop/deconnecter.gif width=10 height=10>");e.insert(elemNomfile,{postion:'bottom'});e.insert(elemForSuppr,{postion:'bottom'});$(ulLstFile).insert(e,{postion:'bottom'});elemForSuppr.observe("click",function(evt){objInptFile.value="";e.remove();});var newInpt=$(objInptFile).cloneNode(true);newInpt.name="inptUploadFile_"+getUniqueId();newInpt.style.display="none";setClassForCurr(newInpt,"inptUploadFile");if(navigator.userAgent.indexOf('Firefox')>-1)
objInptFile.value="";$("divLst_inptsUpload").insert(newInpt);}
function uploadGo(objForm){$(objForm).submit();$$('li.liFileAUpload').each(function(obj){obj.remove();});$$('input.inptUploadFile').each(function(obj){obj.remove();});}
function uploadChoixFile(objForm){var objinptId=$(objForm).select('.inptFileUpload').last().id;document.getElementById(objinptId).select();}
function ajoutMessageIE6(div){if(div){div.style.display='none';var html='';html+='<div id="avertissementTitre">CONSEIL VISITEUR&nbsp;</div>\n';html+='<div id="div_croix_avertissement"><a href="#" ><IMG class=img_navigateur src="/config_v3/imgs_defaut/ie6/close.png"></a></div>\n';html+='<div id="avertissementText">vous utilisez une version obselte dInternet Explorer. Au del des risques de scurit que votre ordinateur encourt, nous vous informons que notre site Internet nest plus optimis pour cette version. Nous vous invitons  mettre  jour au plus vite votre navigateur ou  utiliser ceux prconises :</div>\n';html+='<div id="logoNavigateur"><a href="https://www.google.fr/chrome" target=_blank><IMG class=img_navigateur src="/config_v3/imgs_defaut/ie6/chrome.jpg"></a>&nbsp;<a href="https://www.mozilla.org/fr/firefox/new/" target=_blank><IMG class=img_navigateur src="/config_v3/imgs_defaut/ie6/ff.jpg"></a>&nbsp;<a href="http://www.microsoft.com/france/windows/ie" target=_blank><IMG class=img_navigateur src="/config_v3/imgs_defaut/ie6/ie.jpg"></a></div>\n';document.getElementById(div.getAttribute('id')).innerHTML=html;}}
function verifNavigateur(moduleProp){if($('div_avertissementIE8')){if(getVersionIE()<9){ajoutMessageIE6($('div_avertissementIE8'));if(getVersionIE()==7){document.getElementById('div_avertissementIE8').style.display='block';}else{new Effect.BlindDown('div_avertissementIE8',1);}}}else if($('div_avertissementIE6')){if(getVersionIE()<7){ajoutMessageIE6($('div_avertissementIE6'));new Effect.BlindDown('div_avertissementIE6',1);}}}
function masquerAvertissement(){new Effect.BlindUp('div_avertissementIE6',1);}
function ouvrirFermerDiv(nomDiv){if($(nomDiv).showing==true){Effect.BlindUp(nomDiv);$(nomDiv).showing=false;}
else{Effect.BlindDown(nomDiv);$(nomDiv).showing=true;}}
function afficheBulleAvecDiv(evt,txt,largMax,suffixe){var bulle=document.getElementById("divInfoBulleAvecDiv");if(!bulle)
bulle=getNewDivToBody("divInfoBulleAvecDiv","divInfoBulleAvecDiv");bulle.style.position="absolute";bulle.style.color="#000000";bulle.style.zIndex="10000001";var txt2;txt2="<div class='div_bulle_haut' id='div_bulle_haut_"+suffixe+"'></div>";txt2+="<div class='div_bulle_gauche' id='div_bulle_gauche_"+suffixe+"'></div>";txt2+="<div class='div_bulle_content' id='div_bulle_content_"+suffixe+"'>";txt2+=txt;txt2+="</div>";txt2+="<div class='div_bulle_droite' id='div_bulle_droite_"+suffixe+"'></div>";txt2+="<div class='div_bulle_bas' id='div_bulle_bas_"+suffixe+"'></div>";bulle.innerHTML=unescape(txt2);bulle.style.visibility="visible";setPositionObjBySouris(evt,bulle,15,25);}
function effaceBulleAvecDiv(evt){var bulle=document.getElementById("divInfoBulleAvecDiv");if(bulle)
bulle.style.visibility="hidden";}
function getParamSite(nomParam){switch(nomParam){case"mode_recherche_carte":if($('divParametre_ModeRechercheCarte')){return $('divParametre_ModeRechercheCarte').innerHTML;}
break;case"mode_ouverture_resa":if($('divParametre_ModeAffichageResa')){return $('divParametre_ModeAffichageResa').innerHTML;}
break;}}
function sendThisContentToFriend(){var cmd="envoi2ami";var w=620;var h=500;var titreDiv="Envoyer  un ami";var objet="MSG_FORMAIL_OBJET_MAIL_ENVOI_AMI_CONTENT";var url=document.location.href;var lien="MSG_MESSAGE_ENVOI_LIEN_CONTENT";var message="MSG_CORP_MAIL_ENVOIAMI_CONTENT";sendThisToFriend(cmd,w,h,titreDiv,objet,url,lien,message,"");}
function sendThisToFriend(cmd,w,h,titreDiv,objet,url,lien,message,lstRef){if(getVersionIE()<7)
return false;if(!w||!h){if(getVersionIE()<9){w=parseInt(document.documentElement.clientWidth)*0.9;h=parseInt(document.documentElement.clientHeight)*0.9;}else{w=parseInt(window.innerWidth)*0.9;h=parseInt(window.innerHeight)*0.9;}
if(!w)
w=800;if(!h)
h=600;}
var adr="/lib_2/ajax/contenuFenetre.php";var xhr_local=creeObjHttpRequest();var html_init="<div id='div_sendMailToFriend'><img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br /></div>";afficheDivAvecTransparence(html_init,w,h,null,titreDiv);var sending=getInfoSession()+"&element="+cmd+"&motClesObjetMail="+escape(objet)+"&URL="+url+"&motClesLien="+escape(lien)+"&motClesMessage="+escape(message)+"&lstReference="+lstRef;xhr_local.onreadystatechange=function(){if(xhr_local&&xhr_local.readyState==4){html=xhr_local.responseText;if($('div_sendMailToFriend'))
$('div_sendMailToFriend').innerHTML=html;if(jQuery('#inputDateFinEnvoiAmi').length>0){jQuery('#inputDateDebEnvoiAmi').datepicker({minDate:0,onSelect:function(date){jQuery('#inputDateFinEnvoiAmi').datepicker({minDate:date});}});}
if(jQuery('#select_typeCentrale').length>0){jQuery('#select_typeCentrale').change(function(){var mail=jQuery(this).find('option:selected').attr('data-mail');jQuery('#emailDeLaPart').val(mail);});}
if(jQuery('#div_envoiAmisInfosMiniCata').length>0){jQuery('#div_envoiAmisInfosMiniCata').click(function(){if(jQuery('#div_saisieInfosClientPourMiniCata').is(':visible')){jQuery('#div_saisieInfosClientPourMiniCata').hide();}else{jQuery('#div_saisieInfosClientPourMiniCata').show();}});}
initActionBtnReloadCaptcha();}}
xhr_local.open("POST",adr,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(sending);}
function estIpad(){return navigator.userAgent.match(/iPad/i)!=null;}
function estMobile(){if(navigator.userAgent.match(/(android|iphone|ipad|blackberry|symbian|symbianos|symbos|netfront|model-orange|javaplatform|iemobile|windows phone|samsung|htc|opera mobile|opera mobi|opera mini|presto|huawei|blazer|bolt|doris|fennec|gobrowser|iris|maemo browser|mib|cldc|minimo|semc-browser|skyfire|teashark|teleca|uzard|uzardweb|meego|nokia|bb10|playbook)/gi)){if(((screen.width>=480)&&(screen.height>=800))||((screen.width>=800)&&(screen.height>=480))||navigator.userAgent.match(/ipad/gi)){return false;}else{return true;}}else{return false;}}
function sendThisToProp(ident,w,h,titreDiv,mailALaCentrale,forceQueMailCentrale,dateDeb,dureeSejour,dateFin){if(!mailALaCentrale){mailALaCentrale="N"}
if(!forceQueMailCentrale){forceQueMailCentrale="N";}
if(getVersionIE()<7){return false;}
if(!w||!h){if(getVersionIE()<9){w=parseInt(document.documentElement.clientWidth)*0.9;h=parseInt(document.documentElement.clientHeight)*0.9;}else{w=parseInt(window.innerWidth)*0.9;h=parseInt(window.innerHeight)*0.9;}
if(!w)
w=800;if(!h)
h=600;}
var adr="/lib_2/ajax/contenuFenetre.php";var sending="&element=xhtmlEnvoiProp&ident="+ident+"&mailALaCentrale="+mailALaCentrale+"&forceQueMailCentrale="+forceQueMailCentrale;var html_init="<div id='div_sendMailToProp'><img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br /></div>";afficheDivAvecTransparence(html_init,w,h,null,titreDiv);var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local&&xhr_local.readyState==4){html=xhr_local.responseText;if($('div_sendMailToProp')){$('div_sendMailToProp').innerHTML=html;initFormContactProp(dateDeb,ident,dureeSejour,dateFin);}}}
xhr_local.open("POST",adr,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(sending);}
function initFormContactProp(dateDeb,ident,dureeSejour,dateFin){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);if($(".datepicker").length>0){if(dateDeb){var objDateDeb=new OBJDate(dateDeb);$("#inpt_formPropmailDateDeb").val(objDateDeb.toString());if($("#inpt_formPropmailDateFin").length>0){if(dureeSejour){var objDateFin=new OBJDate(dateDeb);objDateFin.ajoutJour(dureeSejour);$("#inpt_formPropmailDateFin").val(objDateFin.toString());delete objDateFin;}else if(dateFin){$("#inpt_formPropmailDateFin").val(dateFin);}}}
$(".datepicker").datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1,beforeShow:function(){jQuery('#ui-datepicker-div').addClass('notranslate');}});}
$("#inpt_formPropmailDateDeb").datepicker("option","onSelect",function(selectedDate){var dateDebut=new OBJDate(selectedDate);dateDebut.ajoutJour(1);$("#inpt_formPropmailDateFin").datepicker("option","minDate",dateDebut.toString());$('#inpt_formPropmailDateFin').datepicker("setDate",dateDebut.toString());delete dateDebut;setTimeout(function(){$('#inpt_formPropmailDateFin').focus();},0);});$("#inpt_formPropmailDateFin").datepicker("option","onSelect",function(selectedDate){var dateFin=new OBJDate(selectedDate);var dateDebut=new OBJDate($("#inpt_formPropmailDateDeb").val());verifDureMiniSejour(ident,dateDebut.toString(),dateFin.getNbJourEcartWithOBJDate(dateDebut),$('#inpt_formPropmailDateFin'));delete dateFin;delete dateDebut;});if(objDateDeb){if(dureeSejour){verifDureMiniSejour(ident,dateDeb,dureeSejour,$('#inpt_formPropmailDateDeb'))}
if($("#inpt_formPropmailDateFin")){objDateDeb.ajoutJour(1);$("#inpt_formPropmailDateFin").datepicker("option","minDate",objDateDeb.toString());}}
initActionBtnReloadCaptcha();})(jQuery);}
function initActionBtnReloadCaptcha(){(function($){$('#sp_btnReload').click(function(){var date=new Date();var time=date.getTime();var srcCaptcha=$('#span_captchaImg img').attr('src');var pos=srcCaptcha.indexOf('?time');if(pos!=-1){srcCaptcha=srcCaptcha.substr(0,pos);}
srcCaptcha+='?time='+time;$('#span_captchaImg img').attr('src',srcCaptcha);});})(jQuery);}
function verifDureMiniSejour(ident,dateDebutString,dureeSejour,elementPourInsertionAfter){(function($){$('#div_dateFin .commentaire_restrictions').html('');$('.commentaireRestrictionDureePourFormulaireProp').remove();jQuery.ajax({type:"POST",url:"/lib_2/ajax/contenuFenetre.php",data:{dateDebut:dateDebutString,element:'elemObjProd',typeInfo:'getDureeMiniMaxiByDate-'+ident+'-'+dateDebutString},success:function(retour){eval("var tabRetour="+retour);if(tabRetour.mini<=dureeSejour){return;}
if(elementPourInsertionAfter){var message='<p class="commentaire_restrictions commentaireRestrictionDureePourFormulaireProp">'+$('#div_dateFin').attr('data-avant')+' '+tabRetour.mini+' '+$('#div_dateFin').attr('data-apres')+'</p>';$(elementPourInsertionAfter.parents('div')[0]).after(message);return;}
$('#div_dateFin').append('<span class="commentaire_restrictions">'+$('#div_dateFin').attr('data-avant')+' '+tabRetour.mini+' '+$('#div_dateFin').attr('data-apres')+'</span>');$('#div_dateFin .commentaire_restrictions').dialog({modal:true,zIndex:1000005,minWidth:400,title:$('#div_dateFin').attr('data-titre'),buttons:[{text:'ok',click:function(){$(this).dialog('close');}}]});}});})(jQuery);}
function verifEtEnvoiMailAmi(){var i=0;(function($){var langue=$("body").attr("data-langue");var mailClient=new LiveValidation("emailDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailClient,langue,true);var mailAmi1=new LiveValidation("email1",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailAmi1,langue,true);var mailAmi2=new LiveValidation("email2",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailAmi2,langue,false);var mailAmi3=new LiveValidation("email3",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailAmi3,langue,false);var codeSecu=new LiveValidation("captcha",{validMessage:"Ok",onlyOnSubmit:true});var messErrorCodeSecu='Code incorrect';if(langue=="FRANCAIS"){if(!$('#prenomDeLaPart').hasClass('optionnel')){var prenomClient=new LiveValidation("prenomDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});prenomClient.add(Validate.Presence,{failureMessage:"Champ obligatoire"});}
var message=new LiveValidation("emailMessage",{validMessage:"Ok",onlyOnSubmit:true});message.add(Validate.Presence,{failureMessage:"Champ obligatoire"});codeSecu.add(Validate.Presence,{failureMessage:"Champ obligatoire"});}else{if(!$('#prenomDeLaPart').hasClass('optionnel')){var prenomClient=new LiveValidation("prenomDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});prenomClient.add(Validate.Presence,{failureMessage:"Required field"});}
var message=new LiveValidation("emailMessage",{validMessage:"Ok",onlyOnSubmit:true});message.add(Validate.Presence,{failureMessage:"Required field"});codeSecu.add(Validate.Presence,{failureMessage:"Required field"});messErrorCodeSecu='Incorrect code';}
codeSecu.add(Validate.Custom,{against:function(value){var check=true;$.ajax({type:'POST',url:'/lib_2/ajax/infosDist.php',async:false,data:{info:'checkCodeSecu',val:value},dataType:'json',success:function(retour){check=traiteRetourVerifCaptcha(retour);}});return check;},failureMessage:messErrorCodeSecu});var tabAValider=new Array(mailClient,mailAmi1,mailAmi2,mailAmi3,message,codeSecu);if(!$('#prenomDeLaPart').hasClass('optionnel')){tabAValider.push(prenomClient);}
LiveValidation.massValidate(tabAValider);if($(".LV_invalid").length==0){envoiMailAmiByAjaxByForm();}})(jQuery);}
function reinitValueDefautInput(){jQuery("input[data-defaut]").each(function(){if(jQuery(this).hasClass("chpInptErreurDetecte")){jQuery(this).val(jQuery(this).attr("data-defaut"));}});}
function verifEtEnvoiMailContactProp(tracking){var track=tracking||false;if(track){window.trackingContactProp=true;}
if($('form_envoiMailProp')){var form=$('form_envoiMailProp');checkForm(form,envoiMailContactPropByAjaxByForm,erreurEnvoiMailContactProp);}}
function erreurEnvoiMailContactProp(){jQuery.scrollTo("#form_envoiMailProp",500,{offset:-20});}
function ouvreCalDeb(){(function($){$("#inpt_formPropmailDateDeb").datepicker({minDate:0});})(jQuery);}
function verifEtEnvoiMailContactProp_2(){(function($){$("#form_envoiMailProp select").focus(function(){$(this).siblings(".LV_validation_message").remove();});var tel=$('#inpt_formPropmailTel').val();$('#inpt_formPropmailTel').val(tel.replace(/ /g,''));var langue=$("body").attr("data-langue");var tabMessages=getTabMessagesValidationFormulaireByLangue(langue);var email=new LiveValidation("inpt_formPropmailFrom",{validMessage:tabMessages.valid,onlyOnSubmit:true});addValidateOnLiveValidationEmail(email,langue,true);var nom=new LiveValidation("inpt_formPropmailNom",{validMessage:tabMessages.valid,onlyOnSubmit:true});nom.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});var tel=new LiveValidation("inpt_formPropmailTel",{validMessage:tabMessages.valid,onlyOnSubmit:true});tel.add(Validate.Format,{pattern:/^[0-9]{6,}$/,failureMessage:tabMessages.tel});var dateDeb=new LiveValidation("inpt_formPropmailDateDeb",{validMessage:tabMessages.valid,onlyOnSubmit:true});dateDeb.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});dateDeb.add(Validate.Format,{pattern:/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/,failureMessage:tabMessages.dates});var dateFin=new LiveValidation("inpt_formPropmailDateFin",{validMessage:tabMessages.valid,onlyOnSubmit:true});dateFin.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});dateFin.add(Validate.Format,{pattern:/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/,failureMessage:tabMessages.dates});var msg=new LiveValidation("textarea_formPropMessage",{validMessage:tabMessages.valid,onlyOnSubmit:true});msg.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});var tabAValider=new Array(email,nom,tel,dateDeb,dateFin,msg);if($('#captcha').length>0){tabAValider.push(getLiveValidationCaptcha());}
LiveValidation.massValidate(tabAValider);var xhtml="";$("#div_pays span").remove(".LV_validation_message");if($("#select_pays").val()!="0")
xhtml="<span class='LV_validation_message LV_valid'>Ok</span>";else{if(langue=="FRANCAIS")
xhtml="<span class='LV_validation_message LV_invalid'>Champ obligatoire</span>";else
xhtml="<span class='LV_validation_message LV_invalid'>Required field</span>";}
$("#div_pays").append(xhtml);xhtml="";if($("#select_dpt:visible").length>0){$("#div_dpt span").remove(".LV_validation_message");if($("#select_dpt").val()!="0")
xhtml="<span class='LV_validation_message LV_valid'>Ok</span>";else{if(langue=="FRANCAIS")
xhtml="<span class='LV_validation_message LV_invalid'>Champ obligatoire</span>";else
xhtml="<span class='LV_validation_message LV_invalid'>Required field</span>";}
$("#div_dpt").append(xhtml);xhtml="";}
$("#div_nbPers span").remove(".LV_validation_message");if(($("#select_formPropmailPers").attr('data-obligatoire')==='0')||($("#select_formPropmailPers").val()!="0"&&$("#select_formPropmailPers").val()!="")){xhtml="<span class='LV_validation_message LV_valid'>Ok</span>";}else{if(langue=="FRANCAIS"){xhtml="<span class='LV_validation_message LV_invalid'>Champ obligatoire</span>";}else{xhtml="<span class='LV_validation_message LV_invalid'>Required field</span>";}}
$("#div_nbPers").append(xhtml);xhtml="";if($(".LV_invalid",'#form_envoiMailProp').length==0){envoiMailContactPropByAjaxByForm();if(window.foncQdFini_envoiFormContact){foncQdFini_envoiFormContact();}
if($('#apresEnvoiMail_GAEVENT').length>0){$('#apresEnvoiMail_GAEVENT').trigger('click');}}else{if(typeof(dataLayer)!='undefined'){dataLayer.push({'form_error':true,'event':'form_error'});var champsInvalides='';$('.LV_invalid_field').each(function(){champsInvalides+=$(this).attr('name')+', ';});champsInvalides=champsInvalides.substring(0,champsInvalides.length-2);dataLayer.push({'form_error_field':champsInvalides,'event':'form_error'});}}})(jQuery);}
function verifPaysEtAfficheDpt(pays){(function($){if(pays.value=="FRANCE"){$("#div_dpt").show();$("#select_dpt").attr("modecheck","checkChpObligatoire");}
else{$("#div_dpt").hide();$("#select_dpt").attr("modecheck","");}
if(pays.value!=""){pays.removeClassName("chpInptErreurDetecte")}})(jQuery);}
function verifChoixDepartementFormProp(elem){if(jQuery(elem).val()!=""){jQuery(elem).removeClass("chpInptErreurDetecte").addClass("chpInptAucuneErreur");}
else{jQuery(elem).removeClass("chpInptAucuneErreur").addClass("chpInptErreurDetecte");}}
function estSurPanier(){return jQuery("#divParametre_TypePage").html();}
function initFiche(){initAlbumPhotoJquery();initAlbumPhoto_owlCarousel();initLinkPlanFancyBox();initLinkVideoFancyBox();initLinkLanceAlbumPhotoFancyBox();initAfficheDetailPieceFancyBox();initLinkLanceAlbumPhotoListeFancyBox();initCalendrierAvecTarifs();initChoixTypeTarifMini();initTarifs_gereAffichageColonne();init_sliderMobile();init_flagsTraductions();init_selectDatePourResa();init_avisClients();init_afficheMsqueDispoUneChambre();init_afficheNumeroTelProprio();init_btnAfficheNumeroTel();init_affichePlusPromotions();initBtDescPlusMoins();initAvisClientAfnor();initDesctiveScrollGmapIframe();reinitOnYouTubeIframeAPIReady();if(typeof leaflet_initMapFiche==='function'){leaflet_initMapFiche();}
initCarouselDatesGestprod();initGestionPanier();initEventQTipInfoCalculTaxeSejour();initSejoursAlternatifs();jQuery(window).resize(function(){initBtDescPlusMoins();});}
function initDesctiveScrollGmapIframe(){jQuery('.div_itea_GMAP').click(function(){jQuery(this).find('iframe').addClass('clicked')});jQuery('.div_itea_GMAP').mouseleave(function(){jQuery(this).find('iframe').removeClass('clicked')});}
function init_affichePlusPromotions(){(function($){$(".a_promoEnSavoirPlus").click(function(){var promo="#"+$(this).attr("data-rel");var lblPlus=$(this).attr("data-lblPlus");var lblMoins=$(this).attr("data-lblMoins");if($(promo).hasClass("closed")){$(promo).addClass("opened").removeClass("closed");$(this).html(lblMoins);}
else{$(promo).addClass("closed").removeClass("opened");$(this).html(lblPlus);}});})(jQuery);}
function init_afficheNumeroTelProprio(){jQuery(".sp_telPropByClick").click(function(){jQuery(this).find(".sp_telPropByClick_lbl").hide();jQuery(this).find(".sp_telPropByClick_numero").show();if(window.initClickAfficherNumeroProprio){initClickAfficherNumeroProprio();}});}
function init_btnAfficheNumeroTel(){jQuery(".sp_telByClick").click(function(){jQuery(this).find(".sp_telByClick_lbl").hide();jQuery(this).find(".sp_telByClick_numero").show();if(window.initClickAfficherNumeroTel){initClickAfficherNumeroTel();}});}
function init_selectDatePourResa(){if(jQuery('#select_dateSejour.select_ficheDatesDisposV5').length>0){jQuery('#select_dateSejour.select_ficheDatesDisposV5').bind('change selectmenuchange',function(){jQuery(this).parent().children('input[name="jour"]').attr('value',jQuery(this).children('option:selected').data('jour'));jQuery(this).parent().children('input[name="mois"]').attr('value',jQuery(this).children('option:selected').data('mois'));jQuery(this).parent().children('input[name="annee"]').attr('value',jQuery(this).children('option:selected').data('annee'));jQuery(this).parent().children('input[name="nbj"]').attr('value',jQuery(this).children('option:selected').data('nbj'));});}}
function initListe(){initLinkLanceAlbumPhotoListeFancyBox();initChoixTarifsNDate();init_sliderMobile();init_affichage_ajout_panier();if(typeof leaflet_initMapListe==='function'){leaflet_loadLeafletAssets('getParamsGoogleMap','classique');}
if(typeof foncQdFini_initListe==='function'){foncQdFini_initListe();}}
function initPageStorage(tabJson){(function($){if(tabJson){var value;var body=$('body')[0];for(var key in tabJson){value=tabJson[key];$.data(body,key,value)}}})(jQuery);}
function init_avisClients(){(function($){if($(".boutonMoreAvisClients").length>0){$(".boutonMoreAvisClients").click(function(){var divParent='#'+$(this).attr("data-div-rel");if($(".boutonMoreAvisClients.afficheCinq").length>0){var count=0;$(divParent).find(".avisMasque").each(function(){count++;$(this).fadeIn();$(this).removeClass('avisMasque');if(count>=5){return false;}});if($(divParent).find(".avisMasque").length==0){$(".boutonMoreAvisClients.afficheCinq").hide();}
else{$(".boutonMoreAvisClients").off("click");init_avisClients();}
if(foncQdFini_afficheAvisClient){foncQdFini_afficheAvisClient();}}
else{if($(this).hasClass("afficheAvis")){$(divParent).find(".avisMasque").fadeIn();$(this).text($(this).attr("data-lblAfficheMoins"));$(this).removeClass("afficheAvis");if(foncQdFini_afficheAvisClient){foncQdFini_afficheAvisClient();}}
else{$(divParent).find(".avisMasque").hide();$(this).addClass("afficheAvis");$(this).text($(this).attr("data-lblAffichePlus"));if(foncQdFini_masqueAvisClient){foncQdFini_masqueAvisClient();}}}});}
$(".ul_avisRecapNotes li.filtrable").each(function(){$(this).click(function(){var note=$(this).attr("data-note");$('.div_avisClientDetail').hide();$('.div_avisClientDetail[data-note="'+note+'"]').fadeIn();$(".div_afficheAvisSuppl").hide();$(".div_avisPhraseRecapNb").show();$(".p_phraseRecapNote").hide();$('.p_phraseRecapNote[data-note="'+note+'"]').show();})});$(".a_avisClientsVoirTous").click(function(){$('.div_avisClientDetail').fadeIn();$(".div_avisPhraseRecapNb").hide();});$(".descriptionAvis_afficheSuite").click(function(){var idTexteComm=$(this).attr("data-idCommentaireAvis");$(".descriptionAvis_suite[data-idCommentaireAvis='"+idTexteComm+"']").hide();$(".descriptionAvis_2[data-idCommentaireAvis='"+idTexteComm+"']").show();$(this).hide();})})(jQuery);}
function initLinkPlanFancyBox(){(function($){if($(".a_linkPlanFancyBox").length>0){$(".a_linkPlanFancyBox").fancybox({maxWidth:800,maxHeight:600,fitToView:true,width:'70%',height:'70%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});}})(jQuery);}
function initAfficheDetailPieceFancyBox(){(function($){if($(".a_linkDetailPieceFancyBox").length>0){$(".a_linkDetailPieceFancyBox").fancybox({maxWidth:800,maxHeight:600,fitToView:true,width:'70%',height:'70%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});}})(jQuery);}
function initLinkVideoFancyBox(){(function($){if($(".a_linkYoutubeFancyBox").length>0){$(".a_linkYoutubeFancyBox").fancybox({maxWidth:800,maxHeight:600,fitToView:true,width:'70%',height:'70%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});}})(jQuery);(function($){if($(".a_linkDailymotionFancyBox").length>0){$(".a_linkDailymotionFancyBox").fancybox({maxWidth:800,maxHeight:600,fitToView:true,width:'70%',height:'70%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});}})(jQuery);}
function initLinkLanceAlbumPhotoFancyBox(){if(jQuery("#a_fiche_lien_album").length>0){var tabImgs=new Array();tabImgs[0]=jQuery("#img_fiche_photoPrincipale").attr("src");jQuery("#a_fiche_lien_album").bind("click",function(){jQuery(".img_album").each(function(i){tabImgs[i+1]=jQuery(this).attr("src");});jQuery.fancybox(tabImgs);});}}
function initLinkLanceAlbumPhotoListeFancyBox(){if(jQuery(".a_lst_lien_disporama").length>0){jQuery(".a_lst_lien_disporama").bind("click",function(){var lstImages=jQuery(this).attr("data-tabPhotos");var lstLegendes=jQuery(this).attr("data-tabLegendes");var position=jQuery(this).data('position');tabImgs=lstImages.split(";");tabLegendes=JSON.parse(lstLegendes);tabTout=new Array();for(var i=0;i<tabImgs.length;i++){var obj={href:tabImgs[i],title:tabLegendes[i]}
tabTout.push(obj)}
var autoPlay=false;if(jQuery(this).attr('data-autoplay')=='1'){autoPlay=true;}
if(jQuery(this).attr('data-thumbs')=='1'){jQuery.fancybox(tabTout,{prevEffect:'fade',nextEffect:'fade',autoPlay:autoPlay,index:position,helpers:{thumbs:{width:135,height:75}}});}else{jQuery.fancybox(tabTout,{prevEffect:'fade',nextEffect:'fade',autoPlay:autoPlay,index:position});}});}}
function completeVilleAvecCP2(ville,cp,pays){(function($){if($("#"+pays).val()=="FRANCE"){if($("#div_listeVillesByCP").length>0)
$("#div_listeVillesByCP").hide();$.ajax({type:"POST",url:"/lib_2/ajax/infosDist.php",data:{info:"getVilleByCP",cp:$("#"+cp).val(),limit:46},beforeSend:function(){},success:function(result){if(result===''){return false;}
eval("var tabResult = "+result);var commune='';if(tabResult.length==1){commune=tabResult[0].commune;$("#"+ville).val(commune.trim());}
else if(tabResult.length>1){var html="";html+="<ul class='ul_listeVilles'>";for(var i=0;i<tabResult.length;i++){html+="<li class='li_listeVilles'>";commune=tabResult[i].commune;html+=commune.trim();html+="</li>";}
html+="</ul>";if($("#div_listeVillesByCP").length>0){$("#div_listeVillesByCP").html(html);$("#div_listeVillesByCP").show();}
else{html="<div id='div_listeVillesByCP'>"+html+"</div>";$("#"+ville).parent().append(html);}
$(".li_listeVilles").each(function(){$(this).click(function(){$("#"+ville).val($(this).text());$("#"+ville).blur();$("#div_listeVillesByCP").hide();});});}}});}})(jQuery);}
function initChoixTypeTarifMini(){if(jQuery(".select_choixTypeSejourPourPrix").length>0){jQuery(".select_choixTypeSejourPourPrix").change(function(){jQuery(this).parents(".div_prixParTypeSejourContent").find(".sp_tarifMinTypeSejour").hide();jQuery(this).parents(".div_prixParTypeSejourContent").find(".sp_tarifMinTypeSejour[data-type="+jQuery(this).val()+"]").show();if(jQuery(this).parents(".div_prixParTypeSejourContent").find(".sp_apresTarifMinTypeSejour").length>0){jQuery(this).parents(".div_prixParTypeSejourContent").find(".sp_apresTarifMinTypeSejour").hide();jQuery(this).parents(".div_prixParTypeSejourContent").find(".sp_apresTarifMinTypeSejour[data-type="+jQuery(this).val()+"]").show();}});}}
function initCalendrierAvecTarifs(){(function($){if($('.calendIteaTarifsSemaine_listMois').length>0){$('.calendIteaTarifsSemaine_listMois').each(function(){var nombreDeSlidesADecaler=3;if($(this).attr('data-nombreDeSlidesADecaler'))
nombreDeSlidesADecaler=$(this).attr('data-nombreDeSlidesADecaler');var sudoSliderTarifsSemaines=$(this).sudoSlider({prevNext:true,speed:0,moveCount:nombreDeSlidesADecaler,nextHtml:'<a class="nextBtn">&gt;</a>',prevHtml:'<a class="prevBtn">&lt;</a>'});});}})(jQuery);}
function initCalendrierDisposGP(){(function($){initSliderCalendrier();if($('.div_disposProd').length>0){$('.div_disposProd table.tableDisposProdOneMonth').each(function(){$('.spanCalendJourGP_libreArriveePossible, .spanDateSejourDevisArriveePossible',this).click(function(){var lien=$(this).attr('data-lienResa');if(lien.length>0){window.open(lien,"blank");}});});}})(jQuery);}
function initSliderCalendrier(){(function($){if($('.div_disposProd').length>0){$('.div_disposProd').each(function(){var nombreDeSlidesADecaler=1;if($(this).attr('data-nombreDeSlidesADecaler'))
nombreDeSlidesADecaler=$(this).attr('data-nombreDeSlidesADecaler');var sudoSlider=$(this).sudoSlider({customLink:$('.btnDispoProdMoisSuivPrec'),prevNext:false,speed:0,moveCount:nombreDeSlidesADecaler});});}})(jQuery);}
function initSliderCalendrierParSemaine(){(function($){if($('.calendIteaTarifsSemaine_listMois').length>0){$('.calendIteaTarifsSemaine_listMois').each(function(){var nombreDeSlidesADecaler=3;if($(this).attr('data-nombreDeSlidesADecaler'))
nombreDeSlidesADecaler=$(this).attr('data-nombreDeSlidesADecaler');var sudoSlider=$(this).sudoSlider({prevNext:false,speed:0,moveCount:nombreDeSlidesADecaler,nextHtml:'<a class="nextBtn">></span>',prevHtml:'<a class="prevBtn"><</span>'});});}})(jQuery);}
function initCalendrierAnnuelGP(){(function($){initCalendrierDisposGP();$.fn.qtip.zindex=1000001;$('.div_disposProdAnnee table.tableDisposProdOneMonth').each(function(){$('.spanCalendJourGP_libreArriveePossible, .spanDateSejourDevisArriveePossible, .spanCalendJourGP_libre',this).qtip({content:{text:false},style:{classes:'jgrowl ui-tooltip-blue ui-tooltip-rounded',zindex:9999999}});});})(jQuery);}
function initWidgetResaGP(){(function($){initSliderCalendrier();if($('.div_disposProd').length>0){$('.div_disposProd table.tableDisposProdOneMonth').each(function(){$('.spanCalendJourGP_libreArriveePossible, .spanDateSejourDevisArriveePossible',this).click(function(){if($(this).hasClass('DatePassee')){}
else{var lien=$('#input_DomainResaDefaut').attr('value')+$(this).attr('data-lienResa');if($('#itea_widget_resa_annee').length>0){var tabInfos=lien.split('&');var length=tabInfos.length;for(var i=0;i<length;i++){switch(tabInfos[i].substring(0,4)){case'jour':var cleVal=tabInfos[i].split('=');var jour=parseInt(cleVal[1],10);$('#itea_widget_resa_jour > option').removeAttr("selected");$('#itea_widget_resa_jour > option[value="'+jour+'"]').attr("selected","selected");break;case'mois':var cleVal=tabInfos[i].split('=');var mois=parseInt(cleVal[1],10);$('#itea_widget_resa_mois > option').removeAttr("selected");$('#itea_widget_resa_mois > option[value="'+mois+'"]').attr("selected","selected");break;case'anne':var cleVal=tabInfos[i].split('=');var annee=cleVal[1];$('#itea_widget_resa_annee > option').removeAttr("selected");$('#itea_widget_resa_annee > option[value="'+annee+'"]').attr("selected","selected");break;}}}
$('table.tableDisposProdOneMonth .spanCalendJourarriveeSelected').removeClass('spanCalendJourarriveeSelected');$(this).addClass('spanCalendJourarriveeSelected');if(lien.length>0){if($('#a_itea_widget_resa_valid').length>0){var ope="";if($("#input_OPE").length>0){ope=$("#input_OPE").val();if(ope.length>0){lien+="&ope="+ope;}}
lien+='&widget=1';if($('#itea_widget_resa_duree').length>0)
lien+='&duree='+$('#itea_widget_resa_duree option[selected="selected"]').val();$('#a_itea_widget_resa_valid').attr('href',lien);}}}});$('.spanCalendJourGP_libreArriveePossible.right, .spanDateSejourDevisArriveePossible.right, .spanCalendJourGP_libre.right',this).qtip({content:{text:false},style:{classes:'jgrowl ui-tooltip-blue ui-tooltip-rounded'},position:{my:'top right'}});$('.spanCalendJourGP_libreArriveePossible.left, .spanDateSejourDevisArriveePossible.left, .spanCalendJourGP_libre.left',this).qtip({content:{text:false},style:{classes:'jgrowl ui-tooltip-blue ui-tooltip-rounded'},position:{my:'top left'}});});}
if($('#itea_widget_resa_annee').length>0){$('#itea_widget_resa_annee > option, #itea_widget_resa_jour > option, #itea_widget_resa_mois > option').click(function(){switch($(this).parent().attr('id')){case'itea_widget_resa_annee':$('#itea_widget_resa_annee > option').removeAttr('selected');break;case'itea_widget_resa_jour':$('#itea_widget_resa_jour > option').removeAttr('selected');break;case'itea_widget_resa_mois':$('#itea_widget_resa_mois > option').removeAttr('selected');break;}
$(this).attr('selected','selected');var link=$('#input_DomainResaDefaut').attr('value')+$('#input_linkResaDefaut').val();if($('#itea_widget_resa_jour option[selected="selected"]').val())
link+='&jour='+$('#itea_widget_resa_jour option[selected="selected"]').val();if($('#itea_widget_resa_mois option[selected="selected"]').val())
link+='&mois='+$('#itea_widget_resa_mois option[selected="selected"]').val();if($('#itea_widget_resa_annee option[selected="selected"]').val())
link+='&annee='+$('#itea_widget_resa_annee option[selected="selected"]').val();if($('#itea_widget_resa_duree').length>0)
link+='&duree='+$('#itea_widget_resa_duree option[selected="selected"]').val();var ope="";if($("#input_OPE").length>0){ope=$("#input_OPE").val();if(ope.length>0){link+="&ope="+ope;}}
link+='&widget=1';$('#a_itea_widget_resa_valid').attr('href',link);});}
if($('#itea_widget_resa_duree').length>0){$('#itea_widget_resa_duree > option').click(function(){$('#itea_widget_resa_duree > option').removeAttr('selected');$(this).attr('selected','selected');var link=$('#input_DomainResaDefaut').attr('value')+$('#input_linkResaDefaut').val();if($('#itea_widget_resa_jour option[selected="selected"]').val())
link+='&jour='+$('#itea_widget_resa_jour option[selected="selected"]').val();if($('#itea_widget_resa_mois option[selected="selected"]').val())
link+='&mois='+$('#itea_widget_resa_mois option[selected="selected"]').val();if($('#itea_widget_resa_annee option[selected="selected"]').val())
link+='&annee='+$('#itea_widget_resa_annee option[selected="selected"]').val();if($('#itea_widget_resa_duree').length>0)
link+='&duree='+$('#itea_widget_resa_duree option[selected="selected"]').val();var ope="";if($("#input_OPE").length>0){ope=$("#input_OPE").val();if(ope.length>0){link+="&ope="+ope;}}
link+='&widget=1';$('#a_itea_widget_resa_valid').attr('href',link);});}
if($('#select_dateSejour').length>0){var dispos=$('#select_dateSejour').attr('value');if($('#select_dateSejour').hasClass('select_ficheDatesDisposV5')){dispos=$('#select_dateSejour').find(':selected').attr('data-jour')+'/'+$('#select_dateSejour').find(':selected').attr('data-mois')+'/'+$('#select_dateSejour').find(':selected').attr('data-annee');}
var lienpardefaut=$('#input_DomainResaDefaut').attr('value')+$('#input_linkResaDefaut').attr('value')+'&DISPOS='+dispos;$('#a_itea_widget_resa_valid').attr('href',lienpardefaut);$('#select_dateSejour').change(function(){var value=$(this).attr('value');if($(this).hasClass('select_ficheDatesDisposV5')){value=$(this).find(':selected').attr('data-jour')+'/'+$(this).find(':selected').attr('data-mois')+'/'+$(this).find(':selected').attr('data-annee');}
var href=$('#input_DomainResaDefaut').attr('value')+$('#input_linkResaDefaut').attr('value')+'&DISPOS='+value;var ope="";if($("#input_OPE").length>0){ope=$("#input_OPE").val();if(ope.length>0){href+="&ope="+ope;}}
$('#a_itea_widget_resa_valid').attr('href',href);});}})(jQuery);}
function checkAllMotsCle(){(function($){$("#checkboxValideAll").click(function(){var checked=$(this).attr('checked');if(checked=='checked'){$('.inputMotCleAModifier').attr('checked',true);}
else{$('.inputMotCleAModifier').attr('checked',false);}});})(jQuery);}
function lancementStat(){(function($){$("[class*='iteaStatMe_']").click(setStatToElement);})(jQuery);}
function setStatToElement(elem){(function($){elem=elem.currentTarget;var classes=$(elem).attr('class');var tabClass=classes.split(' ');var typeStat='';for(var i=0;i<tabClass.length;i++){if(tabClass[i].substring(0,11)=='iteaStatMe_'){typeStat=tabClass[i].substring(11);}}
var ident=$(elem).attr('data-ident');if(ident!=undefined&&ident.length>0&&typeStat.length>0){trackMe(ident,typeStat,'1');}})(jQuery);}
function getNumSemaine(aaaa,mm,jj)
{var MaDate=new Date(aaaa,mm,jj);var annee=MaDate.getFullYear();var NumSemaine=0;ListeMois=new Array(31,28,31,30,31,30,31,31,30,31,30,31);if(annee%4==0&&annee%100!=0||annee%400==0){ListeMois[1]=29;}
var TotalJour=0;for(cpt=0;cpt<(mm-1);cpt++){TotalJour+=ListeMois[cpt];}
TotalJour+=jj;DebutAn=new Date(annee,0,1);var JourDebutAn;JourDebutAn=DebutAn.getDay();if(JourDebutAn==0){JourDebutAn=7;}
TotalJour-=8-JourDebutAn;NumSemaine=1;NumSemaine+=Math.floor(TotalJour/7);if(TotalJour%7!=0){NumSemaine+=1;}
return(NumSemaine);}
function XMLToArray(xmlDoc,numericalKeyName){var nameNumeric=numericalKeyName||'item';var thisArray=new Array();if(jQuery(xmlDoc).children().length>0){jQuery(xmlDoc).children().each(function(){var nameOfTheNode=this.nodeName;if(this.nodeName==nameNumeric){nameOfTheNode=jQuery(this).attr('tag');}
if(jQuery(this).children().length>0){var NextNode=jQuery(this);thisArray[nameOfTheNode]=XMLToArray(NextNode,nameNumeric);}else{thisArray[nameOfTheNode]=jQuery(this).text();}});}
if(thisArray['ROOT']!=undefined){return thisArray['ROOT'];}
return thisArray;}
function initAfficheMasqueTexteEntetePage(){(function($){if($('.introLimit').length>0){var compteurTexteMax=$('.introLimit').attr('data-limitTexte');var texteEtude='';$.each($('.introLimit div,.introLimit p,.introLimit li,.introLimit h3'),function(){if(compteurTexteMax<0){$(this).addClass('hidePlus')}else if($(this).children('div').length==0&&$(this).children('li').length==0&&$(this).children('p').length==0){texteEtude=$.trim($(this).text());compteurTexteMax-=texteEtude.length;if(compteurTexteMax<0){var size=texteEtude.length+compteurTexteMax;var texteFinal=texteEtude.substr(0,size);var texteFinalCache=texteEtude.substr(size);var htmlTextCourt=texteFinal+'<span class="hideMoins">...'
if($('.introLimit').attr('data-lblPlus').length>0){htmlTextCourt+='<a href="javascript:void(0);" class="a_enteteTexteAfficheSuite a_enteteTexteAfficheSuiteTheme" data-show="1" >'+$('.introLimit').attr('data-lblPlus')+'</a>';}
htmlTextCourt+='</span>'
htmlTextCourt+='<span class="hidePlus">'+texteFinalCache+'</span>';$(this).html(htmlTextCourt)
$(this).find('.hidePlus').hide();}}})
if($('.introLimit').find('.hidePlus')){if($('.introLimit').attr('data-lblMoins').length>0){$('.introLimit').append('<a href="javascript:void(0);" class="a_enteteTexteAfficheSuite a_enteteTexteAfficheSuiteTheme hidePlus" data-show="0" >'+$('.introLimit').attr('data-lblMoins')+'</a>');$('.introLimit .hidePlus').hide();}
$('.introLimit .a_enteteTexteAfficheSuite').click(function(){if($(this).attr('data-show')=='1'){$('.introLimit .hidePlus').show();$('.introLimit .hideMoins').hide();}else{$('.introLimit .hidePlus').hide();$('.introLimit .hideMoins').show();}})}}else{if($(".span_enteteTexteAfficheMasque").length>0){$(".span_enteteTexteAfficheMasque").hide();}
if($(".a_enteteTexteAfficheSuite").length>0){$(".a_enteteTexteAfficheSuite").toggle(function(){$(".span_enteteTexteAfficheMasque").show();$(".span_enteteTexteAfficheSuite").hide();$(this).text($(this).attr("data-lblMoins"));$(this).parent().addClass('open');},function(){$(".span_enteteTexteAfficheMasque").hide();$(".span_enteteTexteAfficheSuite").show();$(this).text($(this).attr("data-lblPlus"));$(this).parent().removeClass('open');})}}})(jQuery);}
function initTarifs_gereAffichageColonne(){if(jQuery(".select_changeColonneTarif").length>0){jQuery(".select_changeColonneTarif").change(function(){jQuery(this).parent().parent().find("#div_tableTarif table").find(".colonneTarif").hide();jQuery(this).parent().parent().find("#div_tableTarif table").find(".colonneTarif_"+jQuery(this).val()).show();});}}
function init_flagsTraductions(){(function($){$('li.li_drapeaux a').click(function(){$('p.description_environnement, p.description_gite').hide();var langue=$(this).attr('data-langue');if(langue!='FRANCAIS'){$('p.description_environnement'+langue+', p.description_gite'+langue).show('fast');}else{$('p#p_fiche_description_environnement, p#p_fiche_description_gite').show('fast');}
return false;});})(jQuery)}
function initLangueDatepicker(){var langue=window.lang||false;if(!langue){langue=jQuery('html').attr('lang');}
jQuery.datepicker.setDefaults(jQuery.datepicker.regional[langue]);}
function autocompleteurCpVille(inputCp,inputVille,domaine){var nomDomaine=domaine||'';(function($){$(inputCp).autocomplete({source:function(request,response){var params={url:nomDomaine+'/lib_2/ajax/infosDist.php',dataType:"json",type:'POST',data:{cp:request.term,info:'getVilleByCP',allfields:'1',like:1,limit:46},success:function(data){response($.map(data,function(item){var commune=item.commune;commune=commune.trim();return{label:item.code_postal+", "+item.commune,value:commune,code:item.code_postal};}));}};if(nomDomaine){params.dataType='jsonp';}
$.ajax(params);},minLength:2,select:function(event,ui){event.preventDefault();var val=ui.item.value;$(inputVille).val(val);$(inputCp).val(ui.item.code);},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top");},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all");}});})(jQuery);}
function autocompleteur(elemInput,elemARemplirQuandSelection,url,tabParamsRequeteAjax,minLength,callback,champLibelleDansReponse,fonctionSurReponseAjax){var minLengthParam=minLength||2;var elemDestination=elemARemplirQuandSelection||null;(function($){$(elemInput).autocomplete({source:function(request,response){var params=tabParamsRequeteAjax||{};params.value=request.term;params.returnJson=true;$.ajax({url:url,dataType:'jsonp',data:params,success:function(data){var fonctionRemplissage=fonctionSurReponseAjax||null;if(fonctionRemplissage&&typeof window[fonctionRemplissage]=='function'){window[fonctionRemplissage](data);}
response($.map(data,function(item){var champ=champLibelleDansReponse||null;var label;if(champ){label=item[champ];}
else{var tabKeys=Object.keys(item);label=item[tabKeys[0]];}
return{label:label,value:JSON.stringify(item)};}));}});},minLength:minLengthParam,select:function(event,ui){var fonction=callback||false;event.preventDefault();if(fonction){try{window[fonction](ui.item);}
catch(e){}}
else{var val=ui.item.value;if(elemDestination){$(elemDestination).val(val);}
$(elemInput).val(ui.item.label);}},focus:function(event,ui){event.preventDefault();var val=ui.item.value;if(elemDestination){$(elemDestination).val(val);}},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top");},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all");}});})(jQuery)}
function autocompleteurParametrable(elemInput,inputHidden,url,action,minLength,callback){var minLengthParam=minLength||2;(function($){$(elemInput).autocomplete({source:function(request,response){var params={value:request.term,typeinfo:action,info:action,action:action,returnJson:true,pourAutocompleteur:true};params[$(elemInput).attr('name')]=request.term;$.ajax({url:url,dataType:"json",data:params,success:function(data){response($.map(data,function(item){return{label:item.label,value:item.value};}));}});},minLength:minLengthParam,select:function(event,ui){var fonction=callback||false;event.preventDefault();if(fonction){try{window[fonction](ui.item);}
catch(e){}}
else{var val=ui.item.value;$(inputHidden).val(val);$(elemInput).val(ui.item.label);}},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top");},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all");}});})(jQuery)}
function clickOnWidgetCartoSites(elem,e,data){var objData=data||false;if(objData){if(objData.site.substring(0,4)!='http'&&objData.site.substring(0,4)!='HTTP'){objData.site='http://'+objData.site;}
window.open(objData.site);}}
function hoverOnWidgetCarto(elem,e,data){var objData=data||false;if(objData){if(navigator.appName!="Microsoft Internet Explorer"){xMouse=e.pageX+1;yMouse=e.pageY+1;}else{var de=document.documentElement;var b=document.body;xMouse=window.event.clientX+(de.scrollLeft||b.scrollLeft)-(de.clientLeft||0);yMouse=window.event.clientY+(de.scrollTop||b.scrollTop)-(de.clientTop||0);}
jQuery('#infobulleDpt').remove();var infoBulle=jQuery("<div id='infobulleDpt' class='infobulleCarto' data-dpt='"+elem.data("value")+"'></div>").append('<span>'+objData.libelle+'</span>');jQuery(infoBulle).appendTo('body');var left=xMouse;infoBulle.css('position','absolute');infoBulle.css("left",left+20);infoBulle.css('zIndex',12000);infoBulle.css("top",yMouse-5);infoBulle.css("display","block");}}
function outOnWidgetCarto(elem,e,data){if(elem.data("value")==jQuery('#infobulleDpt').attr('data-dpt')){jQuery('#infobulleDpt').remove();}}
function moveOnWidgetCarto(elem,e,data){if(navigator.appName!="Microsoft Internet Explorer"){xMouse=e.pageX+1;yMouse=e.pageY+1;}else{var de=document.documentElement;var b=document.body;xMouse=window.event.clientX+(de.scrollLeft||b.scrollLeft)-(de.clientLeft||0);yMouse=window.event.clientY+(de.scrollTop||b.scrollTop)-(de.clientTop||0);}
jQuery('#infobulleDpt').css("left",xMouse+20);jQuery('#infobulleDpt').css("top",yMouse-5);}
function initWidgetPointDeVente(){(function($){$('.btn_connexionPV').unbind('click');$('.btn_connexionPV').bind('click',function(event){event.preventDefault();var vars=$(this).parents('form').serialize();$.ajax({url:'/lib_2/ajax/infosDist.php',type:'POST',dataType:'xml',data:'info=connectionPV&'+vars,success:function(data){var tabResult=XMLToArray(data);if(tabResult.code=='OK'){document.location.href=tabResult.url_accueil;}else{$(".div_msgErreurConnexionPv").show();}}});});$('.btnDeconnexionPV').click(function(){var div=$(this).parents('.itea_connexionPV');var typePv=$(this).parents('.itea_connexionPV').attr('data-type');$.ajax({url:'/lib_2/ajax/infosDist.php',type:'POST',dataType:'xml',data:'info=deconnectionPV&typePV='+typePv,success:function(data){var tabResult=XMLToArray(data);if(tabResult.code=='OK'){document.location.href="/";}}});});$(".form_connexionPV input[type='text']").focus(function(){$(".div_msgErreurConnexionPv").hide();});})(jQuery)}
function debugLogJS(nomFonction){(function($){$.ajax({url:'/lib_2/ajax/infosDist.php',type:'POST',data:{'info':'debugLogJS','nomFonction':nomFonction}});})(jQuery);}
function errLogJS(nomFonction,infosJS){(function($){$.ajax({url:'/lib_2/ajax/infosDist.php',type:'POST',data:{'info':'errLogJS','nomFonction':nomFonction,infosJS:infosJS}});})(jQuery);}
function errlog(log){console.log('errlog log:',log);(function($){$.ajax({url:'/lib_2/ajax/infosDist.php',type:'POST',data:{'info':'errlog','log':log,}});})(jQuery);}
function initChangementMotDePassePV(){(function($){$('.btnChangeMDPPV').click(function(){$.ajax({url:'/lib_2/ajax/contenuFenetre.php',type:'POST',dataType:'xml',data:'element=pv&typeInfo=displayChangePass',success:function(data){var xml=XMLToArray(data);var html=xml.html;var titre=xml.titre;var textAnnuler=xml.annuler;$('<div id="popinPV">').dialog({height:300,width:730,buttons:[{text:"Ok",click:function(){$('#popinPV form').submit();}},{text:textAnnuler,click:function(){$(this).dialog('close');$('#popinPV').remove();}}],title:titre}).html(html);var fonctionValid=function(){var vars=$('#formChangementPassPV').serialize();jQuery('#popinPV .erreurChangementMDPPV').remove();$('#qtipPV').remove();$.ajax({url:'/lib_2/ajax/contenuFenetre.php',type:'POST',dataType:'xml',data:'element=pv&typeInfo=changePass&'+vars,success:function(data){var xml=XMLToArray(data);if(xml.code=='OK'){$('#popinPV').dialog('destroy');$('#popinPV').remove();jQuery('#changePassCE').qtip({content:{text:xml.message},style:{classes:'jgrowl ui-tooltip-blue ui-tooltip-rounded'},position:{my:'top right'},show:{event:false,ready:true,effect:function(){$(this).stop(0,1).fadeIn(400);},delay:0},hide:{effect:function(){$(this).slideUp();}}});setTimeout(function(){jQuery('#changePassCE').qtip('hide');},3000);}
else{jQuery('#popinPV').append('<p class="erreurChangementMDPPV" style="display:none;"><span class="ui-icon ui-icon-alert"></span>&nbsp;<span>'+xml.message+'</span></p>');$('.erreurChangementMDPPV').slideDown('fast');}}});};initValidationFormulaires(fonctionValid,function(){});}});});})(jQuery);}
function loadScriptJs(src,callback){var list=document.getElementsByTagName('script');var i=list.length;while(i--){if(list[i].src===src){if(typeof callback==='function'){callback();}
return;}}
jQuery.ajax({url:src,dataType:'script',cache:true,success:function(){if(typeof callback==='function'){callback();}}});}
function loadScriptCss(href){var list=document.getElementsByTagName('link');var i=list.length;while(i--){if(list[i].href===href){return;}}
jQuery('<link>').appendTo('head').attr({type:'text/css',rel:'stylesheet',href:href});}
function loadScript(){var script=document.createElement('script');script.type='text/javascript';script.src='https://maps.googleapis.com/maps/api/js?key=AIzaSyDwyvX1RaJOlfzTQuh0QJdCqofz7C9CXjw&sensor=FALSE&callback=initialize';document.body.appendChild(script);}
function initialize(){var mapOptions={zoom:8,center:new google.maps.LatLng(-34.397,150.644),mapTypeId:google.maps.MapTypeId.ROADMAP}
var map=new google.maps.Map(document.getElementById('div_mediasCarte'),mapOptions);}
function includeJS(scriptName){var script=document.createElement('script');script.src=scriptName;script.type='text/javascript';document.body.appendChild(script);}
function initChoixTarifsNDate(){(function($){if($('.div_choixTarifAjax').length>0){$('.div_choixTarifAjax').each(function(){var ident=$(this).attr('data-ident');var avecListeDeroulante=$(this).find('.inpt_choixTarifAvecListe').val();var avecAccesResa=$(this).find('.inpt_choixTarifAccesResa').val();var divChoixTarif=$(this);var reload=$(this).find('.inpt_choixTarifReload').val();$.ajax({type:'POST',url:'/lib_2/ajax/infosDist.php',data:{info:"getHTML_choixTarifNDate",ident:ident,avecListeDeroulante:avecListeDeroulante,avecAccesResa:avecAccesResa,reload:reload},success:function(result){divChoixTarif.replaceWith(result);if(jQuery('.viewWithQtip').length>0){jQuery('.viewWithQtipTohide').hide()
jQuery('.viewWithQtip').each(function(){if(jQuery(this).attr('data-qhelp')&&jQuery("#"+jQuery(this).attr('data-qhelp'))){jQuery(this).qtip({content:{text:jQuery("#"+jQuery(this).attr('data-qhelp')).html(),title:{text:jQuery(this).attr('data-qtitle')}},show:'mouseover',hide:'mouseout'})}})}
if(typeof foncQdFini_initChoixTarifsNDate==='function'){foncQdFini_initChoixTarifsNDate();}}});});}})(jQuery);}
function init_afficheMsqueDispoUneChambre(){(function($){if($('.a_afficheMasqueDispoUneChambre').length>0){$('.a_afficheMasqueDispoUneChambre').click(function(){var idChambre=$(this).attr("data-chambre");var divDispo=$('.div_dispoUneCHambre[data-chambre="'+idChambre+'"]');var lblAffiche=$(this).attr('data-lbl-affiche');var lblMasque=$(this).attr('data-lbl-masque');if($(divDispo).is(":hidden")){$(divDispo).show();$(this).text(lblMasque);}
else{$(divDispo).hide();$(this).text(lblAffiche);}})}})(jQuery);}
function initWidgetCptGDF(){initCnxCptGDF();initCreationCptGDF();}
function initCnxCptGDF(){initLiHeaderCptGDF();initValidFormCnxCptGDF();initMdpOublieCptGDF();initCptGdfBtnFB();initCptGdfGooglePlus();initActionBtAffichePopInCreationCptGDF();initCptGdfConnecteSiteExt();cptGDF_initAnnulFancyBox();initCheckSeSouvenirDeMoi();}
function initCheckSeSouvenirDeMoi(){(function($){$('body').delegate('.itea_cnxCptGDF_saisie_seSouvenir label','click',function(){$(this).prev("input").trigger("click");});})(jQuery);}
function cptGDF_initAnnulFancyBox(){(function($){$('body').delegate('.fancyboxAnnul','click',function(){$.fancybox.close();});})(jQuery);}
function initCreationCptGDF(){initActionBtCreationCptGDF_connecterCompte();initActionBtCreerCompte();}
function initLiHeaderCptGDF(){(function($){$('body').delegate('.btLoginCptGDF','click',function(){if(jQuery(window).width()<650){window.location='/'+$(this).attr('data-cible')}else{widget_affichePopinCnxCptGDF();}});$('#btDisconnectCptGDF').click(function(){var tokenGoogle=$(this).attr('data-token');if(tokenGoogle){deconnecteGooglePlus(tokenGoogle);}
cptGdfDeconnexion();});$('#cptGDF_accesCompte:not(.sansClick)').click(function(){if($('#cptGDF_accesCompte_menu').is(':hidden')){$('#cptGDF_accesCompte_menu').show('blind');$('body').addClass("cptGDF_contentMenuHeader_fixed");$(this).addClass("clicked");setTimeout(function(){$('#cptGDF_accesCompte_menu').addClass("ITEA_clicOutBody");},1000);}
else{$('body').removeClass("cptGDF_contentMenuHeader_fixed");$(this).removeClass("clicked");}});$(window).scroll(function(){if($('#cptGDF_accesCompte_menu').is(":hidden")){$('body').removeClass("cptGDF_contentMenuHeader_fixed");$(this).removeClass("clicked");}});if($('.compteGDF_menu').length>0){$('.compteGDF_menu a').click(function(){if(jQuery(window).width()<650){$('#cptGDF_accesCompte').trigger('click')
return false;}});}})(jQuery);}
function initValidFormCnxCptGDF(){(function($){$('.itea_cnxCptGDF_valid').click(function(e){e.preventDefault();var form=$('.frmCnxCptGDF:visible');var $msgInfo=form.find('.itea_cnxCptGDF_msgInfo');$msgInfo.html('').hide();if(form.find('input[name=email]').val()===''||form.find('input[name=password]').val()===''){$msgInfo.html($('#itea_cnxCptGDF_msgInfo_val').text()).fadeIn();return false;}
$.ajax({type:'POST',url:urlCptClient,data:form.serialize()+'&action=login_gdf',beforeSend:function(){$('.itea_cnxCptGDF_valid').attr('disabled',true);$msgInfo.html('').show();attenteInDiv($msgInfo[0]);},success:function(result){$('.itea_cnxCptGDF_valid').attr('disabled',false);var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){$msgInfo.html(tabRetour.msg).fadeIn();}
return false;}
var tabArgs=getVarsFromUrl();if(tabArgs.getPopInCnx!==undefined){document.location.href='/compte-client.html';return false;}
if(document.location.pathname=='/compte-client.html'){document.location.reload();}
$.fancybox.close();connexionOK(tabRetour);$('body').addClass("compteGdfConnecte");compteGdf_mettreAjourLienFavoris();}});});})(jQuery);}
function compteGdf_mettreAjourLienFavoris(){(function($){$('[data-compte-gdf-favoris="true"]').each(function(){$(this).attr('href',$(this).data("compte-gdf-favoris-url"));});})(jQuery);}
function initMdpOublieCptGDF(){(function($){$('.btCptGDF_getEmail').click(function(){$.fancybox.close();$('#inptGetEmailCptGdf_email').val($('#itea_cnxCptGDF_email').val());var inputEmail=new LiveValidation('inptGetEmailCptGdf_email',{validMessage:' ',onlyOnSubmit:true});inputEmail.disable().enable();$('#itea_mdpOublieCptGDF_content_form').show();$('#itea_mdpOublieCptGDF_mail_ok').hide();widget_affichePopinMdpOublieCptGDF();cptGDF_initActionsGetEmail();});})(jQuery);}
function cptGDF_initActionsGetEmail(){(function($){if($('#btGetEmailCptGdf_email').length===0){return false;}
var tabAValider=[];var email=new LiveValidation('inptGetEmailCptGdf_email',{validMessage:' ',onlyOnSubmit:true});email.add(Validate.Presence,{failureMessage:$('#inpt_msgMailNonRenseigne').val()});addValidateOnLiveValidationEmail(email,undefined,true,$('#inpt_msgMailInexistant').val(),'checkEmailClientCompilExist');tabAValider.push(email);$('#btGetEmailCptGdf_email').click(function(e){e.preventDefault();if(LiveValidation.massValidate(tabAValider)){var data='action=envoiMailConfirmDemandeNewPassword';data+='&email='+$('#inptGetEmailCptGdf_email').val();$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){setMsgInfoCptGDF($('#getEmailCptGDF_msgInfo'),tabRetour.msg);$('#itea_mdpOublieCptGDF_mail_ok').show();return false;}
$('#getEmailCptGDF_msgInfo').html(tabRetour.msg);$('#itea_mdpOublieCptGDF_content_form').hide();$('#itea_mdpOublieCptGDF_mail_ok').show();}});}});})(jQuery);}
function initCptGdfBtnFB(){(function($){$('.itea_cptGDF_btnFB').click(function(){connexionFacebook(cptGdfFacebookOK,cptGdfFacebookKO);});})(jQuery);}
function initCptGdfGooglePlus(){_idBtnConnexionGoogle='itea_cptGDF_btnGoogle';_fctGooglePlusOK=cptGdfGooglePlusOK;_fctGooglePlusKO=cptGdfGooglePlusKO;(function($){$('.itea_cptGDF_btnGoogle').click(function(){$('#itea_cptGDF_btnGoogle button').click();});})(jQuery);}
function cptGdfCnxExterneOK(tabInfosUser){(function($){var data='action=login_gdf_externe';data+='&'+$.param(tabInfosUser);$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var elemMsgInfo=$('#itea_creationCptGDF_msgInfo');if(!elemMsgInfo.is(':visible')){var elemMsgInfo=$('.itea_cnxCptGDF_msgInfo');}
setMsgInfoCptGDF(elemMsgInfo);var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){setMsgInfoCptGDF(elemMsgInfo,tabRetour.msg);}
return false;}
if(tabRetour.code==='KO_CREA'){setMsgInfoCptGDF(elemMsgInfo,tabRetour.msg);return false;}
$.fancybox.close();if(tabRetour.code==='OK_CREA'){widget_affichePopinCreationCptGDF_mailEnvoye(tabRetour.msg);return false;}
if(tabRetour.code==='OK_QUEST_ASSOC'){widget_affichePopinConnecteSiteExt(tabRetour.msg);return false;}
connexionOK(tabRetour);}});})(jQuery);}
function cptGdfFacebookOK(tabInfosUser){cptGdfCnxExterneOK(tabInfosUser);}
function cptGdfFacebookKO(){}
function cptGdfGooglePlusOK(accessToken,tabInfosUser){(function($){$('#btDisconnectCptGDF').attr('data-token',accessToken);cptGdfCnxExterneOK(tabInfosUser);})(jQuery);}
function cptGdfGooglePlusKO(erreur){console.log(erreur);}
function connexionOK(tabResult){(function($){$('.itea_cnxCptGDF_msgInfo').hide();$('#liLoginCptGDF').hide();$('#liPrenomCptGDF').html(tabResult.prenom).show();$('#photoCptGDF').attr('src',tabResult.photo);$('#cptGDF_accesCompte').show();if(elemToClickAfterCnxCptGDF!==undefined){elemToClickAfterCnxCptGDF.click();elemToClickAfterCnxCptGDF=null;}})(jQuery);}
function cptGdfDeconnexion(){(function($){var data='action=DECONNEXION_GDF';$.ajax({type:'POST',url:urlCptClient,data:data,success:function(){document.location.href='/';}});})(jQuery);}
function initActionBtAffichePopInCreationCptGDF(){(function($){$('.itea_cnxCptGDF_creerCompte').click(function(){cptGdf_ouvrePopinCreationCompte();});})(jQuery);}
function cptGdf_ouvrePopinCreationCompte(){(function($){$.fancybox.close();widget_affichePopinCreationCptGDF();})(jQuery);}
function initCptGdfConnecteSiteExt(){(function($){$('body').delegate('#cptGDF_btConnecteSiteExt','click',function(){var data='action=connecteSiteExt';data+='&site='+$(this).data('site');data+='&email='+$(this).data('email');$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){setMsgInfoCptGDF($('#cptGDF_connecteSiteExt_msgInfo'),tabRetour.msg);return false;}
setMsgInfoCptGDF($('#cptGDF_connecteSiteExt_msgInfo'));$.fancybox.close();connexionOK(tabRetour);}});});})(jQuery);}
function initActionBtCreationCptGDF_connecterCompte(){(function($){$('.itea_creationCptGDF_connecterCompte').click(function(){$.fancybox.close();widget_affichePopinCnxCptGDF();});})(jQuery);}
function initLandingPageCptGDF(){(function($){var data='action=GET_LANDING_PAGE';$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
widget_affichePopinLandingPageCptGDF(tabRetour.html);}});})(jQuery);}
function initActionBtCreerCompte(){(function($){if($('#itea_creationCptGDF_valid').length===0){return false;}
initValidateCreerCompteGdf();$('#itea_creationCptGDF_valid').click(function(e){e.preventDefault();setMsgInfoCptGDF($('#itea_creationCptGDF_msgInfo'));if(!$('#chkCptGDF_condGene').is(':checked')){setMsgInfoCptGDF($('#itea_creationCptGDF_msgInfo'),$('#inpt_msgCondGeneNonValidees').val());}
if($('#frmCreationCptGDF').valid()&&$('#chkCptGDF_condGene').is(':checked')){var data='action=create_cpt_gdf&'+$('#frmCreationCptGDF').serialize();$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='OK_CREA'){$.fancybox.close();widget_affichePopinCreationCptGDF_mailEnvoye(tabRetour.msg);return false;}
if(tabRetour.msg){setMsgInfoCptGDF($('#itea_creationCptGDF_msgInfo'),tabRetour.msg);}}});}});})(jQuery);}
function initLiveValidationCreerCompteGDF(){var tabAValider=[];(function($){var nom=new LiveValidation('itea_creationCptGDF_nom',{validMessage:' ',onlyOnBlur:true});nom.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire').val()});tabAValider.push(nom);var prenom=new LiveValidation('itea_creationCptGDF_prenom',{validMessage:' ',onlyOnBlur:true});prenom.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire').val()});tabAValider.push(prenom);var email=new LiveValidation('itea_creationCptGDF_email',{validMessage:' ',onlyOnBlur:true});email.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire').val()});addValidateOnLiveValidationEmail(email,undefined,true,$('#inpt_msgMailNonValide').val());addValidateOnLiveValidationEmail(email,undefined,true,$('#inpt_msgMailExisteDeja').val(),'checkEmailClientCompilNotExist');tabAValider.push(email);var mdp=new LiveValidation('itea_creationCptGDF_password',{validMessage:' ',onlyOnBlur:true});mdp.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire').val()});mdp.add(Validate.Format,{pattern:/^[0-9a-zA-Z-_]+$/,failureMessage:$('#inpt_msgSeulementChiffresLettres').val()});mdp.add(Validate.Length,{minimum:4,tooShortMessage:$('#inpt_msgNbCar').val()});tabAValider.push(mdp);var mdpConfirm=new LiveValidation('itea_creationCptGDF_password_confirm',{validMessage:' ',onlyOnBlur:true});mdpConfirm.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire').val()});mdpConfirm.add(Validate.Confirmation,{match:'itea_creationCptGDF_password',failureMessage:$('#inpt_msgCorresMdp').val()});tabAValider.push(mdpConfirm);})(jQuery);return tabAValider;}
function initValidateCreerCompteGdf(){(function($){setCustomRulesForJqueryValidate();$.extend($.validator.messages,{required:$('#inpt_msgChampObligatoire').val(),email:$('#inpt_msgMailNonValide').val(),checkEmail:$('#inpt_msgMailExisteDeja').val(),minlength:$('#inpt_msgNbCar').val(),checkPassLettresEtChiffres:$('#inpt_msgSeulementChiffresLettres').val()});$('#frmCreationCptGDF').validate({errorElement:'span',errorClass:'erreurMessage',onfocusout:false,rules:{"nom":{required:true},"prenom":{required:true},"email":{required:true,email:true,checkEmail:'checkEmailClientCompilNotExist'},"password":{required:true,minlength:4,checkPassLettresEtChiffres:true},"password_confirm":{required:true,equalTo:'#itea_creationCptGDF_password'}},messages:{"password_confirm":{equalTo:$('#inpt_msgCorresMdp').val()}}});})(jQuery);}
function setCustomRulesForJqueryValidate(){(function($){$.validator.addMethod("notEqualTo",function(value,element,param){return this.optional(element)||value!=param;});$.validator.addMethod("equals",function(value,element,param){return this.optional(element)||value===param;});$.validator.addMethod("notDefaultValue",function(value,element,args){return(value!==$(element).attr('data-defaut'));});$.validator.addMethod("telephone",function(value,element,args){var filter=/^((\+[1-9]{1,4}[ \-]*)|(\([0-9]{2,3}\)[ \-]*)|([0-9]{2,4})[ \-]*)*?[0-9]{3,4}?[ \-]*[0-9]{3,4}?$/;if(filter.test(value)){return true;}
return false;});$.validator.addMethod("checkEmail",function(value,element,args){var params={};params.info=args;return checkEmailIteaPourValidate(value,params);});$.validator.addMethod("checkPassLettresEtChiffres",function(value,element,args){var filter=/^[0-9a-zA-Z-_]+$/;if(filter.test(value)){return true;}
return false;});})(jQuery);}
function initActionBtCreateFavori(){(function($){$('body').delegate('#bt_cptGDF_createFavori','click',function(){$('#div_cptGDF_newFavori').show();$('#inpt_cptGDF_newFavori').focus();});})(jQuery);}
function initActionBtValidNewFavori(){(function($){$('body').delegate('#bt_cptGDF_validNewFavori','click',function(e){e.preventDefault();enregistreNewFavori($(this).attr('data-from'));});})(jQuery);}
function actionsAfterCreateFavori(html){(function($){$('#div_cptGDF_newFavori').hide();$('#inpt_cptGDF_newFavori').val('');$('#ul_cptGDF_lstFavori').prepend(html);$('#compteGDF_pasDeFavoris').hide();})(jQuery);}
function setMsgInfoNewFavoriCptGDF(msg){(function($){setMsgInfoCptGDF($('#cptGDF_newFavori_msgInfo'),msg);})(jQuery);}
function setMsgInfoCptGDF(elem,pMsg){(function(){var msg=pMsg||false;if(msg){elem.html(msg).fadeOut().fadeIn();}else{elem.html('').hide();}})(jQuery);}
function enregistreNewFavori(pFrom){(function($){var libelle=traiteTexteAvantReqAjax($('#inpt_cptGDF_newFavori').val());if(libelle.trim().length===0){setMsgInfoNewFavoriCptGDF($('#div_cptGdf_lbl_error_favori_lib_vide').text());return false;}
setMsgInfoNewFavoriCptGDF();var data='action=ADD_FAVORI';data+='&libelle='+libelle;var from=pFrom||false;if(from){data+='&from='+from;}
$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){setMsgInfoNewFavoriCptGDF(tabRetour.msg);return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
setMsgInfoNewFavoriCptGDF();actionsAfterCreateFavori(tabRetour.html);}});})(jQuery);}
function cptGDF_initActionsAjoutFavoriHeber(){initActionBtCreateFavori();initActionBtValidNewFavori();initActionBtAjoutFavoriHeber();initActionBtValidAjoutFavoriHeber();initActionBtContinueSearchFavoriHeber();initActionBtVoirMonCompte();}
function initActionBtAjoutFavoriHeber(){(function($){$('body').delegate('.btAjoutFavoriHeber','click',function(){var elemClick=$(this);var indiceListe=elemClick.attr('data-indice-liste')||0;var data='action=getHTML_favorisForAjoutHeber';data+='&ref='+elemClick.attr('data-ref');data+='&url='+elemClick.attr('data-url');data+='&indice_liste='+indiceListe;$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){elemToClickAfterCnxCptGDF=elemClick;return false;}
affichePopinAjoutFavoriHeber(tabRetour.html);}});});})(jQuery);}
function initActionBtValidAjoutFavoriHeber(){(function($){$('body').delegate('.btValidAjoutFavoriHeber','click',function(){var divConteneur=$('#popIn_ajoutFavoriHeber');var favoriId=$(this).attr('data-id');var divMsg=$('#cptGDF_detailFavori_msgInfo_'+favoriId);var data='action=ADD_FAVORI_HEBER';data+='&favori_id='+favoriId;data+='&ref='+divConteneur.attr('data-ref');divMsg.text('').hide();$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){divMsg.text(tabRetour.msg).show();return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
$('.div_ajoutFavoriHeber').toggle();}});});})(jQuery);}
function widget_affichePopinCnxCptGDF(idPopin,email){(function($){if(idPopin===undefined){idPopin='itea_cnxCptGDF';}
if(email!==undefined){$('#'+idPopin).find('input[type="email"]').val(email);$('#'+idPopin).find('input[type="password"]').val();}
if($('.compteGDF_logindansPage').length>0){$('.compteGDF_logindansPage').hide();}
$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,href:'#'+idPopin,wrapCSS:'popin_compteGDF popin_coonnectCompteGDF',fitToView:false,afterClose:function(){if($('.compteGDF_logindansPage').length>0){$('.compteGDF_logindansPage').show();}}});})(jQuery);}
function widget_affichePopinMdpOublieCptGDF(){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,href:'#itea_mdpOublieCptGDF',wrapCSS:'popin_compteGDF popin_mdpOublieCompteGDF',fitToView:false});})(jQuery);}
function widget_affichePopinCreationCptGDF(){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,href:'#itea_creationCptGDF',wrapCSS:'popin_compteGDF popin_creaCompteGDF',fitToView:false});})(jQuery);}
function widget_affichePopinCreationCptGDF_mailEnvoye(html){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_creaCompteGDF_onfirm',fitToView:false,afterClose:function(){document.location.href='/';}});})(jQuery);}
function widget_affichePopinConnecteSiteExt(html){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_connectSiteExterne_cptGDF',fitToView:false});})(jQuery);}
function widget_affichePopinLandingPageCptGDF(html){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_confirmCreation_cptGDF',fitToView:false});})(jQuery);}
function affichePopinAjoutFavoriHeber(html){(function($){$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_ajoutFavorisHeber',fitToView:false});})(jQuery);}
function initActionBtContinueSearchFavoriHeber(){(function($){$('body').delegate('#btContinueSearchFavoriHeber','click',function(){$.fancybox.close();});})(jQuery);}
function initActionBtVoirMonCompte(){(function($){$('body').delegate('#btVoirMonCompte','click',function(){window.open('/compte-client.html?action=afficheFavoris','cptGdfFavoris');$.fancybox.close();});})(jQuery);}
function traiteRepKoCnxCptGDF(tabRetour){if(tabRetour.code==='KO_CNX'){widget_affichePopinCnxCptGDF(tabRetour.idPopin);return false;}
return true;}
function initFicheVisitee(ref){(function($){var data='action=ADD_FICHE_VISITEE';data+='&ref='+ref;$.ajax({type:'POST',url:urlCptClient,data:data});})(jQuery);}
function getVarsFromUrl(){var out={};(function($){var params=location.search.substring(1).split('&');$(params).each(function(val){var tab=this.split('=');out[tab[0]]=tab[1];});})(jQuery);return out;}
function afficheEnregistrerPanierMiniCatalogue(){(function($){var sending=getInfoSession()+'&element=afficheEnregistrePanier';$.ajax({type:'POST',url:'/lib_2/ajax/contenuFenetre.php',data:sending,success:function(data){var titre=$('.input_titre_form',$(data)).val();afficheDivAvecTransparence('<div id="div_sendMailToFriend"></div>',800,500,null,titre);$('#div_sendMailToFriend').html(data);var langue=$("body").attr("data-langue");var tabAValider=[];var mail=new LiveValidation('email1',{validMessage:'Ok',onlyOnSubmit:true});addValidateOnLiveValidationEmail(mail,langue,true);tabAValider.push(mail);var nom=new LiveValidation('nomPourMiniCatalogue',{validMessage:'Ok',onlyOnSubmit:true});nom.add(Validate.Presence,{failureMessage:"Champ obligatoire"});tabAValider.push(nom);$('#a_validFormMail','#div_sendMailToFriend').click(function(){if(LiveValidation.massValidate(tabAValider)){enregistrerPanierMiniCatalogue();}});}});})(jQuery);}
function afficheEnvoiSelectionPourClient(action){(function($){var sending=getInfoSession()+'&element='+action;$.ajax({type:'POST',url:'/lib_2/ajax/contenuFenetre.php',data:sending,success:function(data){var html=$(data);var titre=$('.input_titre_form',html).val();if(estSurBureauITEA()){var marge=60;afficheDivAvecTransparence('<div id="div_sendMailToFriend"></div>',(window.innerWidth-marge),(window.innerHeight-marge),null,titre);}else{afficheDivAvecTransparence('<div id="div_sendMailToFriend"></div>',650,600,null,titre);}
$('#div_sendMailToFriend').html(data);if($('#inputDateFinEnvoiAmi').length>0){$('#inputDateDebEnvoiAmi').datepicker({minDate:0,onSelect:function(date){$('#inputDateFinEnvoiAmi').datepicker({minDate:date});}});}
if($('#select_typeCentrale').length>0){$('#select_typeCentrale').change(function(){var mail=$(this).find('option:selected').attr('data-mail');$('#emailDeLaPart').val(mail);});}
if($('#div_envoiAmisInfosMiniCata').length>0){$('#div_envoiAmisInfosMiniCata').click(function(){if($('#div_saisieInfosClientPourMiniCata').is(':visible')){$('#div_saisieInfosClientPourMiniCata').hide();}else{$('#div_saisieInfosClientPourMiniCata').show();}});}
$('select[name="typeEnvoiMiniCatalogue"]').change(function(){if($(this).val()){$('#div_selectModelMailMiniCata').hide('fast');$('#div_envoiAmiMessage').hide('fast');$('#emailMessage').attr('disabled','disabled');$('#div_envoiCommentaire').show('fast');$('#emailCommentaire').removeAttr('disabled');}
else{$('#div_envoiCommentaire').hide('fast');$('#emailCommentaire').attr('disabled','disabled');$('#div_selectModelMailMiniCata').show('fast');$('#div_envoiAmiMessage').show('fast');$('#emailMessage').removeAttr('disabled');}
if($(this).val()=='HTMLX'){$('#divSelectLienDocHTML').show('fast');}
else{$('#divSelectLienDocHTML').hide('fast');}});if($('input[name="CP"').length>0&&$('input[name="ville"').length>0){autocompleteurCpVille($('input[name="CP"'),$('input[name="ville"'));}
var langue=$("body").attr("data-langue")||'FRANCAIS';var tabAValider=[];var mail=new LiveValidation('email1',{validMessage:'Ok',onlyOnSubmit:true});addValidateOnLiveValidationEmail(mail,langue,true);tabAValider.push(mail);$('#a_validFormMail,#a_validFormEnregistrementSeulement','#div_sendMailToFriend').click(function(){var seulementEnregistrement=$(this).attr('id')==='a_validFormEnregistrementSeulement';var mailClient=new LiveValidation("emailDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailClient,langue,true);var mailAmi1=new LiveValidation("email1",{validMessage:"Ok",onlyOnSubmit:true});var email1Obligatoire=true;if(seulementEnregistrement){email1Obligatoire=false;}
addValidateOnLiveValidationEmail(mailAmi1,langue,email1Obligatoire);var mailAmi2=new LiveValidation("email2",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailAmi2,langue,false);var mailAmi3=new LiveValidation("email3",{validMessage:"Ok",onlyOnSubmit:true});addValidateOnLiveValidationEmail(mailAmi3,langue,false);if(langue=="FRANCAIS"){if(!$('#prenomDeLaPart').hasClass('optionnel')){var prenomClient=new LiveValidation("prenomDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});prenomClient.add(Validate.Presence,{failureMessage:"Champ obligatoire"});}
var message=new LiveValidation("emailMessage",{validMessage:"Ok",onlyOnSubmit:true});message.add(Validate.Presence,{failureMessage:"Champ obligatoire"});}else{if(!$('#prenomDeLaPart').hasClass('optionnel')){var prenomClient=new LiveValidation("prenomDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});prenomClient.add(Validate.Presence,{failureMessage:"Required field"});}
var message=new LiveValidation("emailMessage",{validMessage:"Ok",onlyOnSubmit:true});message.add(Validate.Presence,{failureMessage:"Required field"});}
var tabAValider=new Array(mailClient,mailAmi1,mailAmi2,mailAmi3,message);if($('#div_envoiAmisInfosMiniCata').length>0){$('#div_saisieInfosClientPourMiniCata').show();var nom=new LiveValidation('nomPourMiniCatalogue',{validMessage:'Ok',onlyOnSubmit:true});nom.add(Validate.Presence,{failureMessage:"Champ obligatoire"});tabAValider.push(nom);}
if(!$('#prenomDeLaPart').hasClass('optionnel')){tabAValider.push(prenomClient);}
LiveValidation.massValidate(tabAValider);if($(".LV_invalid").length==0){envoiMailClientSelection(seulementEnregistrement);}
if(estSurBureauITEA()){if($('#emailRecevoirCopie').prop('checked')){localStorage.setItem('emailRecevoirCopie','1');}else{localStorage.setItem('emailRecevoirCopie','0');}
var typeEnvoi=$('select[name="typeEnvoiMiniCatalogue"]').val()||'';localStorage.setItem('typeEnvoiMiniCatalogue',typeEnvoi);var typeLienMiniCata=localStorage.typeLienMiniCata||'liste';localStorage.setItem('typeLienMiniCata',typeLienMiniCata);}});if(estSurBureauITEA()){if(localStorage.emailRecevoirCopie==='1'){$('#emailRecevoirCopie').prop('checked',true);}
var typeEnvoiMinCata=localStorage.typeEnvoiMiniCatalogue||'';var option=$('select[name="typeEnvoiMiniCatalogue"] > option[value="'+typeEnvoiMinCata+'"]');if(option.length>0){$('select[name="typeEnvoiMiniCatalogue"]').val(typeEnvoiMinCata);$('select[name="typeEnvoiMiniCatalogue"]').change();var typeLienMiniCata=localStorage.typeLienMiniCata||'liste';$('select[name="typeLienMiniCatalogue"]').val(typeLienMiniCata);}
initHistoClientMiniCata();initAutocompleteClientsExistantsMiniCatalogue();initGestionModelesMailMiniCata();initBtnImprSeulementMiniCata();var dernierModelUtilise=getDernierModelUtilise();if(dernierModelUtilise.length>0){jQuery('#selectModelMailMiniCata').val(dernierModelUtilise).change();}}}});})(jQuery);}
function envoiMailClientSelection(seulementEnregistrement){(function($){var sending=$('#formMailToFriend').serialize();if($('#div_saisieInfosClientPourMiniCata').length>0){var tabInfosClient=getInfosClientPourMiniCata();sending+="&tabInfosClient="+JSON.stringify(tabInfosClient);}
var url='/lib_2/ajax/envoiMail.php';if(seulementEnregistrement){url='/lib_2/ajax/gerePanier.php';sending+='&action=ENREGISTREMENTSELECTIONCLIENT';}
$("#div_envoiAmiSubmit").hide();$('#a_validFormEnregistrementSeulement').hide();$.ajax({type:'POST',url:url,data:sending,success:function(data){$('#div_messageEnvoiMail').addClass("messageAffiche");$('#div_messageEnvoiMail').html(data);setHistoClientMiniCata();enregistrerDernierModeleUtilise();$("#div_sendMailToFriend form *").attr("disabled","disabled");$(".div_messageIntroForm").hide();},error:function(data){$('#div_messageEnvoiMail').html('<p class="alert alert-warning">Il y a eu une erreur lors du traitement de votre demande. Veuillez contacter ITEA.</p>');}});})(jQuery);}
function enregistrerPanierMiniCatalogue(){(function($){var sending=$('.formSaisieMiniCatalogue').serialize();var tabInfosClient=getInfosClientPourMiniCata();sending+='&tabInfosClient='+JSON.stringify(tabInfosClient);sending+='&action=ENREGISTREMINICATALOGUE';$.ajax({type:'POST',url:'/lib_2/ajax/gerePanier.php',data:sending,success:function(data){$('#div_messageEnvoiMail').html(data);},error:function(data){$('#div_messageEnvoiMail').html('<p class="alert alert-warning">Il y a eu une erreur lors du traitement de votre demande. Veuillez contacter ITEA.</p>');}});})(jQuery);}
(function($){$.fn.onclickout=function(callback){var elm=this;$(document).bind("click",function(evt){if($(evt.target).closest(elm).size()===0){callback.call(elm,evt);}});return elm;};})(jQuery);function getEcartAnneeEntreObjsDates(dateRecente,DateAncienne){var ynew=dateRecente.getFullYear();var mnew=dateRecente.getMonth();var dnew=dateRecente.getDate();var yold=DateAncienne.getFullYear();var mold=DateAncienne.getMonth();var dold=DateAncienne.getDate();var diff=ynew-yold;if(mold>mnew)
diff--;else
{if(mold==mnew)
{if(dold>dnew)
diff--;}}
return diff;}
function estSurBureauITEA(){var url=''+window.location;if(url.match('^http[s]{0,1}://(reservation-bureau|reservation-interne).itea')===null&&url.match('^http://172.24.1.22')===null&&url.match('^http://172.24.1.23')===null&&url.match('^http://172.24.1.32')===null&&url.match('^http://172.25.1.37')===null){return false;}
return true;}
function estSurBureauProprietaire(){if(window.location.host==='prop.itea-dev.com'||window.location.host==='prop.itea.fr'){return true;}
return false;}
function estSurBureauMandataire(){if($('body').data('estmandataire')==='oui'){return true;}
return false;}
function estSurRenouvellementAdhesion(){console.log('divers.js estSurRenouvellementAdhesion');if(estSurBureauProprietaire()&&(window.location.pathname==='/v5/renouvellement.php'||window.location.pathname==='/v5/apercu_renouvellement.php')){return true;}
return false;}
function estSurResa(){var url=window.location.pathname;if(url!==undefined&&url.match(/etape\d\.php/)){return true;}
return false;}
function estSurFlux(){if(window.location.host==='flux.itea-dev.com'||window.location.host==='flux.itea.fr'){return true;}
return false;}
function estSurBureauPropOuITEA(){return(estSurBureauITEA()||estSurBureauProprietaire());}
function yaDateAGererBureauITEA(){if(!estSurBureauITEA()){return false;}
var deb=getParamFromURL('deb');if(deb===undefined){deb=getParamFromURL('debutsejour');}
var nbj=getParamFromURL('duree');if(nbj===undefined){nbj=getParamFromURL('nbj');}
if(nbj===undefined){nbj=getParamFromURL('dureesejour');}
if(deb!==undefined&&nbj!==undefined){return true;}
return false;}
function yaInseeAGererBureauITEA(){if(!estSurBureauITEA()){return false;}
var insee=getParamFromURL('insee');var lieucgi=getParamFromURL('lieucgi');if(insee!==undefined||lieucgi!==undefined){return true;}
return false;}
function effaceValeurFormInDiv(elem){(function($){$(elem).find('input[type="text"]').each(function(){$(this).val('');});$(elem).find('input[type="radio"]').each(function(){$(this).attr('checked',false);});$(elem).find('select option[value=""]').prop('selected',true);})(jQuery);}
function supprimeFlagMultiResaDansLocalStorage(){(function($){var histoClients=JSON.parse(localStorage.getItem('histoClients'))||false;if(histoClients){$.each(histoClients,function(index,client){delete client.clientMultiResa;histoClients[index]=client;});localStorage.setItem('histoClients',JSON.stringify(histoClients));}
localStorage.removeItem('OBJMULTIRESA');localStorage.removeItem('queryStringMultiResa');})(jQuery);}
function traiteRetourVerifCaptcha(retour){try{if(retour.code=='OK'||retour.code=='Ok'){return true;}
if(retour.reload){jQuery('#sp_btnReload').trigger('click');}}
catch(e){}
return false;}
function getTabMessagesValidationFormulaireByLangue(langue){var tabMessages={};tabMessages.valid='Ok';if(langue=='FRANCAIS'){tabMessages.obligatoire='Champ obligatoire';tabMessages.email='Adresse mail non valide';tabMessages.dates='Veuillez saisir une date au format jj/mm/aaaa';tabMessages.captcha='Code incorrect';tabMessages.tel='6 chiffres minimum';}else{tabMessages.obligatoire='Required field';tabMessages.email='Invalid email';tabMessages.dates='Please enter a date in the format dd/mm/yyyy';tabMessages.captcha='Incorrect code';tabMessages.tel='6 numbers minimum';}
return tabMessages;}
function goodspotInitAffichage(){jQuery(document).ready(function($){var goodspotActif=window.goodspotInit||false;if(goodspotActif){return true;}
var blocDetailPatron=$('.goodSpot_unBlocDetails')[0];if(!blocDetailPatron){$('body').append('<div id="divBlocSqueletteGoodSpot"></div>');$('#divBlocSqueletteGoodSpot').load('/lib_2/ajax/infosDist.php?info=getHTMLSqueletteGoodSpot');}
window.goodspotInit=true;$('body').click(function(e){var target=e.target;var li=$(target).parents('li.goodSpot_uneActivitePasLienExterne');if(!li||$(li).length===0){return;}
var ul=$(li).parent('ul');var divParente=ul.parent();var contenu=$('>*',divParente);contenu.hide('fast');var blocDetail=remplirDetailGoodspot(li);if(!blocDetail){return;}
divParente.append(blocDetail);blocDetail.show('fast');$('.goodSpot_retourListe',blocDetail).click(function(){contenu.show('fast');blocDetail.hide('fast');blocDetail.remove();divParente.find('.viafranceClosed').hide();});});$('.div_goodSpotContent').each(function(){if($('.goodSpot_uneActivite',this).length>2){var activitesCachees=$('.goodSpot_uneActivite:nth-child(n+3)',this);$(activitesCachees).hide();$('.a_goodSpot_plus',this).css('display','block');$('.a_goodSpot_plus',this).click(function(){if($(activitesCachees).is(':hidden')){$(activitesCachees).show();$(this).html($(this).data('masque'));}
else{$(activitesCachees).hide();$(this).html($(this).data('affiche'));}})}});});}
function remplirDetailGoodspot(liActivite){var blocDetail;(function($){var blocDetailPatron=$('.goodSpot_unBlocDetails')[0];if(!blocDetailPatron){return false;}
blocDetail=$(blocDetailPatron).clone();var src=$(liActivite).data('url_image_spot_big');$('.goodSpot_imgVignette',blocDetail).attr('src',src);$('.goodspotDetail_title',blocDetail).html($(liActivite).data('title'));$('.goodSpotDetail_ville',blocDetail).html($(liActivite).data('ville'));$('.goodspotDetail_description',blocDetail).html($(liActivite).data('description'));$('.goodspotDetail_adresse',blocDetail).html($(liActivite).data('adresse'));$('.goodspotDetail_CP_ville',blocDetail).html($(liActivite).data('code_postal')+' - '+$(liActivite).data('ville'));$('.goodspotDetail_prix',blocDetail).html($(liActivite).data('prix')+'  / '+$(liActivite).data('type_forfait'));if($(liActivite).data('people_min')){$('.spanMinPersonnes',blocDetail).html($(liActivite).data('people_min'));$('.goodspotDetail_min',blocDetail).show();}
if($(liActivite).data('people_max')){$('.spanMaxPersonnes',blocDetail).html($(liActivite).data('people_max'));$('.goodspotDetail_max',blocDetail).show();}
$('.pGoodspotDetail_duree',blocDetail).hide();if($(liActivite).data('duree')){$('.goodspotDetail_duree',blocDetail).html($(liActivite).data('duree'));$('.pGoodspotDetail_duree',blocDetail).show();}
$('.goodspotDetail_disponibilite',blocDetail).html($(liActivite).data('disponibilite'));$('.a_goodspotDetail',blocDetail).attr('href',$(liActivite).data('url_spot'));var lesContents=$('.goodSpot_onglets>*',blocDetail);var lesOnglets=$('li',blocDetail);$('li:first-child',blocDetail).addClass('active');$('.goodSpot_onglets>*:first-child',blocDetail).removeClass('cache');lesOnglets.click(function(){lesOnglets.removeClass('active');lesContents.addClass('cache');$(this).addClass('active');$('.goodSpot_onglets > .'+$(this).data('class'),blocDetail).removeClass('cache');});})(jQuery);return blocDetail;}
function onYouTubeIframeAPIReady(){if(jQuery('div#div_ficheYoutubeApiJs').length>0){var height=jQuery("#div_ficheYoutubeApiJs").data("hauteur");var width=jQuery("#div_ficheYoutubeApiJs").data("largeur");var autoplay=jQuery("#div_ficheYoutubeApiJs").data("autoplay");var id=jQuery("#div_ficheYoutubeApiJs").data("idyoutube");console.log("idYoutube"+id);playerYoutube=new YT.Player('div_ficheYoutubeApiJs',{height:height,width:width,autoplay:autoplay,videoId:id,playerVars:{rel:0,autohide:1,showinfo:0},events:{'onReady':onPlayerReady}});playerYoutube.addEventListener("onStateChange",function(state){if(state.data===0){if(typeof foncQdFini_endVideoYoutube==='function'){foncQdFini_endVideoYoutube();}}});}}
function onPlayerReady(){if(jQuery("#div_ficheYoutubeApiJs").data("autoplay")=='1'){playerYoutube.mute();playerYoutube.playVideo();}}
function reinitOnYouTubeIframeAPIReady(){setTimeout(function(){if(jQuery("div#div_ficheYoutubeApiJs").length>0){onYouTubeIframeAPIReady();}},500);}
function aListeEnPost(){return estMoteurSansLien();}
function estMoteurSansLien(){if(jQuery('#itea_page_contentListe')&&jQuery('#itea_page_contentListe').attr('data-post')==='true'){return true;}
return false;}
function getParamFromURL(param){var params={},queries,temp,i,l;queries=window.location.search.replace('?','').split('&');for(i=0,l=queries.length;i<l;i++){temp=queries[i].split('=');params[temp[0]]=temp[1];}
if(params[param]===undefined){return undefined;}
return decodeURIComponent(params[param]);}
function setHistoClientMiniCata(){(function($){var chaine="civilite="+$('select[name="civilite"]').val()+"&";chaine+=$('#div_saisieInfosClientPourMiniCata  input').serialize();var pastSearches=[];if(window.localStorage["histoClientMiniCata"]){pastSearches=JSON.parse(localStorage["histoClientMiniCata"]);for(var i=0;i<pastSearches.length;i++){if(chaine===pastSearches[i]){return;}}}
pastSearches.unshift(chaine);if(pastSearches.length>5){pastSearches.pop();}
window.localStorage["histoClientMiniCata"]=JSON.stringify(pastSearches);})(jQuery);}
function getHistoClientMiniCata(){var pastSearches=[];if(window.localStorage["histoClientMiniCata"]){pastSearches=JSON.parse(window.localStorage["histoClientMiniCata"]);}
return pastSearches;}
function initHistoClientMiniCata(){(function($){var tabCiv={1:'M',2:'Mme',3:'M et Mme',O:''};var tabHistoClient=getHistoClientMiniCata();if(tabHistoClient.length>0){tabHistoClient.forEach(function(client){var objClient={};client.split('&').forEach(function(key){objClient[key.split("=")[0]]=key.split("=")[1];});var option='<option data-civilite="'+objClient.civilite+'" data-nom="'+objClient.nom+'" data-prenom="'+objClient.prenom+'" data-adresse1="'+objClient.adresse1+'" data-adresse2="'+objClient.adresse2
+'" data-cp="'+objClient.CP+'" data-ville="'+objClient.ville+'" data-pays="'+objClient.pays+'" data-teldom="'+objClient.teldom
+'" data-telbur="'+objClient.telbur+'" onclick="fillInfosClientMiniCata(this);" >'+tabCiv[objClient.civilite]+' '+objClient.prenom+' '+objClient.nom+' - '+objClient.ville+'</option>';$('#histoClientMiniCata').append(option);});$('#div_histoClientMiniCata').show();}else{$('#div_histoClientMiniCata').hide();}})(jQuery);}
function fillInfosClientMiniCata(element){(function($){var civilite=$(element).attr('data-civilite');var nom=$(element).attr('data-nom');var prenom=$(element).attr('data-prenom');var adresse1=$(element).attr('data-adresse1');var adresse2=$(element).attr('data-adresse2');var cp=$(element).attr('data-cp');var ville=$(element).attr('data-ville');var pays=$(element).attr('data-pays');var teldom=$(element).attr('data-teldom');var telbur=$(element).attr('data-telbur');$('.civilite').val(decodeURIComponent(civilite.replace(/\+/g,' ')));$('.nom').val(decodeURIComponent(nom.replace(/\+/g,' ')));$('.prenom').val(decodeURIComponent(prenom.replace(/\+/g,' ')));$('.adresse1').val(decodeURIComponent(adresse1.replace(/\+/g,' ')));$('.adresse2').val(decodeURIComponent(adresse2.replace(/\+/g,' ')));$('.cp').val(decodeURIComponent(cp.replace(/\+/g,' ')));$('.ville').val(decodeURIComponent(ville.replace(/\+/g,' ')));$('.pays').val(decodeURIComponent(pays.replace(/\+/g,' ')));$('.teldom').val(decodeURIComponent(teldom.replace(/\+/g,' ')));$('.telbur').val(decodeURIComponent(telbur.replace(/\+/g,' ')));})(jQuery);}
function initAutocompleteClientsExistantsMiniCatalogue(){(function($){var date;var timeKeyUp;var xhr;$('.div_champMiniCatalogue .nom, .div_champMiniCatalogue .prenom, #div_envoiAmiContent #email1, .div_champMiniCatalogue .cp, .div_champMiniCatalogue .teldom').keyup(function(){if($('.div_champMiniCatalogue .rpenom').val()!=''){if($('.div_champMiniCatalogue .nom').val()==''&&$('#div_envoiAmiContent #email1').val()==''&&$('.div_champMiniCatalogue .cp').val()==''&&$('.div_champMiniCatalogue .teldom').val()==''){return false;}}
date=new Date();timeKeyUp=date.getTime();setTimeout(function(){date=new Date();var time=date.getTime();var delai=time-timeKeyUp;if(delai>=800){xhr=lanceAutocompleteClients(false,true);}},800);});$('.div_champMiniCatalogue .nom, .div_champMiniCatalogue .prenom, #div_envoiAmiContent #email1, .div_champMiniCatalogue .cp, .div_champMiniCatalogue .teldom').keypress(function(){if(xhr!==undefined){xhr.abort();}});})(jQuery);}
function initGestionModelesMailMiniCata(){(function($){$('#btnAjoutModeleMailMiniCata').click(function(){$(this).next('.error').html('');var objet=$('#emailObjet').val();var mail=$('#emailMessage').val();if(objet.length===0){$(this).next('.error').html('Vous n\'avez pas saisi d\'objet !');return;}else if(mail.length===0){$(this).next('.error').html('Le contenu de votre email est vide !');return;}
$.ajax({url:'./ajax/appelsAjax.php',type:'POST',data:{'mail':mail,'objet':objet,'action':'addNewModeleMailMiniCata'},beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(data,textStatus,jqXHR){if(data==='KO'){$(this).next('.error').html('Une erreur s\'est produite !');return;}
var rep=JSON.parse(data);if($("#selectModelMailMiniCata option[value='"+rep.value+"']").length===0){$('#selectModelMailMiniCata').append('<option value="'+rep.value+'">'+rep.text+'</option>');}
$('#selectModelMailMiniCata').val(rep.value);},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});});$('#supprModeleMailMiniCata').click(function(){var file=$('#selectModelMailMiniCata').val();if(file.length===0){$('#emailObjet').val("");$('#emailMessage').val("");return;}
$.ajax({url:'./ajax/appelsAjax.php',type:'POST',data:{'file':file,'action':'supprModeleMailMiniCata'},beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(data,textStatus,jqXHR){if(data==='KO'){$(this).next('.error').html('Une erreur s\'est produite !');return;}
$('#selectModelMailMiniCata option[value="'+file+'"]').remove();$('#emailObjet').val("");$('#emailMessage').val("");setValueMessageMailMiniCata();},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});});$('#selectModelMailMiniCata').change(function(){var file=$(this).val();if(file.length===0){$('#emailObjet').val("");setValueMessageMailMiniCata();return;}
$.ajax({url:'./ajax/appelsAjax.php',type:'POST',data:{'file':file,'action':'getModeleMailMiniCata'},beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(data,textStatus,jqXHR){if(data==='KO'){$(this).next('.error').html('Une erreur s\'est produite !');return;}
$('#emailObjet').val(file.replace('.txt',''));setValueMessageMailMiniCata(data);},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});});$('#emailMessage').redactor({lang:'fr',emptyHtml:"<br/>",buttons:['html','|','formatting','|','bold','italic','deleted','|','underline','|','unorderedlist','orderedlist','|','link','|','fontcolor','|','alignment'],minHeight:250,});})(jQuery);}
function enregistrerDernierModeleUtilise(valueDernierModele){var dernierModele=valueDernierModele||jQuery('#selectModelMailMiniCata').val()||'';window.localStorage["dernierModeleUtilise"]=dernierModele;}
function getDernierModelUtilise(){return window.localStorage["dernierModeleUtilise"]||'';}
function setValueMessageMailMiniCata(value){(function($){var message=value||"";$('#div_envoiAmiMessage .div_contentEnvoiAmi').empty();var textarea='<textarea type="text" id="emailMessage" name="liste2Ami_message">'+message+'</textarea>';$('#div_envoiAmiMessage .div_contentEnvoiAmi').append(textarea);$('#emailMessage').redactor({lang:'fr',emptyHtml:"<br/>",buttons:['html','|','formatting','|','bold','italic','deleted','|','underline','|','unorderedlist','orderedlist','|','link','|','fontcolor','|','alignment'],minHeight:250,});})(jQuery);}
function initBtnImprSeulementMiniCata(){return;(function($){$('#a_imprFormMail').click(function(){var nom=new LiveValidation('nomPourMiniCatalogue',{validMessage:'Ok',onlyOnSubmit:true});nom.add(Validate.Presence,{failureMessage:"Champ obligatoire"});var prenomClient=new LiveValidation("prenomDeLaPart",{validMessage:"Ok",onlyOnSubmit:true});prenomClient.add(Validate.Presence,{failureMessage:"Champ obligatoire"});var tabValidate=new Array(nom,prenomClient);if(LiveValidation.massValidate(tabValidate)){setInfosClientMiniCataPourPrint();}});})(jQuery);}
function setInfosClientMiniCataPourPrint(){(function($){var civilite=$('#div_saisieInfosClientPourMiniCata .civilite').val();var nom=$('#div_saisieInfosClientPourMiniCata .nom').val()||"";var prenom=$('#div_saisieInfosClientPourMiniCata .prenom').val()||"";var adresse1=$('#div_saisieInfosClientPourMiniCata .adresse1').val()||"";var adresse2=$('#div_saisieInfosClientPourMiniCata .adresse2').val()||"";var cp=$('#div_saisieInfosClientPourMiniCata .cp').val()||"";var ville=$('#div_saisieInfosClientPourMiniCata .ville').val()||"";var pays=$('#div_saisieInfosClientPourMiniCata .pays').val()||"";var teldom=$('#div_saisieInfosClientPourMiniCata .teldom').val()||"";var telbur=$('#div_saisieInfosClientPourMiniCata .telbur').val()||"";$.ajax({url:'/lib_2/ajax/gerePanier.php',type:'POST',data:{action:'setObjClientPanierPourPrint',cv:civilite,nom:nom,prenom:prenom,adresse1:adresse1,adresse2:adresse2,cp:cp,ville:ville,pays:pays,teldom:teldom,telbur:telbur},beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(data,textStatus,jqXHR){effaceDivAvecTransparence();window.open('?TO_PDF=1','_blank');},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});})(jQuery);}
function lanceScriptResa(a){console.log(a);}
function initFormContactRgpd(){if(jQuery('.frm_contactRgpd').length>0){jQuery(".a_validFormContactRgpd").click(function(){jQuery(this).closest('.div_formContactRgpd').addClass('aEnvoyer');var formId=jQuery(this).closest('.div_formContactRgpd').find('form').attr('id');checkForm($(formId),envoiMailContactRgpd,removeClassAEnvoyer);});jQuery('#selectInstanceRGPD').change(function(){jQuery('.blockWidgetRGPD').hide();jQuery('.blockWidgetRGPD[data-instance="'+jQuery(this).val()+'"]').show();});}}
function envoiMailContactRgpd(){var idDiv=jQuery('.aEnvoyer').attr('id');var idForm=jQuery('.aEnvoyer').find('form').attr('id');envoiMailByAjaxByForm(idForm,idDiv,true);removeClassAEnvoyer();}
function removeClassAEnvoyer(){jQuery('div').removeClass('aEnvoyer');}
function urlEstAvecProtocol(url){if(url.match(/^http[s]{0,1}:\/\//)!==null){return true;}
return false;}
function prepareHtmlForPdfConvertion(){(function($){$('link[rel="stylesheet"]').each(function(){if(!urlEstAvecProtocol($(this).attr('href'))){$(this).attr('href',window.location.protocol+'//'+window.location.host+$(this).attr('href'));}});$('img').each(function(){if(!urlEstAvecProtocol($(this).attr('src'))){$(this).attr('src',window.location.protocol+'//'+window.location.host+$(this).attr('src'));}});})(jQuery);}
function initCarouselDatesGestprod(){(function($){if($('.div_carouselDatesPackage').length>0){var premiereDate;var premiereDateResponsive;if($('#dateCarouselSelected').prev().prev().prev().length>0){premiereDate=parseInt($('#dateCarouselSelected').prev().prev().prev().data('position'));premiereDateResponsive=premiereDate+2;}
else if($('#dateCarouselSelected').prev().prev().length>0){premiereDate=parseInt($('#dateCarouselSelected').prev().prev().data('position'));premiereDateResponsive=premiereDate+1;}
else if($('#dateCarouselSelected').prev().length>0){premiereDate=parseInt($('#dateCarouselSelected').prev().data('position'));premiereDateResponsive=premiereDate;}
$('.div_carouselDatesPackage').owlCarousel({loop:false,margin:5,nav:true,navText:["<span></span>","<span></span>"],responsive:{0:{startPosition:premiereDateResponsive,items:3,slideBy:3},778:{startPosition:premiereDate,items:7,slideBy:7}}});}})(jQuery);}
function enleverHoverSurTactile(){if(hasTouch()){try{for(var si in document.styleSheets){var styleSheet=document.styleSheets[si];if(!styleSheet.rules)continue;for(var ri=styleSheet.rules.length-1;ri>=0;ri--){if(!styleSheet.rules[ri].selectorText)continue;if(styleSheet.rules[ri].selectorText.match(':hover')){var arrayOfStrings=styleSheet.rules[ri].selectorText.split(',');var fullString='';for(var i=0;i<arrayOfStrings.length;i++){if(!(arrayOfStrings[i].match(':hover'))){fullString=fullString+arrayOfStrings[i];}}
console.log(fullString);}}}}catch(ex){}}}
function hasTouch(){return'ontouchstart'in document.documentElement||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;}
function initSimulationAbonnement(){jQuery('.simulationAbonnement .div_submit input').click(function(){var nbUnite=parseInt(jQuery('.simulationAbonnement .nbUnites input').val());var resultat=150+2*nbUnite;jQuery('.simulationAbonnement .nbUnites input').val(nbUnite);if(jQuery('.simulationAbonnement .nbUnites input').val()<1){jQuery('.simulationAbonnement .resultat').hide();alert("Veuillez saisir une valeur positive non nulle");}else{jQuery('.simulationAbonnement .resultat .value').html(resultat);jQuery('.simulationAbonnement .resultat').show();}});}
function initModalTaxeSejour(){(function($){if($('#div_popinTaxeSejourDetail').length>0){$('#lienModalInfosTaxeSejour').fancybox({maxWidth:800});$('.infoTaxeSejour').click(function(){$('#lienModalInfosTaxeSejour').click();});if($('#lienModalInfosTaxeSejour')&&$('#lienModalInfosTaxeSejour').attr('data-autoclick')&&$('#lienModalInfosTaxeSejour').attr('data-autoclick').length>0){$('#lienModalInfosTaxeSejour').click();}}})(jQuery);}
function getTabInfosIdObjetPayable(idObjetPayable){var tabInfos=idObjetPayable.split('_');return{'instance':tabInfos[0],'id_famille':tabInfos[1],'exercice':tabInfos[2],'numero':tabInfos[3],'code_societe':tabInfos[4]};}
function isNullOrUndefined(variable){if(typeof variable==='undefined'||variable===null){return true;}
return false;}
function isNullOrUndefinedOrEmpty(variable){if(isNullOrUndefined(variable)||variable===''){return true;}
return false;}
function estModeAdmin(){if(jQuery('.div_adminV5modificationPage').length>0){return true;}
return false;}
function initAlerteGeneral(){(function($){if($('#div_massageAlerteGeneral').length>0){if(!getCookie('POPIN_MESSAGE_GENERAL')){var html=$('#div_massageAlerteGeneral').html();$.fancybox({maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',content:html,padding:0,wrapCSS:'messageAlerteGeneral'});if(!estModeAdmin()){setCookie('POPIN_MESSAGE_GENERAL','ouvert');}}}})(jQuery);}
function isNullOrUndefined(variable){if(typeof variable==='undefined'||variable===null){return true;}
return false;}
function isNullOrUndefinedOrEmpty(variable){if(isNullOrUndefined(variable)||variable===''){return true;}
return false;}
function gestionAffichageSelecteurLangue(){var nouvelleLangCurr=langueDemandeUtilisateur();if(nouvelleLangCurr==='zh-CN'){nouvelleLangCurr='cn';}
jQuery('.langues.avecGoogleTanslate .listeLangues li.langueCourante').removeClass('langueCourante').show();jQuery('.langues.avecGoogleTanslate .listeLangues li.'+nouvelleLangCurr.toUpperCase()).addClass('langueCourante').hide();var nouvelleLangCurrText=jQuery('.langues.avecGoogleTanslate .listeLangues li.langueCourante span').attr('data-langue');jQuery('.langues.avecGoogleTanslate #current').attr('data-lang',nouvelleLangCurr.toUpperCase());jQuery('html').attr('lang',nouvelleLangCurr).attr('xml:lang',nouvelleLangCurr);jQuery('.langues.avecGoogleTanslate #current img').attr('src','/imgs_defaut/css/header/'+nouvelleLangCurr+'.gif');jQuery('.langues.avecGoogleTanslate #current img').attr('alt',nouvelleLangCurrText);jQuery('.langues.avecGoogleTanslate #current span').html(nouvelleLangCurrText);}
function langueDemandeUtilisateur(){if(!isNullOrUndefinedOrEmpty(getCookie('langueTraduction'))){return getCookie('langueTraduction');}
if(navigator.language==='zh-CN'){return navigator.language;}
return navigator.language.match(/(.{0,2})(-.*)?/)[1];}
function langueAffichee(){if(isNullOrUndefinedOrEmpty(getCookie('googtrans'))){return'fr';}
return getCookie('googtrans').match(/\/(.{0,4})\/(.*)?/)[2];}
function changeLangueDemandeUtilisateur(langue){setCookie('langueTraduction',langue);traduitAvecGoogle();}
function traduitAvecGoogle(){gestionAffichageSelecteurLangue();if(langueDemandeUtilisateur()===langueAffichee()){return;}
doGTranslate('|'+langueDemandeUtilisateur());}
function initAncienneVersionJQuery(){(function($){if(typeof jQuery.fn.on==="undefined"){$.fn.on=function(){return this;};}})(jQuery);}
function envBurIteaEstSet(){return typeof envBurItea!=='undefined';}
function updatePrixReglette(element){var input=jQuery(element);jQuery('.prixSelonNombreFormatReglette .prixRegletteInput span.valeur').html(input.val());jQuery('.prixSelonNombreFormatReglette .prixRegletteTarif > span').hide();jQuery('.prixSelonNombreFormatReglette .prixRegletteTarif > span.'+input.val()).show();}
function switchPolitiqueConfidentialite(selecteurHtmlAToggle=''){if(selecteurHtmlAToggle!==''){jQuery(selecteurHtmlAToggle).toggleClass('disabled');}}
function initAllCalendrierItea(){$$("div.calendrierITEANbMois").each(function(objCal){objCal.hide();var btPrec=objCal.select("span.calendrierITEA_navig_previous").first();var btSuiv=objCal.select("span.calendrierITEA_navig_next").first();var nbMois=objCal.getAttribute("nbMois");var div1mois=objCal.select("div.calendrierITEA1Mois").first();var objUl=objCal.select("ul.calendrierITEA_list").first();if(objUl){objUl.style.position="absolute";objUl.style.width="50000px";objCal.style.overflow="hidden";setScrollHorizontalOnDiv(objCal,objUl,{"nextButton":btSuiv,"prevButton":btPrec,"nbLiDecal":nbMois});}
objCal.show();});}
function setScrollHorizontalOnDiv(idDiv,idUl,params){if(!$(params.nextButton)||!$(params.prevButton)){return false;}
var btSuiv=$(params.nextButton);var btPrec=$(params.prevButton);var decal;if(!params.noResizeToLi){if($(idDiv)&&$(idUl)&&$(idUl).firstChild){$(idDiv).style.width=$(idUl).firstChild.offsetWidth+'px';$(idUl).style.padding='0px';}}
btPrec.style.visibility="hidden";if(btSuiv){btSuiv.onclick=function(evt){if(params.decalage){decal=params.decalage;}else if(params.nbLiDecal){var unLi=idUl.childNodes[1].offsetLeft;decal=unLi*params.nbLiDecal;}else{decal=$(idDiv).getWidth();}
var posXLastChild=$(idUl).childElements().last().positionedOffset(idUl).left;var posX0=$(idUl).positionedOffset(idDiv).left;var posX1=posXLastChild+$(idUl).childElements().last().getWidth()+posX0;var posFinal=posXLastChild+$(idUl).childElements().last().getWidth();if(posX1-decal<decal){decal=posX1-decal;}
if(btPrec){btPrec.style.visibility="visible";}
if(params.scrollSansEffet){var position=$(idUl).positionedOffset(idDiv).left;$(idUl).style.left=(position+(decal*-1))+"px";if(decal==0){btSuiv.style.visibility="hidden";}
if($(params.ulJumelle)){$(params.ulJumelle).style.left=$(params.ulJumelle).positionedOffset(idDiv).left+(decal*-1);}}else{new Effect.Move(idUl,{x:decal*-1,mode:'relative'})
if($(params.ulJumelle)){new Effect.Move(params.ulJumelle,{x:decal*-1,mode:'relative'})}}}}
if(btPrec){btPrec.onclick=function(evt){if(params.decalage){decal=params.decalage;}else if(params.objDecalage){decal=params.objDecalage.getWidth();if(params.multipDecal){decal*=params.multipDecal;}}else{decal=$(idDiv).getWidth();}
var posX=$(idUl).positionedOffset(idDiv).left;if(posX+decal>0){decal=posX*-1;}
if(btSuiv){btSuiv.style.visibility="visible";}
if(params.scrollSansEffet){var position=$(idUl).positionedOffset(idDiv).left;$(idUl).style.left=(position+decal)+"px";if((position+decal)==0){btPrec.style.visibility="hidden";}
if($(params.ulJumelle)){$(params.ulJumelle).style.left=$(params.ulJumelle).positionedOffset(idDiv).left+decal;}}else{new Effect.Move(idUl,{x:decal,mode:'relative'})
if($(params.ulJumelle)){new Effect.Move(params.ulJumelle,{x:decal,mode:'relative'})}}}}
return true;}
function setScrollVerticalOnDiv(idDiv,idUl,params){var btSuiv=$(params.nextButton);var btPrec=$(params.prevButton);var decal;if(!params.noResizeToLi){if($(idDiv)&&$(idUl)&&$(idUl).firstChild){var tailleMax=normaliseTaille(idDiv,idUl+" li","fieldset",{"height":true,"width":true,"conteneur":"li"});if(getVersionIE()<9){var hauteurMax=parseInt(tailleMax['h'])+10;var largeurMax=parseInt(tailleMax['w'])+20;}else{var largeurMax=parseInt(tailleMax['w'])+15;var hauteurMax=parseInt(tailleMax['h'])+10;}
if(!params.nbLi){$(idDiv).style.width=largeurMax*2+'px';$(idDiv).style.height=hauteurMax*3+'px';$(idUl).style.width=(largeurMax-5)*2+'px';}else{if(parseInt(params.nbLi)<=2){$(idDiv).style.height=hauteurMax+'px';if(parseInt(params.nbLi)<=1){$(idDiv).style.width=largeurMax+'px';$(idUl).style.width=largeurMax-5+'px';}
else{$(idDiv).style.width=largeurMax*2+'px';$(idUl).style.width=(largeurMax-5)*2+'px';}}else if(parseInt(params.nbLi)>2&&(parseInt(params.nbLi)<7)){$(idDiv).style.height=hauteurMax*(Math.ceil(params.nbLi/2))+'px';$(idDiv).style.width=largeurMax*2+'px'
$(idUl).style.width=(largeurMax-5)*2+'px';}else{$(idDiv).style.width=largeurMax*2+'px'
$(idDiv).style.height=hauteurMax*3+'px';$(idUl).style.width=(largeurMax-5)*2+'px'}}
$(idUl).style.padding='0px';}}
if(btSuiv){btSuiv.onclick=function(evt){if(params.decalage)decal=params.decalage;else if(params.nbLiDecal){var unLi=$(idUl).childNodes[1].offsetHeight;decal=unLi*params.nbLiDecal;}else if(params.listeBulle){if($(idUl).positionedOffset(idDiv).top>0){if(getVersionIE()<9)decal=hauteurMax+25;else decal=hauteurMax+20;}
else{decal=hauteurMax+2;}}else decal=$(idDiv).getHeight();var posYLastChild=$(idUl).childElements().last().positionedOffset(idUl).top;var posY0=$(idUl).positionedOffset(idDiv).top;var posY1=posYLastChild+$(idUl).childElements().last().getHeight()+posY0;if(posY1-decal<decal){decal=posY1-decal;}
if(params.scrollSansEffet){$(idUl).style.top=($(idUl).positionedOffset(idDiv).top+(decal*-1))+"px";if($(params.ulJumelle))$(params.ulJumelle).style.top=$(params.ulJumelle).positionedOffset(idDiv).top+(decal*-1);}else{new Effect.Move(idUl,{y:decal*-1,mode:'relative'})
if($(params.ulJumelle))new Effect.Move(params.ulJumelle,{y:decal*-1,mode:'relative'})}}}
if(btPrec){btPrec.onclick=function(evt){if(params.decalage)decal=params.decalage;else if(params.objDecalage){decal=params.objDecalage.getHeight();if(params.multipDecal)decal*=params.multipDecal;}else if(params.listeBulle){if($(idUl).positionedOffset(idDiv).top>0){if(getVersionIE()<9)decal=hauteurMax+20;else decal=hauteurMax+20;}
else decal=hauteurMax+2;}
else decal=$(idDiv).getHeight();var posY=$(idUl).positionedOffset(idDiv).top;if(posY+decal>0){decal=posY*-1;}
if(params.scrollSansEffet){$(idUl).style.top=($(idUl).positionedOffset(idDiv).top+decal)+"px";if($(params.ulJumelle))$(params.ulJumelle).style.top=$(params.ulJumelle).positionedOffset(idDiv).top+decal;}else{new Effect.Move(idUl,{y:decal,mode:'relative'})
if($(params.ulJumelle))new Effect.Move(params.ulJumelle,{y:decal,mode:'relative'})}}}
return true;}
function setScrollHorizontalOnLstGenerePage(idDiv,idUl,params){if(!$(idDiv)||!$(idUl)||!$(params.idDivPastePage))return false;var eltUl=new Element("ul",{'class':'ulScrollPage'});var numPage=1;$(idUl).childElements().each(function(eltPage){var eltLi=new Element("li",{'class':'liScrollPage'})
if(numPage==1)eltLi.addClassName("liScrollPage_select");eltLi.numPage=numPage;eltLi.update(numPage++);eltLi.observe("click",function(evt){$$("li.liScrollPage_select").each(function(obj){obj.removeClassName("liScrollPage_select");});this.addClassName("liScrollPage_select");var liAAfficher=$(idUl).childElements().toArray()[(this.numPage-1)];var decalLi=liAAfficher.positionedOffset(idDiv).left;var decalCurr=$(idUl).positionedOffset(idDiv).left;var decal=(decalLi+decalCurr)*-1;new Effect.Move(idUl,{x:decal,mode:'relative'})});eltUl.appendChild(eltLi);});switch(params.position){case"bottom":default:$(params.idDivPastePage).appendChild(eltUl);break;case"top":$(params.idDivPastePage).insertBefore(eltUl,$(params.idDivPastePage).childElements().first());break;}
return true;}
function normaliseTaille(idDiv,idConteneur,elementChild,params){var maxHeight=0;var maxWidth=0;var maxTaille=new Array();$$("#"+idConteneur+" "+elementChild).each(function(obj){if(getVersionIE()<9){if(obj.clientHeight>=maxHeight)maxHeight=obj.clientHeight;if(obj.clientWidth>=maxWidth)maxWidth=obj.clientWidth;}else{if(obj.offsetHeight>=maxHeight)maxHeight=obj.offsetHeight;if(obj.offsetWidth>=maxWidth)maxWidth=obj.offsetWidth;}});if(params.conteneur){$$("#"+idConteneur).each(function(obj1){if(params.height){if(getVersionIE()<9)obj1.style.height=parseInt(maxHeight)+"px";else obj1.style.height=parseInt(maxHeight)+10+"px";}
if(params.width){if(getVersionIE()<9)obj1.style.width=parseInt(maxWidth)+10+"px";else obj1.style.width=parseInt(maxWidth)+10+"px";}});}
$$("#"+idConteneur+" "+elementChild).each(function(obj){if(params.height){if(getVersionIE()<9)obj.style.height=parseInt(maxHeight)-10+"px";else obj.style.height=parseInt(maxHeight)+"px";}
if(params.width){if(getVersionIE()<9)obj.style.width=parseInt(maxWidth)-10+"px";else obj.style.width=parseInt(maxWidth)+"px";}});maxTaille['h']=maxHeight;maxTaille['w']=maxWidth;return maxTaille;}
function setActionSurDiaporama(){if(jQuery(".div_mediaDiapoPage").length>0){jQuery(".div_mediaDiapoPage").each(function(){if(jQuery(this).find("li").length>1){var time=jQuery(this).attr("data-temps");var hauteur=jQuery(this).attr("data-hauteur");var largeur=jQuery(this).attr("data-largeur");var afficherNavigation=jQuery(this).attr("data-navigation");var status_controls=false;if(afficherNavigation=='1'){status_controls=true;}
if(jQuery(this).attr("data-sudoslider")=='1'){var auto=false;if(time>0){time*=1000;auto=true}
jQuery(this).css('width',largeur+'px');jQuery(this).css('position','relative');jQuery(this).css('overflow','hidden');jQuery(this).children('ul').css('position','relative');var sudoSliderLook=jQuery(this).sudoSlider({autowidth:false,slideCount:1,moveCount:1,pause:time,auto:auto});}
else if(time>0){jQuery(this).jDiaporama({delay:time,theme:"default",useThumbs:false,width:largeur,height:hauteur,transition:"fade",status_controls:status_controls,keyboard:false,infos:true,onrollover:false,currentimage:status_controls,controls:status_controls,constraintWidth:false});}}});}
if(jQuery(".SudoSlider_numeric").length>0){jQuery(".SudoSlider_numeric").each(function(){var sudoSlider=jQuery(this).sudoSlider({fade:true,crossFade:false,numeric:true,prevNext:false});});}
if(jQuery(".SudoSlider_auto").length>0){jQuery(".SudoSlider_auto").each(function(){var sudoSlider=jQuery(this).sudoSlider({fade:true,auto:true,prevNext:false});});}
if(jQuery(".iteaV5_responsiveSlides").length>0){setTimeout(function(){jQuery('.iteaV5_responsiveSlides li img').each(function(){if(jQuery(this).data('srcfullquality')){jQuery(this).attr('src',jQuery(this).data('srcfullquality'));}});},5000);jQuery(".iteaV5_responsiveSlides").each(function(){var time=1000*jQuery(this).attr("data-temps");var speed=jQuery(this).attr("data-speed");var nav=false;var auto=true;if(jQuery(this).attr("data-auto")=="false"){var auto=false;}
if(jQuery(this).attr("data-nav")=='1'){nav=true;}
if(!speed){speed=500;}
jQuery(this).responsiveSlides({timeout:time,speed:speed,nav:nav,pager:nav,prevText:"",nextText:"",auto:auto});});iteaV5_responsiveSlidesLoadFondLi();jQuery(window).resize(function(){setTimeout(function(){iteaV5_responsiveSlidesLoadFondLi();},500);});}}
function iteaV5_responsiveSlidesLoadFondLi(){jQuery('li[data-diaporamasrcli]').each(function(){jQuery(this).css('background-image','url('+jQuery(this).data('diaporamasrcli')+'?width='+jQuery(this).width()+'&height='+jQuery(this).height()+')');});}
function afficheNextImgInDiapo(){$$('.div_mediaDiapoPage').each(function(elt){var divImgAAfficher=$(elt.childNodes[0]);var listeMediaDispoInDiapo=$(elt.childNodes[2]).children;if(window.compteurImgInDiapoMedia[elt.id]==undefined){if($(elt.childNodes[2]).children.length>2)window.compteurImgInDiapoMedia[elt.id]=1;else window.compteurImgInDiapoMedia[elt.id]=0;}
divImgAAfficher.childNodes[0].style.position="absolute";divImgAAfficher.childNodes[1].style.position="absolute";if($(divImgAAfficher.childNodes[0]).style.display=="none"){$(divImgAAfficher.childNodes[0]).appear({duration:1.5,from:0.0,to:1.0});$(divImgAAfficher.childNodes[1]).fade({duration:1.5,from:1.0,to:0.0});}
if($(divImgAAfficher.childNodes[1]).style.display=="none"){$(divImgAAfficher.childNodes[1]).appear({duration:1.5,from:0.0,to:1.0});$(divImgAAfficher.childNodes[0]).fade({duration:1.5,from:1.0,to:0.0});}
if($(divImgAAfficher.childNodes[0]).style.display=="none"){$(divImgAAfficher.childNodes[0]).src=$(listeMediaDispoInDiapo[window.compteurImgInDiapoMedia[elt.id]]).readAttribute("source");}else $(divImgAAfficher.childNodes[1]).src=$(listeMediaDispoInDiapo[window.compteurImgInDiapoMedia[elt.id]]).readAttribute("source");window.compteurImgInDiapoMedia[elt.id]+=1;if(window.compteurImgInDiapoMedia[elt.id]>=$(elt.childNodes[2]).children.length){window.compteurImgInDiapoMedia[elt.id]=0;}});}
function blindUpDown(idDiv){var div=$(idDiv);if(!div)return;if(div.showing!=true){div.showing=true;Effect.BlindDown($(div),{duration:0.5});}
else{div.showing=false;Effect.BlindUp($(div),{duration:0.5});}}
function blindUpDownByClass(classe){var elems=$$(classe);if(!elems)return;elems.each(function(elem){blindUpDown(elem.identify());});}function chargeMotCleDansDiv(idDiv,motCle){if(!window.jsonMotcle)window.jsonMotcle=[];for(var i=0;i<window.jsonMotcle.length;i++){if(window.jsonMotcle[i].motcle==motCle){if($(idDiv))$(idDiv).innerHTML=window.jsonMotcle[i].content;return;}}
var adr="/lib_2/ajax/contenuFenetre.php";var sending=getInfoSession()+"&element=motCle&typeInfo=motcle&val="+motCle;appelAjaxToFunc(adr,sending,function(reponse){window.jsonMotcle.push({'motcle':motCle,'content':reponse});window.jsonMotcle.uniq();if($(idDiv))$(idDiv).innerHTML=reponse;});}
function chargeInformationKML(urlInformation){var xmlhttp=creeObjHttpRequest();xmlhttp.open("GET",urlInformation,false);xmlhttp.send();xmlDoc=xmlhttp.responseXML;var url="";var id="";var tabInfos=new Array();var length=xmlDoc.getElementsByTagName("KML").length;for(var i=0;i<length;i++){id=xmlDoc.getElementsByTagName("KML")[i].getAttribute("id");url=xmlDoc.getElementsByTagName("KML")[i].childNodes[0].nodeValue;tabInfos[i]=new Array();tabInfos[i]["url"]=url;tabInfos[i]["id"]=id;}
return tabInfos;}
function getInformationKMLByRep(foncQdfini){var url="/lib_2/ajax/google_map.php";var sending="CMD=infosKml";var xhr_local=creeObjHttpRequest();xhr_local.onreadystatechange=function(){if(xhr_local.readyState==4&&xhr_local.status==200){var reponse=eval('('+xhr_local.responseText+')');if(foncQdfini)foncQdfini(reponse);}}
xhr_local.open("POST",url,true);xhr_local.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr_local.send(sending);}
function iteaGMAP_initForFiche(icon,reload,mapType){if(jQuery('div.div_itea_GMAP iframe').length>0){return;}
if(!window.iconGMAP){window.iconGMAP=icon;}
if(loadScriptGoogleMap()){return;}
if(window.iconGMAP){icon=window.iconGMAP;}
if(!icon){icon=null;}
if(!reload){reload=false;}
$$(".div_itea_GMAP").each(function(obj){if(!jQuery(obj).is(':hidden')){if(reload){var mapInstancie=window.gmap||false;reload=false;if(mapInstancie){reload=true;}}
var lat=obj.getAttribute("latitude");var lng=obj.getAttribute("longitude");var zoom=8;var latCarte;var lngCarte;if(obj.getAttribute("zoom").length>0){zoom=obj.getAttribute("zoom");}
if(obj.getAttribute("picto").length>0)
icon=obj.getAttribute("picto");if(reload){zoom=window.gmap.getZoom();var centreCarte=window.gmap.getCentre();latCarte=centreCarte.lat();lngCarte=centreCarte.lng();}else{latCarte=lat;lngCarte=lng;mapType='roadmap';}
switch(mapType){case'satellite':mapType=google.maps.MapTypeId.SATELLITE;break;case'roadmap':mapType=google.maps.MapTypeId.ROADMAP;break;default:mapType=window.gmap.getMapType();break;}
window.gmap=new ObjGoogleMap(latCarte,lngCarte,zoom,null,null,null,mapType,obj.id,false);var kml=obj.getAttribute("data-kml");if(kml){var testKML=new google.maps.KmlLayer({map:window.gmap.google_map,url:kml,preserveViewport:true});}
var centre=new google.maps.LatLng(lat,lng);window.gmap.addMarker(centre,icon,null,null,null);}});}
function iteaGMAP_initForListe(idDiv){var maFrame='<iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"';maFrame+=' src="https://maps.google.com/maps?q=libelle+%40'+jQuery('#'+idDiv).attr('latitude')+','+jQuery('#'+idDiv).attr('longitude')+'&output=embed" ></iframe>';jQuery('#'+idDiv).html(maFrame);}
function iteaGmapImage(idDiv,largeur,hauteur){var obj=$(idDiv);var zoom=8;if(!largeur){largeur=200;}
if(!hauteur){hauteur=200;}
var latCarte=obj.getAttribute("latitude");var lngCarte=obj.getAttribute("longitude");var key=obj.getAttribute("data-key");var url="https://maps.googleapis.com/maps/api/staticmap?center="+latCarte+","+lngCarte+"&zoom="+zoom+"&size="+largeur+"x"+hauteur+"&markers="+latCarte+","+lngCarte+"&key="+key;var lnk="https://maps.google.com/maps?q="+latCarte+","+lngCarte+"&z="+zoom;var container=document.getElementById(idDiv);var codeHTML="<a target='_blank' href='"+lnk+"'><img src='"+url+"' alt='google map' />";if(obj.getAttribute("data-lblzoom")){codeHTML+="<span class='lblzoom'>"+obj.getAttribute("data-lblzoom")+"</span>";}
codeHTML+="</a>";container.innerHTML=codeHTML;}
function updateUrlItineraireGmap(){(function($){var from=$('#inpt_adresseGmap').val().replace(/ /g,'+');var lat=$('div#div_itea_map_leaf_fiche').data('latitude');var lon=$('div#div_itea_map_leaf_fiche').data('longitude');if(isNaN(lat)){lat=$('div.div_itea_GMAP').data('latitude');lon=$('div.div_itea_GMAP').data('longitude');}
$('#span_validerGmap').attr('href','https://www.google.com/maps/dir/'+from+'/'+lat+','+lon+'/');})(jQuery);}
function afficheItineraireInDiv(){(function($){var from=$('#inpt_adresseGmap').val().replace(/ /g,"+");var lat=$('div#div_itea_map_leaf_fiche').data('latitude');var lon=$('div#div_itea_map_leaf_fiche').data('longitude');if(lat===undefined){lat=$('div.div_itea_GMAP').data('latitude');lon=$('div.div_itea_GMAP').data('longitude');}
var to=lat+','+lon;window.open("https://www.google.com/maps/dir/"+from+"/"+to+"/");})(jQuery);}
function iteaGMAP_initItineraire(param){var gmap=window.gmap||false;var lat,lng;if(jQuery(".div_itea_GMAP").length>0){var divMap=jQuery(".div_itea_GMAP")[0];lat=jQuery(divMap).attr("latitude");lng=jQuery(divMap).attr("longitude");}
if(!lat&&!lng){if(gmap){lat=window.gmap.getCentre().lat();lng=window.gmap.getCentre().lng();}else{var params=getParamsGoogleMap('classique');lat=params.x;lng=params.y;}}
window.gmap2=new ObjGoogleMap(lat,lng,8,null,null,null,google.maps.MapTypeId.ROADMAP,"divGmapItinerairePlan",false,google.maps.MapTypeControlStyle.DROPDOWN_MENU);var centre=new google.maps.LatLng(lat,lng);window.gmap2.addMarker(centre,null,null,null,null);window.gmap2.construireItineraire(window.gmap2,param.addr);}
function stopAjaxForCarte(){window.stop();if(window.gmap)window.gmap.reload();}
function iteaGMAPStreetView_initForFiche(paramsCarte,paramsStreetView){if(loadScriptGoogleMap()){return;}
if($$(".div_itea_GMAP").length==0&&$("div_itea_streetView")==undefined){return;}
if($$(".div_itea_GMAP_parametrable").length==0&&$('div_fiche_streetView')==undefined){iteaGMAP_initForFiche(paramsCarte.img);return;}else if($("div_itea_streetView")&&$("div_itea_streetView").getAttribute('data-chargercartoetsv')=='1'){iteaGMAP_initForFiche(paramsCarte.img);}
(function($){if(paramsCarte){$.data($('body')[0],'paramsCarte',paramsCarte);$.data($('body')[0],'paramsStreetView',paramsStreetView);}
else{paramsCarte=$.data($('body')[0],'paramsCarte');paramsStreetView=$.data($('body')[0],'paramsStreetView');}
var pitch=5;var zoom=1;var heading=0;if($("#div_itea_streetView").length>0&&$("#div_itea_streetView").attr('data-svparams').length>0){var tabParams=$("#div_itea_streetView").attr('data-svparams').split(',');var estNouveauCBP=false;if(tabParams.length==3){$.each(tabParams,function(key,value){valtmp=value.substr(0,(value.length-1));if(valtmp.length>0){switch(value.substr((value.length-1),1)){case'h':heading=valtmp;paramsStreetView.heading=valtmp;estNouveauCBP=true;break;case'y':zoom=0;if(valtmp<65){zoom=1;}
if(valtmp<40){zoom=2;}
if(valtmp<20){zoom=3;}
if(valtmp<15){zoom=4;}
paramsStreetView.zoom=zoom;estNouveauCBP=true;break;case't':pitch=valtmp-90;paramsStreetView.pitch=pitch;estNouveauCBP=true;break;}}})}
if(!estNouveauCBP){paramsStreetView.heading=tabParams[1];if(tabParams[2]>1){paramsStreetView.fov=tabParams[2];}
if(tabParams[3]){paramsStreetView.zoom=tabParams[3];}
else{paramsStreetView.zoom=0;}
if(tabParams[4]){paramsStreetView.pitch=tabParams[4];}else{paramsStreetView.pitch=0;}
heading=parseInt(paramsStreetView.heading);zoom=parseInt(paramsStreetView.zoom);pitch=parseInt(paramsStreetView.pitch);}}
var mapManager={sv:new google.maps.StreetViewService(),map:null,divMap:null,divView:null,panorama:null,setMap:function(divMap,mapOptions){this.map=new google.maps.Map(divMap,mapOptions);},processSVData:function(data,status){if(status==google.maps.StreetViewStatus.UNKNOWN_ERROR||($("#div_itea_streetView").attr('data-cachersierreur')=='1'&&status==google.maps.StreetViewStatus.ZERO_RESULTS)){$("#div_itea_streetView").hide();if($("#titrestreetview")){$("#titrestreetview").hide();}}},gll:null,setGll:function(lat,lng){this.gll=new google.maps.LatLng(lat,lng);},mapOptions:{},heading:heading,pitch:pitch,zoom:zoom,setPanoramaForMap:function(){var panoOptions={position:this.gll,pov:({heading:this.heading,zoom:this.zoom,pitch:this.pitch})};var panorama=new google.maps.StreetViewPanorama($("#div_itea_streetView")[0],panoOptions);this.map.setStreetView(panorama);this.sv.getPanoramaByLocation(this.gll,20,this.processSVData);},setPanorama:function(){var panoOptions={position:this.gll,pov:({heading:this.heading,zoom:this.zoom,pitch:this.pitch})};this.panorama=new google.maps.StreetViewPanorama(document.getElementById('div_itea_streetView'),panoOptions);this.sv.getPanoramaByLocation(this.gll,20,this.processSVData);}}
mapManager.divMap=$("#div_itea_GMAP_parametrable")[0];mapManager.divView=$("#div_itea_streetView")[0];var zoom;if(mapManager.divMap!=undefined){zoom=$(mapManager.divMap).attr('zoom');var lat=$(mapManager.divMap).attr("latitude");var lng=$(mapManager.divMap).attr("longitude");var mapWidth=$(mapManager.divMap).width();var mapHeight=$(mapManager.divMap).height();}
if(mapManager.divView!=undefined){zoom=$(mapManager.divView).attr('zoom');var lat=$(mapManager.divView).attr("latitude");var lng=$(mapManager.divView).attr("longitude");var streetWidth=$('#div_fiche_streetView').width();var streetHeight=$('#div_fiche_streetView').height();if(!streetWidth){streetWidth=$('#div_itea_streetView').width();}
if(!streetHeight){streetHeight=$('#div_itea_streetView').height();}
if(paramsStreetView.pitch){mapManager.ptich=parseInt(paramsStreetView.pitch);}
if(paramsStreetView.heading)mapManager.heading=parseInt(paramsStreetView.heading);if(paramsStreetView.zoom)mapManager.zoom=parseInt(paramsStreetView.zoom);if(paramsStreetView.img){var ico=paramsStreetView.img;}
else{var ico="/config_v3/imgs_defaut/google_map/punaise.png";}
var srcStreet="https://maps.googleapis.com/maps/api/streetview?size="+streetWidth+"x"+streetHeight+"&location="+lat+","+lng+"&heading="+paramsStreetView.heading;if(paramsStreetView.fov>1){srcStreet+="&fov="+paramsStreetView.fov;}
srcStreet+="&pitch="+paramsStreetView.pitch;if(jQuery('#div_htmlFinITEAUturoa').length>0||jQuery('#div_htmlFinITEAHao').length>0){console.log('urlStreeetview: (visible que chez itea)')
console.log(srcStreet)}}
if(typeof(zoom)=='undefined'||zoom==null){if(paramsCarte)
zoom=parseInt(paramsCarte.z);if($(mapManager.divMap).attr('zoom'))
zoom=parseInt($(mapManager.divMap).attr('zoom'));if(!zoom){zoom=11;}}
else{zoom=parseInt(zoom);}
if(paramsCarte.img){var ico=paramsCarte.img;}
else{var ico=$(mapManager.divMap).attr('picto');}
if(mapManager.divMap!=undefined){if(paramsCarte.embed){var src="https://maps.googleapis.com/maps/api/staticmap?center="+lat+","+lng+"&zoom="+zoom+"&size="+mapWidth+"x"+mapHeight+"&maptype=roadmap&markers=color:green%7Clabel:G%7C"+lat+","+lng;$(mapManager.divMap).html('<img src="'+src+'" width="100%" height="100%" />');}
else{mapManager.setGll(lat,lng);mapManager.mapOptions={center:mapManager.gll,zoom:zoom,mapTypeId:google.maps.MapTypeId.ROADMAP};mapManager.setMap(mapManager.divMap,mapManager.mapOptions);var marker=new google.maps.Marker({map:mapManager.map,position:mapManager.gll,icon:ico});}}
if(mapManager.divView!=undefined){if(paramsStreetView.embed){$(mapManager.divView).html('<img src="'+srcStreet+'" width="100%" height="100%" />');}else{if(paramsCarte.embed||mapManager.divMap==undefined){mapManager.setGll(lat,lng);mapManager.setPanorama();var marker=new google.maps.Marker({position:mapManager.gll,map:mapManager.panorama,icon:ico});}else{mapManager.setPanoramaForMap();}}}})(jQuery);}
window.gmapIsInit=false;function loadScriptGoogleMap(){if(!window.typeGmap){return true;}
var retour=false;(function($){if(window.gmapIsInit===false){window.gmapIsInit=true;retour=true;var script=document.createElement('script');script.type='text/javascript';script.src='https://maps.googleapis.com/maps/api/js?v=3&callback=chargeGMap&language='+$('html').attr('lang');if(window.gmapKey){script.src+='&key='+window.gmapKey;}
document.body.appendChild(script);}})(jQuery);return retour;}
function chargeGMap(){var scriptMap=document.createElement("script");scriptMap.type='text/javascript';scriptMap.src='/lib_2/js/api/map-ui/jquery.ui.map-min.js';scriptMap.onload=scriptMap.onreadystatechange=function(){scriptMap.onreadystatechange=scriptMap.onload=null;var scriptMapExt=document.createElement('script');scriptMapExt.type='text/javascript';scriptMapExt.src='/lib_2/js/api/map-ui/jquery.ui.map-min.extensions.js';document.body.appendChild(scriptMapExt);lanceFoncsInitGMap();}
document.body.appendChild(scriptMap);}
function execFoncsInitGMap(){if(window.foncGMap&&window.idDivGMap){if(window.foncGMap=='iteaGMAP_initForListe'){iteaGMAP_initForListe(window.idDivGMap);window.foncGMap=null;window.idDivGMap=null;}}else{if(window.typeGmap=="classique"){var params=getParamsGoogleMap('classique');iteaGMap_init(params);}else if(window.typeGmap=="streetView"){var params=getParamsGoogleMap('streetView');iteaGMAPStreetView_initForFiche(params.carte,params.streetView);}}}
function handlerScrollGMap(){(function($){var hauteurHautCarto=$('#div_cartoGmap').offset().top;var hauteurHautFenetre=$(window).scrollTop();var hauteurFenetre=$(window).height();var scrollMax=hauteurHautCarto-hauteurFenetre;if(hauteurHautFenetre>scrollMax){$(window).unbind('scroll',handlerScrollGMap);execFoncsInitGMap();}})(jQuery);};function lanceFoncsInitGMap(){(function($){if($('#div_cartoGmap').length>0){$(window).bind('scroll',handlerScrollGMap);handlerScrollGMap();}else{execFoncsInitGMap();}})(jQuery);}
function getParamsGoogleMap(typeGoogleMap){var retour;(function($){$.ajax({type:'POST',url:'/lib_2/ajax/google_map.php',async:false,data:{cmd:'getParamsGoogleMap',typegmap:typeGoogleMap},dataType:'json',success:function(result){console.log('getParamsGoogleMap on a le result');retour=result;}});})(jQuery);return retour;}
function verifEtInitGoogleMap(){(function($){if($('div.div_itea_GMAP iframe').length>0&&$('#div_itea_streetView').length===0){return;}
if($('#divgmap3:visible').length>0||$('.div_itea_GMAP:visible').length>0){loadScriptGoogleMap();}})(jQuery);}
function refreshListProdWithNewGMParams(param,callback,page){console.log('foncGoogleMap.js refreshListProdWithNewGMParams');window.scrollTo(0,0);(function($){var idArboDiv=$('.div_contentListe').attr('id');afficheLoaderGlobal_site();var hiddenCgi={};$('#listeMoteurAffinage form > input').each(function(){if($(this).attr('name')!=='ID')
hiddenCgi[$(this).attr('name')]=$(this).attr('value');});hiddenCgi['page']=page;console.log('hiddenCgi : ');console.log(hiddenCgi);setTimeout(function(){$.ajax({type:'POST',url:'/lib_2/ajax/google_map.php',async:true,data:{cmd:'refreshListeProd',MINLAT:param['MINLAT'],MAXLAT:param['MAXLAT'],MINLNG:param['MINLNG'],MAXLNG:param['MAXLNG'],ZOOM:param['ZOOM'],CENTREX:param['CENTREX'],CENTREY:param['CENTREY'],PAGE:param['PAGE'],MODECARTO:param['MODECARTO'],MAPMOVED:param['MAPMOVED'],LNO:param['LNO'],HIDDENCGI:hiddenCgi},dataType:'html',success:function(result){refreshNbLocAndNbPage(page);if($('#ul_lst').length){$('#ul_lst').replaceWith(result);}else{$('#div_pasDereponse').replaceWith(result);}
refreshRecapCrit();setNbResultByCgi('sp_nbResult');refreshUrlsMoteurs();refreshFormPlusDeCriteresWithNewParams();if(typeof callback=='function'){callback();}
if(typeof foncQdFini_refreshListProdWithNewGMParams=='function'){foncQdFini_refreshListProdWithNewGMParams();}},error:function(jqXHR,textStatus,errorThrown){console.log('Error refreshListProdWithNewGMParams() textStatus: '+textStatus+' errorThrown: '+errorThrown);}});},1);})(jQuery);}
function refreshNbLocAndNbPage(page){(function($){$.ajax({type:'POST',url:'/lib_2/ajax/google_map.php',async:false,data:{cmd:'getInfosListeProd'},dataType:'json',beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(result){$('#divLstInfoCritCourant').replaceWith(result.divLstInfoCritCourant);refreshPagination(page,parseInt(result.nbPages,10));},error:function(jqXHR,textStatus,errorThrown){console.log('Error refreshNbLocAndNbPage() textStatus: '+textStatus+' errorThrown: '+errorThrown);},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});})(jQuery);}
function refreshRecapCrit(){console.log('foncGoogleMaps.js refreshRecapCrit');(function($){$.ajax({type:'POST',url:'/lib_2/ajax/google_map.php',async:false,data:{cmd:'getRecapCrit'},dataType:'html',success:function(result){$('.ul_recap_criteres').replaceWith(result);},error:function(jqXHR,textStatus,errorThrown){console.log('Error refreshRecapCrit() textStatus: '+textStatus+' errorThrown: '+errorThrown);}});})(jQuery);}
function refreshPagination(page,nbPages){(function($){if(nbPages===0){nbPages=1;}
var displayNextPageButton=true;var displayPrevPageButton=true;if(page===1&&page<nbPages){var displayPrevPageButton=false;}else if(nbPages===1){displayNextPageButton=false;displayPrevPageButton=false;}else if(page===nbPages){displayNextPageButton=false;}
if(displayPrevPageButton){$('.button_prev_page').show();}else{$('.button_prev_page').hide();}
if(displayNextPageButton){$('.button_next_page').show();}else{$('.button_next_page').hide();}
$('#current_page').text(page);$('#nb_pages').text(nbPages);})(jQuery);}
function refreshUrlsMoteurs(){(function($){var tabClassMoteur=['moteur_imitecheckbox'];for(var i=0;i<tabClassMoteur.length;i++){$('.'+tabClassMoteur[i]).each(function(){var href=$(this).attr('href');if(href.match(/^refreshListeWithCgi/)){return;}
var hrefAvecParamsGMap=getUrlAvecLstParamsGoogleMaps(href);$(this).attr('href',hrefAvecParamsGMap);});}})(jQuery);}
function getCgiCarto(){var valCgi={};if(window.gmap!==undefined){var gmap=$('#divgmap3').gmap('get','map');valCgi.zoom=gmap.getZoom();valCgi.minlat=gmap.getBounds().getSouthWest().lat();valCgi.maxlat=gmap.getBounds().getNorthEast().lat();valCgi.minlng=gmap.getBounds().getSouthWest().lng();valCgi.maxlng=gmap.getBounds().getNorthEast().lng();valCgi.centrex=(parseFloat(valCgi.maxlat)+parseFloat(valCgi.minlat))/2;valCgi.centrey=(parseFloat(valCgi.maxlng)+parseFloat(valCgi.minlng))/2;}else if(_leafletMap!==undefined){var bounds=_leafletMap.getBounds();valCgi.zoom=_leafletMap.getZoom();valCgi.minlat=bounds.getSouth();valCgi.maxlat=bounds.getNorth();valCgi.minlng=bounds.getWest();valCgi.maxlng=bounds.getEast();valCgi.centrex=(parseFloat(bounds.getNorth())+parseFloat(bounds.getSouth()))/2;valCgi.centrey=(parseFloat(bounds.getEast())+parseFloat(bounds.getWest()))/2;}
return valCgi;}
function refreshFormPlusDeCriteresWithNewParams(){(function($){$('form').each(function(){var link=$(this).attr('action');if(link!==undefined&&link.match(/^\/?liste?(-?\w+)?\.html/)===null){return;}
var formAModif=$(this);var tabCgi=['zoom','centrex','centrey','minlat','maxlat','minlng','maxlng'];var valCgi=getCgiCarto();tabCgi.each(function(cgi){if(formAModif.find('input[name="'+cgi+'"]').length>0){formAModif.find('input[name="'+cgi+'"]').val(valCgi[cgi]);}else{var input='<input type="hidden" name="'+cgi+'" value="'+valCgi[cgi]+'">';formAModif.prepend(input);}});});})(jQuery);}
function estCartoListeEnReloadAjax(){var retour=false;(function($){if($('#divgmap3').attr('data-modeleaflet')==='1'){retour=true;}})(jQuery);return retour;}
function cartoSetActionSurNavigListeCarte(){if($('gbulle_spanlist_next')&&$('gbulle_spanlist_prev')){var spanSuivant=$('gbulle_spanlist_prev');var divList=$($(spanSuivant.parentNode).nextSiblings())[0];var ulListCarte=divList.childElements()[0];if(ulListCarte){ulListCarte.id="ulLstDetailCarte";}
setScrollHorizontalOnDiv(divList.id,ulListCarte.id,{"nextButton":$('gbulle_spanlist_next'),"prevButton":$('gbulle_spanlist_prev'),"scrollSansEffet":"true"});}}
function cartoZoomTo(lat,lon,zoom){if(window.gmap!==undefined){window.gmap.setZoom(zoom);window.gmap.SeDeplacerVers(lat,lon);return;}
if(_leafletMap!==undefined){var center=L.latLng(lat,lon);if(_leafletMap.getZoom()==zoom&&center.equals(_leafletMap.getCenter())){return;}
_leafletMap.setView(center,zoom);return;}}
var _leafletMap;var _leafletMarkerGroup;var _leafletMarkerFocusGroup;var _leafletAjax;function leaflet_resetMap(){_leafletMap.remove();_leafletMap=undefined;_leafletMarkerGroup=undefined;_leafletAjax=undefined;_leafletMarkerFocusGroup=undefined;}
function leaflet_isHighDensity(){return((window.matchMedia&&(window.matchMedia('only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)').matches||window.matchMedia('only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)').matches))||(window.devicePixelRatio&&window.devicePixelRatio>1.3));}
function leaflet_initMapListe(){console.log('foncGoogleMaps.js leaflet_initMapListe()');(function($){loadScriptCss('/lib_2/js/api/leaflet_1.3.1/leaflet.css');loadScriptCss('/css_defaut/v5/leaflet/leaflet.css');loadScriptCss('/lib_2/js/api/leaflet-markercluster-1.4.1/MarkerCluster.css');loadScriptCss('/lib_2/js/api/leaflet-markercluster-1.4.1/MarkerCluster.Default.css');loadScriptCss('/lib_2/js/api/leaflet-gesturehandling-1.1.8/leaflet-gesture-handling.css');loadScriptJs('/lib_2/js/api/leaflet_1.3.1/leaflet.js',function(){loadScriptJs('/lib_2/js/api/leaflet-providers-1.5.0/leaflet-providers.js',function(){loadScriptJs('/lib_2/js/api/leaflet-bing-layer-1.0.0/leaflet-bing-layer.js',function(){loadScriptJs('/lib_2/js/api/leaflet-google/Google.js',function(){loadScriptJs('/lib_2/js/api/leaflet-smoothmarkerbouncing-1.3.0/leaflet-smoothmarkerbouncing.js',function(){loadScriptJs('/lib_2/js/api/leaflet-markercluster-1.4.1/leaflet.markercluster.js',function(){loadScriptJs('/lib_2/js/api/leaflet-gesturehandling-1.1.8/leaflet-gesture-handling.js',function(){$.ajax({url:'/lib_2/ajax/google_map.php',data:{cmd:'getParamsGoogleMap',typegmap:'classique'},dataType:'json',success:function(params){leaflet_chargeListe(params);}});});});});});});});});})(jQuery);}
function leaflet_yaPopupOuverte(){return(jQuery('div.leaflet-popup').length>0);}
function leaflet_affichePopup(ev){var bounds=_leafletMap.getBounds();var popup=ev.target.getPopup();jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',type:'POST',async:false,data:{CMD:'XHTML',ident:ev.target.properties.ident,departement:ev.target.properties.departement,moy_x:ev.target.properties.moy_x,moy_y:ev.target.properties.moy_y,filtre:ev.target.properties.filtre,filtreValue:ev.target.properties.filtreValue,zoom:_leafletMap.getZoom(),minLng:bounds.getWest(),minLat:bounds.getSouth(),maxLng:bounds.getEast(),maxLat:bounds.getNorth(),positionMarkerLat:ev.latlng.lat,positionMarkerLng:ev.latlng.lng,leaflet:1,modecarto:"2"},success:function(html){popup.options.maxWidth=500;popup.setContent(html);popup.update();cartoSetActionSurNavigListeCarte();}});}
function leaflet_clearMarkers(){if(_leafletMarkerGroup===undefined){return;}
_leafletMarkerGroup.clearLayers();}
function leaflet_fitResults(points,params){if(points===null&&_leafletMarkerFocusGroup===undefined){_leafletMap.setView([params.x,params.y],8);}else if(points===undefined||(typeof points==='object'&&points!==null&&Object.keys(points).length===0)){points=null;}
if(points===null&&_leafletMarkerFocusGroup!=null){setTimeout(function(){_leafletMap.invalidateSize();},400);}else if(_leafletMap!=null&&points!=null){_leafletMarkerFocusGroup=points;_leafletMap.fitBounds([[Math.min.apply(Math,points.map(function(point){return point.latitude;})),Math.min.apply(Math,points.map(function(point){return point.longitude;}))],[Math.max.apply(Math,points.map(function(point){return point.latitude;})),Math.max.apply(Math,points.map(function(point){return point.longitude;}))]]);}
if(points!=null&&points.length===1){_leafletMap.setZoom(_leafletMap.getZoom()-8);}
leaflet_ecouteZoomEtDeplacementCarte(params);}
function leaflet_isMarkerInsidePolygon(marker,polyPoints){var x=marker.getLatLng().lat,y=marker.getLatLng().lng;var inside=false;for(var i=0,j=polyPoints.length-1;i<polyPoints.length;j=i++){var xi=polyPoints[i].lat,yi=polyPoints[i].lng;var xj=polyPoints[j].lat,yj=polyPoints[j].lng;var intersect=((yi>y)!==(yj>y))&&(x<(xj-xi)*(y-yi)/(yj-yi)+xi);if(intersect)
inside=!inside;}
return inside;}
function leaflet_getPolygonArea(polyPoints){var area=0;polyPoints.push(polyPoints[0]);for(var i=0;i<polyPoints.length-1;i++){var j=i+1;area=area+(polyPoints[i].lat*polyPoints[j].lng-polyPoints[i].lng*polyPoints[j].lat);}
return Math.abs(area/2);}
function leaflet_bindSurvol(){jQuery(".li_elemListe,.li_elemPanier").bind('mouseover mouseout',function(event){var ident=jQuery(this).attr('data-ident');_leafletMarkerGroup.eachLayer(function(marker){if(marker.properties.ident===ident){if(event.type==='mouseover'&&marker.hasOwnProperty('_icon')&&marker._icon!==null){marker.bounce();marker.setZIndexOffset(250);}else if(marker.hasOwnProperty('_icon')&&marker._icon!==null){marker.stopBouncing();marker.setZIndexOffset(0);}else{_leafletMap.eachLayer(function(cluster){var polygonContainsMarker=false;if(event.type==='mouseover'&&cluster.hasOwnProperty('_bounds')&&cluster.hasOwnProperty('_icon')){var clusterPolygonCoordinates=cluster.getConvexHull();polygonContainsMarker=leaflet_isMarkerInsidePolygon(marker,clusterPolygonCoordinates);for(var i=0;i<clusterPolygonCoordinates.length;i++){if(clusterPolygonCoordinates[i].lat===marker.getLatLng().lat&&clusterPolygonCoordinates[i].lng===marker.getLatLng().lng){polygonContainsMarker=true;}}
if(polygonContainsMarker&&!jQuery('.selectedCluster').length){jQuery(cluster._icon).addClass('selectedCluster');if(leaflet_getPolygonArea(clusterPolygonCoordinates)>=0.005){_leafletMarkerGroup._showCoverage({layer:cluster});}}}else if(cluster.hasOwnProperty('_bounds')&&cluster.hasOwnProperty('_icon')){jQuery(cluster._icon).removeClass('selectedCluster');_leafletMarkerGroup._hideCoverage({layer:cluster});}});}}});});}
function leaflet_addPoint(point){if(point.classe==='gite'){var icon=L.icon({iconUrl:point.img,iconSize:[19,26],iconAnchor:[10,26],popupAnchor:[0,-26]});var marker=L.marker([point.latitude,point.longitude],{icon:icon,riseOnHover:true});marker.properties={};marker.properties.filtre=point.filtre;marker.properties.filtreValue=point.filtreValue;if(point.ident!==undefined&&point.ident!==''){marker.properties.ident=point.ident;}
if(point.departement!==undefined){marker.properties.departement=point.departement;}
if(point.moy_x!==undefined){marker.properties.moy_x=point.moy_x;}
if(point.moy_y!==undefined){marker.properties.moy_y=point.moy_y;}
var addedMarker=marker.addTo(_leafletMarkerGroup);addedMarker.bindPopup('Chargement...');addedMarker.on('click',leaflet_affichePopup);}}
function leaflet_affichePoints(points,fitResults,params){if(_leafletMarkerGroup===undefined){_leafletMarkerGroup=new L.MarkerClusterGroup({maxClusterRadius:50});_leafletMarkerGroup.addTo(_leafletMap);}else if(!leaflet_yaPopupOuverte()){leaflet_clearMarkers();}
if(!Array.isArray(points)){return;}
if(points.length===1&&(points[0].filtre==='region'||points[0].filtre==='dpt')){cartoZoomTo(points[0].latitude,points[0].longitude,7);}
if(typeof params.cgis.LNO!=='undefined'){var newpoint=[];var lnoArray=params.cgis.LNO.split(',');points.forEach(function(point){var ref=point.ident.split('.');lnoArray.forEach(function(unLno){if(ref[2].includes(unLno)||ref[2].includes(unLno.toLowerCase())){newpoint.push(point);}});});points=newpoint;}
points.forEach(function(point){leaflet_addPoint(point);});leaflet_bindSurvol();if(fitResults){leaflet_fitResults(points,params);}
effaceMsgAttenteParDessus('_carte');}
function leaflet_chargePoints(params,fitResults){if(_leafletAjax!==undefined){effaceMsgAttenteParDessus('_carte');_leafletAjax.abort();}
if(typeof params.cgis.LNO!=='undefined'){params.modecarto="2";}
affMsgAttenteParDessusInDiv('divgmap3','_carte');var bounds=_leafletMap.getBounds();if(params.modecarto==="1"){var tabParamsAjax={zoom:999,minLng:bounds.getWest(),minLat:bounds.getSouth(),maxLng:bounds.getEast(),maxLat:bounds.getNorth(),afficherquelistesurcarto:false,queryCgi:encodeURIComponent(jQuery('#itea_page_contentListe').attr('data-cgi')),modecarto:2};_leafletAjax=jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',data:tabParamsAjax,type:'POST',dataType:'json',async:false,success:function(points){leaflet_fitResults(points,params);}});}
if(params.modecarto==="1"){fitResults=false;}
var tabParamsAjax={zoom:999,minLng:bounds.getWest(),minLat:bounds.getSouth(),maxLng:bounds.getEast(),maxLat:bounds.getNorth(),afficherquelistesurcarto:false,queryCgi:encodeURIComponent(jQuery('#itea_page_contentListe').attr('data-cgi')),modecarto:params.modecarto};_leafletAjax=jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',data:tabParamsAjax,type:'POST',dataType:'json',async:false,success:function(points){if(points!==null)
leaflet_affichePoints(points,fitResults,params);else
jQuery('#divChargementParDessus_carte').hide();}});jQuery.ajax({url:'/lib_2/ajax/google_map.php',data:{cmd:'getCircleAroundCity',typegmap:'classique'},dataType:'json',success:function(cityCircle){if(cityCircle.length!==0&&cityCircle.radius!==0){L.circle([cityCircle.lat,cityCircle.lng],{radius:cityCircle.radius,color:'#d1d1d1',opacity:0.8,fillColor:'#d1d1d1',fillOpacity:0.4}).addTo(_leafletMap);}}});}
function leaflet_updateCgi(callback,page,params){jQuery('.hideOnRefreshMap').hide();var bounds=_leafletMap.getBounds();var param={MINLNG:bounds.getWest(),MINLAT:bounds.getSouth(),MAXLNG:bounds.getEast(),MAXLAT:bounds.getNorth(),ZOOM:999,CENTREX:(parseFloat(bounds.getNorth())+parseFloat(bounds.getSouth()))/2,CENTREY:(parseFloat(bounds.getEast())+parseFloat(bounds.getWest()))/2,PAGE:page,MODECARTO:parseInt(params.modecarto,10),MAPMOVED:params.mapMoved,LNO:params.cgis.LNO};refreshListProdWithNewGMParams(param,callback,page);}
function leaflet_loadProvider(map,params){if(estPageGestProd(params.cgis)){params.autoupdate_checkbox='non';params.autoupdate='non';}
createUpdateCheckbox(params,false);if(params.provider.length===0&&(!params.hasOwnProperty('apiKey')||params.apiKey.length===0)){params.provider='openstreetmap';}else if(params.provider.length===0&&params.apiKey.length!==0){params.provider='googlemaps';}
switch(params.provider){case'googlemaps':jQuery.getScript("https://maps.googleapis.com/maps/api/js?key="+params.apiKey,function(){var roads=new L.gridLayer.googleMutant({type:'roadmap'}).addTo(map);});break;case'here':var roadLayer=L.tileLayer.provider('HERE',{app_id:params.appId,app_code:params.appCode});var satelliteLayer=L.tileLayer.provider('HERE.hybridDay',{app_id:params.appId,app_code:params.appCode});roadLayer.addTo(map);map.layers=[roadLayer,satelliteLayer];var baseLayers={"Standard":roadLayer,"Satellite":satelliteLayer};L.control.layers(baseLayers).addTo(map);break;case'openstreetmap':L.tileLayer.provider('OpenStreetMap').addTo(map);break;case'bingmaps':L.tileLayer.bing(params.apiKey).addTo(map);break;case'openstreetmapitea':L.tileLayer('https://maps.itea.fr/osm_tiles/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(map);break;default:break;}}
function leaflet_resizeMap(){(function($){$('div#divgmap3').width($('#div_cartoAcoteListe').width());$('div#divgmap3').height($('#div_cartoAcoteListe').height());})(jQuery);}
function leaflet_chargeListe(params){(function($){if($('div#divgmap3')!==null&&$('div#divgmap3').length!==0&&$('div#divgmap3').data('modeleaflet')=='1'){leaflet_resizeMap();$(window).resize(function(){leaflet_resizeMap();});if(_leafletMap!==undefined&&typeof _leafletMap.remove==='function'){_leafletMap.remove();_leafletMarkerGroup=undefined;}
_leafletMap=L.map('divgmap3',{gestureHandling:true}).setView([params.x,params.y],params.z-3);_leafletMap.options.maxZoom=18;leaflet_loadProvider(_leafletMap,params);L.Marker.setBouncingOptions({exclusive:true});_leafletMap.scrollWheelZoom.disable();if(!estPageGestProd(params.cgis)){leaflet_chargePoints(params,true);}
$('#bodyPage').on('click','.updateListButton',function(){page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);if(estPageGestProd(params.cgis)){params.autoupdate_checkbox='non';params.autoupdate='non';}
createUpdateCheckbox(params,true);});setTimeout(function(){_leafletMap.on('zoomend dragend',function(){if($('.autoupdate').length>0){if($('.autoupdate').prop('checked')===true){page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);}else{createUpdateButton(params);}}else if(params.autoupdate==='oui'&&$('.updateListButton').length==0){page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);}});},1000);$('#divgmap3').attr("oncontextmenu","return false;");$('#divgmap3').mouseup(function(evt){if(evt.which===3){if(evt.originalEvent.detail===2){_leafletMap.setZoom(_leafletMap.getZoom()-1);}}});}
var page=1;params.mapMoved=0;$('#bodyPage').on('click','.button_next_page',function(){if($('div#divgmap3').length===0||$('div#divgmap3:visible')===null||$('div#divgmap3:visible').length===0||$('div#divgmap3').data('modeleaflet')!='1'){document.location.href=$('.button_next_page').data('url');}else{if(!isNaN(parseInt($('#current_page').text(),10))&&parseInt($('#current_page').text(),10)!==page){page=parseInt($('#current_page').text(),10);}
page++;leaflet_updateCgi(leaflet_bindSurvol,page,params);if($('#contentListeGaucheCarte').scrollTop()!==0){$('#contentListeGaucheCarte').animate({scrollTop:0},750);}else{$('html, body').animate({scrollTop:0},750);}
if($('.btnSwitchCarte > .itea_aOnglet').length!==0){var regex=/page=\d+/i;var href=$('.btnSwitchCarte > .itea_aOnglet').attr('href');var newhref=href.replace(regex,'page='+page);$('.btnSwitchCarte > .itea_aOnglet').attr('href',newhref);}}});$('#bodyPage').on('click','.button_prev_page',function(){if($('div#divgmap3').length===0||$('div#divgmap3:visible')===null||$('div#divgmap3:visible').length===0||$('div#divgmap3').data('modeleaflet')!='1'){document.location.href=$('.button_prev_page').data('url');}else{if(!isNaN(parseInt($('#current_page').text(),10))&&parseInt($('#current_page').text(),10)!==page){page=parseInt($('#current_page').text(),10);}
page--;leaflet_updateCgi(leaflet_bindSurvol,page,params);if($('#contentListeGaucheCarte').scrollTop()!==0){$('#contentListeGaucheCarte').animate({scrollTop:0},750);}else{$('html, body').animate({scrollTop:0},750);}
if($('.btnSwitchCarte > .itea_aOnglet').length!==0){var regex=/page=\d+/i;var href=$('.btnSwitchCarte > .itea_aOnglet').attr('href');var newhref=href.replace(regex,'page='+page);$('.btnSwitchCarte > .itea_aOnglet').attr('href',newhref);}}});})(jQuery);}
function createUpdateButton(params){var updateButton='<div class="leaflet-control updatemanager">'+'<button class="updateListButton">'+params.updateButtonLabel+'</button>'+'</div>';if(jQuery('.updatemanager').length){jQuery('.updatemanager').replaceWith(updateButton);}else{jQuery(".leaflet-top.leaflet-right").html(updateButton);}}
function createUpdateCheckbox(params,desactiveParUtilisateur){if(params.autoupdate_checkbox!=='non'){var checkboxdiv='<div class="leaflet-control updatemanager updatemanagerauto">'+'<input id="autoupdatecheck" class="autoupdate" type="checkbox" name="autoupdate" value="autoupdate"><label for="autoupdatecheck">'+params.autoupdateLabel+'</label>'+'</div>';if(jQuery('.updatemanager').length){jQuery('.updatemanager').replaceWith(checkboxdiv);}else{jQuery(".leaflet-top.leaflet-right").html(checkboxdiv);}
if(params.autoupdate==='oui'&&!desactiveParUtilisateur){jQuery('.autoupdate').attr('checked',true);}}}
function leaflet_initMapFiche(){(function($){if($('div#div_itea_map_leaf_fiche')===null||$('div#div_itea_map_leaf_fiche').length===0){return;}
var lat=parseFloat($('div#div_itea_map_leaf_fiche').data('latitude'));var lon=parseFloat($('div#div_itea_map_leaf_fiche').data('longitude'));var zoom=$('div#div_itea_map_leaf_fiche').data('zoom');loadScriptCss('/lib_2/js/api/leaflet_1.3.1/leaflet.css');loadScriptJs('/lib_2/js/api/leaflet_1.3.1/leaflet.js',function(){loadScriptJs('/lib_2/js/api/leaflet-providers-1.5.0/leaflet-providers.js',function(){loadScriptJs('/lib_2/js/api/leaflet-bing-layer-1.0.0/leaflet-bing-layer.js',function(){loadScriptJs('/lib_2/js/api/leaflet-google/Google.js',function(){loadScriptJs('/lib_2/js/api/leaflet-gesturehandling-1.1.8/leaflet-gesture-handling.js',function(){_leafletMap=L.map('div_itea_map_leaf_fiche',{gestureHandling:true}).setView([lat,lon],zoom);$.ajax({url:'/lib_2/ajax/google_map.php',data:{cmd:'getParamsGoogleMap',typegmap:'classique'},dataType:'json',success:function(params){params.autoupdate_checkbox='non';leaflet_loadProvider(_leafletMap,params);_leafletMap.scrollWheelZoom.disable();L.marker([lat,lon],{icon:L.icon({iconUrl:'/imgs_defaut/v5/gmap/punaise-v2.png'})}).addTo(_leafletMap);}});});});});});});})(jQuery);}
function reloadLeafletMap(){if(typeof _leafletMap!=='undefined'){_leafletMap.invalidateSize();}}
function estPageGestProd(cgis){var cgisBloquants=['BILL','PACK','VOIT','NDATE','HOTEL'];for(var i=0;i<cgisBloquants.length;i++){if(cgis.hasOwnProperty(cgisBloquants[i])){return true;}};return false;}
function getNewDivToBody(ident,classe){var objBody=document.getElementsByTagName("body").item(0);return getNewDivChild(objBody,ident,classe);}
function getNewDivChild(objParent,ident,classe){var newdiv=document.createElement("DIV");newdiv.id=ident;setClassForObj(newdiv,classe);objParent.appendChild(newdiv);return newdiv;}
function getLargeurWindow(){var w;if(getVersionIE()<6)w=(document.documentElement.clientWidth);else{if(getVersionIE()<9){if(document.viewport&&document.viewport.getWidth()>0)w=document.viewport.getWidth();else w=(document.body.offsetWidth);}
else w=(window.innerWidth);}
return parseInt(w);}
function getHauteurWindow(){var h;if(getVersionIE()<6)h=(document.documentElement.clientHeight);else{if(getVersionIE()<9){if(document.viewport&&document.viewport.getHeight()>0)h=document.viewport.getHeight();else h=(document.body.offsetHeight);}
else h=(window.innerHeight);}
if(h<40&&getVersionIE()<9&&getVersionIE()>5)h=(document.documentElement.clientHeight);return parseInt(h);}
function getLargeurReelleImage(objImg){var l;if(getVersionIE()<9){l=objImg.clientWidth;}else l=objImg.naturalWidth;return parseInt(l);}
function getHauteurReelleImage(objImg){var h;if(getVersionIE()<9)h=objImg.clientHeight;else h=objImg.naturalHeight;return parseInt(h);}
function afficheDivAvecTransparence(html,w,h,suffixe,titreDiv){if(!suffixe||suffixe==undefined)suffixe="";var hW=getHauteurWindow();var lW=getLargeurWindow();if(hW<40)hW=40;if(lW<40)lW=40;if(h>hW)h=hW-40;if(w>lW)w=lW-40;var divGene=document.getElementById("divGraph_affFenetre"+suffixe);if(!divGene)divGene=getNewDivToBody("divGraph_affFenetre"+suffixe,"divGraph"+suffixe);if(getVersionIE()<9)divGene.style.position="absolute";else divGene.style.position="fixed";if(getVersionIE()<9){var objBody=document.getElementsByTagName("body").item(0);objBody.style.height="100%";}
divGene.style.zIndex="900000";divGene.style.left="0px";divGene.style.top="0px";divGene.style.width="100%";divGene.style.height="100%";divGene.style.opacity=0.2;divGene.style.backgroundColor="#000000";divGene.style.display="block";divGene.style.filter="alpha(opacity=70)";var divFerme=document.getElementById("divGraph_fermeFenetre"+suffixe);if(!divFerme)divFerme=getNewDivToBody("divGraph_fermeFenetre"+suffixe,"divGraphFerme"+suffixe);if(getVersionIE()<9)divFerme.style.position="absolute";else divFerme.style.position="fixed";divFerme.style.zIndex="900001";divFerme.style.right="10px";divFerme.style.top="10px";divFerme.style.display="block";divFerme.innerHTML='<div class="divGraph_fermeFenetreContent" onclick="effaceDivAvecTransparence();"><a href="javascript:void(0);" style="text-decoration:none;"></a></div>';var divMsg=document.getElementById("divGraph_fenetre"+suffixe);if(!divMsg)divMsg=getNewDivToBody("divGraph_fenetre"+suffixe,"divGraph"+suffixe);if(getVersionIE()<9)divMsg.style.position="absolute";else divMsg.style.position="fixed";divMsg.style.zIndex="1000000";divMsg.style.backgroundColor="#FFFFFF";divMsg.style.width=w+"px";divMsg.style.height=h+"px";divMsg.style.opacity=1;divMsg.style.marginLeft="-"+(w/2)+"px";divMsg.style.top="50%";divMsg.style.left="50%";if(estIpad()){divMsg.style.top="10px";}else{divMsg.style.marginTop="-"+(h/2)+"px";}
divMsg.style.display="block";if(getVersionIE()<9){divGene.style.minHeight="1px";var yscroll=document.body.scrollTop;if(!yscroll)yscroll=document.documentElement.scrollTop;divGene.style.top=yscroll+"px";divMsg.style.marginTop=null;divMsg.style.top=(yscroll+50)+"px";function setForScroll(evt){var yscroll=document.body.scrollTop;if(!yscroll)yscroll=document.documentElement.scrollTop;var divGene=document.getElementById("divGraph_affFenetre"+suffixe);var divMsg=document.getElementById("divGraph_fenetre"+suffixe);divGene.style.top=yscroll+"px";divMsg.style.marginTop=null;divMsg.style.top=parseInt(yscroll+50)+"px";}
document.onmousewheel=setForScroll;window.onscroll=setForScroll;}
if(titreDiv)html="<div id='div_btnCloseFrmResa' class='div_headPopin'><p><span class='sp_titrePopin'>"+titreDiv+"</span><a href='#ferme' onClick='effaceDivAvecTransparence();' class='a_fermePopin' title='fermer'><img src='/config_v3/imgs_defaut/v5/fermer-popin.gif' alt='fermer'/></a></p></div>"+html;divMsg.innerHTML=unescape(html);if(window.Effect)new Effect.Opacity($(divGene),{from:0.2,to:0.7});if(getVersionIE()<7){var tabObjSelect=document.getElementsByTagName("SELECT");for(var i=0;i<tabObjSelect.length&&tabObjSelect[i];i++)tabObjSelect[i].style.visibility="hidden";}
Event.observe(document,'keyup',function(event){if(event.keyCode==Event.KEY_ESC){effaceDivAvecTransparence(suffixe);Event.stopObserving(document,'keyup');}});}
function afficheDivAvecTransparenceAbsolue(html,w,h,suffixe,titreDiv){if(!suffixe||suffixe==undefined)suffixe="";var hW=getHauteurWindow();var lW=getLargeurWindow();if(hW<40)hW=40;if(lW<40)lW=40;if(h>hW)h=hW-70;if(w>lW)w=lW-40;var divGene=document.getElementById("divGraph_affFenetre"+suffixe);if(!divGene)divGene=getNewDivToBody("divGraph_affFenetre"+suffixe,"divGraph"+suffixe);divGene.setAttribute("style","");if(getVersionIE()<9)divGene.style.position="absolute";else divGene.style.position="fixed";$("bodyPage").scrollTo();if(getVersionIE()<9){var objBody=document.getElementsByTagName("body").item(0);objBody.style.height="100%";}
divGene.style.zIndex="900000";divGene.style.left="0px";divGene.style.top="0px";divGene.style.width="100%";divGene.style.height="100%";divGene.style.opacity=0.2;divGene.style.backgroundColor="#000000";divGene.style.display="block";divGene.style.filter="alpha(opacity=70)";var divMsg=document.getElementById("divGraph_fenetre"+suffixe);if(!divMsg)divMsg=getNewDivToBody("divGraph_fenetre"+suffixe,"divGraph"+suffixe);divMsg.setAttribute("style","");divMsg.style.position="fixed";divMsg.style.zIndex="1000000";divMsg.style.backgroundColor="#FFFFFF";divMsg.style.width=w+"px";divMsg.style.height=h+"px";divMsg.style.opacity=1;divMsg.style.marginLeft="-"+(w/2)+"px";divMsg.style.left="50%";divMsg.style.top="20px";divMsg.style.display="block";if(getVersionIE()<9){divGene.style.minHeight="1px";var yscroll=document.body.scrollTop;if(!yscroll)yscroll=document.documentElement.scrollTop;divGene.style.top=yscroll+"px";divMsg.style.marginTop=null;function setForScroll(evt){var yscroll=document.body.scrollTop;if(!yscroll)yscroll=document.documentElement.scrollTop;var divGene=document.getElementById("divGraph_affFenetre"+suffixe);divGene.style.top=yscroll+"px";}
document.onmousewheel=setForScroll;window.onscroll=setForScroll;}
if(titreDiv)html="<div id='div_btnCloseFrmResa' class='div_headPopin'><p><span class='sp_titrePopin'>"+titreDiv+"</span><a href='#ferme' onClick='effaceDivAvecTransparence();' class='a_fermePopin' title='fermer'><img src='/config_v3/imgs_defaut/v5/fermer-popin.gif' alt='fermer'/></a></p></div>"+html;divMsg.innerHTML=unescape(html);if(window.Effect)new Effect.Opacity($(divGene),{from:0.2,to:0.7});if(getVersionIE()<7){var tabObjSelect=document.getElementsByTagName("SELECT");for(var i=0;i<tabObjSelect.length&&tabObjSelect[i];i++)tabObjSelect[i].style.visibility="hidden";}
Event.observe(document,'keypress',function(event){if(event.keyCode==Event.KEY_ESC){effaceDivAvecTransparence(suffixe);Event.stopObserving(document,'keypress');}});}
function effaceDivAvecTransparence(suffixe){if(!suffixe||suffixe==undefined)suffixe="";var divGene=document.getElementById("divGraph_affFenetre"+suffixe);var divMsg=document.getElementById("divGraph_fenetre"+suffixe);var divFerme=document.getElementById("divGraph_fermeFenetre"+suffixe);if(divMsg)divMsg.style.display="none";if(divGene)divGene.style.display="none";if(divFerme)divFerme.style.display="none";if(getVersionIE()<7){var tabObjSelect=document.getElementsByTagName("SELECT");for(var i=0;i<tabObjSelect.length&&tabObjSelect[i];i++)tabObjSelect[i].style.visibility="visible";}}
function effaceDivAvecTransparenceInIFrame(suffixe){if(!suffixe||suffixe==undefined)suffixe="";var divGene=parent.document.getElementById("divGraph_affFenetre"+suffixe);var divMsg=parent.document.getElementById("divGraph_fenetre"+suffixe);var divFerme=parent.document.getElementById("divGraph_fermeFenetre"+suffixe);if(divMsg)divMsg.style.display="none";if(divGene)divGene.style.display="none";if(divFerme)divFerme.style.display="none";if(getVersionIE()<7){var tabObjSelect=parent.document.getElementsByTagName("SELECT");for(var i=0;i<tabObjSelect.length&&tabObjSelect[i];i++)tabObjSelect[i].style.visibility="visible";}}
function effaceDivAvecTransparenceFondu(){effaceDivAvecTransparence();}
function alertAMalibu(msg,foncQdFini){msg=unescape(msg);var html="<div id='div_msgErr'>";html+="<span id='span_msgErr'>"+msg+"</span>";html+="<span id='span_btnRetour'>OK</span>";html+="</div>";afficheDivAvecTransparence(html,"250","100");document.getElementById("div_msgErr").style.fontFamily="Arial";document.getElementById("div_msgErr").style.fontSize="11px";document.getElementById("div_msgErr").style.margin="10px";document.getElementById("span_msgErr").style.display="block";document.getElementById("span_msgErr").style.paddingBottom="20px";document.getElementById("span_btnRetour").style.display="block";document.getElementById("span_btnRetour").style.textAlign="center";document.getElementById("span_btnRetour").style.fontWeight="bold";document.getElementById("span_btnRetour").style.color="white";document.getElementById("span_btnRetour").style.cursor="pointer";document.getElementById("span_btnRetour").style.margin="auto";document.getElementById("span_btnRetour").style.width="42px";document.getElementById("span_btnRetour").style.lineHeight="21px";document.getElementById("span_btnRetour").style.backgroundImage="url(/config_v3/imgs_defaut/bt_ok.gif)";document.getElementById("span_btnRetour").style.backgroundRepeat="no-repeat";document.getElementById("span_btnRetour").onclick=function(evt){effaceDivAvecTransparence();if(foncQdFini)foncQdFini();}}
function alertAJquery(msg,foncQdFini){(function($){msg=unescape(msg);$("<div id='div_msgErr'>").html("<span id='span_msgErr'>"+msg+"</span>").dialog({modal:true,close:function(){if(foncQdFini){foncQdFini();}}});})(jQuery);}
function alertAMalibuAvecActionRetour(msg,onclick){msg=unescape(msg);var html="<div id='div_msgErr'>";html+="<span id='span_msgErr'>"+msg+"</span>";html+="<span id='span_btnRetour' onclick='effaceDivAvecTransparence();"+onclick+"'>OK</span>";html+="</div>";afficheDivAvecTransparence(html,"250","100");document.getElementById("div_msgErr").style.fontFamily="Arial";document.getElementById("div_msgErr").style.fontSize="11px";document.getElementById("div_msgErr").style.margin="10px";document.getElementById("span_msgErr").style.display="block";document.getElementById("span_msgErr").style.paddingBottom="20px";document.getElementById("span_btnRetour").style.display="block";document.getElementById("span_btnRetour").style.textAlign="center";document.getElementById("span_btnRetour").style.fontWeight="bold";document.getElementById("span_btnRetour").style.color="white";document.getElementById("span_btnRetour").style.cursor="pointer";document.getElementById("span_btnRetour").style.margin="auto";document.getElementById("span_btnRetour").style.width="42px";document.getElementById("span_btnRetour").style.lineHeight="21px";document.getElementById("span_btnRetour").style.backgroundImage="url(/config_v3/imgs_defaut/bt_ok.gif)";document.getElementById("span_btnRetour").style.backgroundRepeat="no-repeat";}
function alertAMalibuAvecSauvetage(msg,onclick){msg=unescape(msg);var html="<div id='div_msgErr'>";html+="<span id='span_msgErr'>"+msg+"</span>";html+="<div id='div_action_sur_confirAMalibu'>";html+="<span id='span_btnRetour' onclick='"+onclick+"'>OK</span>";html+="<span id='span_btnAnnuler'>Annuler</span>";html+="</div>";html+="</div>";afficheDivAvecTransparence(html,"250","100");document.getElementById("div_msgErr").style.fontFamily="Arial";document.getElementById("div_msgErr").style.fontSize="11px";document.getElementById("div_msgErr").style.margin="10px";document.getElementById("span_msgErr").style.display="block";document.getElementById("span_msgErr").style.paddingBottom="20px";document.getElementById("div_action_sur_confirAMalibu").style.position="relative";document.getElementById("span_btnRetour").style.display="block";document.getElementById("span_btnRetour").style.textAlign="center";document.getElementById("span_btnRetour").style.fontWeight="bold";document.getElementById("span_btnRetour").style.color="white";document.getElementById("span_btnRetour").style.cursor="pointer";document.getElementById("span_btnRetour").style.margin="auto";document.getElementById("span_btnRetour").style.width="42px";document.getElementById("span_btnRetour").style.lineHeight="21px";document.getElementById("span_btnRetour").style.backgroundImage="url(/config_v3/imgs_defaut/bt_ok.gif)";document.getElementById("span_btnRetour").style.backgroundRepeat="no-repeat";document.getElementById("span_btnRetour").style.position="absolute";document.getElementById("span_btnRetour").style.left="60px";document.getElementById("span_btnAnnuler").style.display="block";document.getElementById("span_btnAnnuler").style.textAlign="center";document.getElementById("span_btnAnnuler").style.fontWeight="bold";document.getElementById("span_btnAnnuler").style.color="white";document.getElementById("span_btnAnnuler").style.cursor="pointer";document.getElementById("span_btnAnnuler").style.margin="auto";document.getElementById("span_btnAnnuler").style.width="42px";document.getElementById("span_btnAnnuler").style.lineHeight="21px";document.getElementById("span_btnAnnuler").style.backgroundImage="url(/config_v3/imgs_defaut/bt_ok.gif)";document.getElementById("span_btnAnnuler").style.backgroundRepeat="no-repeat";document.getElementById("span_btnAnnuler").style.position="absolute";document.getElementById("span_btnAnnuler").style.right="60px";document.getElementById("span_btnAnnuler").onclick=function(evt){effaceDivAvecTransparence();}}
function affMsgAttenteInDiv(nomDiv){var elem=document.getElementById(nomDiv);if(elem){elem.innerHTML+="<div id=divChargement><table class='table_transparence' id=tabRechargement width=100%><tr><td align=center id=tdChargement><img id=imgRechargement style='margin:auto' width=16 height=16 src=/config_v3/imgs_defaut/loading/roue16x16.gif /></td></tr></table></div>";var divCharg=document.getElementById("divChargement");divCharg.style.position="relative";divCharg.style.width=elem.offsetWidth+"px";divCharg.style.height=elem.offsetHeight+"px";divCharg.style.top="0px";divCharg.style.left="0px";if(elem.positionedOffset){var pos=elem.positionedOffset();divCharg.style.top=pos.top;divCharg.style.left=pos.left;}
divCharg.style.opacity=0.6;divCharg.style.filter="alpha(opacity=60)";divCharg.style.KhtmlOpacity=0.6;divCharg.style.background="#FFFFFF";}}
function attenteInDiv(element,position){var position=position||'relative';if(jQuery(element).length>0){var width=jQuery(element).outerWidth();var height=jQuery(element).outerHeight();jQuery(element).append("<div id='divChargement'><table class='table_transparence' id='tabRechargement'><tr><td align=center id=tdChargement><img id=imgRechargement style='margin:auto' width=16 height=16 src='/config_v3/imgs_defaut/loading/roue16x16.gif' /></td></tr></table></div>");var divCharg=jQuery("#divChargement");var offset=jQuery(element).offset();jQuery(divCharg).offset({top:offset.top,left:offset.left});jQuery(divCharg).css({width:width,height:height,opacity:0.6,filter:"alpha(opacity=60)",KhtmlOpacity:0.6,"background-color":'#FFFFFF',position:position});}}
function effaceAttenteInDiv(){jQuery('#divChargement').remove();}
function affMsgAttenteParDessusInDiv(nomDiv,suffixe,txt,forcerSansoffset){var elem=$(nomDiv);if(!suffixe)suffixe="";if(!txt)txt="";if(!forcerSansoffset)forcerSansoffset=false;if(elem){var divCharg=getNewDivChild(elem,"divChargementParDessus"+suffixe,"chargement");divCharg.style.position="absolute";divCharg.style.zIndex=9999;divCharg.style.width=elem.offsetWidth+"px";if(elem.offsetHeight>0)divCharg.style.height=elem.offsetHeight+"px";else divCharg.style.height="100%";divCharg.style.top=elem.offsetTop+"px";divCharg.style.left=elem.offsetLeft+"px";if(getVersionIE()<9)divCharg.style.filter="alpha(opacity=60)";else divCharg.style.opacity=0.6;divCharg.style.KhtmlOpacity=0.6;divCharg.style.background="#FFFFFF";if(forcerSansoffset){divCharg.style.top='0px';divCharg.style.left='0px';}
else if(elem.positionedOffset){var pos=elem.positionedOffset();divCharg.style.top=pos.top;divCharg.style.left=pos.left;}
if(!txt)txt="<img id=imgRechargement style='margin:auto' width=16 height=16 src=/config_v3/imgs_defaut/loading/roue16x16.gif />";divCharg.innerHTML+="<div id=divRechargementParDessus"+suffixe+" ><table class='table_transparence' width='100%' height='100%'><tr valign='middle'><td align='center'><div id='divChargementParDessusMsg'>"+txt+"</div></td></tr></table></div>";return $("divChargementParDessusMsg");}
return null;}
function effaceMsgAttenteParDessus(suffixe){if(!suffixe)suffixe="";var elem=$("divChargementParDessus"+suffixe);if(elem)elem.parentNode.removeChild(elem);}
function affDefileRechercheCommune(nomdiv,ldep){debugLogJS('affDefileRechercheCommune');}
function getHtmlForFlash(urlFic,idObj){var html='<object align="middle" id="'+idObj+'" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">';html+='<param value="sameDomain" name="allowScriptAccess"/>';html+='<param value="false" name="allowFullScreen"/>';html+='<param value="'+urlFic+'" name="movie"/>';html+='<param value="high" name="quality"/>';html+='<param value="#ffffff" name="bgcolor"/>';html+='<param value="transparent" name="wmode"/>';html+='<embed align="middle" wmode="transparent" pluginspage="https://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" allowfullscreen="false" allowscriptaccess="sameDomain" name="'+idObj+'" bgcolor="#ffffff" quality="high" ';html+=' src="'+urlFic+'"/>';html+=' </object>';return html;}
function getDivCentreeWithHtml(html){var divGene=document.getElementById("divGeneCentreeMsg");if(!divGene){var body=document.getElementsByTagName("body").item(0);var divGene=document.createElement("DIV");divGene.id="divGeneCentreeMsg";setClassForObj(divGene,"divGeneCentreeMsg");body.appendChild(divGene);}
divGene.innerHTML=html;var largPanel=divGene.offsetWidth;var hautPanel=divGene.offsetHeight;var largScreen=window.outerWidth;var hautScreen=window.outerHeight;var marginLarg=((largScreen-largPanel))/2;var marginHaut=((hautScreen-hautPanel))/2;if(marginHaut<0)marginHaut=25;divGene.style.position="absolute";divGene.style.opacity=1;divGene.style.left=marginLarg+"px";divGene.style.top=marginHaut+"px";divGene.style.display="block";divGene.style.visibility="visible";return divGene;}
function effaceDivSurPage(){var divGene=document.getElementById("divSurPage");var divMsg=document.getElementById("divMsgSurPage");if(divGene)divGene.parentNode.removeChild(divGene);if(divMsg)divMsg.parentNode.removeChild(divMsg);}
function getDivSurPageWithHtml(html){var divGenerale=document.getElementById("general");var divGene=document.getElementById("divSurPage");var divPage=document.getElementById("page");if(!divGene){var body=document.getElementsByTagName("body").item(0);var divGene=document.createElement("DIV");divGene.id="divSurPage";setClassForObj(divGene,"divGraph");body.appendChild(divGene);}
divGene.style.zIndex="9001";divGene.style.position="absolute";divGene.style.left=(divGenerale.offsetLeft+divPage.offsetLeft)+"px";divGene.style.top=(divGenerale.offsetTop+divPage.offsetTop)+"px";divGene.style.width=divPage.offsetWidth+"px";divGene.style.height=divPage.offsetHeight+"px";divGene.style.opacity=0.7;divGene.style.filter="alpha(opacity=70)";divGene.style.minHeight="1px";divGene.style.backgroundColor="#FFFFFF";divGene.style.display="block";var divMsg=document.getElementById("divMsgSurPage");if(!divMsg){var body=document.getElementsByTagName("body").item(0);var divMsg=document.createElement("DIV");divMsg.id="divMsgSurPage";setClassForObj(divMsg,"divGraph");body.appendChild(divMsg);}
divMsg.innerHTML=html;w=200;h=100;divMsg.style.zIndex="9002";divMsg.style.position="absolute";divMsg.style.backgroundColor="#FFFFFF";divMsg.style.width=w+"px";divMsg.style.height=h+"px";divMsg.style.opacity=1;divMsg.style.border="1px solid #000000";divMsg.style.marginLeft="-"+(w/2)+"px";divMsg.style.left=((divGenerale.offsetLeft+divPage.offsetLeft)+(divPage.offsetWidth-w)/2)+"px";divMsg.style.top=((divGenerale.offsetTop+divPage.offsetTop)+200)+"px";divMsg.style.display="block";divMsg.style.opacity=0.7;}
function setPositionObjBySouris(evt,obj,decalX,decalY){var xMouse,yMouse,x,y;if(!decalX)decalX=0;if(!decalY)decalY=0;if(navigator.appName!="Microsoft Internet Explorer"){xMouse=evt.pageX+1;yMouse=evt.pageY+1;var ww=window.innerWidth;var wh=window.innerHeight;}else{var de=document.documentElement;var b=document.body;xMouse=evt.clientX+(de.scrollLeft||b.scrollLeft)-(de.clientLeft||0);yMouse=evt.clientY+(de.scrollTop||b.scrollTop)-(de.clientTop||0);var ww=b.clientWidth;var wh=b.clientHeight;}
var yMax=wh-obj.offsetHeight;if(yMouse>yMax)y=yMouse-obj.offsetHeight;else y=yMouse;var xMax=ww-obj.offsetWidth;if(xMouse>xMax)x=xMouse-obj.offsetWidth;else x=xMouse;obj.style.left=(x+decalX)+"px";obj.style.top=(y+decalY)+"px";}
function afficheBulle(evt,txt,largMax){var bulle=document.getElementById("divInfoBulle");if(!bulle)bulle=getNewDivToBody("divInfoBulle","divInfoBulle");bulle.style.backgroundColor="#FFFFFF";bulle.style.border="1px solid #000000";bulle.style.padding="3px";bulle.style.position="absolute";bulle.style.color="#000000";bulle.style.zIndex="10000001";bulle.innerHTML=unescape(txt);bulle.style.visibility="visible";setPositionObjBySouris(evt,bulle,15,25);}
function effaceBulle(evt){var bulle=document.getElementById("divInfoBulle");if(bulle)bulle.style.visibility="hidden";}
function afficheImageOnBulle(evt,path_img,largMax){var txt="<img src="+path_img+" width="+largMax+" />";afficheBulle(evt,txt,largMax);}
function estVisibleEcran(elem){var off=jQuery(elem).offset();var t=off.top;var l=off.left;var h=jQuery(elem).height();var w=jQuery(elem).width();var docH=jQuery(window).height();var docW=jQuery(window).width();var isEntirelyVisible=(t>0&&l>0&&t+h<docH&&l+w<docW);return isEntirelyVisible;}
function rendVisibleEcran(elem,decalage){var offsetTop=jQuery(elem).offset().top;var scroll=offsetTop-decalage;jQuery('html, body').animate({scrollTop:scroll});}
function initCartoSVG(){(function($){if($('.itea_cartoSVG').length>0){$('.itea_cartoSVG').each(function(){var carto=this;var attributes={};attributes.fill={def:$(carto).attr('data-fill')||'#a0a0a0',hover:$(carto).attr('data-hover')||'#aabb00',selected:$(carto).attr('data-selected')||'#909000'};attributes.noColor=$(carto).attr('data-noColor')||'#efefef';attributes.stroke=$(carto).attr('data-stroke')||'#767676';attributes.strokeWidth=$(carto).attr('data-strokeWidth')||1;attributes.strokeLinejoin=$(carto).attr('data-strokeLinejoin')||'round';attributes.scale={x:$(carto).attr('data-x')||1,y:$(carto).attr('data-y')||1};attributes.mouseout=function(elem,e,data){if(window[$(carto).attr('data-mouseout')]){window[$(carto).attr('data-mouseout')](elem,e,data);}};attributes.mouseover=function(elem,e,data){if(window[$(carto).attr('data-mouseover')]){window[$(carto).attr('data-mouseover')](elem,e,data);}};attributes.click=function(elem,e,data){if(window[$(carto).attr('data-click')]){window[$(carto).attr('data-click')](elem,e,data);}};attributes.mousemove=function(elem,e,data){if(window[$(carto).attr('data-mousemove')]){window[$(carto).attr('data-mousemove')](elem,e,data);}};var paper=new Raphael(carto,(990*attributes.scale.x),(873*attributes.scale.y));var attr={fill:attributes.fill.def,stroke:attributes.stroke,'stroke-width':attributes.strokeWidth,'stroke-linejoin':attributes.strokeLinejoin};var dataGeo=false;if($(carto).attr('data-geographique')!=undefined){dataGeo=$(carto).attr('data-geographique');dataGeo=$.parseJSON(dataGeo);}
var fr={};fr.departement20=paper.path('M 445.33847,488.9562 L 445.33847,491.11245 L 447.30722,492.48745 L 450.61972,494.42495 L 450.83847,495.98745 L 448.86972,496.5812 L 445.74472,497.17495 L 445.74472,498.5187 L 446.90097,499.7062 L 447.11972,503.61245 L 451.40097,504.98745 L 452.96347,505.36245 L 454.33847,507.5187 L 453.36972,508.8937 L 451.80722,509.4562 L 450.61972,511.61245 L 449.46347,512.98745 L 450.02597,516.48745 L 452.96347,516.29995 L 453.74472,516.8937 L 456.49472,515.5187 L 457.27597,516.29995 L 455.90097,519.23745 L 457.27597,520.61245 L 454.93222,522.36245 L 453.36972,525.86245 L 457.65097,526.86245 L 463.71347,527.42495 L 461.18222,530.36245 C 461.18222,530.36245 459.99289,529.90364 459.46347,530.1437 C 459.44782,530.15141 459.41536,530.16589 459.40097,530.17495 C 459.39647,530.17828 459.37406,530.20271 459.36972,530.2062 C 459.36553,530.20986 459.34249,530.23363 459.33847,530.23745 C 459.33478,530.24161 459.31073,530.26437 459.30722,530.2687 C 459.30054,530.27771 459.28192,530.29022 459.27597,530.29995 C 459.27319,530.30499 459.27856,530.32597 459.27597,530.3312 C 459.27118,530.34203 459.24871,530.38211 459.24472,530.3937 C 459.24293,530.39969 459.2463,530.41876 459.24472,530.42495 C 459.24199,530.43772 459.21532,530.47387 459.21347,530.48745 C 459.21207,530.50144 459.21394,530.53512 459.21347,530.54995 C 459.21348,531.52651 457.86972,533.8937 457.86972,533.8937 L 459.80722,536.0187 L 463.33847,538.17495 L 469.96347,539.92495 L 471.90097,540.7062 L 473.68222,541.48745 L 472.49472,543.6437 L 475.61972,543.4562 L 476.21347,544.8312 L 479.33847,544.8312 L 480.11972,541.11245 L 478.15097,540.7062 L 480.90097,537.79995 L 479.93222,536.79995 L 480.11972,535.04995 L 483.65097,533.11245 L 483.83847,530.9562 L 481.49472,530.7687 L 479.93222,532.11245 L 479.93222,530.17495 L 483.05722,529.98745 L 484.02597,527.6437 L 484.80722,520.79995 L 484.21347,517.86245 L 484.15097,515.04995 L 480.74472,517.29995 L 484.15097,515.04995 L 484.02597,509.2687 L 488.71347,502.6437 L 488.71347,491.7062 L 486.77597,487.98745 L 486.18222,476.2687 L 484.80722,474.11245 L 482.27597,472.17495 L 481.86972,464.92495 L 483.05722,461.61245 L 481.49472,456.3312 L 480.52597,452.04995 L 479.71347,450.86245 L 477.96347,449.8937 L 475.02597,451.86245 L 475.43222,453.79995 L 476.99472,455.7687 L 475.24472,457.11245 L 476.02597,458.67495 L 474.83847,460.04995 L 474.83847,461.79995 L 476.80722,463.5812 L 476.80722,466.29995 L 475.61972,468.8312 L 474.27597,469.42495 L 472.71347,467.2687 L 469.96347,467.48745 L 469.36972,467.0812 L 467.02597,467.0812 L 464.90097,469.04995 L 464.08847,472.36245 L 459.02597,473.3312 L 455.11972,476.6437 L 454.33847,478.79995 L 452.40097,478.61245 L 451.40097,477.42495 L 450.83847,480.7687 L 449.46347,481.3312 L 449.05722,484.4562 L 449.65097,485.8312 L 447.49472,487.3937 L 446.90097,488.9562 L 449.08847,489.36245 z').attr(attr).data('value','20');fr.departement13=paper.path('M 379.71875,409.90625 L 374.25,413.03125 L 372.84375,423.53125 L 367.0625,422.71875 L 365.40625,427.125 L 366.78125,429.0625 L 360.4375,432.9375 L 358.6875,437 L 364.875,437.28125 L 373.09375,437.875 L 374.65625,439.4375 L 371.71875,439.4375 L 369.78125,442.75 L 378.15625,444.5 L 384.8125,443.34375 L 381.28125,440 L 383.625,438.0625 L 387.34375,439.625 L 389.09375,443.34375 L 400.25,443.53125 L 403.15625,442.34375 L 403.75,444.125 L 400.625,446.84375 L 404.9375,447.03125 L 404.15625,449 L 402.96875,450.375 L 412.53125,450.375 L 417.21875,451.9375 L 417.6875,452.5625 L 417.875,448.6875 L 419.28125,447.09375 L 421.0625,446.03125 L 420.875,444.96875 L 419.46875,443.5625 L 418.0625,443.5625 L 417.15625,442.5 L 418.75,441.0625 L 418.75,440.53125 L 417,439.65625 L 417,438.25 L 420.875,438.4375 L 421.78125,437.71875 L 418.40625,434.53125 L 418.59375,430.8125 L 416.46875,429.0625 L 418.21875,425.53125 L 422.46875,422.6875 L 419.28125,420.5625 L 417,422.34375 L 411.6875,423.5625 L 407.4375,423.03125 L 399.84375,419.875 L 395.25,420.03125 L 391.375,418.28125 L 389.9375,416.3125 L 386.9375,412.96875 L 379.875,409.96875 L 379.71875,409.90625 z ').attr(attr).data('value','13');fr.departement84=paper.path('M 387,381.34375 L 384.25,381.5625 L 382.125,384.875 L 382.6875,388.375 L 386,388.78125 L 385.4375,390.34375 L 382.875,390.53125 L 379.96875,393.46875 L 379.1875,392.5 L 379.75,388.59375 L 378.59375,387.21875 L 373.3125,388 L 372.28125,390.09375 L 372.84375,390.40625 L 376.15625,395.90625 L 376.15625,400.34375 L 381.96875,406.125 L 381.96875,408.625 L 379.71875,409.90625 L 379.875,409.96875 L 386.9375,412.96875 L 389.9375,416.3125 L 391.375,418.28125 L 395.25,420.03125 L 399.84375,419.875 L 407.4375,423.03125 L 411.6875,423.5625 L 417,422.34375 L 419.1875,420.625 L 419.46875,419.15625 L 415.40625,414.5625 L 410.96875,414.5625 L 410.96875,412.96875 L 412.5625,411.1875 L 412.5625,409.25 L 409.03125,407.5 L 408.6875,404.65625 L 410.625,403.78125 L 410.625,401.3125 L 408.5,400.9375 L 408.34375,398.28125 L 408.3125,398.09375 L 406.53125,397.96875 L 403.59375,395.8125 L 402.8125,393.28125 L 397.34375,392.875 L 393.25,392.5 L 392.84375,390.15625 L 394.21875,387.21875 L 391.6875,389.375 L 387.78125,388.96875 L 387,387.59375 L 389.71875,383.90625 L 387,381.34375 z ').attr(attr).data('value','84');fr.departement83=paper.path('M 457.78125,413.1875 L 454.8125,413.3125 L 453.40625,414.75 L 448.09375,414.5625 L 443.5,417.90625 L 440.34375,415.78125 L 435.375,417.375 L 434.5,419.15625 L 430.96875,421.8125 L 424.59375,417.5625 L 419.4375,419.25 L 419.1875,420.625 L 419.28125,420.5625 L 422.46875,422.6875 L 418.21875,425.53125 L 416.46875,429.0625 L 418.59375,430.8125 L 418.40625,434.53125 L 421.78125,437.71875 L 420.875,438.4375 L 417,438.25 L 417,439.65625 L 418.75,440.53125 L 418.75,441.0625 L 417.15625,442.5 L 418.0625,443.5625 L 419.46875,443.5625 L 420.875,444.96875 L 421.0625,446.03125 L 419.28125,447.09375 L 417.875,448.6875 L 417.6875,452.5625 L 418.21875,453.28125 L 421.71875,454.84375 L 422.6875,458.75 L 424.84375,459.15625 L 426.8125,457.78125 L 430.3125,455.625 L 436.375,456.21875 L 436.1875,457.78125 L 434.21875,458.75 L 438.90625,458.96875 L 437.75,457.78125 L 437.34375,455.25 L 439.875,453.5 L 442.8125,454.46875 L 444,454.84375 L 444.96875,456.03125 L 446.34375,455.0625 L 446.71875,452.5 L 448.28125,451.15625 L 452.375,451.15625 L 453.5625,449.375 L 456.28125,450.15625 L 459.40625,448.8125 L 459.40625,443.71875 L 455.3125,443.90625 L 458.4375,441.96875 L 460,439.8125 L 460.40625,436.6875 L 466.0625,435.90625 L 469.21875,432.375 L 467.03125,430.125 L 467.03125,428.875 L 465.96875,427.8125 L 467.375,426.59375 L 467.03125,424.625 L 464.71875,423.75 L 463.5,423.75 L 461.375,421.625 L 461,417.90625 L 458.71875,416.84375 L 456.40625,416.6875 L 455.53125,414.5625 L 457.78125,413.1875 z ').attr(attr).data('value','83');fr.departement04=paper.path('M 463.84375,364.34375 L 461.71875,367.53125 L 458.71875,369.3125 L 457.65625,371.4375 L 455,371.59375 L 455,373.53125 L 454.28125,374.59375 L 453.21875,377.25 L 446.875,377.09375 L 443.875,375.5 L 441.90625,376.90625 L 438.21875,376.71875 L 437.3125,377.96875 L 438.21875,377.96875 L 438.75,381.3125 L 437.84375,381.6875 L 434.5,379.5625 L 434.5,378.3125 L 432.5625,376.71875 L 431.5,376.71875 L 431.5,378.5 L 429.90625,378.84375 L 426.53125,380.78125 L 424.40625,384.34375 L 423.875,386.09375 L 425.125,386.4375 L 425.3125,389.28125 L 424.0625,389.28125 L 422.125,387.5 L 421.0625,387.6875 L 421.59375,389.28125 L 424.59375,392.625 L 422.65625,393.34375 L 421.25,392.46875 L 417.6875,392.46875 L 414.6875,395.28125 L 414.65625,395.25 L 414.53125,396.40625 L 413.375,395.03125 L 411.8125,393.65625 L 410.8125,396.59375 L 409.0625,398.15625 L 408.3125,398.09375 L 408.34375,398.28125 L 408.5,400.9375 L 410.625,401.3125 L 410.625,403.78125 L 408.6875,404.65625 L 409.03125,407.5 L 412.5625,409.25 L 412.5625,411.1875 L 410.96875,412.96875 L 410.96875,414.5625 L 415.40625,414.5625 L 419.46875,419.15625 L 419.4375,419.25 L 424.59375,417.5625 L 430.96875,421.8125 L 434.5,419.15625 L 435.375,417.375 L 440.34375,415.78125 L 443.5,417.90625 L 448.09375,414.5625 L 453.40625,414.75 L 454.8125,413.3125 L 457.78125,413.1875 L 457.84375,413.15625 L 457.125,411.375 L 458,410.3125 L 457.65625,408.90625 L 460.46875,408.90625 L 461.1875,408.03125 L 463.84375,406.59375 L 465.96875,408.03125 L 467.375,407.125 L 464.03125,404.125 L 460.46875,400.78125 L 459.25,400.40625 L 459.0625,397.75 L 456.9375,394.59375 L 457.65625,390 L 458.71875,387.5 L 460.65625,385.90625 L 460.84375,383.4375 L 463.5,382.03125 L 463.90625,381.875 L 463.90625,378.09375 L 466.65625,377.71875 L 465.09375,376.34375 L 463.125,375.75 L 462.15625,373.21875 L 462.9375,371.46875 L 466.4375,367.75 L 465.875,365 L 466.375,364.46875 L 463.84375,364.34375 z ').attr(attr).data('value','04');fr.departement06=paper.path('M 463.90625,381.875 L 463.5,382.03125 L 460.84375,383.4375 L 460.65625,385.90625 L 458.71875,387.5 L 457.65625,390 L 456.9375,394.59375 L 459.0625,397.75 L 459.25,400.40625 L 460.46875,400.78125 L 464.03125,404.125 L 467.375,407.125 L 465.96875,408.03125 L 463.84375,406.59375 L 461.1875,408.03125 L 460.46875,408.90625 L 457.65625,408.90625 L 458,410.3125 L 457.125,411.375 L 457.84375,413.15625 L 455.53125,414.5625 L 456.40625,416.6875 L 458.71875,416.84375 L 461,417.90625 L 461.375,421.625 L 463.5,423.75 L 464.71875,423.75 L 467.03125,424.625 L 467.375,426.59375 L 465.96875,427.8125 L 467.03125,428.875 L 467.03125,430.125 L 469.21875,432.375 L 469.375,432.1875 L 469.5625,427.71875 L 473.46875,428.5 L 474.84375,426.71875 L 476.8125,427.125 L 477,421.0625 L 481.5,420.6875 L 485.40625,417.15625 L 488.90625,417.15625 L 489.09375,415 L 492.625,412.875 L 490.65625,408.375 L 493.59375,405.84375 L 493,402.90625 L 497.3125,401.53125 L 498.46875,397.25 L 497.90625,394.3125 L 496.90625,392.5625 L 496.125,390 L 493.21875,390.21875 L 484.03125,393.53125 L 481.09375,393.53125 L 476.03125,389.4375 L 470.9375,388.0625 L 468,388.0625 L 468,384.53125 L 463.90625,382 L 463.90625,381.875 z ').attr(attr).data('value','06');fr.departement05=paper.path('M 447.34375,339.15625 L 445.59375,339.9375 L 445.1875,342.875 L 441.6875,343.28125 L 441.09375,340.53125 L 439.9375,339.375 L 436.40625,339.75 L 435.03125,340.9375 L 434.25,345.03125 L 434.84375,346 L 438.9375,346.40625 L 439.71875,348.9375 L 441.28125,349.71875 L 441.28125,354 L 437.5625,353.8125 L 436,355.5625 L 431.53125,354.78125 L 429,356.9375 L 427.21875,356.15625 L 424.6875,358.125 L 425.65625,359.875 L 424.09375,361.4375 L 419.21875,361.4375 L 419.21875,363.78125 L 420.78125,364.5625 L 420.1875,365.9375 L 416.875,367.28125 L 412.78125,367.6875 L 411.59375,371.40625 L 411.40625,373.75 L 413.5625,375.5 L 411.40625,378.03125 L 408.6875,376.65625 L 405.5625,376.46875 L 405.15625,378.21875 L 407.125,379.59375 L 404.75,381.15625 L 405.5625,384.46875 L 412.1875,386.25 L 413.375,388.78125 L 415.3125,389.15625 L 414.65625,395.25 L 414.6875,395.28125 L 417.6875,392.46875 L 421.25,392.46875 L 422.65625,393.34375 L 424.59375,392.625 L 421.59375,389.28125 L 421.0625,387.6875 L 422.125,387.5 L 424.0625,389.28125 L 425.3125,389.28125 L 425.125,386.4375 L 423.875,386.09375 L 424.40625,384.34375 L 426.53125,380.78125 L 429.90625,378.84375 L 431.5,378.5 L 431.5,376.71875 L 432.5625,376.71875 L 434.5,378.3125 L 434.5,379.5625 L 437.84375,381.6875 L 438.75,381.3125 L 438.21875,377.96875 L 437.3125,377.96875 L 438.21875,376.71875 L 441.90625,376.90625 L 443.875,375.5 L 446.875,377.09375 L 453.21875,377.25 L 454.28125,374.59375 L 455,373.53125 L 455,371.59375 L 457.65625,371.4375 L 458.71875,369.3125 L 461.71875,367.53125 L 463.84375,364.34375 L 466.375,364.46875 L 468.21875,362.46875 L 470.34375,362.65625 L 470.34375,360.90625 L 467.625,359.53125 L 467.03125,353.875 L 464.875,353.09375 L 462.15625,353.5 L 457.0625,350.9375 L 456.28125,345.09375 L 453.375,344.125 L 452.375,342.15625 L 451.09375,339.34375 L 447.34375,339.15625 z ').attr(attr).data('value','05');fr.departement48=paper.path('M 320.78125,352.25 L 315.3125,354.21875 L 313.75,357.71875 L 310.25,355.375 L 307.5,363.96875 L 304.6875,370.4375 L 308.78125,375.46875 L 308.5,379.34375 L 311.25,381.28125 L 311.25,385.96875 L 312.09375,392.59375 L 315.40625,394 L 315.125,396.1875 L 319.8125,395.375 L 321.46875,396.1875 L 320.4375,397.09375 L 326.46875,401.125 L 331.625,400.0625 L 332.5,398.8125 L 331.78125,397.0625 L 333.90625,396.53125 L 336.90625,399.34375 L 342.03125,399.875 L 344.34375,396.34375 L 344.34375,393.34375 L 345.75,391.75 L 344.5,391.40625 L 344.5,387.34375 L 341.6875,384.34375 L 344,383.96875 L 345.21875,382.90625 L 346.1875,381.03125 L 345.21875,380.4375 L 345.78125,376.3125 L 342.46875,372.71875 L 341.09375,365.53125 L 336.125,359.1875 L 332.5,360.0625 L 331.71875,357.34375 L 329.75,357.34375 L 329.375,359.6875 L 324.3125,361.25 L 320.78125,352.25 z ').attr(attr).data('value','48');fr.departement03=paper.path('M 301.625,247.96875 L 298.90625,251.46875 L 297.34375,251.65625 L 295.59375,253.4375 L 293.625,251.28125 L 288.375,256.5625 L 288.375,259.6875 L 289.34375,260.46875 L 289.53125,262.03125 L 286.8125,264.15625 L 284.25,263.375 L 279.375,264.375 L 276.84375,267.28125 L 275.90625,269.28125 L 276.0625,269.25 L 278.40625,272.5625 L 278.40625,274.90625 L 279.75,276.65625 L 281.125,274.90625 L 282.6875,277.65625 L 284.84375,278.4375 L 287,283.5 L 287.09375,284.96875 L 290.0625,287.28125 L 291.65625,286.5625 L 292.90625,283.5625 L 294.125,283.21875 L 294.125,281.625 L 296.25,281.4375 L 296.4375,282.5 L 299.09375,279.5 L 302.09375,279.5 L 302.625,280.5625 L 301.21875,282.5 L 303.3125,284.8125 L 303.6875,286.21875 L 308.625,289.0625 L 314.625,289.9375 L 316.40625,289.75 L 319.0625,290.28125 L 321.34375,288.875 L 323.125,289.75 L 323.46875,292.21875 L 325.78125,292.75 L 328.78125,292.59375 L 329.65625,294.71875 L 332.40625,295.8125 L 332.5,294.84375 L 337.1875,294.625 L 336.8125,283.5 L 335.4375,280.78125 L 336,278.625 L 339.25,278.0625 L 339.34375,277.84375 L 343.4375,274.71875 L 343.625,267.09375 L 342.25,265.15625 L 339.125,265.15625 L 337.96875,263.59375 L 334.65625,263.59375 L 333.6875,262.40625 L 333.6875,259.46875 L 329.75,252.0625 L 327.8125,250.6875 L 324.09375,255.78125 L 322.53125,256.15625 L 321.9375,253.625 L 320.1875,252.84375 L 319.40625,254.40625 L 316.5,254.40625 L 316.09375,252.65625 L 314.125,253.8125 L 312,255 L 309.65625,252.4375 L 306.3125,250.875 L 306.125,248.34375 L 301.625,247.96875 z ').attr(attr).data('value','03');fr.departement30=paper.path('M 346.1875,381.03125 L 345.21875,382.90625 L 344,383.96875 L 341.6875,384.34375 L 344.5,387.34375 L 344.5,391.40625 L 345.75,391.75 L 344.34375,393.34375 L 344.34375,396.34375 L 342.03125,399.875 L 336.90625,399.34375 L 333.90625,396.53125 L 331.78125,397.0625 L 332.5,398.8125 L 331.625,400.0625 L 326.46875,401.125 L 320.4375,397.09375 L 319.28125,398.125 L 319.28125,400.90625 L 317.0625,401.4375 L 317.625,403.65625 L 320.375,404.21875 L 323.40625,404.21875 L 324.25,408.0625 L 320.65625,409.71875 L 320.65625,411.46875 L 323.46875,412.4375 L 323.46875,414.03125 L 324.71875,414.75 L 325.78125,413.84375 L 327.1875,413.84375 L 327.90625,415.4375 L 330.03125,415.4375 L 331.09375,411.71875 L 332.84375,411.71875 L 335.5,408.375 L 338.6875,408.71875 L 339.21875,413.3125 L 340.4375,414.75 L 342.40625,413.6875 L 345.75,415.4375 L 347,417.5625 L 352.8125,421.09375 L 354.9375,426.0625 L 354.9375,428.6875 L 351.21875,430.8125 L 348.8125,432.96875 L 351.8125,433.1875 L 351.8125,437.09375 L 356.28125,436.875 L 358.6875,437 L 360.4375,432.9375 L 366.78125,429.0625 L 365.40625,427.125 L 367.0625,422.71875 L 372.84375,423.53125 L 374.25,413.03125 L 381.96875,408.625 L 381.96875,406.125 L 376.15625,400.34375 L 376.15625,395.90625 L 372.84375,390.40625 L 365.9375,386.53125 L 365.40625,389.5625 L 362.625,389.84375 L 361.8125,386.8125 L 359.03125,387.34375 L 358.5,391.21875 L 356.28125,390.40625 L 351.59375,387.34375 L 349.375,388.46875 L 349.375,382.9375 L 346.1875,381.03125 z ').attr(attr).data('value','30');fr.departement11=paper.path('M 274.25,438.46875 L 273.96875,442.0625 L 270.375,440.9375 L 266.5,440.9375 L 266.78125,439.5625 L 264.84375,439.84375 L 260.71875,441.21875 L 259.34375,438.71875 L 256.5625,441.21875 L 257.40625,443.15625 L 254.34375,444.53125 L 253.8125,447.5625 L 251.3125,448.6875 L 253.53125,451.15625 L 252.96875,452.8125 L 262.65625,457.5 L 263.46875,464.15625 L 263.46875,467.75 L 264.03125,472.4375 L 259.0625,472.4375 L 257.6875,474.375 L 264.03125,479.625 L 267.625,477.6875 L 272.03125,482.9375 L 271.375,483 L 272.21875,483.5 L 280.15625,479.625 L 278.21875,476.78125 L 278.0625,473.4375 L 296.59375,473.4375 L 296.25,470.9375 L 300.5,468.65625 L 305.4375,472.53125 L 308,473.71875 L 307.84375,468.125 L 308.0625,461.6875 L 305.71875,461.875 L 303.75,458.96875 L 305.3125,456.40625 L 308.625,459.53125 L 311.5625,457.1875 L 313.53125,455.25 L 313.78125,453.1875 L 311.28125,453.09375 L 310.40625,450.28125 L 307.9375,450.09375 L 305.625,446.71875 L 303.84375,446.90625 L 301.75,445.65625 L 301.375,442.65625 L 300.3125,443.1875 L 300.84375,445.3125 L 298.375,445.3125 L 298.1875,448.84375 L 294.5,450.09375 L 292.71875,446.375 L 290.25,447.96875 L 288.125,446.375 L 287.0625,443.90625 L 288.84375,441.78125 L 288,439.5 L 287.78125,439.5625 L 281.96875,439.5625 L 275.90625,438.46875 L 274.25,438.46875 z ').attr(attr).data('value','11');fr.departement34=paper.path('M 335.5,408.375 L 332.84375,411.71875 L 331.09375,411.71875 L 330.03125,415.4375 L 327.90625,415.4375 L 327.1875,413.84375 L 325.78125,413.84375 L 324.71875,414.75 L 323.46875,414.03125 L 323.46875,412.4375 L 320.65625,411.46875 L 320.65625,412.5 L 317.34375,413.03125 L 315.6875,414.4375 L 316.21875,417.75 L 313.1875,417.75 L 310.15625,416.09375 L 308.5,416.09375 L 308.5,418.03125 L 308.78125,423.8125 L 305.46875,423.8125 L 303.8125,423.8125 L 302.6875,426.03125 L 295.5,428.5 L 292.75,426.59375 L 291.09375,429.0625 L 290.28125,431.8125 L 293.3125,434.59375 L 292.1875,438.1875 L 288,439.5 L 288.84375,441.78125 L 287.0625,443.90625 L 288.125,446.375 L 290.25,447.96875 L 292.71875,446.375 L 294.5,450.09375 L 298.1875,448.84375 L 298.375,445.3125 L 300.84375,445.3125 L 300.3125,443.1875 L 301.375,442.65625 L 301.75,445.65625 L 303.84375,446.90625 L 305.625,446.71875 L 307.9375,450.09375 L 310.40625,450.28125 L 311.28125,453.09375 L 313.78125,453.1875 L 313.90625,452.125 L 320.9375,449.96875 L 321.71875,448.21875 L 327.1875,448.03125 L 328.9375,445.875 L 339.5,437.46875 L 346.125,432.78125 L 348.8125,432.96875 L 351.21875,430.8125 L 354.9375,428.6875 L 354.9375,426.0625 L 352.8125,421.09375 L 347,417.5625 L 345.75,415.4375 L 342.40625,413.6875 L 340.4375,414.75 L 339.21875,413.3125 L 338.6875,408.71875 L 335.5,408.375 z ').attr(attr).data('value','34');fr.departement66=paper.path('M 300.5,468.65625 L 296.25,470.9375 L 296.59375,473.4375 L 278.0625,473.4375 L 278.21875,476.78125 L 280.15625,479.625 L 272.21875,483.5 L 271.375,483 L 264.84375,483.46875 L 264.03125,485.125 L 260.71875,485.96875 L 258.5,487.90625 L 252.4375,489.3125 L 252.78125,491.375 L 255.71875,494.125 L 261.5625,495.6875 L 261.75,499.1875 L 264.875,501.9375 L 267.21875,501.53125 L 270.5625,497.4375 L 274.65625,496.65625 L 281.09375,498.8125 L 286.5625,503.5 L 288.125,501.53125 L 289.5,501.53125 L 290.875,502.5 L 292.03125,501.9375 L 292.21875,499.1875 L 298.09375,497.8125 L 300.03125,495.28125 L 302.96875,494.3125 L 307.0625,494.3125 L 309.625,497.03125 L 312.75,497.25 L 312.75,494.125 L 311.1875,491.96875 L 308.4375,490.78125 L 308,473.71875 L 305.4375,472.53125 L 300.5,468.65625 z ').attr(attr).data('value','66');fr.departement15=paper.path('M 285.84375,323.71875 L 285.25,325.875 L 286.21875,328.21875 L 285.03125,329.59375 L 283.09375,329.59375 L 281.125,327.4375 L 279.375,326.46875 L 279.1875,331.9375 L 275.65625,334.09375 L 273.125,337.59375 L 273.71875,341.125 L 272.9375,342.6875 L 271.9375,345.8125 L 270.375,345.8125 L 268.8125,347.75 L 270,348.9375 L 270.78125,350.875 L 268.25,352.65625 L 269.28125,359.1875 L 272.59375,361.65625 L 270.09375,367.46875 L 272.59375,368.5625 L 271.5,371.875 L 273.6875,372.15625 L 275.34375,369.40625 L 278.125,369.40625 L 278.65625,370.21875 L 284.75,370.21875 L 285.84375,367.75 L 287.21875,367.1875 L 287.78125,362.78125 L 289.15625,362.78125 L 289.15625,358.09375 L 294.6875,353.375 L 295.25,354.21875 L 295.78125,357.8125 L 299.65625,357.25 L 300.5,362.78125 L 302.40625,362.78125 L 302.96875,368.3125 L 304.6875,370.4375 L 307.5,363.96875 L 310.25,355.375 L 313.75,357.71875 L 315.3125,354.21875 L 320.3125,352.40625 L 320.3125,350.75 L 319.25,349.15625 L 317.125,347.90625 L 318.1875,346.3125 L 317.28125,345.4375 L 318.34375,345.09375 L 319.59375,344.03125 L 317.46875,343.84375 L 316.40625,342.4375 L 316.0625,338.71875 L 314.8125,337.46875 L 313.9375,334.3125 L 309.5,334.3125 L 308.625,331.8125 L 307.21875,331.65625 L 306.5,333.0625 L 303.6875,332.875 L 301.03125,328.8125 L 299.96875,328.65625 L 297.84375,327.59375 L 296.59375,328.8125 L 293.4375,328.8125 L 291.84375,325.46875 L 285.84375,323.71875 z ').attr(attr).data('value','15');fr.departement43=paper.path('M 317.8125,326.34375 L 316.40625,327.0625 L 316.40625,328.28125 L 314.28125,328.46875 L 312.34375,330.0625 L 308.8125,330.59375 L 308,331.75 L 308.625,331.8125 L 309.5,334.3125 L 313.9375,334.3125 L 314.8125,337.46875 L 316.0625,338.71875 L 316.40625,342.4375 L 317.46875,343.84375 L 319.59375,344.03125 L 318.34375,345.09375 L 317.28125,345.4375 L 318.1875,346.3125 L 317.125,347.90625 L 319.25,349.15625 L 320.3125,350.75 L 320.3125,352.40625 L 320.78125,352.25 L 324.3125,361.25 L 329.375,359.6875 L 329.75,357.34375 L 331.71875,357.34375 L 332.5,360.0625 L 336.125,359.1875 L 340.625,364.9375 L 343.4375,360.46875 L 348.5,356.75 L 353.1875,356.75 L 354.75,351.875 L 357.875,351.65625 L 358.09375,347.96875 L 361,347.96875 L 360.4375,346.59375 L 359.65625,344.0625 L 360.8125,342.09375 L 363.5625,340.9375 L 364.71875,336.25 L 362.1875,333.3125 L 359.0625,333.5 L 359.4375,329.78125 L 353.1875,327.0625 L 351.0625,327.25 L 346.75,330.78125 L 342.8125,329.5 L 342.03125,330.25 L 339.5625,329.53125 L 337.8125,327.75 L 336.75,329.875 L 333.71875,329.71875 L 332.3125,328.46875 L 331.25,330.9375 L 329.3125,330.0625 L 328.0625,327.75 L 326.46875,327.75 L 325.0625,326.53125 L 322.9375,327.40625 L 320.46875,327.59375 L 319.0625,326.6875 L 318.1875,327.21875 L 317.8125,326.34375 z ').attr(attr).data('value','43');fr.departement63=paper.path('M 299.09375,279.5 L 296.4375,282.5 L 296.25,281.4375 L 294.125,281.625 L 294.125,283.21875 L 292.90625,283.5625 L 291.65625,286.5625 L 290.0625,287.28125 L 287.09375,284.96875 L 287.375,289.5625 L 288.9375,291.5 L 289.71875,295.21875 L 287.375,296.96875 L 286.8125,299.71875 L 284.65625,300.875 L 280.9375,303.03125 L 281.3125,304.78125 L 285.8125,309.28125 L 286.21875,312.03125 L 284.4375,314.9375 L 284.4375,317.6875 L 285.625,319.0625 L 286.21875,322.375 L 285.84375,323.71875 L 291.84375,325.46875 L 293.4375,328.8125 L 296.59375,328.8125 L 297.84375,327.59375 L 299.96875,328.65625 L 301.03125,328.8125 L 303.6875,332.875 L 306.5,333.0625 L 307.21875,331.65625 L 308,331.75 L 308.8125,330.59375 L 312.34375,330.0625 L 314.28125,328.46875 L 316.40625,328.28125 L 316.40625,327.0625 L 317.8125,326.34375 L 318.1875,327.21875 L 319.0625,326.6875 L 320.46875,327.59375 L 322.9375,327.40625 L 325.0625,326.53125 L 326.46875,327.75 L 328.0625,327.75 L 329.3125,330.0625 L 331.25,330.9375 L 332.3125,328.46875 L 333.71875,329.71875 L 336.75,329.875 L 337.8125,327.75 L 339.5625,329.53125 L 342.03125,330.25 L 342.8125,329.5 L 341.28125,329 L 340.6875,326.65625 L 344.40625,323.15625 L 342.65625,316.71875 L 337.5625,313.375 L 335.4375,308.3125 L 333.09375,305.1875 L 333.6875,300.875 L 335.4375,299.125 L 332.3125,296.59375 L 332.40625,295.8125 L 329.65625,294.71875 L 328.78125,292.59375 L 325.78125,292.75 L 323.46875,292.21875 L 323.125,289.75 L 321.34375,288.875 L 319.0625,290.28125 L 316.40625,289.75 L 314.625,289.9375 L 308.625,289.0625 L 303.6875,286.21875 L 303.3125,284.8125 L 301.21875,282.5 L 302.625,280.5625 L 302.09375,279.5 L 299.09375,279.5 z ').attr(attr).data('value','63');fr.departement65=paper.path('M 179.21875,428.53125 L 177.28125,429.5625 L 177.625,429.59375 L 180.9375,435.0625 L 178.78125,437.03125 L 180.34375,439.375 L 182.6875,442.875 L 180.75,445.40625 L 177.625,452.4375 L 172.34375,456.9375 L 173.71875,459.6875 L 172.53125,460.46875 L 169.625,459.875 L 168.8125,466.3125 L 167.25,467.5 L 166.9375,471.53125 L 167.4375,471.25 L 170.75,473.21875 L 174.65625,476.15625 L 175.03125,478.5 L 178.15625,481.03125 L 180.71875,481.03125 L 187.15625,478.28125 L 189.875,481.40625 L 193.59375,482.40625 L 194.96875,480.0625 L 196.71875,480.84375 L 200.5,481.09375 L 200.25,470.59375 L 202.21875,470.59375 L 203.96875,471.46875 L 205.21875,470.25 L 205.03125,468.3125 L 207.5,466.875 L 206.625,463.1875 L 205.5625,462.28125 L 203.4375,463 L 204.5,461.21875 L 203.96875,458.9375 L 200.78125,456.625 L 200.96875,455.03125 L 202.75,452.03125 L 205.03125,451.15625 L 205.03125,449.90625 L 206.4375,447.78125 L 207.375,446.46875 L 203.8125,444.625 L 199.03125,444.625 L 198.3125,443.1875 L 195.84375,443.1875 L 195.125,441.59375 L 192.84375,441.59375 L 192.125,442.3125 L 189.46875,442.3125 L 189.3125,440.71875 L 187.1875,439.3125 L 187.90625,438.59375 L 188.25,436.84375 L 187.71875,436.3125 L 186.65625,433.46875 L 184.34375,433.125 L 182.0625,431.875 L 182.21875,428.53125 L 179.21875,428.53125 z ').attr(attr).data('value','65');fr.departement64=paper.path('M 172.15625,428.875 L 169.34375,430.46875 L 163.6875,430.28125 L 163.15625,429.40625 L 159.4375,430.65625 L 156.59375,431.53125 L 154.46875,429.9375 L 152.1875,430.65625 L 151.46875,429.75 L 148.65625,429.75 L 146.875,430.65625 L 142.28125,430.46875 L 139.8125,432.40625 L 135.375,432.0625 L 134.5,433.3125 L 133.4375,432.9375 L 134.84375,431.53125 L 132.375,429.59375 L 129.375,432.25 L 124.25,432.59375 L 118.625,429.78125 L 117.8125,431.21875 L 113.3125,436.6875 L 109.8125,438.0625 L 107.28125,438.4375 L 107.28125,440.59375 L 109.625,442.75 L 113.125,442.9375 L 113.3125,445.46875 L 116.0625,445.6875 L 116.84375,443.90625 L 120.5625,445.46875 L 122.90625,446.0625 L 123.46875,448.40625 L 122.125,449.59375 L 122.125,453.28125 L 119.375,454.65625 L 119.1875,456.40625 L 120.9375,458.375 L 124.0625,459.34375 L 124.65625,456.40625 L 126.40625,454.46875 L 126.21875,457 L 127.59375,458.96875 L 131.09375,458.96875 L 132.65625,461.09375 L 137.34375,461.875 L 141.84375,464.625 L 149.25,464.625 L 149.65625,468.71875 L 154.71875,472.625 L 156.6875,474.96875 L 158.84375,473.8125 L 160.78125,473.40625 L 161.75,474.375 L 163.53125,473.40625 L 166.9375,471.53125 L 167.25,467.5 L 168.8125,466.3125 L 169.625,459.875 L 172.53125,460.46875 L 173.71875,459.6875 L 172.34375,456.9375 L 177.625,452.4375 L 180.75,445.40625 L 182.6875,442.875 L 180.34375,439.375 L 178.78125,437.03125 L 180.9375,435.0625 L 177.625,429.59375 L 172.34375,429.21875 L 172.15625,428.875 z ').attr(attr).data('value','64');fr.departement40=paper.path('M 139.8125,374.4375 L 133.625,377.625 L 132.03125,377.6875 L 128.5625,396.25 L 124.0625,413.4375 L 122.6875,420.09375 L 121.53125,424.78125 L 118.625,429.78125 L 124.25,432.59375 L 129.375,432.25 L 132.375,429.59375 L 134.84375,431.53125 L 133.4375,432.9375 L 134.5,433.3125 L 135.375,432.0625 L 139.8125,432.40625 L 142.28125,430.46875 L 146.875,430.65625 L 148.65625,429.75 L 151.46875,429.75 L 152.1875,430.65625 L 154.46875,429.9375 L 156.59375,431.53125 L 159.4375,430.65625 L 163.15625,429.40625 L 163.6875,430.28125 L 169.34375,430.46875 L 172.15625,428.875 L 170.78125,426.46875 L 172.15625,422.75 L 174.09375,420.21875 L 173.5,416.90625 L 175.0625,415.34375 L 172.75,411.4375 L 174.6875,409.09375 L 176.84375,408.6875 L 178.78125,409.46875 L 181.53125,407.125 L 182.5,410.0625 L 183.46875,411.4375 L 185.625,410.84375 L 185.4375,408.3125 L 186.0625,406.9375 L 185.59375,405.71875 L 186.125,401.84375 L 188.25,399.71875 L 187.1875,398.46875 L 184.875,398.28125 L 182.21875,397.25 L 178.34375,397.59375 L 177.625,393.34375 L 175.15625,390.34375 L 174.09375,390 L 174.46875,393.53125 L 174.46875,394.59375 L 171.09375,394.75 L 167.5625,393.53125 L 166.84375,389.09375 L 164.375,386.4375 L 162.625,386.28125 L 162.4375,384.6875 L 160.5,383.4375 L 157.3125,382.5625 L 158.1875,381.5 L 158.1875,380.4375 L 157.125,379.5625 L 155.90625,378.5 L 152.34375,379.03125 L 150.25,380.78125 L 148.8125,380.96875 L 146.53125,379.375 L 143.15625,380.78125 L 141.5625,379.71875 L 143,377.96875 L 143.15625,375.65625 L 139.8125,374.4375 z ').attr(attr).data('value','40');fr.departement33=paper.path('M 141.25,315.21875 L 138.125,319.90625 L 137.15625,336.3125 L 134.625,352.90625 L 132.84375,365.78125 L 132.65625,369.125 L 134.03125,364.625 L 136.75,361.09375 L 140.65625,364.625 L 141.0625,365.78125 L 142.21875,367.34375 L 137.34375,367.5625 L 136.5625,366.375 L 134.625,367.15625 L 134.21875,370.09375 L 132.0625,373.03125 L 132.0625,377.5 L 132.03125,377.6875 L 133.625,377.625 L 139.8125,374.4375 L 143.15625,375.65625 L 143,377.96875 L 141.5625,379.71875 L 143.15625,380.78125 L 146.53125,379.375 L 148.8125,380.96875 L 150.25,380.78125 L 152.34375,379.03125 L 155.90625,378.5 L 157.125,379.5625 L 158.1875,380.4375 L 158.1875,381.5 L 157.3125,382.5625 L 160.5,383.4375 L 162.4375,384.6875 L 162.625,386.28125 L 164.375,386.4375 L 166.84375,389.09375 L 167.5625,393.53125 L 171.09375,394.75 L 174.46875,394.59375 L 174.46875,393.53125 L 174.09375,390 L 175.15625,390.34375 L 177.15625,392.78125 L 180.28125,392.28125 L 181.71875,390.875 L 181.53125,388.9375 L 180.28125,387.875 L 180.65625,385.90625 L 182.59375,385.90625 L 184.53125,384.6875 L 183.65625,382.90625 L 183.125,380.25 L 184.53125,377.78125 L 187.53125,373.1875 L 189.3125,371.0625 L 190.90625,370.53125 L 191.25,368.78125 L 189.125,368.59375 L 188.25,366.65625 L 188.9375,364.71875 L 191.4375,364.1875 L 193.1875,363.65625 L 195.25,363.375 L 195.125,363.28125 L 194.96875,359.40625 L 196.90625,358 L 194.4375,356.40625 L 191.96875,359.40625 L 185.9375,359.59375 L 185.40625,358.15625 L 183.65625,357.28125 L 185.0625,355.5 L 185.0625,353.5625 L 184.34375,352.5 L 184.34375,351.4375 L 186.125,350.375 L 186.65625,347.21875 L 187.71875,344.375 L 186.65625,342.78125 L 184.71875,342.78125 L 183.6875,341.5625 L 182.6875,343.65625 L 180.75,342.28125 L 178,343.65625 L 175.65625,343.28125 L 171.1875,338.78125 L 168.4375,338.59375 L 167.65625,332.34375 L 162.5625,331.75 L 162.375,328.8125 L 161.40625,329.78125 L 155.625,329.78125 L 155.90625,331.03125 L 157.28125,336.6875 L 157.65625,342.34375 L 156.6875,343.90625 L 155.71875,339.21875 L 152.96875,328.5 L 143,319.5 L 143.21875,315.40625 L 141.25,315.21875 z ').attr(attr).data('value','33');fr.departement24=paper.path('M 209.84375,310.46875 L 208.09375,313.59375 L 205.34375,313.96875 L 205.15625,318.65625 L 195.96875,324.90625 L 195.78125,331.75 L 192.25,335.25 L 190.3125,337.03125 L 186.40625,336.625 L 184.25,340.34375 L 183.6875,341.5625 L 184.71875,342.78125 L 186.65625,342.78125 L 187.71875,344.375 L 186.65625,347.21875 L 186.125,350.375 L 184.34375,351.4375 L 184.34375,352.5 L 185.0625,353.5625 L 185.0625,355.5 L 183.65625,357.28125 L 185.40625,358.15625 L 185.9375,359.59375 L 191.96875,359.40625 L 194.4375,356.40625 L 196.90625,358 L 194.96875,359.40625 L 195.125,363.28125 L 197.96875,365.25 L 198.3125,368.9375 L 201.3125,370 L 203.09375,368.40625 L 206.96875,368.40625 L 209.09375,366.65625 L 210.34375,366.84375 L 210.6875,368.25 L 214.59375,368.25 L 215.46875,367.1875 L 216.875,367.375 L 218.46875,369.125 L 218.46875,370.375 L 217.0625,371.25 L 217.59375,372.5 L 219.53125,372.65625 L 222,370.375 L 224.125,370.375 L 225.53125,371.96875 L 228.59375,373.25 L 228.78125,372.75 L 230.5625,371 L 230.75,368.0625 L 235.03125,367.6875 L 237.78125,363.78125 L 236.59375,363.375 L 236.40625,361.25 L 239.71875,360.84375 L 239.9375,358.90625 L 241.5,357.90625 L 243.25,354.78125 L 241.5,352.84375 L 241.5,350.6875 L 242.84375,349.53125 L 241.09375,346.78125 L 241.28125,342.5 L 237,342.6875 L 235.25,341.5 L 236.8125,339.5625 L 234.65625,337.8125 L 236.21875,335.84375 L 234.65625,335.0625 L 234.65625,332.34375 L 238.5625,328.8125 L 236.40625,327.0625 L 235.25,324.125 L 231.125,323.53125 L 229.75,322.5625 L 232.6875,321.1875 L 231.71875,319.84375 L 227.4375,319.25 L 226.4375,315.34375 L 220.1875,314.75 L 218.8125,316.71875 L 217.46875,317.09375 L 215.6875,314.75 L 216.5,312.59375 L 215.5,310.65625 L 209.84375,310.46875 z ').attr(attr).data('value','24');fr.departement47=paper.path('M 195.25,363.375 L 193.1875,363.65625 L 191.4375,364.1875 L 188.9375,364.71875 L 188.25,366.65625 L 189.125,368.59375 L 191.25,368.78125 L 190.90625,370.53125 L 189.3125,371.0625 L 187.53125,373.1875 L 184.53125,377.78125 L 183.125,380.25 L 183.65625,382.90625 L 184.53125,384.6875 L 182.59375,385.90625 L 180.65625,385.90625 L 180.28125,387.875 L 181.53125,388.9375 L 181.71875,390.875 L 180.28125,392.28125 L 177.15625,392.78125 L 177.625,393.34375 L 178.34375,397.59375 L 182.21875,397.25 L 184.875,398.28125 L 187.1875,398.46875 L 188.25,399.71875 L 186.125,401.84375 L 185.59375,405.71875 L 186.0625,406.9375 L 186.8125,405.375 L 189.125,407.34375 L 192.25,404.21875 L 193.625,406.15625 L 196.9375,405.5625 L 200.46875,405.1875 L 202.03125,402.4375 L 207.875,401.875 L 210.8125,404.78125 L 211.8125,403.8125 L 213.75,403.21875 L 212.96875,400.5 L 215.90625,399.71875 L 219.625,398.9375 L 218.8125,396.59375 L 220,395.21875 L 220.96875,391.5 L 218.8125,389.15625 L 220.1875,384.6875 L 223.125,386.4375 L 227.4375,385.65625 L 225.46875,381.34375 L 223.90625,375.5 L 227.8125,375.3125 L 228.59375,373.25 L 225.53125,371.96875 L 224.125,370.375 L 222,370.375 L 219.53125,372.65625 L 217.59375,372.5 L 217.0625,371.25 L 218.46875,370.375 L 218.46875,369.125 L 216.875,367.375 L 215.46875,367.1875 L 214.59375,368.25 L 210.6875,368.25 L 210.34375,366.84375 L 209.09375,366.65625 L 206.96875,368.40625 L 203.09375,368.40625 L 201.3125,370 L 198.3125,368.9375 L 197.96875,365.25 L 195.25,363.375 z ').attr(attr).data('value','47');fr.departement46=paper.path('M 247.46875,347.3125 L 243.3125,349.25 L 242.71875,349.34375 L 242.84375,349.53125 L 241.5,350.6875 L 241.5,352.84375 L 243.25,354.78125 L 241.5,357.90625 L 239.9375,358.90625 L 239.71875,360.84375 L 236.40625,361.25 L 236.59375,363.375 L 237.78125,363.78125 L 235.03125,367.6875 L 230.75,368.0625 L 230.5625,371 L 228.78125,372.75 L 227.8125,375.3125 L 223.90625,375.5 L 225.46875,381.34375 L 227.125,384.96875 L 229.625,384.875 L 229.78125,385.90625 L 228.375,387.5 L 229.4375,389.625 L 231.03125,389.625 L 232.78125,391.5625 L 234.375,391.5625 L 235.625,390.15625 L 235.96875,390.53125 L 235.96875,392.28125 L 236.5,394.59375 L 240.21875,394.75 L 243.21875,391.5625 L 244.8125,391.40625 L 245.34375,392.28125 L 246.21875,394.21875 L 247.65625,394.21875 L 248.1875,390.6875 L 251.1875,391.0625 L 252.9375,388.9375 L 255.78125,389.625 L 260.03125,387.6875 L 260.0625,388.0625 L 261.4375,386.625 L 259.65625,383.96875 L 258.96875,380.4375 L 261.25,378.5 L 262.3125,378.84375 L 265.5,375.3125 L 267.25,375.5 L 267.96875,374.59375 L 271.5,374.59375 L 272.75,373.1875 L 273.09375,372.09375 L 271.5,371.875 L 272.59375,368.5625 L 270.09375,367.46875 L 272.59375,361.65625 L 269.28125,359.1875 L 268.15625,352 L 265.125,351.1875 L 262.90625,353.375 L 261.8125,351.4375 L 258.5,354.75 L 256.28125,355.03125 L 252.4375,349.53125 L 247.46875,347.3125 z ').attr(attr).data('value','46');fr.departement09=paper.path('M 237.21875,446.375 L 235.96875,447.25 L 235.4375,448.3125 L 237.90625,450.09375 L 238.625,451.34375 L 238.09375,452.375 L 233.84375,452.75 L 232.625,454.5 L 232.78125,455.03125 L 234.375,455.5625 L 235.28125,456.8125 L 234.21875,458.5625 L 232.96875,458.40625 L 231.03125,456.625 L 228.71875,455.9375 L 226.4375,456.09375 L 222.375,458.5625 L 222.53125,461.9375 L 223.59375,462.65625 L 222.90625,465.28125 L 218.28125,466.53125 L 216.53125,468.65625 L 216.53125,472.1875 L 217.25,473.25 L 215.59375,474.78125 L 216.65625,475.375 L 222.6875,476.53125 L 225.25,476.53125 L 228.5625,480.84375 L 236.96875,480.4375 L 240.28125,485.71875 L 243.21875,484.53125 L 251.8125,485.71875 L 252.4375,489.3125 L 258.5,487.90625 L 260.71875,485.96875 L 264.03125,485.125 L 264.84375,483.46875 L 272.03125,482.9375 L 267.625,477.6875 L 264.03125,479.625 L 257.6875,474.375 L 259.0625,472.4375 L 264.03125,472.4375 L 263.46875,467.75 L 263.46875,464.15625 L 262.65625,457.5 L 252.96875,452.8125 L 253.53125,451.15625 L 251.6875,449.09375 L 250.125,449.75 L 248,450.09375 L 244.09375,448.3125 L 243.03125,447.96875 L 244.625,449.90625 L 243.9375,451.5 L 240.5625,451.15625 L 240.40625,449.375 L 238.4375,446.71875 L 237.21875,446.375 z ').attr(attr).data('value','09');fr.departement32=paper.path('M 207.875,401.875 L 202.03125,402.4375 L 200.46875,405.1875 L 196.9375,405.5625 L 193.625,406.15625 L 192.25,404.21875 L 189.125,407.34375 L 186.8125,405.375 L 185.4375,408.3125 L 185.625,410.84375 L 183.46875,411.4375 L 182.5,410.0625 L 181.53125,407.125 L 178.78125,409.46875 L 176.84375,408.6875 L 174.6875,409.09375 L 172.75,411.4375 L 175.0625,415.34375 L 173.5,416.90625 L 174.09375,420.21875 L 172.15625,422.75 L 170.78125,426.46875 L 172.34375,429.21875 L 177.28125,429.5625 L 179.21875,428.53125 L 182.21875,428.53125 L 182.0625,431.875 L 184.34375,433.125 L 186.65625,433.46875 L 187.71875,436.3125 L 188.25,436.84375 L 187.90625,438.59375 L 187.1875,439.3125 L 189.3125,440.71875 L 189.46875,442.3125 L 192.125,442.3125 L 192.84375,441.59375 L 195.125,441.59375 L 195.84375,443.1875 L 198.3125,443.1875 L 199.03125,444.625 L 203.8125,444.625 L 207.375,446.46875 L 207.6875,446.03125 L 209.625,444.96875 L 213.15625,440.375 L 219.71875,440.90625 L 222.53125,442.84375 L 223.4375,441.59375 L 224.84375,437.375 L 226.59375,433.3125 L 230.3125,431.71875 L 232.09375,431 L 231.5625,429.40625 L 229.78125,429.21875 L 229.09375,427.46875 L 227.65625,427.46875 L 225.375,425.15625 L 225.53125,423.5625 L 222.53125,420.5625 L 222,418.65625 L 220.0625,419.5 L 219.53125,418.4375 L 220.78125,416.5 L 219.34375,415.09375 L 219.34375,412.625 L 218.125,411.375 L 214.21875,411.1875 L 214.21875,408.90625 L 216.34375,407.3125 L 216.34375,405.53125 L 218.65625,404.46875 L 217.40625,403.78125 L 216,404.46875 L 213.15625,404.46875 L 212.28125,403.65625 L 211.8125,403.8125 L 210.8125,404.78125 L 207.875,401.875 z ').attr(attr).data('value','32');fr.departement31=paper.path('M 245,412.4375 L 242.15625,413.5 L 241.28125,414.90625 L 240.21875,413.6875 L 238.28125,413.5 L 237.90625,415.28125 L 236.6875,415.78125 L 238.4375,416.6875 L 237.21875,418.625 L 232.78125,419.875 L 230.84375,417.5625 L 229.09375,417.5625 L 227.65625,418.4375 L 222.53125,418.4375 L 222,418.65625 L 222.53125,420.5625 L 225.53125,423.5625 L 225.375,425.15625 L 227.65625,427.46875 L 229.09375,427.46875 L 229.78125,429.21875 L 231.5625,429.40625 L 232.09375,431 L 230.3125,431.71875 L 226.59375,433.3125 L 224.84375,437.375 L 223.4375,441.59375 L 222.53125,442.84375 L 219.71875,440.90625 L 213.15625,440.375 L 209.625,444.96875 L 207.6875,446.03125 L 206.4375,447.78125 L 205.03125,449.90625 L 205.03125,451.15625 L 202.75,452.03125 L 200.96875,455.03125 L 200.78125,456.625 L 203.96875,458.9375 L 204.5,461.21875 L 203.4375,463 L 205.5625,462.28125 L 206.625,463.1875 L 207.5,466.875 L 205.03125,468.3125 L 205.21875,470.25 L 203.96875,471.46875 L 202.21875,470.59375 L 200.25,470.59375 L 200.5,481.09375 L 208.4375,481.625 L 208.84375,472.03125 L 211.5625,472.4375 L 215.59375,474.78125 L 217.25,473.25 L 216.53125,472.1875 L 216.53125,468.65625 L 218.28125,466.53125 L 222.90625,465.28125 L 223.59375,462.65625 L 222.53125,461.9375 L 222.375,458.5625 L 226.4375,456.09375 L 228.71875,455.9375 L 231.03125,456.625 L 232.96875,458.40625 L 234.21875,458.5625 L 235.28125,456.8125 L 234.375,455.5625 L 232.78125,455.03125 L 232.625,454.5 L 233.84375,452.75 L 238.09375,452.375 L 238.625,451.34375 L 237.90625,450.09375 L 235.4375,448.3125 L 235.96875,447.25 L 237.21875,446.375 L 238.4375,446.71875 L 240.40625,449.375 L 240.5625,451.15625 L 243.9375,451.5 L 244.625,449.90625 L 243.03125,447.96875 L 244.09375,448.3125 L 248,450.09375 L 250.125,449.75 L 251.6875,449.09375 L 251.3125,448.6875 L 253.8125,447.5625 L 254.34375,444.53125 L 257.40625,443.15625 L 256.5625,441.21875 L 259.34375,438.71875 L 260.71875,441.21875 L 264.84375,439.84375 L 265.625,439.71875 L 265.6875,438.4375 L 265.6875,435.9375 L 263.5625,436.3125 L 260.90625,435.59375 L 258.59375,432.78125 L 257.71875,431.53125 L 253.125,429.59375 L 252.0625,428 L 253.46875,427.46875 L 253.46875,425.53125 L 252.0625,423.9375 L 250.28125,421.09375 L 250.125,418.625 L 249.59375,418.28125 L 247.46875,415.78125 L 246.59375,413.15625 L 245,412.4375 z ').attr(attr).data('value','31');fr.departement82=paper.path('M 220.1875,384.6875 L 218.8125,389.15625 L 220.96875,391.5 L 220,395.21875 L 218.8125,396.59375 L 219.625,398.9375 L 215.90625,399.71875 L 212.96875,400.5 L 213.75,403.21875 L 212.28125,403.65625 L 213.15625,404.46875 L 216,404.46875 L 217.40625,403.78125 L 218.65625,404.46875 L 216.34375,405.53125 L 216.34375,407.3125 L 214.21875,408.90625 L 214.21875,411.1875 L 218.125,411.375 L 219.34375,412.625 L 219.34375,415.09375 L 220.78125,416.5 L 219.53125,418.4375 L 220.0625,419.5 L 222.53125,418.4375 L 227.65625,418.4375 L 229.09375,417.5625 L 230.84375,417.5625 L 232.78125,419.875 L 237.21875,418.625 L 238.4375,416.6875 L 236.6875,415.78125 L 237.90625,415.28125 L 238.28125,413.5 L 240.21875,413.6875 L 241.28125,414.90625 L 242.15625,413.5 L 245,412.4375 L 246.28125,413.03125 L 247.28125,411.375 L 245.53125,409.4375 L 248.875,409.4375 L 249.9375,407.5 L 252.25,405.375 L 249.9375,405.375 L 250.65625,402.375 L 256.65625,401.65625 L 258.96875,400.25 L 261.78125,399.1875 L 262.6875,398.28125 L 261.59375,395.46875 L 263.1875,392.28125 L 260.375,392.09375 L 260.03125,387.6875 L 255.78125,389.625 L 252.9375,388.9375 L 251.1875,391.0625 L 248.1875,390.6875 L 247.65625,394.21875 L 246.21875,394.21875 L 245.34375,392.28125 L 244.8125,391.40625 L 243.21875,391.5625 L 240.21875,394.75 L 236.5,394.59375 L 235.96875,392.28125 L 235.96875,390.53125 L 235.625,390.15625 L 234.375,391.5625 L 232.78125,391.5625 L 231.03125,389.625 L 229.4375,389.625 L 228.375,387.5 L 229.78125,385.90625 L 229.625,384.875 L 227.125,384.96875 L 227.4375,385.65625 L 223.125,386.4375 L 220.1875,384.6875 z ').attr(attr).data('value','82');fr.departement12=paper.path('M 294.6875,353.375 L 289.15625,358.09375 L 289.15625,362.78125 L 287.78125,362.78125 L 287.21875,367.1875 L 285.84375,367.75 L 284.75,370.21875 L 278.65625,370.21875 L 278.125,369.40625 L 275.34375,369.40625 L 273.6875,372.15625 L 273.09375,372.09375 L 272.75,373.1875 L 271.5,374.59375 L 267.96875,374.59375 L 267.25,375.5 L 265.5,375.3125 L 262.3125,378.84375 L 261.25,378.5 L 258.96875,380.4375 L 259.65625,383.96875 L 261.4375,386.625 L 260.0625,388.0625 L 260.375,392.09375 L 263.1875,392.28125 L 261.59375,395.46875 L 262.84375,398.65625 L 264.4375,397.75 L 265.15625,399.34375 L 267.4375,397.0625 L 270.8125,396.875 L 274.15625,399.34375 L 280,400.40625 L 282.125,404.125 L 285.125,405.53125 L 286.71875,409.59375 L 286.53125,411.1875 L 288.46875,414.75 L 288.46875,416.6875 L 292,421.28125 L 295.375,423.03125 L 297.5,422.5 L 298.5625,421.09375 L 300.15625,421.46875 L 303.8125,423.8125 L 303.84375,423.8125 L 305.46875,423.8125 L 308.78125,423.8125 L 308.5,418.03125 L 308.5,416.09375 L 310.15625,416.09375 L 313.1875,417.75 L 316.21875,417.75 L 315.6875,414.4375 L 317.34375,413.03125 L 320.65625,412.5 L 320.65625,409.71875 L 324.25,408.0625 L 323.40625,404.21875 L 320.375,404.21875 L 317.625,403.65625 L 317.0625,401.4375 L 319.28125,400.90625 L 319.28125,398.125 L 321.46875,396.1875 L 319.8125,395.375 L 315.125,396.1875 L 315.40625,394 L 312.09375,392.59375 L 311.25,385.96875 L 311.25,381.28125 L 308.5,379.34375 L 308.78125,375.46875 L 302.96875,368.3125 L 302.40625,362.78125 L 300.5,362.78125 L 299.65625,357.25 L 295.78125,357.8125 L 295.25,354.21875 L 294.6875,353.375 z ').attr(attr).data('value','12');fr.departement81=paper.path('M 270.8125,396.875 L 267.4375,397.0625 L 265.15625,399.34375 L 264.4375,397.75 L 262.84375,398.65625 L 262.6875,398.28125 L 261.78125,399.1875 L 258.96875,400.25 L 256.65625,401.65625 L 250.65625,402.375 L 249.9375,405.375 L 252.25,405.375 L 249.9375,407.5 L 248.875,409.4375 L 245.53125,409.4375 L 247.28125,411.375 L 246.28125,413.03125 L 246.59375,413.15625 L 247.46875,415.78125 L 249.59375,418.28125 L 250.125,418.625 L 250.28125,421.09375 L 252.0625,423.9375 L 253.46875,425.53125 L 253.46875,427.46875 L 252.0625,428 L 253.125,429.59375 L 257.71875,431.53125 L 258.59375,432.78125 L 260.90625,435.59375 L 263.5625,436.3125 L 265.6875,435.9375 L 265.6875,438.4375 L 265.625,439.71875 L 266.78125,439.5625 L 266.5,440.9375 L 270.375,440.9375 L 273.96875,442.0625 L 274.25,438.46875 L 275.90625,438.46875 L 281.96875,439.5625 L 287.78125,439.5625 L 292.1875,438.1875 L 293.3125,434.59375 L 290.28125,431.8125 L 291.09375,429.0625 L 292.75,426.59375 L 295.5,428.5 L 302.6875,426.03125 L 303.8125,423.8125 L 300.15625,421.46875 L 298.5625,421.09375 L 297.5,422.5 L 295.375,423.03125 L 292,421.28125 L 288.46875,416.6875 L 288.46875,414.75 L 286.53125,411.1875 L 286.71875,409.59375 L 285.125,405.53125 L 282.125,404.125 L 280,400.40625 L 274.15625,399.34375 L 270.8125,396.875 z ').attr(attr).data('value','81');fr.departement01=paper.path('M 383.28125,262.59375 L 381.125,262.8125 L 379.75,265.34375 L 376.0625,279.78125 L 375.53125,280.96875 L 375.15625,285.53125 L 374.09375,287 L 374.09375,293.59375 L 373.46875,295.09375 L 377.28125,297.40625 L 378.78125,297.625 L 381.125,299.75 L 381.53125,303.15625 L 384.09375,302.3125 L 388.0625,303.46875 L 388.125,302.71875 L 390.03125,302.71875 L 392.78125,305.28125 L 395.34375,304 L 396.625,300.1875 L 397.90625,298.6875 L 399.59375,298.90625 L 401.28125,300.40625 L 402.15625,303.15625 L 410,312.71875 L 412.34375,311.03125 L 412.75,307.40625 L 415.3125,306.96875 L 415.3125,300.59375 L 416.59375,299.53125 L 417,293.8125 L 417.5,294.21875 L 417.4375,292.125 L 416.375,290.1875 L 416.8125,284.6875 L 418.71875,285.75 L 419.78125,283.8125 L 421.6875,283.1875 L 423.65625,281.625 L 421.53125,281.625 L 421.53125,277.90625 L 423.875,276.53125 L 427.375,276.15625 L 427.59375,274.1875 L 426.40625,273.40625 L 429.34375,269.6875 L 428.9375,268.53125 L 425.59375,266.75 L 417.46875,275.6875 L 411.8125,275.6875 L 411.8125,273.34375 L 408.6875,271.78125 L 404.96875,275.875 L 402.03125,276.28125 L 402.03125,273.53125 L 399.5,272.375 L 395.59375,266.90625 L 392.0625,265.53125 L 390.90625,263 L 388.9375,262.59375 L 387,263.96875 L 385.4375,264.375 L 383.28125,262.59375 z ').attr(attr).data('value','01');fr.departement38=paper.path('M 397.90625,298.6875 L 396.625,300.1875 L 395.34375,304 L 392.78125,305.28125 L 390.03125,302.71875 L 388.125,302.71875 L 387.90625,305.5 L 390.6875,307.84375 L 386.4375,313.34375 L 380.90625,314.625 L 376.65625,316.125 L 379.40625,318.875 L 380.0625,320.15625 L 375.8125,322.28125 L 375.375,328.4375 L 375.25,328.5 L 376.4375,330.96875 L 379.84375,332.03125 L 382.1875,331.1875 L 384.9375,329.28125 L 388.5625,332.25 L 391.53125,332.25 L 393.65625,335.21875 L 392.78125,337.34375 L 393.21875,340.34375 L 392.15625,343.3125 L 392.59375,344.375 L 394.0625,343.9375 L 397.46875,345 L 401.9375,346.28125 L 403.84375,345 L 404.6875,343.53125 L 405.34375,343.53125 L 405.53125,359.4375 L 406.59375,360.5 L 409.375,360.5 L 411.90625,362 L 413.8125,363.5 L 415.75,363.6875 L 417,364.75 L 420.53125,365.15625 L 420.78125,364.5625 L 419.21875,363.78125 L 419.21875,361.4375 L 424.09375,361.4375 L 425.65625,359.875 L 424.6875,358.125 L 427.21875,356.15625 L 429,356.9375 L 431.53125,354.78125 L 436,355.5625 L 437.5625,353.8125 L 441.28125,354 L 441.28125,349.71875 L 439.71875,348.9375 L 438.9375,346.40625 L 434.84375,346 L 434.25,345.03125 L 435.03125,340.9375 L 436.40625,339.75 L 435.28125,338.21875 L 433.15625,336.9375 L 431.875,338.21875 L 432.3125,336.5 L 432.3125,334.8125 L 430.59375,333.09375 L 431.46875,329.0625 L 433.375,328 L 433.15625,325.25 L 429.125,321.21875 L 427.625,321.21875 L 426.5625,322.6875 L 424.03125,319.3125 L 422.53125,319.5 L 421.25,322.28125 L 422.125,323.96875 L 421.46875,324.625 L 419.78125,323.34375 L 414.875,322.28125 L 412.5625,318.03125 L 412.5625,316.3125 L 410.21875,313.78125 L 409.96875,312.6875 L 402.15625,303.15625 L 401.28125,300.40625 L 399.59375,298.90625 L 397.90625,298.6875 z ').attr(attr).data('value','38');fr.departement74=paper.path('M 446.125,266.1875 L 441.65625,266.96875 L 437.34375,270.46875 L 436.1875,268.71875 L 434.03125,268.90625 L 432.0625,273.21875 L 432.28125,274.96875 L 434.40625,276.71875 L 430.5,279.28125 L 427.96875,281.625 L 423.65625,281.625 L 421.6875,283.1875 L 419.78125,283.8125 L 418.71875,285.75 L 416.8125,284.6875 L 416.375,290.1875 L 417.4375,292.125 L 417.5,294.21875 L 419.125,295.5 L 419.125,301.03125 L 422.96875,301.65625 L 424.4375,304.4375 L 427.84375,304.84375 L 428.46875,303.59375 L 430.1875,303.59375 L 433.15625,306.78125 L 434.21875,307.84375 L 437.625,307.1875 L 438.46875,305.5 L 439.3125,302.09375 L 441.21875,300.59375 L 442.71875,296.15625 L 444.625,294.875 L 446.125,295.28125 L 446.53125,296.5625 L 445.46875,297.84375 L 447.375,300.1875 L 450.5625,300.1875 L 452.5,303.375 L 452.0625,304.4375 L 453.96875,303.15625 L 455.46875,301.46875 L 456.78125,301.625 L 456.875,298.21875 L 463.53125,295.46875 L 464.3125,293.53125 L 463.90625,289.21875 L 459.625,284.75 L 458.25,285.53125 L 458.25,283.75 L 458.25,280.84375 L 454.53125,279.0625 L 454.34375,277.5 L 456.5,275.15625 L 456.5,272.4375 L 452.96875,268.71875 L 452.78125,266.1875 L 446.125,266.1875 z ').attr(attr).data('value','74');fr.departement42=paper.path('M 339.53125,278.03125 L 336,278.625 L 335.4375,280.78125 L 336.8125,283.5 L 337.1875,294.625 L 332.5,294.84375 L 332.3125,296.59375 L 335.4375,299.125 L 333.6875,300.875 L 333.09375,305.1875 L 335.4375,308.3125 L 337.5625,313.375 L 342.65625,316.71875 L 344.40625,323.15625 L 340.6875,326.65625 L 341.28125,329 L 346.75,330.78125 L 351.0625,327.25 L 353.1875,327.0625 L 359.4375,329.78125 L 359.0625,333.5 L 362.1875,333.3125 L 364.65625,336.15625 L 366.46875,335.65625 L 369.84375,335.03125 L 370.71875,331.1875 L 375.375,328.4375 L 375.8125,322.28125 L 375.96875,322.1875 L 373.6875,321.84375 L 371.5625,322.6875 L 369.84375,321.625 L 371.96875,319.09375 L 371.34375,317.1875 L 364.75,316.125 L 359.21875,311.03125 L 359.21875,309.3125 L 360.5,308.25 L 360.5,306.78125 L 359.03125,305.90625 L 360.28125,304 L 360.28125,301.25 L 357.75,298.90625 L 357.75,296.5625 L 356.03125,294.875 L 356.03125,292.96875 L 355.1875,289.78125 L 356.46875,288.5 L 356.6875,284.6875 L 360.71875,284.6875 L 361.78125,283.40625 L 360.5,281.28125 L 360.5,279.375 L 359.4375,278.53125 L 358.6875,282.53125 L 356.53125,282.53125 L 354.96875,284.09375 L 353.78125,282.90625 L 347.53125,281.9375 L 345.1875,283.3125 L 343.625,283.3125 L 343.25,281.9375 L 340.3125,281.34375 L 340.125,278.21875 L 339.53125,278.03125 z ').attr(attr).data('value','42');fr.departement69=paper.path('M 371.75,275.3125 L 369.625,275.5 L 367.84375,277.25 L 366.6875,275.6875 L 364.9375,277.25 L 362.5625,275.6875 L 360.625,275.6875 L 359.84375,276.28125 L 359.4375,278.53125 L 360.5,279.375 L 360.5,281.28125 L 361.78125,283.40625 L 360.71875,284.6875 L 356.6875,284.6875 L 356.46875,288.5 L 355.1875,289.78125 L 356.03125,292.96875 L 356.03125,294.875 L 357.75,296.5625 L 357.75,298.90625 L 360.28125,301.25 L 360.28125,304 L 359.03125,305.90625 L 360.5,306.78125 L 360.5,308.25 L 359.21875,309.3125 L 359.21875,311.03125 L 364.75,316.125 L 371.34375,317.1875 L 371.96875,319.09375 L 369.84375,321.625 L 371.5625,322.6875 L 373.6875,321.84375 L 375.96875,322.1875 L 380.0625,320.15625 L 379.40625,318.875 L 376.65625,316.125 L 380.90625,314.625 L 386.4375,313.34375 L 390.6875,307.84375 L 387.90625,305.5 L 388.0625,303.46875 L 384.09375,302.3125 L 381.53125,303.15625 L 381.125,299.75 L 378.78125,297.625 L 377.28125,297.40625 L 373.46875,295.09375 L 374.09375,293.59375 L 374.09375,287 L 375.15625,285.53125 L 375.53125,280.96875 L 374.875,282.53125 L 373.5,282.34375 L 372.75,278.4375 L 371.75,275.3125 z ').attr(attr).data('value','69');fr.departement73=paper.path('M 417,293.8125 L 416.59375,299.53125 L 415.3125,300.59375 L 415.3125,306.96875 L 412.75,307.40625 L 412.34375,311.03125 L 410,312.71875 L 409.96875,312.6875 L 410.21875,313.78125 L 412.5625,316.3125 L 412.5625,318.03125 L 414.875,322.28125 L 419.78125,323.34375 L 421.46875,324.625 L 422.125,323.96875 L 421.25,322.28125 L 422.53125,319.5 L 424.03125,319.3125 L 426.5625,322.6875 L 427.625,321.21875 L 429.125,321.21875 L 433.15625,325.25 L 433.375,328 L 431.46875,329.0625 L 430.59375,333.09375 L 432.3125,334.8125 L 432.3125,336.5 L 431.875,338.21875 L 433.15625,336.9375 L 435.28125,338.21875 L 436.40625,339.75 L 439.9375,339.375 L 441.09375,340.53125 L 441.6875,343.28125 L 445.1875,342.875 L 445.59375,339.9375 L 447.34375,339.15625 L 451.09375,339.34375 L 451.03125,339.21875 L 456.875,336.875 L 459.03125,338.25 L 461.1875,338.25 L 461.375,335.90625 L 463.90625,334.53125 L 464.875,333.375 L 469.96875,331.40625 L 470.5625,328.09375 L 469.5625,326.53125 L 472.3125,321.84375 L 469.78125,320.875 L 469,318.125 L 463.71875,315 C 463.71875,315 464.03377,309.01275 463.53125,307.9375 C 463.51544,307.91055 463.48155,307.86019 463.46875,307.84375 C 463.46374,307.8383 463.44264,307.81713 463.4375,307.8125 C 463.43393,307.81272 463.4091,307.81243 463.40625,307.8125 C 463.4062,307.80552 463.40608,307.78312 463.40625,307.78125 C 463.40269,307.78137 463.37784,307.78121 463.375,307.78125 C 463.37209,307.7811 463.3467,307.78118 463.34375,307.78125 C 463.34022,307.78117 463.31534,307.78126 463.3125,307.78125 C 462.53125,307.97657 459.625,308.1875 459.625,308.1875 L 456.6875,304.84375 L 456.78125,301.625 L 455.46875,301.46875 L 453.96875,303.15625 L 452.0625,304.4375 L 452.5,303.375 L 450.5625,300.1875 L 447.375,300.1875 L 445.46875,297.84375 L 446.53125,296.5625 L 446.125,295.28125 L 444.625,294.875 L 442.71875,296.15625 L 441.21875,300.59375 L 439.3125,302.09375 L 438.46875,305.5 L 437.625,307.1875 L 434.21875,307.84375 L 433.15625,306.78125 L 430.1875,303.59375 L 428.46875,303.59375 L 427.84375,304.84375 L 424.4375,304.4375 L 422.96875,301.65625 L 419.125,301.03125 L 419.125,295.5 L 417,293.8125 z ').attr(attr).data('value','73');fr.departement07=paper.path('M 375.25,328.5 L 370.71875,331.1875 L 369.84375,335.03125 L 366.46875,335.65625 L 364.65625,336.15625 L 364.71875,336.25 L 363.5625,340.9375 L 360.8125,342.09375 L 359.65625,344.0625 L 360.4375,346.59375 L 361,347.96875 L 358.09375,347.96875 L 357.875,351.65625 L 354.75,351.875 L 353.1875,356.75 L 348.5,356.75 L 343.4375,360.46875 L 340.625,364.9375 L 341.09375,365.53125 L 342.46875,372.71875 L 345.78125,376.3125 L 345.21875,380.4375 L 349.375,382.9375 L 349.375,388.46875 L 351.59375,387.34375 L 356.28125,390.40625 L 358.5,391.21875 L 359.03125,387.34375 L 361.8125,386.8125 L 362.625,389.84375 L 365.40625,389.5625 L 365.9375,386.53125 L 372.28125,390.09375 L 373.3125,388 L 376,387.59375 L 376.21875,383.46875 L 375.59375,382.59375 L 374.75,382.40625 L 374.75,380.90625 L 375.375,379.40625 L 374.3125,377.71875 L 374.9375,373.90625 L 377.5,370.90625 L 377.5,366.6875 L 376.4375,361.78125 L 378.34375,361.375 L 378.78125,359.25 L 380.6875,355.625 L 381.75,352.875 L 380.0625,348.625 L 379,345.21875 L 377.5,339.28125 L 377.5,331.3125 L 376.4375,330.96875 L 375.25,328.5 z ').attr(attr).data('value','07');fr.departement26=paper.path('M 384.9375,329.28125 L 382.1875,331.1875 L 379.84375,332.03125 L 377.5,331.3125 L 377.5,339.28125 L 379,345.21875 L 380.0625,348.625 L 381.75,352.875 L 380.6875,355.625 L 378.78125,359.25 L 378.34375,361.375 L 376.4375,361.78125 L 377.5,366.6875 L 377.5,370.90625 L 374.9375,373.90625 L 374.3125,377.71875 L 375.375,379.40625 L 374.75,380.90625 L 374.75,382.40625 L 375.59375,382.59375 L 376.21875,383.46875 L 376,387.59375 L 378.59375,387.21875 L 379.75,388.59375 L 379.1875,392.5 L 379.96875,393.46875 L 382.875,390.53125 L 385.4375,390.34375 L 386,388.78125 L 382.6875,388.375 L 382.125,384.875 L 384.25,381.5625 L 387,381.34375 L 389.71875,383.90625 L 387,387.59375 L 387.78125,388.96875 L 391.6875,389.375 L 394.21875,387.21875 L 392.84375,390.15625 L 393.25,392.5 L 397.34375,392.875 L 402.8125,393.28125 L 403.59375,395.8125 L 406.53125,397.96875 L 409.0625,398.15625 L 410.8125,396.59375 L 411.8125,393.65625 L 413.375,395.03125 L 414.53125,396.40625 L 415.3125,389.15625 L 413.375,388.78125 L 412.1875,386.25 L 405.5625,384.46875 L 404.75,381.15625 L 407.125,379.59375 L 405.15625,378.21875 L 405.5625,376.46875 L 408.6875,376.65625 L 411.40625,378.03125 L 413.5625,375.5 L 411.40625,373.75 L 411.59375,371.40625 L 412.78125,367.6875 L 416.875,367.28125 L 420.1875,365.9375 L 420.53125,365.15625 L 417,364.75 L 415.75,363.6875 L 413.8125,363.5 L 411.90625,362 L 409.375,360.5 L 406.59375,360.5 L 405.53125,359.4375 L 405.34375,343.53125 L 404.6875,343.53125 L 403.84375,345 L 401.9375,346.28125 L 397.46875,345 L 394.0625,343.9375 L 392.59375,344.375 L 392.15625,343.3125 L 393.21875,340.34375 L 392.78125,337.34375 L 393.65625,335.21875 L 391.53125,332.25 L 388.5625,332.25 L 384.9375,329.28125 z ').attr(attr).data('value','26');fr.departement17=paper.path('M 149.3125,270.625 L 146.5625,270.8125 L 140.59375,274.4375 L 142.03125,275.75 L 138.90625,278.28125 L 138.53125,280.25 L 135.59375,280.625 L 134.03125,278.875 L 130.125,278.5 L 129.71875,276.53125 L 127.375,274.96875 L 124.0625,276.15625 L 126.21875,279.28125 L 128.9375,279.28125 L 131.6875,281.03125 L 133.84375,282.78125 L 137.9375,282.59375 L 138.71875,284.34375 L 141.4375,284.9375 L 142.4375,287.65625 L 144.1875,288.4375 L 144,290.59375 L 141.65625,290.21875 L 140.875,291.375 L 142.625,293.90625 L 141.65625,298.21875 L 139.3125,298.03125 L 139.5,300.75 L 140.09375,301.71875 L 137.34375,301.71875 L 136.96875,300.15625 L 138.71875,297.8125 L 138.125,296.46875 L 137.15625,295.6875 L 136.75,291 L 133.4375,290.59375 L 130.71875,287.28125 L 130.3125,294.125 L 134.8125,297.4375 L 135.1875,301.15625 L 135.96875,305.4375 L 136.375,309.75 L 138.71875,309.53125 L 142.8125,312.875 L 145.5625,314.4375 L 145.75,316.375 L 147.90625,316.78125 L 154.15625,323.03125 L 155.625,329.78125 L 161.40625,329.78125 L 162.375,328.8125 L 162.5625,331.75 L 167.65625,332.34375 L 168.4375,338.59375 L 171.1875,338.78125 L 175.65625,343.28125 L 178,343.65625 L 180.75,342.28125 L 182.6875,343.65625 L 184.25,340.34375 L 185.8125,337.625 L 181.65625,334.8125 L 180.375,333.09375 L 178.65625,331.1875 L 174.625,331.84375 L 173.34375,331.1875 L 173.15625,330.125 L 175.28125,329.28125 L 175.28125,328.875 L 173.78125,328.4375 L 172.71875,327.59375 L 175.28125,325.46875 L 175.28125,323.96875 L 174,322.6875 L 174.84375,321.84375 L 175.28125,319.71875 L 173.78125,318.25 L 172.5,316.125 L 170.1875,314 L 168.46875,312.9375 L 169.96875,311.21875 L 169.125,311.03125 L 168.90625,306.5625 L 167.1875,305.90625 L 169.53125,304.65625 L 172.3125,304.65625 L 173.5625,303.59375 L 175.90625,303.59375 L 176.34375,304.65625 L 178.46875,304.84375 L 179.9375,304.21875 L 180.375,300.1875 L 182.0625,294.03125 L 182.125,294 L 180.59375,292.53125 L 180.15625,290.40625 L 177.40625,289.125 L 173.78125,286.59375 L 169.3125,287 L 166.5625,283.40625 L 162.53125,283.1875 L 159.34375,280.84375 L 159.34375,279.5625 L 157.21875,277.25 L 157.125,274.375 L 154.1875,272.1875 L 150.46875,273.75 L 149.3125,270.625 z ').attr(attr).data('value','17');fr.departement19=paper.path('M 265.75,307.625 L 264.90625,309.75 L 261.71875,310.375 L 260.46875,312.5 L 258.96875,312.5 L 256.84375,311.875 L 255.34375,314.40625 L 253.03125,314.625 L 251.53125,317.375 L 249.625,317.375 L 248.125,318.875 L 244.3125,318.4375 L 243.03125,320.5625 L 241.5625,320.375 L 239,323.5625 L 236.65625,322.6875 L 235.5625,324.90625 L 236.40625,327.0625 L 238.5625,328.8125 L 234.65625,332.34375 L 234.65625,335.0625 L 236.21875,335.84375 L 234.65625,337.8125 L 236.8125,339.5625 L 235.25,341.5 L 237,342.6875 L 241.28125,342.5 L 241.09375,346.78125 L 242.71875,349.34375 L 243.3125,349.25 L 247.46875,347.3125 L 252.4375,349.53125 L 256.28125,355.03125 L 258.5,354.75 L 261.8125,351.4375 L 262.90625,353.375 L 265.125,351.1875 L 268.15625,352 L 268.25,352.65625 L 270.78125,350.875 L 270,348.9375 L 268.8125,347.75 L 270.375,345.8125 L 271.9375,345.8125 L 272.9375,342.6875 L 273.71875,341.125 L 273.125,337.59375 L 275.65625,334.09375 L 279.1875,331.9375 L 279.375,326.46875 L 281.125,327.4375 L 283.09375,329.59375 L 285.03125,329.59375 L 286.21875,328.21875 L 285.25,325.875 L 286.21875,322.375 L 285.625,319.0625 L 284.4375,317.6875 L 284.4375,314.9375 L 286.21875,312.03125 L 285.8125,309.28125 L 285.375,308.84375 L 283.40625,310.375 L 279.5625,310.375 L 278.3125,312.28125 L 275.96875,312.28125 L 274.0625,310.375 L 273.1875,309.09375 L 268.3125,309.09375 L 267.25,307.625 L 265.75,307.625 z ').attr(attr).data('value','19');fr.departement23=paper.path('M 256.125,267.875 L 254.96875,271 L 251.4375,270.8125 L 250.65625,270.40625 L 248.3125,270.625 L 246.5625,269.4375 L 243.1875,273.3125 L 243.25,276.1875 L 240.90625,280.84375 L 241.34375,283.1875 L 243.875,283.8125 L 245.59375,288.0625 L 247.28125,289.78125 L 246.65625,297.84375 L 250.25,296.78125 L 251.75,298.6875 L 249.40625,300.59375 L 249.40625,302.53125 L 251.3125,302.71875 L 254.71875,302.53125 L 255.78125,301.03125 L 256.625,301.03125 L 256.21875,303.59375 L 258.96875,304.84375 L 261.53125,306.5625 L 261.53125,307.625 L 260.03125,307.625 L 260.46875,310.15625 L 261.46875,310.78125 L 261.71875,310.375 L 264.90625,309.75 L 265.75,307.625 L 267.25,307.625 L 268.3125,309.09375 L 273.1875,309.09375 L 274.0625,310.375 L 275.96875,312.28125 L 278.3125,312.28125 L 279.5625,310.375 L 283.40625,310.375 L 285.375,308.84375 L 281.3125,304.78125 L 280.9375,303.03125 L 284.65625,300.875 L 286.8125,299.71875 L 287.375,296.96875 L 289.71875,295.21875 L 288.9375,291.5 L 287.375,289.5625 L 287,283.5 L 284.84375,278.4375 L 282.6875,277.65625 L 281.125,274.90625 L 279.75,276.65625 L 278.40625,274.90625 L 278.40625,272.5625 L 276.0625,269.25 L 269.625,270.03125 L 265.90625,269.0625 L 256.125,267.875 z ').attr(attr).data('value','23');fr.departement87=paper.path('M 239.53125,270.8125 L 237.78125,272.5625 L 232.875,272.1875 L 232.3125,272.0625 L 228.59375,272.75 L 226.4375,274.53125 L 226.4375,276.875 L 222.15625,277.0625 L 219.625,280 L 218.0625,281.15625 L 219.40625,282.71875 L 219.21875,288 L 218.25,289.75 L 219.8125,291.5 L 222.53125,291.71875 L 223.125,294.4375 L 223.3125,296.1875 L 219.8125,296.96875 L 218.0625,297.5625 L 218.4375,302.4375 L 216.09375,304 L 214.125,304.59375 L 213.15625,307.34375 L 211.59375,307.53125 L 210.9375,310.5 L 215.5,310.65625 L 216.5,312.59375 L 215.6875,314.75 L 217.46875,317.09375 L 218.8125,316.71875 L 220.1875,314.75 L 226.4375,315.34375 L 227.4375,319.25 L 231.71875,319.84375 L 232.6875,321.1875 L 229.75,322.5625 L 231.125,323.53125 L 235.25,324.125 L 235.5625,324.90625 L 236.65625,322.6875 L 239,323.5625 L 241.5625,320.375 L 243.03125,320.5625 L 244.3125,318.4375 L 248.125,318.875 L 249.625,317.375 L 251.53125,317.375 L 253.03125,314.625 L 255.34375,314.40625 L 256.84375,311.875 L 258.96875,312.5 L 260.46875,312.5 L 261.46875,310.78125 L 260.46875,310.15625 L 260.03125,307.625 L 261.53125,307.625 L 261.53125,306.5625 L 258.96875,304.84375 L 256.21875,303.59375 L 256.625,301.03125 L 255.78125,301.03125 L 254.71875,302.53125 L 251.3125,302.71875 L 249.40625,302.53125 L 249.40625,300.59375 L 251.75,298.6875 L 250.25,296.78125 L 246.65625,297.84375 L 247.28125,289.78125 L 245.59375,288.0625 L 243.875,283.8125 L 241.34375,283.1875 L 240.90625,280.84375 L 243.25,276.1875 L 243.1875,273.3125 L 242.65625,273.9375 L 239.53125,270.8125 z ').attr(attr).data('value','87');fr.departement86=paper.path('M 188.75,225.6875 L 185.03125,229.59375 L 184.09375,231.21875 L 184.40625,236.03125 L 186.09375,235.8125 L 186.3125,237.9375 L 186.96875,241.34375 L 188.03125,243.6875 L 186.75,245.15625 L 187.375,246.21875 L 186.53125,247.71875 L 186.53125,248.34375 L 188.03125,250.0625 L 188.03125,251.125 L 187.375,252.8125 L 185.25,256 L 187.375,256.84375 L 188.03125,258.34375 L 187.15625,260.65625 L 186.96875,261.71875 L 185.6875,263.84375 L 185.6875,265.34375 L 186.53125,265.5625 L 186.53125,270.03125 L 188.03125,271.09375 L 187.375,272.5625 L 187.59375,273.84375 L 189.28125,275.75 L 190.15625,274.46875 L 190.15625,273.40625 L 191.84375,272.5625 L 193.125,273.40625 L 193.125,276.59375 L 191.84375,278.09375 L 190.78125,280.625 L 192.25,282.96875 L 195.25,283.8125 L 194.59375,285.75 L 191.8125,286.21875 L 194.375,289.34375 L 197.78125,289.125 L 200.75,288.0625 L 203.75,289.78125 L 204.8125,288.9375 L 204.59375,286.15625 L 206.28125,284.875 L 207.78125,287.4375 L 209.03125,288.71875 L 212.65625,287.21875 L 214.15625,285.53125 L 217.53125,285.53125 L 219.28125,286.40625 L 219.40625,282.71875 L 218.0625,281.15625 L 219.625,280 L 222.15625,277.0625 L 226.4375,276.875 L 226.4375,274.53125 L 228.59375,272.75 L 233.875,271.78125 L 234.25,268.84375 L 232.125,267.6875 L 230.9375,263.59375 L 227.8125,263.1875 L 225.875,261.25 L 222.15625,258.3125 L 222.9375,255.96875 L 222.9375,252.25 L 219.40625,248.75 L 219.03125,246 L 215.6875,242.5 L 214.53125,237.8125 L 213.15625,237.21875 L 211.59375,235.0625 L 210.03125,236.03125 L 210.4375,238.1875 L 205.34375,239.375 L 199.5,239.375 L 199.6875,237.03125 L 199.6875,233.3125 L 195,231.9375 L 195,229.59375 L 191.28125,228.8125 L 190.5,225.6875 L 188.75,225.6875 z ').attr(attr).data('value','86');fr.departement16=paper.path('M 206.28125,284.875 L 204.59375,286.15625 L 204.8125,288.9375 L 203.75,289.78125 L 200.75,288.0625 L 197.78125,289.125 L 194.375,289.34375 L 191.8125,286.21875 L 191,286.375 L 187.59375,288.0625 L 185.03125,288.71875 L 185.03125,290.1875 L 183.5625,291.90625 L 183.96875,292.96875 L 182.0625,294.03125 L 180.375,300.1875 L 179.9375,304.21875 L 178.46875,304.84375 L 176.34375,304.65625 L 175.90625,303.59375 L 173.5625,303.59375 L 172.3125,304.65625 L 169.53125,304.65625 L 167.1875,305.90625 L 168.90625,306.5625 L 169.125,311.03125 L 169.96875,311.21875 L 168.46875,312.9375 L 170.1875,314 L 172.5,316.125 L 173.78125,318.25 L 175.28125,319.71875 L 174.84375,321.84375 L 174,322.6875 L 175.28125,323.96875 L 175.28125,325.46875 L 172.71875,327.59375 L 173.78125,328.4375 L 175.28125,328.875 L 175.28125,329.28125 L 173.15625,330.125 L 173.34375,331.1875 L 174.625,331.84375 L 178.65625,331.1875 L 180.375,333.09375 L 181.65625,334.8125 L 185.8125,337.625 L 186.40625,336.625 L 190.3125,337.03125 L 192.25,335.25 L 195.78125,331.75 L 195.96875,324.90625 L 205.15625,318.65625 L 205.34375,313.96875 L 208.09375,313.59375 L 209.84375,310.46875 L 210.9375,310.5 L 211.59375,307.53125 L 213.15625,307.34375 L 214.125,304.59375 L 216.09375,304 L 218.4375,302.4375 L 218.0625,297.5625 L 219.8125,296.96875 L 223.3125,296.1875 L 223.125,294.4375 L 222.53125,291.71875 L 219.8125,291.5 L 218.25,289.75 L 219.21875,288 L 219.28125,286.40625 L 217.53125,285.53125 L 214.15625,285.53125 L 212.65625,287.21875 L 209.03125,288.71875 L 207.78125,287.4375 L 206.28125,284.875 z ').attr(attr).data('value','16');fr.departement79=paper.path('M 181.71875,229.40625 L 176.4375,229.59375 L 171.5625,230.5625 L 166.28125,230.96875 L 166.28125,233.6875 L 163.5625,235.46875 L 157.5,234.09375 L 153.40625,235.84375 L 155.34375,238.59375 L 155.34375,240.9375 L 160.03125,244.84375 L 158.875,247.375 L 162,250.875 L 160.625,252.65625 L 162.5625,255.5625 L 163.15625,261.03125 L 162,262.59375 L 163.375,264.9375 L 162,267.5 L 162.1875,269.0625 L 163.75,267.875 L 165.6875,269.84375 L 162.96875,271.59375 L 162,272.75 L 159.84375,273.34375 L 157.3125,274.53125 L 157.125,274.375 L 157.21875,277.25 L 159.34375,279.5625 L 159.34375,280.84375 L 162.53125,283.1875 L 166.5625,283.40625 L 169.3125,287 L 173.78125,286.59375 L 177.40625,289.125 L 180.15625,290.40625 L 180.59375,292.53125 L 182.125,294 L 183.96875,292.96875 L 183.5625,291.90625 L 185.03125,290.1875 L 185.03125,288.71875 L 187.59375,288.0625 L 191,286.375 L 194.59375,285.75 L 195.25,283.8125 L 192.25,282.96875 L 190.78125,280.625 L 191.84375,278.09375 L 193.125,276.59375 L 193.125,273.40625 L 191.84375,272.5625 L 190.15625,273.40625 L 190.15625,274.46875 L 189.28125,275.75 L 187.59375,273.84375 L 187.375,272.5625 L 188.03125,271.09375 L 186.53125,270.03125 L 186.53125,265.5625 L 185.6875,265.34375 L 185.6875,263.84375 L 186.96875,261.71875 L 187.15625,260.65625 L 188.03125,258.34375 L 187.375,256.84375 L 185.25,256 L 187.375,252.8125 L 188.03125,251.125 L 188.03125,250.0625 L 186.53125,248.34375 L 186.53125,247.71875 L 187.375,246.21875 L 186.75,245.15625 L 188.03125,243.6875 L 186.96875,241.34375 L 186.3125,237.9375 L 186.09375,235.8125 L 184.40625,236.03125 L 184.09375,231.21875 L 183.6875,231.9375 L 182.3125,230.78125 L 181.71875,229.40625 z ').attr(attr).data('value','79');fr.departement22=paper.path('M 69.78125,123.21875 L 68,124.59375 L 63.53125,125.15625 L 62.53125,126.53125 L 59.40625,124.1875 L 55.3125,126.9375 L 56.875,129.0625 L 54.15625,132.78125 L 54.03125,132.71875 L 52.90625,137.96875 L 55.3125,138.125 L 55.15625,140.21875 L 56.9375,141.34375 L 55.3125,142.96875 L 54.1875,143.78125 L 54.34375,145.6875 L 56.78125,146.5 L 54.5,147.15625 L 54.5,149.5625 L 55.96875,151.5 L 56.28125,157.15625 L 55.3125,158.125 L 56.125,161.03125 L 59.1875,161.84375 L 59.5,163.4375 L 61.4375,163.59375 L 63.0625,162.46875 L 64.03125,163.4375 L 67.75,165.0625 L 70.8125,163.4375 L 71.59375,161.84375 L 74.1875,161.65625 L 77.09375,164.25 L 79.84375,163.59375 L 82.25,166.03125 L 83.375,166.03125 L 84.5,167.46875 L 86.78125,167.46875 L 87.5625,166.34375 L 88.53125,168.4375 L 90.96875,169.40625 L 94.03125,167.46875 L 94.03125,165.375 L 96.28125,164.5625 L 97.71875,164.5625 L 99.5,167.8125 L 103.375,168.125 L 105.3125,165.6875 L 107.40625,161.1875 L 110.15625,160.21875 L 111.59375,158.125 L 113.0625,159.5625 L 116.125,158.9375 L 117.09375,150.0625 L 118.0625,146.5 L 117.09375,144.5625 L 115.46875,143.9375 L 114.375,138.03125 L 113.125,139.4375 L 109.40625,139.03125 L 109.03125,141.1875 L 106.6875,141.375 L 106.5,138.65625 L 104.53125,138.0625 L 103.15625,139.625 L 103.15625,135.71875 L 100.8125,137.46875 L 97.3125,136.875 L 96.125,139.21875 L 88.90625,143.125 L 88.90625,145.09375 L 87.34375,145.09375 L 87.34375,141.5625 L 83.25,139.625 L 83.625,136.09375 L 79.9375,133.375 L 79.9375,130.0625 L 77.1875,129.46875 L 77.375,126.34375 L 75.25,126.15625 L 75.4375,124 L 71.53125,124 L 70.9375,125.9375 L 69.78125,123.21875 z ').attr(attr).data('value','22');fr.departement85=paper.path('M 138.53125,229.5625 L 137.40625,231.65625 L 134.1875,231.65625 L 135.46875,232.96875 L 134.5,236.1875 L 131.59375,237.15625 L 130.46875,236.34375 L 130.96875,233.125 L 130.15625,231.34375 L 128.375,231.34375 L 127.09375,232.78125 L 127.71875,237.3125 L 129.1875,239.40625 L 127.71875,241.03125 L 125,240.53125 L 120.96875,239.5625 L 119.84375,236.5 L 117.25,236.1875 L 113.875,234.71875 L 113.0625,232.78125 L 109.375,230.375 L 103.5625,237.875 L 103.375,242.5625 L 109.40625,248.40625 L 109.21875,250.15625 L 110.96875,250.15625 L 114.6875,261.3125 L 118.59375,263.25 L 122.5,267.15625 L 127,267.15625 L 128.75,271.0625 L 133.0625,271.0625 L 135,274 L 139.3125,276.15625 L 139.5,273.40625 L 140.59375,274.4375 L 146.5625,270.8125 L 149.3125,270.625 L 150.46875,273.75 L 154.1875,272.1875 L 157.3125,274.53125 L 159.84375,273.34375 L 162,272.75 L 162.96875,271.59375 L 165.6875,269.84375 L 163.75,267.875 L 162.1875,269.0625 L 162,267.5 L 163.375,264.9375 L 162,262.59375 L 163.15625,261.03125 L 162.5625,255.5625 L 160.625,252.65625 L 162,250.875 L 158.875,247.375 L 160.03125,244.84375 L 155.34375,240.9375 L 155.34375,238.59375 L 153.40625,235.84375 L 153.78125,235.6875 L 151.125,233.4375 L 146.125,233.4375 L 144.5,232.46875 L 142.25,232.15625 L 139.65625,229.71875 L 138.53125,229.5625 z ').attr(attr).data('value','85');fr.departement50=paper.path('M 119.5625,77.5 L 118.78125,79.46875 L 122.90625,82.78125 L 122.90625,87.09375 L 121.34375,89.03125 L 122.3125,90 L 122.90625,90.40625 L 122.5,94.125 L 123.875,97.25 L 128.375,102.3125 L 129.34375,106.8125 L 130.3125,108.1875 L 130.3125,115.21875 L 132.65625,119.90625 L 132.65625,125.375 L 130.125,130.4375 L 132.84375,137.46875 L 137.15625,138.4375 L 137.53125,140.40625 L 135.40625,141.375 L 131.71875,141.375 L 132.3125,143.84375 L 133.46875,147.5625 L 136.8125,150.5 L 138.375,150.875 L 139.9375,148.75 L 141.6875,148.53125 L 143.8125,146 L 145.78125,147.5625 L 148.125,147.5625 L 149.6875,148.34375 L 149.6875,148.71875 L 153,149.125 L 154.96875,147.5625 L 157.875,148.75 L 157.9375,148.875 L 161.28125,146.03125 L 162.40625,142.3125 L 162.09375,140.6875 L 162.5625,138.78125 L 160.625,136.84375 L 155.625,133.59375 L 151.9375,133.28125 L 148.21875,128.59375 L 151.28125,127.46875 L 152.5625,125.0625 L 150.96875,123.59375 L 152.40625,122.3125 L 153.84375,123.4375 L 156.4375,121.84375 L 158.0625,119.25 L 158.6875,116.6875 L 157.5625,114.40625 L 158.21875,113.59375 L 156.75,111.1875 L 158.375,109.09375 L 157.09375,107.46875 L 155.46875,109.5625 L 153.21875,108.28125 L 149.5,104.5625 L 149.34375,102.96875 L 150.46875,101.84375 L 150.125,99.6875 L 148.28125,100.15625 L 148.09375,95.46875 L 143,89.4375 L 144.5625,85.53125 L 146.71875,85.53125 L 144.78125,80.25 L 136.375,79.84375 L 131.875,82.96875 L 126.8125,79.65625 L 119.5625,77.5 z ').attr(attr).data('value','50');fr.departement56=paper.path('M 56,160.59375 L 52.75,162.15625 L 50.46875,162.15625 L 48.0625,164.09375 L 48.21875,165.53125 L 49.65625,169.25 L 50.46875,172.15625 L 55.46875,172.96875 L 57.90625,174.90625 L 58.875,173.75 L 60.46875,175.875 L 59.65625,176.84375 L 59.5,179.71875 L 58.0625,179.71875 L 56.9375,181.5 L 54.65625,181.5 L 53.71875,185.34375 L 55.90625,188.84375 L 59.03125,189.625 L 60.1875,187.875 L 59.625,190 L 62.34375,191.1875 L 65.875,194.6875 L 67.03125,196.84375 L 66.65625,199.375 L 66.25,201.9375 L 68.59375,203.6875 L 69.78125,202.3125 L 68.59375,200.75 L 68.59375,197.25 L 70.9375,197.8125 L 71.71875,195.46875 L 72.3125,196.84375 L 74.84375,199 L 76.03125,197.03125 L 74.84375,194.3125 L 77,197.25 L 79.71875,196.84375 L 79.15625,195.46875 L 81.6875,196.0625 L 83.625,198.40625 L 82.65625,199.96875 L 80.125,199.1875 L 77.1875,197.8125 L 75.625,199.78125 L 77.96875,200.5625 L 79.71875,203.28125 L 90.28125,202.3125 L 93,202.90625 L 91.65625,204.0625 L 91.84375,205.84375 L 92.21875,206.125 L 93.0625,205.96875 L 94.8125,204.21875 L 95.96875,205.5625 L 99.09375,205.5625 L 102.8125,203.625 L 108.28125,201.46875 L 108.46875,196 L 109.625,195.375 L 107.5625,191.5 L 109.34375,190.0625 L 109.03125,189.09375 L 107.90625,188.4375 L 109.65625,187.625 L 111.28125,185.6875 L 111.125,183.75 L 109.03125,183.75 L 108.53125,181.84375 L 110,179.90625 L 108.375,177 L 105.96875,175.53125 L 103.21875,175.53125 L 102.25,175.21875 L 102.25,173.9375 L 103.6875,172.625 L 104.5,169.40625 L 104.03125,167.3125 L 103.375,168.125 L 99.5,167.8125 L 97.71875,164.5625 L 96.28125,164.5625 L 94.03125,165.375 L 94.03125,167.46875 L 90.96875,169.40625 L 88.53125,168.4375 L 87.5625,166.34375 L 86.78125,167.46875 L 84.5,167.46875 L 83.375,166.03125 L 82.25,166.03125 L 79.84375,163.59375 L 77.09375,164.25 L 74.1875,161.65625 L 71.59375,161.84375 L 70.8125,163.4375 L 67.75,165.0625 L 64.03125,163.4375 L 63.0625,162.46875 L 61.4375,163.59375 L 59.5,163.4375 L 59.1875,161.84375 L 56.125,161.03125 L 56,160.59375 z ').attr(attr).data('value','56');fr.departement29=paper.path('M 40.65625,129.0625 L 38.53125,131.40625 L 36.1875,130.4375 L 31.875,130.84375 L 31.09375,132.78125 L 28.5625,133.375 L 28.15625,131.21875 L 23.6875,131.8125 L 23.6875,133.1875 L 20.5625,133.375 L 19.1875,132.40625 L 17.625,133.1875 L 17.21875,135.53125 L 11.96875,135.71875 L 9.21875,139.03125 L 11.5625,140.78125 L 8.4375,143.34375 L 9.40625,145.09375 L 8.625,149.375 L 11.75,149.78125 L 12.9375,148.59375 L 13.53125,149.375 L 20.9375,148.40625 L 25.8125,144.90625 L 21.53125,149 L 21.90625,150.9375 L 25.8125,149.1875 L 25.03125,151.9375 L 29.34375,152.125 L 29.15625,153.28125 L 24.46875,153.09375 L 20.75,152.125 L 16.25,149.96875 L 13.53125,153.09375 L 17.03125,154.28125 L 16.84375,159.53125 L 17.8125,158.75 L 19.96875,155.4375 L 24.0625,157.78125 L 26.03125,158.1875 L 26.8125,161.3125 L 25.625,163.4375 L 23.09375,163.25 L 20.75,163.25 L 16.84375,163.84375 L 10.1875,164.21875 L 8.84375,166 L 10.78125,167.15625 L 12.9375,166.96875 L 14.6875,168.53125 L 17.21875,168.34375 L 21.34375,173.03125 L 22.3125,178.09375 L 20.9375,180.84375 L 25.03125,181.625 L 29.53125,181.40625 L 30.5,179.65625 L 28.75,177.3125 L 30.5,178.09375 L 32.28125,177.90625 L 35.40625,179.65625 L 37.34375,179.28125 L 37.34375,175.9375 L 38.125,179.28125 L 40.65625,183.375 L 46.125,183.75 L 46.34375,182.59375 L 47.6875,184.53125 L 51.03125,185.125 L 53.5625,185.125 L 53.71875,185.34375 L 54.65625,181.5 L 56.9375,181.5 L 58.0625,179.71875 L 59.5,179.71875 L 59.65625,176.84375 L 60.46875,175.875 L 58.875,173.75 L 57.90625,174.90625 L 55.46875,172.96875 L 50.46875,172.15625 L 49.65625,169.25 L 48.21875,165.53125 L 48.0625,164.09375 L 50.46875,162.15625 L 52.75,162.15625 L 56,160.59375 L 55.3125,158.125 L 56.28125,157.15625 L 55.96875,151.5 L 54.5,149.5625 L 54.5,147.15625 L 56.78125,146.5 L 54.34375,145.6875 L 54.1875,143.78125 L 55.3125,142.96875 L 56.9375,141.34375 L 55.15625,140.21875 L 55.3125,138.125 L 52.90625,137.96875 L 54.03125,132.71875 L 50.8125,130.84375 L 45.34375,131.03125 L 45.34375,134.9375 L 43.78125,134.9375 L 43.40625,133.1875 L 41.0625,133.5625 L 40.65625,129.0625 z ').attr(attr).data('value','29');fr.departement35=paper.path('M 116.25,135.90625 L 114.375,138.03125 L 115.46875,143.9375 L 117.09375,144.5625 L 118.0625,146.5 L 117.09375,150.0625 L 116.125,158.9375 L 113.0625,159.5625 L 111.59375,158.125 L 110.15625,160.21875 L 107.40625,161.1875 L 105.3125,165.6875 L 104.03125,167.3125 L 104.5,169.40625 L 103.6875,172.625 L 102.25,173.9375 L 102.25,175.21875 L 103.21875,175.53125 L 105.96875,175.53125 L 108.375,177 L 110,179.90625 L 108.53125,181.84375 L 109.03125,183.75 L 111.125,183.75 L 111.28125,185.6875 L 109.65625,187.625 L 107.90625,188.4375 L 109.03125,189.09375 L 109.34375,190.0625 L 107.5625,191.5 L 109.625,195.375 L 113.5625,193.28125 L 125.65625,192.6875 L 126.4375,190.53125 L 128.40625,188.59375 L 132.6875,188 L 132.875,185.84375 L 135.8125,186.25 L 137.5625,188.59375 L 141.5,189.5625 L 142.25,188 L 143.25,184.46875 L 145.78125,178.21875 L 147.15625,177.4375 L 150.46875,177.84375 L 150.46875,172.5625 L 149.09375,171.1875 L 149.09375,165.53125 L 148.5,163.59375 L 148.5,160.46875 L 150.46875,158.5 L 150.46875,154.59375 L 149.5,153.8125 L 149.6875,148.34375 L 148.125,147.5625 L 145.78125,147.5625 L 143.8125,146 L 141.6875,148.53125 L 139.9375,148.75 L 138.375,150.875 L 136.8125,150.5 L 133.46875,147.5625 L 132.3125,143.84375 L 131.71875,141.375 L 122.125,141.375 L 118.59375,139.21875 L 120.9375,136.09375 L 116.25,135.90625 z ').attr(attr).data('value','35');fr.departement44=paper.path('M 132.875,185.84375 L 132.6875,188 L 128.40625,188.59375 L 126.4375,190.53125 L 125.65625,192.6875 L 113.5625,193.28125 L 108.46875,196 L 108.28125,201.46875 L 102.8125,203.625 L 99.09375,205.5625 L 95.96875,205.5625 L 94.8125,204.21875 L 93.0625,205.96875 L 92.21875,206.125 L 93.21875,206.8125 L 89.5,210.125 L 90.28125,210.90625 L 91.0625,212.46875 L 89.09375,215.21875 L 91.25,216.375 L 94.96875,217.15625 L 95.34375,215.59375 L 97.5,218.34375 L 101.03125,218.34375 L 103.5625,215.59375 L 106.875,215.59375 L 103.375,217.34375 L 103.5625,219.3125 L 104.34375,221.0625 L 102.1875,223.21875 L 99.84375,223.21875 L 100.25,226.15625 L 104.53125,225.375 L 109.625,230.0625 L 109.375,230.375 L 113.0625,232.78125 L 113.875,234.71875 L 117.25,236.1875 L 119.84375,236.5 L 120.96875,239.5625 L 125,240.53125 L 127.71875,241.03125 L 129.1875,239.40625 L 127.71875,237.3125 L 127.09375,232.78125 L 128.375,231.34375 L 130.15625,231.34375 L 130.96875,233.125 L 130.46875,236.34375 L 131.59375,237.15625 L 134.5,236.1875 L 135.46875,232.96875 L 134.1875,231.65625 L 137.40625,231.65625 L 138.53125,229.5625 L 139.65625,229.71875 L 142.25,232.15625 L 144.125,232.40625 L 144.1875,230.375 L 142.5625,228.28125 L 141.125,228.28125 L 140.625,228.4375 L 139.65625,227.96875 L 140.46875,227.15625 L 140.46875,225.6875 L 142.09375,225.21875 L 143.0625,222.96875 L 142.25,222.15625 L 142.09375,219.40625 L 140,219.40625 L 137.90625,216.8125 L 137.90625,214.90625 L 140.15625,213.75 L 144.1875,212.96875 L 150.46875,213.125 L 152.40625,211.8125 L 151.75,207.78125 L 148.84375,205.0625 L 145.3125,205.53125 L 144.34375,204.71875 L 144.1875,201.84375 L 146.75,199.5625 L 144.8125,197.15625 L 143.53125,193.75 L 141.4375,192.46875 L 141.4375,190.21875 L 141.21875,189.5 L 137.5625,188.59375 L 135.8125,186.25 L 132.875,185.84375 z ').attr(attr).data('value','44');fr.departement49=paper.path('M 141.9375,188.6875 L 141.5,189.5625 L 141.21875,189.5 L 141.4375,190.21875 L 141.4375,192.46875 L 143.53125,193.75 L 144.8125,197.15625 L 146.75,199.5625 L 144.1875,201.84375 L 144.34375,204.71875 L 145.3125,205.53125 L 148.84375,205.0625 L 151.75,207.78125 L 152.40625,211.8125 L 150.46875,213.125 L 144.1875,212.96875 L 140.15625,213.75 L 137.90625,214.90625 L 137.90625,216.8125 L 140,219.40625 L 142.09375,219.40625 L 142.25,222.15625 L 143.0625,222.96875 L 142.09375,225.21875 L 140.46875,225.6875 L 140.46875,227.15625 L 139.65625,227.96875 L 140.625,228.4375 L 141.125,228.28125 L 142.5625,228.28125 L 144.1875,230.375 L 144.125,232.40625 L 144.5,232.46875 L 146.125,233.4375 L 151.125,233.4375 L 153.78125,235.6875 L 157.5,234.09375 L 163.5625,235.46875 L 166.28125,233.6875 L 166.28125,230.96875 L 171.5625,230.5625 L 176.4375,229.59375 L 181.71875,229.40625 L 182.3125,230.78125 L 183.6875,231.9375 L 185.03125,229.59375 L 188.75,225.6875 L 190.25,225.6875 L 192.46875,217.6875 L 195.59375,213.96875 L 195.375,209.6875 L 197.34375,207.125 L 197.34375,205.96875 L 196.375,204.78125 L 197,203.5 L 194.34375,202.46875 L 186.125,197.46875 L 178.53125,195.21875 L 175.625,195.0625 L 175.625,193.125 L 173.84375,191.65625 L 171.9375,191.65625 L 168.375,190.53125 L 166.125,192.78125 L 160.96875,192.96875 L 158.6875,191.65625 L 152.90625,189.90625 L 151.59375,191.5 L 148.375,189.40625 L 145.46875,189.40625 L 141.9375,188.6875 z ').attr(attr).data('value','49');fr.departement72=paper.path('M 202.4375,151.875 L 197.15625,152.0625 L 191.875,156.9375 L 189.125,156.78125 L 185.46875,157.96875 L 184.34375,159.90625 L 183.84375,164.09375 L 184.1875,166.65625 L 181.28125,169.09375 L 180.46875,170.6875 L 181.125,172.15625 L 180.3125,174.09375 L 180.625,174.90625 L 177.40625,175.21875 L 176.9375,176.65625 L 178.375,180.21875 L 178.21875,181.1875 L 176.9375,182.3125 L 174.1875,182.46875 L 173.84375,183.4375 L 174.5,184.40625 L 174.5,190.21875 L 173.875,191.6875 L 175.625,193.125 L 175.625,195.0625 L 178.53125,195.21875 L 186.125,197.46875 L 194.34375,202.46875 L 197,203.5 L 198.3125,200.875 L 202.21875,203.625 L 204.375,203.625 L 203.1875,199.71875 L 205.5625,201.28125 L 206.90625,199.3125 L 212.5625,197.75 L 211.59375,195.40625 L 212.96875,193.65625 L 215.90625,192.5 L 218.625,188.96875 L 218.625,185.25 L 220.59375,185.25 L 221.375,182.53125 L 221.5625,178.4375 L 219.625,176.65625 L 221.1875,173.9375 L 223.5,171 L 220.78125,169.0625 L 218.25,168.65625 L 215.5,164.5625 L 214.71875,164.5625 L 214.53125,166.5 L 214.34375,165.15625 L 210.25,165.15625 L 208.28125,162.21875 L 204.96875,161.03125 L 204,154 L 202.4375,151.875 z ').attr(attr).data('value','72');fr.departement53=paper.path('M 182.5,146.40625 L 180.5625,146.59375 L 179.75,148.53125 L 176.84375,149.71875 L 171.5625,148.9375 L 166.28125,152.0625 L 164.34375,150.6875 L 161.40625,152.65625 L 159.25,151.09375 L 157.875,148.75 L 154.96875,147.5625 L 153,149.125 L 149.6875,148.71875 L 149.5,153.8125 L 150.46875,154.59375 L 150.46875,158.5 L 148.5,160.46875 L 148.5,163.59375 L 149.09375,165.53125 L 149.09375,171.1875 L 150.46875,172.5625 L 150.46875,177.84375 L 147.15625,177.4375 L 145.78125,178.21875 L 143.25,184.46875 L 142.25,188 L 141.9375,188.6875 L 145.46875,189.40625 L 148.375,189.40625 L 151.59375,191.5 L 152.90625,189.90625 L 158.6875,191.65625 L 160.96875,192.96875 L 166.125,192.78125 L 168.375,190.53125 L 171.9375,191.65625 L 173.84375,191.65625 L 173.875,191.6875 L 174.5,190.21875 L 174.5,184.40625 L 173.84375,183.4375 L 174.1875,182.46875 L 176.9375,182.3125 L 178.21875,181.1875 L 178.375,180.21875 L 176.9375,176.65625 L 177.40625,175.21875 L 180.625,174.90625 L 180.3125,174.09375 L 181.125,172.15625 L 180.46875,170.6875 L 181.28125,169.09375 L 184.1875,166.65625 L 183.84375,164.09375 L 184.34375,159.90625 L 185.46875,157.96875 L 189.125,156.78125 L 188.5625,156.75 L 187.5625,153.21875 L 185.03125,152.25 L 184.25,147.96875 L 182.5,146.40625 z ').attr(attr).data('value','53');fr.departement14=paper.path('M 202.65625,97.78125 L 198.09375,98.59375 L 190.65625,102.90625 L 182.28125,106.21875 L 175.625,102.5 L 159.625,100.15625 L 155.90625,98.21875 L 150.125,99.6875 L 150.46875,101.84375 L 149.34375,102.96875 L 149.5,104.5625 L 153.21875,108.28125 L 155.46875,109.5625 L 157.09375,107.46875 L 158.375,109.09375 L 156.75,111.1875 L 158.21875,113.59375 L 157.5625,114.40625 L 158.6875,116.6875 L 158.0625,119.25 L 156.4375,121.84375 L 153.84375,123.4375 L 152.40625,122.3125 L 150.96875,123.59375 L 152.5625,125.0625 L 151.28125,127.46875 L 148.21875,128.59375 L 151.9375,133.28125 L 155.625,133.59375 L 158.46875,135.4375 L 162.40625,134.25 L 165.3125,130.875 L 169.34375,132 L 172.875,129.5625 L 175,128.78125 L 177.25,131.03125 L 180.96875,130.375 L 184.1875,132.15625 L 188.21875,130.875 L 191.90625,128.125 L 194.34375,125.375 L 195.96875,125.0625 L 196.4375,127.15625 L 197.71875,126.84375 L 197.875,125.375 L 201.59375,124.75 L 202.875,125.53125 L 206.84375,124.65625 L 207.5,122.75 L 207.3125,121 L 205.34375,120.21875 L 205.15625,118.84375 L 206.90625,117.6875 L 207.125,115.71875 L 205.9375,111.03125 L 203.59375,107.71875 L 205.5625,106.5625 L 205.5625,105.78125 L 203.59375,105.1875 L 202.65625,97.78125 z ').attr(attr).data('value','14');fr.departement61=paper.path('M 206.84375,124.65625 L 202.875,125.53125 L 201.59375,124.75 L 197.875,125.375 L 197.71875,126.84375 L 196.4375,127.15625 L 195.96875,125.0625 L 194.34375,125.375 L 191.90625,128.125 L 188.21875,130.875 L 184.1875,132.15625 L 180.96875,130.375 L 177.25,131.03125 L 175,128.78125 L 172.875,129.5625 L 169.34375,132 L 165.3125,130.875 L 162.40625,134.25 L 158.46875,135.4375 L 160.625,136.84375 L 162.5625,138.78125 L 162.09375,140.6875 L 162.40625,142.3125 L 161.28125,146.03125 L 157.9375,148.875 L 159.25,151.09375 L 161.40625,152.65625 L 164.34375,150.6875 L 166.28125,152.0625 L 171.5625,148.9375 L 176.84375,149.71875 L 179.75,148.53125 L 180.5625,146.59375 L 182.5,146.40625 L 184.25,147.96875 L 185.03125,152.25 L 187.5625,153.21875 L 188.5625,156.75 L 191.875,156.9375 L 197.15625,152.0625 L 202.4375,151.875 L 204,154 L 204.96875,161.03125 L 208.28125,162.21875 L 210.25,165.15625 L 214.34375,165.15625 L 214.53125,166.5 L 214.71875,164.5625 L 215.5,164.5625 L 218.25,168.65625 L 220.375,169 L 220.375,164.375 L 219.03125,162.59375 L 218.625,161.03125 L 221.5625,159.28125 L 224.5,158.6875 L 226.4375,156.34375 L 226.0625,149.125 L 221.9375,145.625 L 221.75,142.28125 L 218.25,139.9375 L 219.625,138 L 218.8125,135.0625 L 216.09375,134.09375 L 214.125,132.125 L 212.96875,129.40625 L 207.5,129.21875 L 205.9375,127.25 L 206.84375,124.65625 z ').attr(attr).data('value','61');fr.departement28=paper.path('M 247.15625,126.09375 L 245.96875,127.0625 L 245.96875,130.1875 L 242.0625,132.125 L 242.0625,135.0625 L 240.90625,136.4375 L 236,136.4375 L 233.6875,135.46875 L 226.625,139.15625 L 223.90625,139.15625 L 221.09375,141.84375 L 221.75,142.28125 L 221.9375,145.625 L 226.0625,149.125 L 226.4375,156.34375 L 224.5,158.6875 L 221.5625,159.28125 L 218.625,161.03125 L 219.03125,162.59375 L 220.375,164.375 L 220.375,169 L 220.78125,169.0625 L 223.5,171 L 222.5,172.25 L 224.4375,173.21875 L 227.53125,172.65625 L 229.34375,172.65625 L 229.21875,173.5 L 227.53125,174.46875 L 228.65625,175.3125 L 231.46875,175.3125 L 232.4375,177.5625 L 234.125,178.53125 L 235.375,181.34375 L 239.71875,182.46875 L 242.40625,182.1875 L 244.78125,179.9375 L 246.90625,180.53125 L 247.4375,179.375 L 247.3125,178.125 L 248.4375,177.28125 L 250.25,178.40625 L 251.375,177.5625 L 251.375,176.03125 L 252.90625,175.03125 L 254.3125,175.59375 L 255.5625,177 L 257.8125,175.75 L 260.1875,175.75 L 261.875,173.90625 L 262.875,170.28125 L 264.40625,170 L 264,166.34375 L 265.8125,164.8125 L 265.25,163.6875 L 265.46875,163.3125 L 264.9375,163.375 L 264.53125,158.125 L 264.125,157.53125 L 263.75,155 L 259.65625,154.21875 L 257.875,152.0625 L 257.3125,147.75 L 254.96875,147.375 L 254.5625,145.21875 L 251.84375,143.28125 L 250.46875,139.9375 L 251.84375,137.59375 L 250.46875,136.03125 L 250.46875,134.09375 L 251.25,131.9375 L 249.6875,130.375 L 249.09375,128.03125 L 247.15625,126.09375 z ').attr(attr).data('value','28');fr.departement89=paper.path('M 318.4375,157.34375 L 316.6875,158.6875 L 309.0625,158.3125 L 305.5625,160.0625 L 304.1875,163 L 305.75,164.75 L 303.40625,167.5 L 301.625,169.625 L 305.15625,172.96875 L 306.125,176.09375 L 308.6875,178.8125 L 308.6875,182.34375 L 303.59375,186.625 L 305.34375,188.59375 L 304.96875,191.5 L 302.21875,193.46875 L 298.3125,193.46875 L 298.90625,195.625 L 301.4375,199.125 L 302.03125,202.25 L 302.625,204.40625 L 301.46875,204.75 L 303.9375,205.3125 L 305.78125,205.3125 L 306.75,203.78125 L 308,203.78125 L 309.40625,205.03125 L 309.125,206.59375 L 310.40625,207.4375 L 312.21875,207.4375 L 314.75,209.125 L 315.875,208.5625 L 317,209.53125 L 318.125,209.25 L 320.0625,208 L 321.90625,208.5625 L 323.15625,208.28125 L 323.15625,204.78125 L 323.84375,204.90625 L 324.28125,206.71875 L 326.53125,208.125 L 326.53125,210.25 L 329.75,210.375 L 333.96875,214.3125 L 336.625,214.4375 L 336.46875,213.1875 L 337.59375,211.5 L 338.59375,212.75 L 337.75,214.15625 L 338.15625,215.4375 L 339.6875,214.4375 L 341.53125,214.4375 L 341.375,217.25 L 343.0625,218.375 L 344.34375,217.8125 L 347.46875,215.6875 L 347.28125,215.28125 L 345.4375,214.15625 L 345.3125,212.1875 L 347.28125,211.21875 L 348.125,210.09375 L 347.5625,209.125 L 347.5625,206.875 L 349.09375,204.625 L 351.34375,199.84375 L 351.75,197.75 L 353.15625,197.1875 L 353.3125,196.78125 L 352.59375,196.21875 L 352.59375,194.53125 L 354.84375,192.84375 L 355.40625,190.03125 L 354.4375,188.375 L 352.875,188.375 L 352.46875,187.9375 L 352.46875,185.5625 L 354.4375,184.15625 L 354.28125,182.75 L 354,181.34375 L 353,183.5 L 351.625,183.3125 L 350.46875,181.15625 L 346.5625,183.125 L 338.75,182.71875 L 337.78125,180.5625 L 335.625,177.65625 L 335.25,174.125 L 332.125,170.40625 L 330.15625,171.78125 L 326.625,169.0625 L 327.21875,163.78125 L 322.15625,158.5 L 319.8125,158.5 L 318.4375,157.34375 z ').attr(attr).data('value','89');fr.departement70=paper.path('M 423.5,175.5 L 419.8125,176.09375 L 419.21875,178.03125 L 417.25,179.40625 L 415.90625,177.84375 L 414.9375,178.4375 L 415.6875,179.59375 L 413.75,180.78125 L 414.34375,182.34375 L 412.1875,183.125 L 412.1875,185.65625 L 409.4375,185.65625 L 409.25,187.21875 L 406.53125,187.8125 L 406.71875,190.15625 L 408.46875,190.34375 L 407.5,191.5 L 406.90625,195.40625 L 405.15625,195.40625 L 402.21875,196.59375 L 399.09375,195.40625 L 396.375,196.59375 L 396.375,198.5625 L 398.5,198.9375 L 400.0625,202.0625 L 400.28125,203.625 L 397.75,206.5625 L 396.5625,206.9375 L 395.78125,207.90625 L 397.9375,208.90625 L 398.3125,212.03125 L 400.0625,212.21875 L 400.28125,216.125 L 401.0625,216.90625 L 401.15625,217.53125 L 402.65625,217.9375 L 404.34375,219.34375 L 406.875,219.34375 L 407.84375,218.375 L 409.5625,218.4375 L 411.34375,218.5 L 415.28125,215.28125 L 416.40625,215.28125 L 417.65625,214.3125 L 421.71875,214.4375 L 424.8125,211.90625 L 427.0625,211.5 L 427.90625,209.40625 L 429.71875,208.84375 L 431.53125,205.75 L 434.0625,203.78125 L 436.71875,203.375 L 438.6875,204.78125 L 442.34375,204.34375 L 442.34375,202.375 L 443.8125,201.53125 L 444.96875,199.9375 L 447.21875,199.9375 L 448.46875,198.625 L 448.9375,195.5 L 448.9375,193.5625 L 448.09375,190.59375 L 448.09375,188.09375 L 449.625,186.96875 L 451.4375,186.03125 L 451.25,185.65625 L 445,182.34375 L 443.25,180.375 L 441.5,179.21875 L 439.9375,180 L 439.71875,181.15625 L 438.15625,182.125 L 437.1875,182.125 L 434.25,178.8125 L 430.15625,178.8125 L 428.40625,180.1875 L 426.84375,180.375 L 424.3125,178.4375 L 424.5,176.28125 L 423.5,175.5 z ').attr(attr).data('value','70');fr.departement76=paper.path('M 241.9375,61.5 L 240.65625,63.0625 L 232.28125,69.5 L 217.4375,73.21875 L 207.65625,76.71875 L 199.65625,81.03125 L 194.96875,88.0625 L 194,93.53125 L 197.90625,96.46875 L 203.5625,97.625 L 202.65625,97.78125 L 202.6875,97.9375 L 207.0625,97.375 L 209.3125,94.96875 L 211,94.5625 L 212.9375,97.9375 L 215.625,97.65625 L 216.75,99.59375 L 221.5,99.3125 L 226.28125,102.6875 L 223.1875,103.65625 L 225.4375,105.34375 L 226.84375,105.34375 L 228.09375,108.03125 L 230.34375,108.03125 L 231.03125,106.34375 L 229.34375,105.21875 L 234.125,103.8125 L 239.15625,103.25 L 240.4375,99.59375 L 242.8125,97.5 L 247.3125,97.375 L 252.5,100.03125 L 255.59375,100.375 L 256.125,98.75 L 257.5,96.1875 L 258.28125,94.84375 L 256.3125,94.84375 L 256.3125,91.5 L 255.15625,89.5625 L 255.9375,85.65625 L 256.71875,83.6875 L 255.15625,83.6875 L 255.9375,81.75 L 257.875,79.40625 L 255.9375,75.875 L 255.34375,72.375 L 246.75,63.96875 L 245.78125,62.03125 L 243.625,62.21875 L 241.9375,61.5 z ').attr(attr).data('value','76');fr.departement27=paper.path('M 211,94.5625 L 209.3125,94.96875 L 207.0625,97.375 L 202.6875,97.9375 L 203.59375,105.1875 L 205.5625,105.78125 L 205.5625,106.5625 L 203.59375,107.71875 L 205.9375,111.03125 L 207.125,115.71875 L 206.90625,117.6875 L 205.15625,118.84375 L 205.34375,120.21875 L 207.3125,121 L 207.5,122.75 L 205.9375,127.25 L 207.5,129.21875 L 212.96875,129.40625 L 214.125,132.125 L 216.09375,134.09375 L 218.8125,135.0625 L 219.625,138 L 218.25,139.9375 L 221.09375,141.84375 L 223.90625,139.15625 L 226.625,139.15625 L 233.6875,135.46875 L 236,136.4375 L 240.90625,136.4375 L 242.0625,135.0625 L 242.0625,132.125 L 245.96875,130.1875 L 245.96875,127.0625 L 247.03125,126.1875 L 246.9375,125.3125 L 247.9375,124.3125 L 246.1875,123.9375 L 246.1875,122.375 L 245.1875,120.8125 L 245.96875,119.84375 L 251.4375,118.28125 L 252.8125,115.9375 L 254,111.625 L 255.4375,109.84375 L 255.75,107.53125 L 257.5,108.5 L 258.875,108.125 L 257.875,106.5625 L 257.3125,102.0625 L 255.5625,100.5 L 255.59375,100.375 L 252.5,100.03125 L 247.3125,97.375 L 242.8125,97.5 L 240.4375,99.59375 L 239.15625,103.25 L 234.125,103.8125 L 229.34375,105.21875 L 231.03125,106.34375 L 230.34375,108.03125 L 228.09375,108.03125 L 226.84375,105.34375 L 225.4375,105.34375 L 223.1875,103.65625 L 226.28125,102.6875 L 221.5,99.3125 L 216.75,99.59375 L 215.625,97.65625 L 212.9375,97.9375 L 211,94.5625 z ').attr(attr).data('value','27');fr.departement37=paper.path('M 212.1875,196.875 L 212.5625,197.75 L 206.90625,199.3125 L 205.5625,201.28125 L 203.1875,199.71875 L 204.375,203.625 L 202.21875,203.625 L 198.3125,200.875 L 196.375,204.78125 L 197.34375,205.96875 L 197.34375,207.125 L 195.375,209.6875 L 195.59375,213.96875 L 192.46875,217.6875 L 190.25,225.6875 L 190.5,225.6875 L 191.28125,228.8125 L 195,229.59375 L 195,231.9375 L 199.6875,233.3125 L 199.6875,237.03125 L 199.5,239.375 L 205.34375,239.375 L 210.4375,238.1875 L 210.03125,236.03125 L 211.59375,235.0625 L 213.15625,237.21875 L 214.53125,237.8125 L 215.6875,242.5 L 219.03125,246 L 219.40625,248.75 L 222.4375,251.75 L 224.15625,251.59375 L 226.28125,249.625 L 227.8125,241.65625 L 228.78125,238.84375 L 229.5,235.34375 L 232.59375,234.21875 L 234.6875,234.625 L 236.09375,235.90625 L 237.625,233.375 L 239.03125,232.09375 L 239.03125,230.5625 L 240.84375,230.4375 L 241.28125,228.59375 L 239.71875,226.5 L 239.96875,225.625 L 238.875,224.6875 L 235.9375,220.34375 L 232.15625,220.34375 L 231.03125,218.65625 L 231.03125,211.625 L 229.5,207.5625 L 229.21875,202.53125 L 227.25,202.375 L 225,200.6875 L 224.4375,200.6875 L 222.46875,202.09375 L 221.21875,201.25 L 220.9375,199.3125 L 222.34375,198.59375 L 222.46875,197.90625 L 221.65625,197.1875 L 212.1875,196.875 z ').attr(attr).data('value','37');fr.departement45=paper.path('M 273.71875,160.46875 L 271.1875,162.8125 L 265.46875,163.3125 L 265.25,163.6875 L 265.8125,164.8125 L 264,166.34375 L 264.40625,170 L 262.875,170.28125 L 261.875,173.90625 L 260.1875,175.75 L 257.8125,175.75 L 255.5625,177 L 254.3125,175.59375 L 252.90625,175.03125 L 251.375,176.03125 L 251.375,177.5625 L 250.25,178.40625 L 248.4375,177.28125 L 247.3125,178.125 L 247.4375,179.375 L 246.90625,180.53125 L 247.3125,180.65625 L 248.96875,180.65625 L 248.84375,181.78125 L 247.71875,183.71875 L 247.71875,184.71875 L 248.84375,184.71875 L 249.8125,185.84375 L 250.09375,186.96875 L 247.875,189.1875 L 248.96875,191.875 L 248.96875,193.125 L 250.8125,194.375 L 253.34375,194.65625 L 255,196.0625 L 255.4375,198.46875 L 257.25,200.5625 L 259.21875,200 L 260.0625,198.1875 L 263.15625,198.59375 L 263.84375,199.3125 L 265.8125,199.3125 L 266.78125,198.1875 L 273.9375,198.46875 L 275.625,200.96875 L 277.59375,201.8125 L 279.28125,203.375 L 281.375,203.09375 L 281.9375,202.375 L 283.1875,202.375 L 284.75,204.34375 L 287.96875,204.5 L 288.8125,205.59375 L 291.0625,208.6875 L 292.03125,209.53125 L 293.28125,209.40625 L 293.4375,206.59375 L 294,206.3125 L 294.84375,206.4375 L 296.25,208.28125 L 297.21875,208.6875 L 299.21875,207.875 L 298.90625,207.53125 L 298.71875,205.5625 L 302.625,204.40625 L 302.03125,202.25 L 301.4375,199.125 L 298.90625,195.625 L 298.3125,193.46875 L 302.21875,193.46875 L 304.96875,191.5 L 305.34375,188.59375 L 303.59375,186.625 L 308.6875,182.34375 L 308.6875,178.8125 L 306.125,176.09375 L 305.15625,172.96875 L 301.625,169.625 L 296.75,172.375 L 296.375,170.8125 L 294.21875,170.625 L 293.625,172.1875 L 291.6875,172.5625 L 286.40625,172.375 L 284.25,173.75 L 282.5,172.1875 L 285.625,170.03125 L 285.4375,166.71875 L 283.09375,165.53125 L 281.125,162.59375 L 275.875,162.21875 L 273.71875,160.46875 z ').attr(attr).data('value','45');fr.departement36=paper.path('M 254.71875,221.4375 L 253.46875,221.875 L 250.9375,221.71875 L 248,222.71875 L 247.3125,224.25 L 247.03125,223.6875 L 243.65625,223.84375 L 241.96875,225.25 L 240,225.53125 L 239.71875,226.5 L 241.28125,228.59375 L 240.84375,230.4375 L 239.03125,230.5625 L 239.03125,232.09375 L 237.625,233.375 L 236.09375,235.90625 L 234.6875,234.625 L 232.59375,234.21875 L 229.5,235.34375 L 228.78125,238.84375 L 227.8125,241.65625 L 226.28125,249.625 L 224.15625,251.59375 L 222.4375,251.75 L 222.9375,252.25 L 222.9375,255.96875 L 222.15625,258.3125 L 225.875,261.25 L 227.8125,263.1875 L 230.9375,263.59375 L 232.125,267.6875 L 234.25,268.84375 L 233.875,271.78125 L 232.3125,272.0625 L 232.875,272.1875 L 237.78125,272.5625 L 239.53125,270.8125 L 242.65625,273.9375 L 246.5625,269.4375 L 248.3125,270.625 L 250.65625,270.40625 L 251.4375,270.8125 L 254.96875,271 L 256.125,267.875 L 265.90625,269.0625 L 269.625,270.03125 L 271.3125,269.84375 L 271.40625,268.28125 L 273.375,266.3125 L 272.96875,264.625 L 271.84375,262.40625 L 272.25,261.5625 L 272.40625,259.03125 L 273.09375,258.1875 L 273.25,257.625 L 271.5625,256.09375 L 271,254.125 L 268.34375,252.71875 L 268.34375,251.03125 L 270.28125,249.90625 L 270.28125,248.78125 L 268.46875,247.25 L 267.90625,246.28125 L 269.3125,245.5625 L 269.1875,244.3125 L 271.40625,242.46875 L 271.28125,241.65625 L 269.46875,241.65625 L 268.34375,240.375 L 268.34375,239.6875 L 269.3125,238 L 269.3125,236.75 L 267.0625,233.78125 L 267.5,231.125 L 266.21875,230.15625 L 263.5625,230.28125 L 261.46875,231.125 L 258.65625,230.71875 L 257.25,229.59375 L 256.96875,228.75 L 259.21875,226.90625 L 259.375,224.6875 L 256.40625,223 L 254.71875,221.4375 z ').attr(attr).data('value','36');fr.departement41=paper.path('M 222.5,172.25 L 221.1875,173.9375 L 219.625,176.65625 L 221.5625,178.4375 L 221.375,182.53125 L 220.59375,185.25 L 218.625,185.25 L 218.625,188.96875 L 215.90625,192.5 L 212.96875,193.65625 L 211.59375,195.40625 L 212.1875,196.875 L 221.65625,197.1875 L 222.46875,197.90625 L 222.34375,198.59375 L 220.9375,199.3125 L 221.21875,201.25 L 222.46875,202.09375 L 224.4375,200.6875 L 225,200.6875 L 227.25,202.375 L 229.21875,202.53125 L 229.5,207.5625 L 231.03125,211.625 L 231.03125,218.65625 L 232.15625,220.34375 L 235.9375,220.34375 L 238.875,224.6875 L 239.96875,225.625 L 240,225.53125 L 241.96875,225.25 L 243.65625,223.84375 L 247.03125,223.6875 L 247.3125,224.25 L 248,222.71875 L 250.9375,221.71875 L 253.46875,221.875 L 254.71875,221.4375 L 256.40625,223 L 259.375,224.6875 L 261.875,224.53125 L 261.75,222 L 262.875,220.75 L 264,220.625 L 264.96875,221.71875 L 268.90625,221.3125 L 271.40625,219.90625 L 271.125,218.9375 L 270.4375,218.09375 L 270.5625,216.25 L 272.40625,212.90625 L 274.78125,211.90625 L 274.78125,209.8125 L 275.34375,208.5625 L 273.8125,208 L 272.8125,205.875 L 270.28125,205.1875 L 270.15625,204.34375 L 272.6875,202.25 L 275.53125,200.84375 L 273.9375,198.46875 L 266.78125,198.1875 L 265.8125,199.3125 L 263.84375,199.3125 L 263.15625,198.59375 L 260.0625,198.1875 L 259.21875,200 L 257.25,200.5625 L 255.4375,198.46875 L 255,196.0625 L 253.34375,194.65625 L 250.8125,194.375 L 248.96875,193.125 L 248.96875,191.875 L 247.875,189.1875 L 250.09375,186.96875 L 249.8125,185.84375 L 248.84375,184.71875 L 247.71875,184.71875 L 247.71875,183.71875 L 248.84375,181.78125 L 248.96875,180.65625 L 247.3125,180.65625 L 244.78125,179.9375 L 242.40625,182.1875 L 239.71875,182.46875 L 235.375,181.34375 L 234.125,178.53125 L 232.4375,177.5625 L 231.46875,175.3125 L 228.65625,175.3125 L 227.53125,174.46875 L 229.21875,173.5 L 229.34375,172.65625 L 227.53125,172.65625 L 224.4375,173.21875 L 222.5,172.25 z ').attr(attr).data('value','41');fr.departement18=paper.path('M 275.53125,200.84375 L 272.6875,202.25 L 270.15625,204.34375 L 270.28125,205.1875 L 272.8125,205.875 L 273.8125,208 L 275.34375,208.5625 L 274.78125,209.8125 L 274.78125,211.90625 L 272.40625,212.90625 L 270.5625,216.25 L 270.4375,218.09375 L 271.125,218.9375 L 271.40625,219.90625 L 268.90625,221.3125 L 264.96875,221.71875 L 264,220.625 L 262.875,220.75 L 261.75,222 L 261.875,224.53125 L 259.375,224.6875 L 259.21875,226.90625 L 256.96875,228.75 L 257.25,229.59375 L 258.65625,230.71875 L 261.46875,231.125 L 263.5625,230.28125 L 266.21875,230.15625 L 267.5,231.125 L 267.0625,233.78125 L 269.3125,236.75 L 269.3125,238 L 268.34375,239.6875 L 268.34375,240.375 L 269.46875,241.65625 L 271.28125,241.65625 L 271.40625,242.46875 L 269.1875,244.3125 L 269.3125,245.5625 L 267.90625,246.28125 L 268.46875,247.25 L 270.28125,248.78125 L 270.28125,249.90625 L 268.34375,251.03125 L 268.34375,252.71875 L 271,254.125 L 271.5625,256.09375 L 273.25,257.625 L 273.09375,258.1875 L 272.40625,259.03125 L 272.25,261.5625 L 271.84375,262.40625 L 272.96875,264.625 L 273.375,266.3125 L 271.40625,268.28125 L 271.3125,269.84375 L 275.90625,269.28125 L 276.84375,267.28125 L 279.375,264.375 L 284.25,263.375 L 286.8125,264.15625 L 289.53125,262.03125 L 289.34375,260.46875 L 288.375,259.6875 L 288.375,256.5625 L 293.625,251.28125 L 295.59375,253.4375 L 297.34375,251.65625 L 298.90625,251.46875 L 301.625,247.96875 L 306.125,248.34375 L 306.1875,249.40625 L 307.6875,244.625 L 306.71875,242.875 L 306.90625,240.34375 L 307.5,235.25 L 305.34375,233.125 L 305.75,228.4375 L 303.78125,224.3125 L 303.59375,221.59375 L 300.0625,218.84375 L 299.5,216.5 L 301.25,213.96875 L 301.25,210.25 L 299.21875,207.875 L 297.21875,208.6875 L 296.25,208.28125 L 294.84375,206.4375 L 294,206.3125 L 293.4375,206.59375 L 293.28125,209.40625 L 292.03125,209.53125 L 291.0625,208.6875 L 288.8125,205.59375 L 287.96875,204.5 L 284.75,204.34375 L 283.1875,202.375 L 281.9375,202.375 L 281.375,203.09375 L 279.28125,203.375 L 277.59375,201.8125 L 275.625,200.96875 L 275.53125,200.84375 z ').attr(attr).data('value','18');fr.departement21=paper.path('M 363.375,177.25 L 362.96875,179.78125 L 360.4375,181.15625 L 354,181.34375 L 354.28125,182.75 L 354.4375,184.15625 L 352.46875,185.5625 L 352.46875,187.9375 L 352.875,188.375 L 354.4375,188.375 L 355.40625,190.03125 L 354.84375,192.84375 L 352.59375,194.53125 L 352.59375,196.21875 L 353.3125,196.78125 L 353.15625,197.1875 L 351.75,197.75 L 351.34375,199.84375 L 349.09375,204.625 L 347.5625,206.875 L 347.5625,209.125 L 348.125,210.09375 L 347.28125,211.21875 L 345.3125,212.1875 L 345.4375,214.15625 L 347.28125,215.28125 L 347.96875,216.8125 L 347.6875,218.9375 L 347.28125,220.46875 L 348.25,222.15625 L 351.0625,222.71875 L 352.3125,224.6875 L 352.3125,225.53125 L 351.46875,225.8125 L 351.46875,227.84375 L 351.625,227.90625 L 355.40625,231.8125 L 359.34375,231.6875 L 362.84375,234.34375 L 365.375,236.1875 L 365.5,238.5625 L 368.15625,239.125 L 370.40625,240.9375 L 376.3125,238.84375 L 380.375,237.5625 L 382.1875,237.28125 L 382.75,236.46875 L 384.71875,236.59375 L 386.25,237.5625 L 388.5,237 L 390.75,235.46875 L 392.4375,235.65625 L 392.46875,235.46875 L 393.8125,234.6875 L 393.625,233.6875 L 393.25,232.53125 L 394.21875,230.96875 L 397.53125,229.40625 L 397.53125,227.84375 L 398.71875,226.28125 L 399.875,224.71875 L 399.5,223.34375 L 400.0625,221.1875 L 400.46875,218.0625 L 401.25,218.0625 L 401.0625,216.90625 L 400.28125,216.125 L 400.0625,212.21875 L 398.3125,212.03125 L 397.9375,208.90625 L 395.78125,207.90625 L 396.5625,206.9375 L 397.75,206.5625 L 400.28125,203.625 L 400.0625,202.0625 L 398.5,198.9375 L 396.1875,198.53125 L 395.375,200.5 L 391.09375,201.46875 L 390.6875,200.5 L 387.5625,196.59375 L 385.8125,197.5625 L 383.46875,197.375 L 382.6875,195.8125 L 379.5625,196 L 379.375,192.6875 L 377.625,191.5 L 380.15625,188.78125 L 375.65625,182.71875 L 372.15625,179 L 369.03125,177.25 L 363.375,177.25 z ').attr(attr).data('value','21');fr.departement58=paper.path('M 306.75,203.78125 L 305.78125,205.3125 L 303.9375,205.3125 L 301.46875,204.75 L 298.71875,205.5625 L 298.90625,207.53125 L 301.25,210.25 L 301.25,213.96875 L 299.5,216.5 L 300.0625,218.84375 L 303.59375,221.59375 L 303.78125,224.3125 L 305.75,228.4375 L 305.34375,233.125 L 307.5,235.25 L 306.90625,240.34375 L 306.71875,242.875 L 307.6875,244.625 L 306.1875,249.40625 L 306.3125,250.875 L 309.65625,252.4375 L 312,255 L 314.125,253.8125 L 316.09375,252.65625 L 316.5,254.40625 L 319.40625,254.40625 L 320.1875,252.84375 L 321.9375,253.625 L 322.53125,256.15625 L 324.09375,255.78125 L 327.8125,250.6875 L 329.75,252.0625 L 330.0625,252.65625 L 333.125,250.75 L 334.375,250.90625 L 335.34375,253.28125 L 337.1875,253 L 338.59375,251.59375 L 340.40625,251.59375 L 341.8125,249.78125 L 343.21875,249.5 L 343.5,248.5 L 346.5625,248.65625 L 346.71875,247.9375 L 345.3125,246.6875 L 345.3125,245.4375 L 347.28125,244.3125 L 347.28125,243.46875 L 345.4375,242.34375 L 345.15625,240.25 L 345.3125,238.28125 L 344.0625,237.4375 L 345.15625,235.90625 L 346.15625,235.34375 L 346.84375,233.65625 L 345.875,233.09375 L 344.75,231.40625 L 346.15625,229.4375 L 348.53125,228.03125 L 351.46875,228.03125 L 351.46875,225.8125 L 352.3125,225.53125 L 352.3125,224.6875 L 351.0625,222.71875 L 348.25,222.15625 L 347.28125,220.46875 L 347.6875,218.9375 L 347.96875,216.8125 L 347.46875,215.6875 L 344.34375,217.8125 L 343.0625,218.375 L 341.375,217.25 L 341.53125,214.4375 L 339.6875,214.4375 L 338.15625,215.4375 L 337.75,214.15625 L 338.59375,212.75 L 337.59375,211.5 L 336.46875,213.1875 L 336.625,214.4375 L 333.96875,214.3125 L 329.75,210.375 L 326.53125,210.25 L 326.53125,208.125 L 324.28125,206.71875 L 323.84375,204.90625 L 323.15625,204.78125 L 323.15625,208.28125 L 321.90625,208.5625 L 320.0625,208 L 318.125,209.25 L 317,209.53125 L 315.875,208.5625 L 314.75,209.125 L 312.21875,207.4375 L 310.40625,207.4375 L 309.125,206.59375 L 309.40625,205.03125 L 308,203.78125 L 306.75,203.78125 z ').attr(attr).data('value','58');fr.departement71=paper.path('M 351.46875,227.84375 L 351.46875,228.03125 L 348.53125,228.03125 L 346.15625,229.4375 L 344.75,231.40625 L 345.875,233.09375 L 346.84375,233.65625 L 346.15625,235.34375 L 345.15625,235.90625 L 344.0625,237.4375 L 345.3125,238.28125 L 345.15625,240.25 L 345.4375,242.34375 L 347.28125,243.46875 L 347.28125,244.3125 L 345.3125,245.4375 L 345.3125,246.6875 L 346.71875,247.9375 L 346.5625,248.65625 L 343.5,248.5 L 343.21875,249.5 L 341.8125,249.78125 L 340.40625,251.59375 L 338.59375,251.59375 L 337.1875,253 L 335.34375,253.28125 L 334.375,250.90625 L 333.125,250.75 L 330.0625,252.65625 L 333.6875,259.46875 L 333.6875,262.40625 L 334.65625,263.59375 L 337.96875,263.59375 L 339.125,265.15625 L 342.25,265.15625 L 343.625,267.09375 L 343.4375,274.71875 L 339.34375,277.84375 L 339.25,278.0625 L 339.53125,278.03125 L 340.125,278.21875 L 340.3125,281.34375 L 343.25,281.9375 L 343.625,283.3125 L 345.1875,283.3125 L 347.53125,281.9375 L 353.78125,282.90625 L 354.96875,284.09375 L 356.53125,282.53125 L 358.6875,282.53125 L 359.84375,276.28125 L 360.625,275.6875 L 362.5625,275.6875 L 364.9375,277.25 L 366.6875,275.6875 L 367.84375,277.25 L 369.625,275.5 L 371.75,275.3125 L 372.75,278.4375 L 373.5,282.34375 L 374.875,282.53125 L 376.0625,279.78125 L 379.75,265.34375 L 381.125,262.8125 L 383.28125,262.59375 L 385.4375,264.375 L 387,263.96875 L 388.9375,262.59375 L 390.90625,263 L 392.0625,265.53125 L 393.1875,265.96875 L 398.3125,265.34375 L 400.28125,263.78125 L 399.5,262.59375 L 397.15625,261.8125 L 396.9375,259.09375 L 398.90625,257.71875 L 399.6875,254.40625 L 397.9375,251.28125 L 396.75,249.71875 L 397.34375,249.125 L 397.34375,247.1875 L 395.78125,246.1875 L 395.375,244.625 L 399.875,244.0625 L 400.28125,242.5 L 398.90625,242.5 L 397.75,241.125 L 395.59375,241.125 L 393.8125,238.1875 L 392.25,238 L 392.4375,235.65625 L 390.75,235.46875 L 388.5,237 L 386.25,237.5625 L 384.71875,236.59375 L 382.75,236.46875 L 382.1875,237.28125 L 380.375,237.5625 L 376.3125,238.84375 L 370.40625,240.9375 L 368.15625,239.125 L 365.5,238.5625 L 365.375,236.1875 L 362.84375,234.34375 L 359.34375,231.6875 L 355.40625,231.8125 L 351.625,227.90625 L 351.46875,227.84375 z ').attr(attr).data('value','71');fr.departement39=paper.path('M 401.15625,217.53125 L 401.25,218.0625 L 400.46875,218.0625 L 400.0625,221.1875 L 399.5,223.34375 L 399.875,224.71875 L 398.71875,226.28125 L 397.53125,227.84375 L 397.53125,229.40625 L 394.21875,230.96875 L 393.25,232.53125 L 393.625,233.6875 L 393.8125,234.6875 L 392.46875,235.46875 L 392.25,238 L 393.8125,238.1875 L 395.59375,241.125 L 397.75,241.125 L 398.90625,242.5 L 400.28125,242.5 L 399.875,244.0625 L 395.375,244.625 L 395.78125,246.1875 L 397.34375,247.1875 L 397.34375,249.125 L 396.75,249.71875 L 397.9375,251.28125 L 399.6875,254.40625 L 398.90625,257.71875 L 396.9375,259.09375 L 397.15625,261.8125 L 399.5,262.59375 L 400.28125,263.78125 L 398.3125,265.34375 L 393.1875,265.96875 L 395.59375,266.90625 L 399.5,272.375 L 402.03125,273.53125 L 402.03125,276.28125 L 404.96875,275.875 L 408.6875,271.78125 L 411.8125,273.34375 L 411.8125,275.6875 L 417.46875,275.6875 L 425.59375,266.75 L 425.25,266.5625 L 425.625,262.46875 L 428.5625,258.96875 L 426.59375,258.1875 L 426.78125,257 L 424.40625,256.78125 L 424.25,255.375 L 425.78125,253.84375 L 425.375,252.3125 L 424.53125,250.34375 L 428.03125,249.21875 L 429.3125,247.40625 L 429.59375,245.15625 L 426.78125,242.46875 L 424.8125,241.9375 L 420.46875,240.53125 L 420.46875,236.59375 L 420.1875,233.65625 L 416.6875,233.9375 L 411.21875,232.09375 L 412.0625,230.15625 L 413.3125,227.1875 L 413.75,225.25 L 412.34375,223.40625 L 409.8125,221.71875 L 409.53125,219.625 L 409.5625,218.4375 L 407.84375,218.375 L 406.875,219.34375 L 404.34375,219.34375 L 402.65625,217.9375 L 401.15625,217.53125 z ').attr(attr).data('value','39');fr.departement51=paper.path('M 337.375,99.3125 L 335.03125,100.3125 L 335.4375,102.25 L 331.3125,102.25 L 327.625,105 L 327.625,110.25 L 330.34375,112.03125 L 331.125,113.78125 L 326.625,114.15625 L 326.0625,115.9375 L 327.8125,117.09375 L 327.03125,118.28125 L 325.28125,119.0625 L 325.65625,120.40625 L 328.1875,120.40625 L 329.1875,121.78125 L 327.4375,122.96875 L 325.875,127.0625 L 322.9375,128.4375 L 321.9375,130.5625 L 320.96875,131.75 L 321.1875,132.90625 L 319.625,133.90625 L 319.21875,136.625 L 320.78125,137.59375 L 321.5625,140.53125 L 320.59375,142.28125 L 321.1875,143.65625 L 324.09375,143.46875 L 324.09375,144.4375 L 324.9375,144.25 L 328.3125,147.8125 L 333.0625,147.03125 L 338.625,143.25 L 341.96875,143.25 L 345.34375,140.875 L 349.3125,138.6875 L 352.28125,138.90625 L 352.6875,142.875 L 356.25,148.21875 L 360.21875,148.21875 L 365.78125,147.03125 L 369.75,148.40625 L 373.90625,145.4375 L 374.5,140.5 L 379.09375,139.71875 L 379,136.625 L 375.28125,133.6875 L 374.875,132.125 L 376.25,129.78125 L 375.0625,128.8125 L 376.25,125.875 L 378.40625,124.90625 L 379.96875,120.03125 L 376.84375,120.21875 L 378.59375,118.28125 L 377.21875,113.96875 L 375.875,111.03125 L 377.625,109.46875 L 376.625,109.28125 L 376.375,107.9375 C 376.33461,107.94351 376.09375,107.96875 376.09375,107.96875 L 374.3125,106.375 L 372.3125,108.375 L 371.71875,108.375 L 370.9375,107.375 L 366.1875,107.1875 L 365.375,108.375 L 364,108.375 L 362.8125,105.78125 L 360.21875,105.78125 L 359.625,106.375 L 357.0625,106.1875 L 353.875,103.8125 L 351.6875,103.21875 L 350.90625,102.03125 L 346.75,99.4375 L 342,99.3125 L 342.0625,101.09375 L 340.6875,101.46875 L 337.375,99.3125 z ').attr(attr).data('value','51');fr.departement60=paper.path('M 257.21875,80.21875 L 255.9375,81.75 L 255.15625,83.6875 L 256.71875,83.6875 L 255.9375,85.65625 L 255.15625,89.5625 L 256.3125,91.5 L 256.3125,94.84375 L 258.28125,94.84375 L 257.5,96.1875 L 256.125,98.75 L 255.5625,100.5 L 257.3125,102.0625 L 257.875,106.5625 L 258.875,108.125 L 257.5,108.5 L 255.75,107.53125 L 255.4375,109.84375 L 255.5625,109.6875 L 256.3125,111.4375 L 257.5,113.375 L 262.78125,113.78125 L 266.5,113.375 L 269.03125,111.4375 L 272.15625,113.375 L 273.71875,114.5625 L 276.0625,113.96875 L 278.1875,113 L 282.3125,115.15625 L 286.59375,117.6875 L 287.96875,119.0625 L 290.3125,117.5 L 292.25,118.65625 L 293.4375,119.625 L 295.1875,119.4375 L 296.375,117.875 L 299.09375,119.4375 L 302.4375,118.0625 L 304.375,118.65625 L 306.3125,117.09375 L 307.5,116.5 L 307.875,116.78125 L 308.28125,114.125 L 306.875,112.53125 L 304.5,110.9375 L 303.5,112.53125 L 302.90625,112.71875 L 302.71875,109.75 L 304.5,109.34375 L 304.09375,106.59375 L 301.71875,106.1875 L 302.90625,104.1875 L 306.28125,103.40625 L 307.46875,98.65625 L 309.25,97.84375 L 306.875,96.0625 L 307.6875,94.28125 L 308.0625,88.34375 L 307.25,83.75 L 303.125,84.15625 L 300.34375,83.78125 L 295.1875,85.15625 L 290.8125,89.3125 L 287.25,88.125 L 283.6875,87.75 L 280.90625,84.96875 L 275.9375,83.5625 L 269.21875,84.15625 L 267.4375,82.78125 L 263.84375,82.78125 L 261.28125,83.78125 L 260.09375,82.96875 L 260.09375,80.8125 L 259.6875,80.21875 L 257.21875,80.21875 z ').attr(attr).data('value','60');fr.departement62=paper.path('M 269.25,8.65625 L 258.4375,10.71875 L 249.84375,17.34375 L 249.84375,43.71875 L 249.78125,44.5 L 252.8125,45.21875 L 253.78125,47.375 L 256.125,46.78125 L 257.5,45.03125 L 259.25,45.625 L 262.96875,48.53125 L 264.34375,47.96875 L 265.3125,50.3125 L 268.8125,51.875 L 268.8125,53.8125 L 271.375,54.78125 L 273.90625,53.8125 L 278.78125,53.21875 L 279.96875,54.21875 L 282.3125,53.21875 L 283.46875,55.1875 L 280.5625,57.125 L 280.5625,59.875 L 281.53125,60.84375 L 282.3125,60.65625 L 282.875,59.09375 L 284.65625,57.90625 L 286.40625,59.28125 L 290.5,60.65625 L 292.25,60.65625 L 292.25,58.6875 L 294.8125,60.46875 L 295,62.03125 L 293.8125,63.78125 L 295.96875,62.59375 L 297.75,61.8125 L 298.5,63.1875 L 298.5,64.5625 L 301.4375,63 L 306.125,63 L 306.3125,63.1875 L 307.46875,60.96875 L 306.875,59.96875 L 305.09375,59.59375 L 303.125,59.59375 L 301.9375,59.1875 L 303.90625,58 L 305.6875,58.1875 L 307.46875,58 L 307.6875,54.8125 L 308.875,54.03125 L 309.0625,52.25 L 306.875,50.84375 L 304.3125,50.65625 L 303.71875,50.25 L 305.3125,49.0625 L 305.6875,47.875 L 304.3125,46.90625 L 302.3125,44.5 L 302.53125,43.3125 L 305.09375,42.125 L 305.5,40.75 L 303.71875,39.9375 L 302.71875,37.375 L 299.15625,36.96875 L 295.59375,36 L 295.1875,32.03125 L 297.75,30.4375 L 296.78125,28.4375 L 294.78125,28.4375 L 293.40625,30.625 L 287.25,30.25 L 282.28125,29.03125 L 279.53125,26.0625 L 279.53125,23.6875 L 281.6875,22.6875 L 279.90625,21.3125 L 275.5625,21.125 L 272.96875,14.5625 L 269.25,8.65625 z ').attr(attr).data('value','62');fr.departement59=paper.path('M 285.78125,4.0625 L 279.53125,7 L 269.78125,8.5625 L 269.25,8.65625 L 272.96875,14.5625 L 275.5625,21.125 L 279.90625,21.3125 L 281.6875,22.6875 L 279.53125,23.6875 L 279.53125,26.0625 L 282.28125,29.03125 L 287.25,30.25 L 293.40625,30.625 L 294.78125,28.4375 L 296.78125,28.4375 L 297.75,30.4375 L 295.1875,32.03125 L 295.59375,36 L 299.15625,36.96875 L 302.71875,37.375 L 303.71875,39.9375 L 305.5,40.75 L 305.09375,42.125 L 302.53125,43.3125 L 302.3125,44.5 L 304.3125,46.90625 L 305.6875,47.875 L 305.3125,49.0625 L 303.71875,50.25 L 304.3125,50.65625 L 306.875,50.84375 L 309.0625,52.25 L 308.875,54.03125 L 307.6875,54.8125 L 307.46875,58 L 305.6875,58.1875 L 303.90625,58 L 301.9375,59.1875 L 303.125,59.59375 L 305.09375,59.59375 L 306.875,59.96875 L 307.46875,60.96875 L 306.3125,63.1875 L 307.875,64.75 L 309.4375,65.15625 L 311,64.15625 L 313.15625,64.15625 L 313.75,65.34375 L 314.53125,65.15625 L 316.875,63.78125 L 319.21875,65.15625 L 322.34375,63 L 323.71875,63 L 325.28125,64.375 L 328.40625,62.21875 L 329.75,62.40625 L 330.9375,63.375 L 335.25,63.78125 L 335.625,65.53125 L 337.78125,63.59375 L 338.9375,63.59375 L 339.71875,66.125 L 343.4375,67.09375 L 344.5,66.375 L 344.1875,66.375 L 344,64.4375 L 347.90625,62.09375 L 347.3125,58.375 L 343.59375,57.40625 L 344.5625,56.40625 L 344.5625,53.6875 L 347.5,51.53125 L 346.71875,49.96875 L 340.46875,45.09375 L 329.53125,45.6875 L 328.375,47.625 L 327,47.625 L 327.1875,40.78125 L 324.0625,37.09375 L 321.71875,37.46875 L 320.34375,35.90625 L 316.4375,37.65625 L 315.09375,36.3125 L 312.34375,35.90625 L 311.5625,33.375 L 311.375,25.5625 L 309.625,24.78125 L 309.40625,23.59375 L 308.25,23.59375 L 307.84375,21.25 L 305.3125,21.46875 L 300.4375,23.03125 L 298.09375,25.9375 L 295.75,25.9375 L 294.1875,24 L 293.59375,21.84375 L 291.65625,19.6875 L 288.90625,19.6875 L 287.75,17.5625 L 287.75,14.21875 L 289.09375,12.09375 L 288.3125,9.15625 L 285.78125,4.0625 z ').attr(attr).data('value','59');fr.departement02=paper.path('M 328.40625,62.21875 L 325.28125,64.375 L 323.71875,63 L 322.34375,63 L 319.21875,65.15625 L 316.875,63.78125 L 314.53125,65.15625 L 313.75,65.34375 L 313.15625,64.15625 L 311,64.15625 L 309.4375,65.15625 L 309.375,65.15625 L 309.84375,67.90625 L 307.28125,70.6875 L 307.28125,73.25 L 305.5,75.25 L 305.90625,77.625 L 306.875,81.59375 L 308.0625,88.34375 L 307.6875,94.28125 L 306.875,96.0625 L 309.25,97.84375 L 307.46875,98.65625 L 306.28125,103.40625 L 302.90625,104.1875 L 301.71875,106.1875 L 304.09375,106.59375 L 304.5,109.34375 L 302.71875,109.75 L 302.90625,112.71875 L 303.5,112.53125 L 304.5,110.9375 L 306.875,112.53125 L 308.28125,114.125 L 307.875,116.78125 L 309.65625,118.0625 L 310.25,122.375 L 315.5,127.4375 L 317.25,128.03125 L 318.25,130.375 L 321.53125,131.0625 L 321.9375,130.5625 L 322.9375,128.4375 L 325.875,127.0625 L 327.4375,122.96875 L 329.1875,121.78125 L 328.1875,120.40625 L 325.65625,120.40625 L 325.28125,119.0625 L 327.03125,118.28125 L 327.8125,117.09375 L 326.0625,115.9375 L 326.625,114.15625 L 331.125,113.78125 L 330.34375,112.03125 L 327.625,110.25 L 327.625,105 L 331.3125,102.25 L 335.4375,102.25 L 335.03125,100.3125 L 337.375,99.3125 L 340.6875,101.46875 L 342.0625,101.09375 L 341.875,94.4375 L 342.46875,92.09375 L 343.25,89.375 L 340.6875,88 L 341.28125,86.4375 L 345,85.65625 L 345,83.125 L 347.9375,81.5625 L 348.71875,79.21875 L 347.75,77.65625 L 347.9375,74.71875 L 349.6875,73.15625 L 347.9375,69.84375 L 348.46875,66.375 L 344.5,66.375 L 343.4375,67.09375 L 339.71875,66.125 L 338.9375,63.59375 L 337.78125,63.59375 L 335.625,65.53125 L 335.25,63.78125 L 330.9375,63.375 L 329.75,62.40625 L 328.40625,62.21875 z ').attr(attr).data('value','02');fr.departement80=paper.path('M 249.78125,44.5 L 249.25,50.9375 L 253.5625,54.84375 L 253.5625,56.8125 L 248.28125,53.6875 L 241.9375,61.5 L 243.625,62.21875 L 245.78125,62.03125 L 246.75,63.96875 L 255.34375,72.375 L 255.9375,75.875 L 257.875,79.40625 L 257.21875,80.21875 L 259.6875,80.21875 L 260.09375,80.8125 L 260.09375,82.96875 L 261.28125,83.78125 L 263.84375,82.78125 L 267.4375,82.78125 L 269.21875,84.15625 L 275.9375,83.5625 L 280.90625,84.96875 L 283.6875,87.75 L 287.25,88.125 L 290.8125,89.3125 L 295.1875,85.15625 L 300.34375,83.78125 L 303.125,84.15625 L 307.25,83.75 L 306.875,81.59375 L 305.90625,77.625 L 305.5,75.25 L 307.28125,73.25 L 307.28125,70.6875 L 309.84375,67.90625 L 309.375,65.15625 L 307.875,64.75 L 306.125,63 L 301.4375,63 L 298.5,64.5625 L 298.5,63.1875 L 297.75,61.8125 L 295.96875,62.59375 L 293.8125,63.78125 L 295,62.03125 L 294.8125,60.46875 L 292.25,58.6875 L 292.25,60.65625 L 290.5,60.65625 L 286.40625,59.28125 L 284.65625,57.90625 L 282.875,59.09375 L 282.3125,60.65625 L 281.53125,60.84375 L 280.5625,59.875 L 280.5625,57.125 L 283.46875,55.1875 L 282.3125,53.21875 L 279.96875,54.21875 L 278.78125,53.21875 L 273.90625,53.8125 L 271.375,54.78125 L 268.8125,53.8125 L 268.8125,51.875 L 265.3125,50.3125 L 264.34375,47.96875 L 262.96875,48.53125 L 259.25,45.625 L 257.5,45.03125 L 256.125,46.78125 L 253.78125,47.375 L 252.8125,45.21875 L 249.78125,44.5 z ').attr(attr).data('value','80');fr.departement08=paper.path('M 367.625,55.84375 L 365.65625,58.75 L 363.90625,60.53125 L 363.90625,62.28125 L 363.90625,64.625 L 361.5625,66.1875 L 357.28125,67.5625 L 354.9375,68.53125 L 352.1875,66.375 L 348.46875,66.375 L 347.9375,69.84375 L 349.6875,73.15625 L 347.9375,74.71875 L 347.75,77.65625 L 348.71875,79.21875 L 347.9375,81.5625 L 345,83.125 L 345,85.65625 L 341.28125,86.4375 L 340.6875,88 L 343.25,89.375 L 342.46875,92.09375 L 341.875,94.4375 L 342,99.3125 L 346.75,99.4375 L 350.90625,102.03125 L 351.6875,103.21875 L 353.875,103.8125 L 357.0625,106.1875 L 359.625,106.375 L 360.21875,105.78125 L 362.8125,105.78125 L 364,108.375 L 365.375,108.375 L 366.1875,107.1875 L 370.9375,107.375 L 371.71875,108.375 L 372.3125,108.375 L 374.3125,106.375 L 376.09375,107.96875 C 376.09375,107.96875 376.33461,107.94351 376.375,107.9375 L 376.25,107.125 L 378.59375,105.96875 L 379.75,104.78125 L 379,102.84375 L 378.78125,101.46875 L 380.9375,99.71875 L 381.71875,95.8125 L 379.375,92.875 L 380.15625,91.5 L 382.125,87.8125 L 382.6875,88.59375 L 385.625,88.59375 L 387,89.9375 L 388.75,88.78125 L 390.125,86.53125 L 388.71875,86.3125 L 387.9375,82.40625 L 386.375,81.21875 L 380.90625,80.625 L 379.9375,78.09375 L 378.15625,76.9375 L 371.90625,76.15625 L 371.53125,71.65625 L 372.3125,70.875 L 372.3125,69.125 L 369.1875,67.15625 L 369.78125,65 L 370.5625,63.0625 L 369.1875,61.875 L 371.34375,59.9375 L 371.34375,56.40625 L 370.5625,55.84375 L 367.625,55.84375 z ').attr(attr).data('value','08');fr.departement10=paper.path('M 349.3125,138.6875 L 345.34375,140.875 L 341.96875,143.25 L 338.625,143.25 L 333.0625,147.03125 L 328.3125,147.8125 L 324.9375,144.25 L 324.09375,144.4375 L 324.09375,145.03125 L 321.375,146.1875 L 321.1875,148.53125 L 319.8125,150.3125 L 319.03125,154.21875 L 318.59375,157.5 L 319.8125,158.5 L 322.15625,158.5 L 327.21875,163.78125 L 326.625,169.0625 L 330.15625,171.78125 L 332.125,170.40625 L 335.25,174.125 L 335.625,177.65625 L 337.78125,180.5625 L 338.75,182.71875 L 346.5625,183.125 L 350.46875,181.15625 L 351.625,183.3125 L 353,183.5 L 354,181.34375 L 360.4375,181.15625 L 362.96875,179.78125 L 363.375,177.25 L 369.03125,177.25 L 369.8125,177.6875 L 369.15625,175.1875 L 367.5625,174.1875 L 369.75,172.21875 L 373.125,172 L 374.3125,170.21875 L 374.09375,163.09375 L 373.3125,158.9375 L 369.9375,157.75 L 366.375,152.78125 L 366.5625,149.8125 L 367.59375,147.65625 L 365.78125,147.03125 L 360.21875,148.21875 L 356.25,148.21875 L 352.6875,142.875 L 352.28125,138.90625 L 349.3125,138.6875 z ').attr(attr).data('value','10');fr.departement52=paper.path('M 379.09375,139.71875 L 374.5,140.5 L 373.90625,145.4375 L 369.75,148.40625 L 367.59375,147.65625 L 366.5625,149.8125 L 366.375,152.78125 L 369.9375,157.75 L 373.3125,158.9375 L 374.09375,163.09375 L 374.3125,170.21875 L 373.125,172 L 369.75,172.21875 L 367.5625,174.1875 L 369.15625,175.1875 L 369.8125,177.6875 L 372.15625,179 L 375.65625,182.71875 L 380.15625,188.78125 L 377.625,191.5 L 379.375,192.6875 L 379.5625,196 L 382.6875,195.8125 L 383.46875,197.375 L 385.8125,197.5625 L 387.5625,196.59375 L 390.6875,200.5 L 391.09375,201.46875 L 395.375,200.5 L 396.1875,198.53125 L 396.375,198.5625 L 396.375,196.59375 L 399.09375,195.40625 L 402.21875,196.59375 L 405.15625,195.40625 L 406.90625,195.40625 L 407.5,191.5 L 408.46875,190.34375 L 406.71875,190.15625 L 406.53125,187.8125 L 409.25,187.21875 L 409.4375,185.65625 L 412.1875,185.65625 L 412.1875,183.125 L 414.34375,182.34375 L 413.75,180.78125 L 414.34375,180.40625 L 412.5625,179 L 410.4375,179.78125 L 410.4375,175.6875 L 404.96875,172.96875 L 406.125,167.6875 L 407.875,166.5 L 407.3125,164.75 L 404.75,164.375 L 404.1875,161.8125 L 401.84375,161.8125 L 399.09375,158.125 L 395.96875,157.90625 L 394.625,155.96875 L 396.375,154.21875 L 392.25,149.71875 L 390.5,149.125 L 385.8125,146.78125 L 383.28125,144.0625 L 379.1875,143.46875 L 379.09375,139.71875 z ').attr(attr).data('value','52');fr.departement67=paper.path('M 480.71875,112.28125 L 477,113.3125 L 475.28125,116.3125 L 475.28125,119.25 L 473.71875,120.625 L 472.34375,120.625 L 469.8125,118.84375 L 467.84375,120.21875 L 465.5,120.21875 L 463.5625,118.28125 L 459.84375,117.6875 L 457.6875,116.71875 L 456.90625,113.78125 L 455.15625,115.71875 L 454.1875,120.21875 L 451.625,121 L 451.625,123.53125 L 454.1875,124.71875 L 456.125,126.09375 L 455.34375,127.84375 L 457.125,129 L 460.25,126.65625 L 465.6875,129.78125 L 463.375,134.09375 L 463.5625,135.46875 L 465.125,137.03125 L 463.9375,141.125 L 460.03125,145.03125 L 457.875,144.84375 L 459.25,146.1875 L 458.46875,149.71875 L 459.25,155 L 462.96875,155.96875 L 462.65625,156.6875 L 465.59375,156.53125 L 467.3125,158.625 L 468.84375,160.53125 L 472.6875,160.34375 L 474.40625,165.3125 L 477.40625,166.625 L 477.375,166 L 482.46875,156.03125 L 481.875,150.375 L 484.21875,142.75 L 484.8125,136.09375 L 489.875,132.40625 L 489.875,130.0625 L 491.84375,127.5 L 493.40625,127.5 L 495.15625,125.75 L 494.78125,122.4375 L 496.53125,117.75 L 499.25,117.15625 L 496.53125,115 L 491.65625,114.4375 L 487.34375,112.28125 L 484.40625,114.03125 L 482.84375,112.28125 L 480.71875,112.28125 z ').attr(attr).data('value','67');fr.departement54=paper.path('M 401.59375,88.4375 L 399.25,90.59375 L 395.9375,90.78125 L 394.78125,91.96875 L 394.53125,91.96875 L 394.40625,94.3125 L 395.5625,96.21875 L 395.15625,97.375 L 394.78125,98.71875 L 394.96875,99.46875 L 395.9375,98.71875 L 396.875,97 L 398.8125,96.8125 L 402.0625,95.84375 L 403.78125,97.1875 L 404.53125,98.71875 L 405.125,100.4375 L 405.125,102.15625 L 406.0625,102.9375 L 406.0625,104.25 L 405.125,105.40625 L 404.9375,107.90625 L 405.6875,109.0625 L 405.875,110.59375 L 406.0625,113.0625 L 407.21875,114.03125 L 408.9375,114.78125 L 408.1875,116.3125 L 410.28125,118.25 L 408.375,120.34375 L 408.75,121.6875 L 410.65625,122.625 L 410.65625,123.59375 L 408.375,123.59375 L 407.40625,124.9375 L 407.59375,125.90625 L 409.125,127.4375 L 407.8125,131.0625 L 406.28125,134.5 L 407.03125,136.625 L 407.03125,140.0625 L 407.8125,141.78125 L 408.9375,141.78125 L 409.53125,142.75 L 407.8125,142.75 L 406.28125,143.5 L 406.28125,144.65625 L 408.1875,146.375 L 408.1875,149.0625 L 410.09375,148.46875 L 412.96875,148.65625 L 413.15625,151.71875 L 414.3125,152.125 L 412.96875,153.0625 L 412.78125,154.03125 L 414.875,154.40625 L 416.21875,156.125 L 422.53125,155.75 L 423.875,153.25 L 426.75,153.25 L 427.90625,152.3125 L 429.8125,153.46875 L 431.53125,152.875 L 434.03125,153.0625 L 436.125,152.3125 L 438.21875,150.78125 L 439.375,151.9375 L 439.5625,149.25 L 441.09375,148.65625 L 441.875,151.15625 L 444.15625,151.34375 L 446.46875,151.9375 L 447.40625,152.125 L 450.6875,150.59375 L 452.40625,149.4375 L 453.9375,147.53125 L 457,146.375 L 459,145.9375 L 457.875,144.84375 L 460.03125,145.03125 L 460.4375,144.625 L 458.125,143.875 L 454.875,141.59375 L 452,139.46875 L 448.5625,139.46875 L 444.9375,137.375 L 442.0625,137.1875 L 442.0625,136.40625 L 437.65625,133.75 L 432.6875,131.625 L 430.1875,131.625 L 429.25,128.96875 L 425.40625,124.15625 L 421.59375,124.15625 L 420.0625,122.0625 L 417,122.0625 L 417.1875,119 L 413.15625,116.5 L 413.34375,114.03125 L 415.46875,114.03125 L 415.46875,111.90625 L 416.21875,110.375 L 414.5,108.65625 L 416.03125,106 L 414.875,102.9375 L 413.9375,102.15625 L 411.4375,96.8125 L 412.40625,95.28125 C 412.40625,95.28125 412.32712,94.02401 412.25,92.34375 L 409.625,92.34375 L 406.09375,88.4375 L 401.59375,88.4375 z ').attr(attr).data('value','54');fr.departement77=paper.path('M 307.5,116.5 L 306.3125,117.09375 L 304.375,118.65625 L 302.4375,118.0625 L 299.09375,119.4375 L 296.375,117.875 L 295.1875,119.4375 L 293.4375,119.625 L 292.25,118.65625 L 290.3125,117.5 L 287.96875,119.0625 L 287.875,118.96875 L 287.03125,124.375 L 288.1875,131.25 L 288.1875,135.84375 L 286.65625,139.6875 L 287.03125,142.34375 L 285.3125,143.6875 L 286.25,148.875 L 285.5,150 L 284.9375,155.1875 L 286.25,156.90625 L 281.875,159.78125 L 281.875,163.71875 L 283.09375,165.53125 L 285.4375,166.71875 L 285.625,170.03125 L 282.5,172.1875 L 284.25,173.75 L 286.40625,172.375 L 291.6875,172.5625 L 293.625,172.1875 L 294.21875,170.625 L 296.375,170.8125 L 296.75,172.375 L 301.625,169.625 L 303.40625,167.5 L 305.75,164.75 L 304.1875,163 L 305.5625,160.0625 L 309.0625,158.3125 L 316.6875,158.6875 L 318.4375,157.34375 L 318.59375,157.5 L 319.03125,154.21875 L 319.8125,150.3125 L 321.1875,148.53125 L 321.375,146.1875 L 324.09375,145.03125 L 324.09375,143.46875 L 321.1875,143.65625 L 320.59375,142.28125 L 321.5625,140.53125 L 320.78125,137.59375 L 319.21875,136.625 L 319.625,133.90625 L 321.1875,132.90625 L 320.96875,131.75 L 321.53125,131.0625 L 318.25,130.375 L 317.25,128.03125 L 315.5,127.4375 L 310.25,122.375 L 309.65625,118.0625 L 307.5,116.5 z ').attr(attr).data('value','77');fr.departement68=paper.path('M 465.59375,156.53125 L 462.65625,156.6875 L 460.8125,160.84375 L 458.46875,165.53125 L 459.0625,168.46875 L 457.125,172.96875 L 453.78125,175.875 L 453.59375,183.5 L 451.15625,185.59375 L 451.25,185.65625 L 452.03125,187.21875 L 455.15625,187.40625 L 458.6875,190.15625 L 459.25,191.5 L 459.0625,193.84375 L 458.09375,195.625 L 458.46875,197.96875 L 461.21875,197.5625 L 461.8125,199.71875 L 462.78125,203.875 L 465.09375,203.5 L 464.6875,205.625 L 466.0625,206.8125 L 473.28125,206.625 L 477,203.6875 L 477.1875,199.375 L 479.15625,196.84375 L 476.59375,193.90625 L 475.25,190.78125 L 476.8125,188.65625 L 476.8125,183.75 L 477.78125,181.40625 L 477.78125,177.5 L 479.53125,174.96875 L 477.59375,172.25 L 477.40625,166.625 L 474.40625,165.3125 L 472.6875,160.34375 L 468.84375,160.53125 L 467.3125,158.625 L 465.59375,156.53125 z ').attr(attr).data('value','68');fr.departement55=paper.path('M 390.125,86.53125 L 388.75,88.78125 L 387,89.9375 L 385.625,88.59375 L 382.6875,88.59375 L 382.125,87.8125 L 380.15625,91.5 L 379.375,92.875 L 381.71875,95.8125 L 380.9375,99.71875 L 378.78125,101.46875 L 379,102.84375 L 379.75,104.78125 L 378.59375,105.96875 L 376.25,107.125 L 376.625,109.28125 L 377.625,109.46875 L 375.875,111.03125 L 377.21875,113.96875 L 378.59375,118.28125 L 376.84375,120.21875 L 379.96875,120.03125 L 378.40625,124.90625 L 376.25,125.875 L 375.0625,128.8125 L 376.25,129.78125 L 374.875,132.125 L 375.28125,133.6875 L 379,136.625 L 379.1875,143.46875 L 383.28125,144.0625 L 385.8125,146.78125 L 390.5,149.125 L 392.25,149.71875 L 396.375,154.21875 L 395.9375,154.65625 L 399.375,154.21875 L 399.375,152.5 L 403.21875,151.71875 L 403.21875,150.40625 L 404.15625,150.40625 L 404.15625,151.53125 L 407.21875,150.59375 L 408.40625,149 L 408.1875,149.0625 L 408.1875,146.375 L 406.28125,144.65625 L 406.28125,143.5 L 407.8125,142.75 L 409.53125,142.75 L 408.9375,141.78125 L 407.8125,141.78125 L 407.03125,140.0625 L 407.03125,136.625 L 406.28125,134.5 L 407.8125,131.0625 L 409.125,127.4375 L 407.59375,125.90625 L 407.40625,124.9375 L 408.375,123.59375 L 410.65625,123.59375 L 410.65625,122.625 L 408.75,121.6875 L 408.375,120.34375 L 410.28125,118.25 L 408.1875,116.3125 L 408.9375,114.78125 L 407.21875,114.03125 L 406.0625,113.0625 L 405.875,110.59375 L 405.6875,109.0625 L 404.9375,107.90625 L 405.125,105.40625 L 406.0625,104.25 L 406.0625,102.9375 L 405.125,102.15625 L 405.125,100.4375 L 404.53125,98.71875 L 403.78125,97.1875 L 402.0625,95.84375 L 398.8125,96.8125 L 396.875,97 L 395.9375,98.71875 L 394.96875,99.46875 L 394.78125,98.71875 L 395.15625,97.375 L 395.5625,96.21875 L 394.40625,94.3125 L 394.53125,91.96875 L 393.59375,91.96875 L 392.8125,88.25 L 391.25,86.6875 L 390.125,86.53125 z ').attr(attr).data('value','55');fr.departement57=paper.path('M 423.09375,90.40625 L 420.15625,90.59375 L 417.8125,92.5625 L 417.21875,93.53125 L 413.90625,93.53125 L 412.75,92.34375 L 412.25,92.34375 C 412.32712,94.02401 412.40625,95.28125 412.40625,95.28125 L 411.4375,96.8125 L 413.9375,102.15625 L 414.875,102.9375 L 416.03125,106 L 414.5,108.65625 L 416.21875,110.375 L 415.46875,111.90625 L 415.46875,114.03125 L 413.34375,114.03125 L 413.15625,116.5 L 417.1875,119 L 417,122.0625 L 420.0625,122.0625 L 421.59375,124.15625 L 425.40625,124.15625 L 429.25,128.96875 L 430.1875,131.625 L 432.6875,131.625 L 437.65625,133.75 L 442.0625,136.40625 L 442.0625,137.1875 L 444.9375,137.375 L 448.5625,139.46875 L 452,139.46875 L 454.875,141.59375 L 458.125,143.875 L 460.4375,144.625 L 463.9375,141.125 L 465.125,137.03125 L 463.5625,135.46875 L 463.375,134.09375 L 465.6875,129.78125 L 460.25,126.65625 L 457.125,129 L 455.34375,127.84375 L 456.125,126.09375 L 454.1875,124.71875 L 451.625,123.53125 L 451.625,121 L 454.1875,120.21875 L 455.15625,115.71875 L 456.90625,113.78125 L 457.6875,116.71875 L 459.84375,117.6875 L 463.5625,118.28125 L 465.5,120.21875 L 467.84375,120.21875 L 469.8125,118.84375 L 472.34375,120.625 L 473.71875,120.625 L 475.28125,119.25 L 475.28125,116.3125 L 477,113.3125 L 476.59375,113.4375 L 475.25,111.5 L 471.34375,109.15625 L 469.96875,107 L 465.28125,107.40625 L 462.53125,109.9375 L 455.90625,110.125 L 453.9375,108.75 C 453.80551,108.51057 452.84437,106.81438 452,106.34375 C 451.96729,106.32639 451.91355,106.29802 451.875,106.28125 C 451.84646,106.26959 451.80512,106.25698 451.78125,106.25 C 451.77058,106.24458 451.73002,106.22452 451.71875,106.21875 C 451.71591,106.21876 451.69093,106.21861 451.6875,106.21875 C 451.66248,106.21745 451.61378,106.21875 451.59375,106.21875 C 450.67823,106.21876 448.90565,105.19125 448.6875,105.0625 L 445.9375,106.21875 L 445.75,108.5625 L 442.4375,108.96875 L 440.46875,105.25 L 439.3125,104.84375 L 439.3125,102.125 L 436.5625,100.9375 L 436.375,96.25 L 434.40625,94.3125 L 430.3125,92.34375 L 428.375,92.34375 L 427.78125,92.75 L 425.8125,92.75 L 423.09375,90.40625 z ').attr(attr).data('value','57');fr.departement88=paper.path('M 459,145.9375 L 457,146.375 L 453.9375,147.53125 L 452.40625,149.4375 L 450.6875,150.59375 L 447.40625,152.125 L 446.46875,151.9375 L 444.15625,151.34375 L 441.875,151.15625 L 441.09375,148.65625 L 439.5625,149.25 L 439.375,151.9375 L 438.21875,150.78125 L 436.125,152.3125 L 434.03125,153.0625 L 431.53125,152.875 L 429.8125,153.46875 L 427.90625,152.3125 L 426.75,153.25 L 423.875,153.25 L 422.53125,155.75 L 416.21875,156.125 L 414.875,154.40625 L 412.78125,154.03125 L 412.96875,153.0625 L 414.3125,152.125 L 413.15625,151.71875 L 412.96875,148.65625 L 410.09375,148.46875 L 408.40625,149 L 407.21875,150.59375 L 404.15625,151.53125 L 404.15625,150.40625 L 403.21875,150.40625 L 403.21875,151.71875 L 399.375,152.5 L 399.375,154.21875 L 395.9375,154.65625 L 394.625,155.96875 L 395.96875,157.90625 L 399.09375,158.125 L 401.84375,161.8125 L 404.1875,161.8125 L 404.75,164.375 L 407.3125,164.75 L 407.875,166.5 L 406.125,167.6875 L 404.96875,172.96875 L 410.4375,175.6875 L 410.4375,179.78125 L 412.5625,179 L 414.34375,180.40625 L 415.6875,179.59375 L 414.9375,178.4375 L 415.90625,177.84375 L 417.25,179.40625 L 419.21875,178.03125 L 419.8125,176.09375 L 423.5,175.5 L 424.5,176.28125 L 424.3125,178.4375 L 426.84375,180.375 L 428.40625,180.1875 L 430.15625,178.8125 L 434.25,178.8125 L 437.1875,182.125 L 438.15625,182.125 L 439.71875,181.15625 L 439.9375,180 L 441.5,179.21875 L 443.25,180.375 L 445,182.34375 L 451.15625,185.59375 L 453.59375,183.5 L 453.78125,175.875 L 457.125,172.96875 L 459.0625,168.46875 L 458.46875,165.53125 L 460.8125,160.84375 L 462.96875,155.96875 L 459.25,155 L 458.46875,149.71875 L 459.25,146.1875 L 459,145.9375 z ').attr(attr).data('value','88');fr.departement91=paper.path('M 274.21875,136.40625 L 272.46875,137.1875 L 270.5625,137.9375 L 270.1875,140.0625 L 267.3125,141.40625 L 266.9375,143.5 L 268.28125,145.8125 L 266.34375,148.46875 L 263.5,148.46875 L 264.625,150.1875 L 263.28125,151.71875 L 262.8125,154.8125 L 263.75,155 L 264.125,157.53125 L 264.53125,158.125 L 264.9375,163.375 L 271.1875,162.8125 L 273.71875,160.46875 L 275.875,162.21875 L 281.125,162.59375 L 281.875,163.71875 L 281.875,159.78125 L 286.25,156.90625 L 284.9375,155.1875 L 285.5,150 L 286.25,148.875 L 285.3125,143.6875 L 287.03125,142.34375 L 286.6875,139.90625 L 284.53125,138.90625 L 280.90625,138.90625 L 278.8125,137.75 L 277.28125,138.53125 L 274.21875,136.40625 z ').attr(attr).data('value','91');fr.departement78=paper.path('M 251.5,118.15625 L 251.4375,118.28125 L 245.96875,119.84375 L 245.1875,120.8125 L 246.1875,122.375 L 246.1875,123.9375 L 247.9375,124.3125 L 246.9375,125.3125 L 247.03125,126.1875 L 247.15625,126.09375 L 249.09375,128.03125 L 249.6875,130.375 L 251.25,131.9375 L 250.46875,134.09375 L 250.46875,136.03125 L 251.84375,137.59375 L 250.46875,139.9375 L 251.84375,143.28125 L 254.5625,145.21875 L 254.96875,147.375 L 257.3125,147.75 L 257.875,152.0625 L 259.65625,154.21875 L 262.8125,154.8125 L 263.28125,151.71875 L 264.625,150.1875 L 263.5,148.46875 L 266.34375,148.46875 L 268.28125,145.8125 L 266.9375,143.5 L 267.3125,141.40625 L 270.1875,140.0625 L 270.5625,137.9375 L 272.46875,137.1875 L 274.21875,136.40625 L 274.5625,136.625 L 274.5625,136.40625 L 272.8125,134.4375 L 271.71875,131.46875 L 273.46875,127.65625 L 272.59375,124.78125 L 269.1875,122.71875 L 264.375,122.5 L 259.875,119.625 L 256.25,120.28125 L 251.5,118.15625 z ').attr(attr).data('value','78');fr.departement95=paper.path('M 255.5625,109.6875 L 254,111.625 L 252.8125,115.9375 L 251.5,118.15625 L 256.25,120.28125 L 259.875,119.625 L 264.375,122.5 L 269.1875,122.71875 L 272.59375,124.78125 L 273.46875,127.65625 L 273.4375,127.71875 L 273.8125,127.65625 L 277.3125,125.78125 L 282.5625,125.4375 L 285.4375,124.125 L 287.28125,122.8125 L 287.875,118.96875 L 286.59375,117.6875 L 282.3125,115.15625 L 278.1875,113 L 276.0625,113.96875 L 273.71875,114.5625 L 272.15625,113.375 L 269.03125,111.4375 L 266.5,113.375 L 262.78125,113.78125 L 257.5,113.375 L 256.3125,111.4375 L 255.5625,109.6875 z ').attr(attr).data('value','95');fr.departement93=paper.path('M 287.28125,122.8125 L 285.4375,124.125 L 282.5625,125.4375 L 277.3125,125.78125 L 277.46875,126.5 L 277.90625,126.59375 L 278.3125,127.21875 L 277.90625,128.09375 L 277.375,128.1875 L 277.75,129.09375 L 280.28125,129.0625 L 281.09375,130.3125 L 281.25,132.0625 L 282.125,131.9375 L 282.9375,131.28125 L 284.15625,131.34375 L 285.6875,132.21875 L 286.5625,133.1875 L 286.96875,133.375 L 287.21875,133.84375 L 288.1875,134.09375 L 288.1875,131.25 L 287.03125,124.375 L 287.28125,122.8125 z ').attr(attr).data('value','93');fr.departement75=paper.path('M 280.28125,129.0625 L 277.75,129.09375 L 276.625,129.59375 L 276.15625,130.21875 L 275.125,130.28125 L 274.1875,131.34375 L 274.21875,131.9375 L 274.4375,132.625 L 276,133.0625 L 277.90625,134.03125 L 279.125,134.09375 L 279.9375,133.875 L 280.78125,133.28125 L 281.0625,133.53125 L 282.875,133.78125 L 283.1875,133.125 L 283.1875,132.46875 L 282.875,132.34375 L 281.625,132.40625 L 281.71875,132.71875 L 281.5,132.90625 L 281.09375,132.90625 L 281.25,132.5 L 281.3125,132.0625 L 281.25,132.0625 L 281.09375,130.3125 L 280.28125,129.0625 z ').attr(attr).data('value','75');fr.departement92=paper.path('M 277.3125,125.78125 L 273.8125,127.65625 L 273.4375,127.71875 L 271.71875,131.46875 L 272.8125,134.4375 L 274.5625,136.40625 L 274.5625,136.625 L 277.28125,138.53125 L 277.9375,138.1875 L 277.4375,137.25 L 277.9375,135.78125 L 277.625,135.25 L 277.96875,134.03125 L 277.90625,134.03125 L 276,133.0625 L 274.4375,132.625 L 274.21875,131.9375 L 274.1875,131.34375 L 275.125,130.28125 L 276.15625,130.21875 L 276.625,129.59375 L 277.75,129.09375 L 277.375,128.1875 L 277.90625,128.09375 L 278.3125,127.21875 L 277.90625,126.59375 L 277.46875,126.5 L 277.3125,125.78125 z ').attr(attr).data('value','92');fr.departement94=paper.path('M 282.9375,131.28125 L 282.125,131.9375 L 281.3125,132.0625 L 281.25,132.5 L 281.09375,132.90625 L 281.5,132.90625 L 281.71875,132.71875 L 281.625,132.40625 L 282.875,132.34375 L 283.1875,132.46875 L 283.1875,133.125 L 282.875,133.78125 L 281.0625,133.53125 L 280.78125,133.28125 L 279.9375,133.875 L 279.125,134.09375 L 277.96875,134.03125 L 277.625,135.25 L 277.9375,135.78125 L 277.4375,137.25 L 277.9375,138.1875 L 278.8125,137.75 L 280.90625,138.90625 L 284.53125,138.90625 L 286.6875,139.90625 L 286.65625,139.6875 L 288.1875,135.84375 L 288.1875,134.09375 L 287.21875,133.84375 L 286.96875,133.375 L 286.5625,133.1875 L 285.6875,132.21875 L 284.15625,131.34375 L 282.9375,131.28125 z ').attr(attr).data('value','94');fr.departement25=paper.path('M 447.40625,199.71875 L 447.21875,199.9375 L 444.96875,199.9375 L 443.8125,201.53125 L 442.34375,202.375 L 442.34375,204.34375 L 438.6875,204.78125 L 436.71875,203.375 L 434.0625,203.78125 L 431.53125,205.75 L 429.71875,208.84375 L 427.90625,209.40625 L 427.0625,211.5 L 424.8125,211.90625 L 421.71875,214.4375 L 417.65625,214.3125 L 416.40625,215.28125 L 415.28125,215.28125 L 411.34375,218.5 L 409.5625,218.4375 L 409.53125,219.625 L 409.8125,221.71875 L 412.34375,223.40625 L 413.75,225.25 L 413.3125,227.1875 L 412.0625,230.15625 L 411.21875,232.09375 L 416.6875,233.9375 L 420.1875,233.65625 L 420.46875,236.59375 L 420.46875,240.53125 L 424.8125,241.9375 L 426.78125,242.46875 L 429.59375,245.15625 L 429.3125,247.40625 L 428.03125,249.21875 L 424.53125,250.34375 L 425.375,252.3125 L 425.78125,253.84375 L 424.25,255.375 L 424.40625,256.78125 L 426.78125,257 L 426.8125,256.8125 L 438.90625,245.46875 L 438.53125,236.09375 L 442.8125,233.96875 L 445.75,232.59375 L 448.46875,230.0625 L 448.6875,226.34375 L 451.40625,224.96875 L 457.65625,217.75 L 456.6875,215.40625 L 458.84375,214.4375 L 461.375,211.3125 L 460,209.9375 L 455.3125,210.90625 L 455.125,210.125 L 459.4375,205.15625 L 447.40625,199.71875 z ').attr(attr).data('value','25');fr.departement90=paper.path('M 451.4375,186.03125 L 449.625,186.96875 L 448.09375,188.09375 L 448.09375,190.59375 L 448.9375,193.5625 L 448.9375,195.5 L 448.46875,198.625 L 447.40625,199.71875 L 459.4375,205.15625 L 460.1875,204.28125 L 462.78125,203.875 L 461.8125,199.71875 L 461.21875,197.5625 L 458.46875,197.96875 L 458.09375,195.625 L 459.0625,193.84375 L 459.25,191.5 L 458.6875,190.15625 L 455.15625,187.40625 L 452.03125,187.21875 L 451.4375,186.03125 z ').attr(attr).data('value','90');fr.departement971=paper.path('m 28.266401,201.65044 -1.49969,0.35636 -1.380896,1.21757 0.0594,2.7321 1.069074,0.17818 0.0594,1.69272 -1.054237,0.81666 -0.193028,1.33636 0,0.23756 -0.935443,0.98001 -0.0594,0.17818 -2.063926,-0.1188 -0.252425,-0.99484 -1.49969,-0.86121 -2.67271,-1.39574 -2.939983,0 -1.366047,2.09362 0.0594,3.01423 0.371207,1.23242 0.0594,0.22272 0.193028,2.33119 0.876046,4.30605 0.876058,2.2718 c 1.1e-5,0 0.617595,0.58507 0.742426,0.87605 0.124831,0.29099 0.816661,1.21757 0.816661,1.21757 l 1.366047,0.17818 0.386057,-0.71273 0.0594,0.0742 1.366047,0 2.063926,-1.75211 1.306662,-1.79666 -0.0594,-4.18724 -0.757264,-2.21241 0.252425,-1.81151 1.425444,-0.28212 0.01485,0 0.430605,0.51969 1.187868,0.28213 0.935454,0.35635 0.08908,-0.0445 0.103945,0.34152 1.8115,0.10393 3.118163,-0.57909 1.752115,-1.27696 3.058766,-0.11878 2.613312,-0.87606 -1.618472,-0.9206 -0.193028,-0.87605 -2.063926,-1.33636 -3.919974,-0.0594 -1.187868,-2.03422 0,-2.27181 -0.816673,-1.75211 -1.98968,-0.87605 z').attr(attr).data('value','971');fr.departement972=paper.path('m 22.074386,255.50485 c 0,0 -3.612262,0.0878 -4.053606,0.25242 -0.441355,0.16458 -2.212406,1.39575 -2.212418,1.39575 l -0.267263,0.0742 -1.054236,1.57393 0.356358,2.04907 3.088464,3.04393 -0.534537,0.83151 0,1.64817 1.321499,1.8115 4.246646,3.78635 3.786343,0 0.356358,0 1.054237,-0.0891 0.178179,0 -0.178179,0.74243 0,0.57908 1.247265,0.32666 0.519688,0.32667 c 0,0 -0.174093,1.40254 0.267274,1.48484 l -1.321511,0.0742 -1.856049,-0.56424 -1.232415,-0.25242 -1.588774,0.65333 -0.890907,1.06909 -0.430605,1.23241 0.341521,1.24727 0.890895,1.23241 1.143332,0.65333 c 0,0 1.147431,-0.32545 1.588774,-0.49 0.441355,-0.16464 0.801824,-0.90575 0.801812,-0.90574 0,0 1.312409,-0.081 1.930294,-0.16334 0.617886,-0.0823 1.247265,0.74241 1.247265,0.74242 l 2.910286,0.40091 1.321511,0.74241 0.786962,-0.0742 0,-0.83151 0.712728,-0.40091 0.712721,0.40091 -0.356358,0.99484 -0.801816,0.74241 0.356358,1.46999 1.054241,0.57909 1.247265,-0.0742 1.232416,-0.99484 0.356358,-1.30666 1.232418,-1.32151 -0.801814,-1.64817 -0.519688,-1.48484 -0.623632,-1.97483 -0.623633,-1.39576 c 0,0 -1.499702,-1.48232 -1.49969,-1.8115 0,-0.32918 -1.410599,-1.06907 -1.410599,-1.06908 l -0.17818,-1.3215 c 0,0 0.360434,-0.3996 0.801817,-0.56425 0.441308,-0.16459 -0.267279,-0.90576 -0.267279,-0.90575 l -0.876058,0.16333 -1.336349,0.32666 -0.34152,-0.41575 -0.534538,-0.57909 0.08908,-0.74241 0.965153,0.17818 0.801812,-0.90576 -1.143332,-0.90574 -0.890896,-0.25243 -0.267274,-0.49 0,0 0,-0.57908 0.979991,-0.41576 0.697878,0.57909 1.232416,0.49 0.623633,-0.74243 0,-0.81666 0.534542,-0.65333 -0.445447,-0.50484 -0.965153,-0.40091 -0.623633,0.56424 -2.464831,0.25243 -0.801812,0.57908 -1.054237,-0.32666 -1.232415,-1.97484 -2.836039,-2.80634 -1.588786,-0.65333 -2.910285,-1.48484 z').attr(attr).data('value','972');fr.departement973=paper.path('m 24.69165,308.79176 c -0.07645,0.005 -0.1341,0.0288 -0.16061,0.0535 l -1.4811,1.87367 -1.28482,1.48111 -1.4811,1.48111 0.21414,3.96151 -0.10708,3.65816 1.28482,1.78447 1.26696,2.26625 0.73164,1.39188 -0.73164,0.89224 -0.85652,2.37334 0.10705,3.26557 -1.05284,1.87368 -1.69523,1.39189 0.51749,0.58886 1.28482,0.78517 1.1599,0.69594 1.69525,-0.49966 1.8023,-1.0885 3.71168,-0.0892 1.39189,0.98146 1.48111,0.10708 1.4811,0.30335 2.12352,-1.69524 2.44471,-4.24703 1.80231,-3.65815 1.8023,-2.67669 1.90939,-2.46256 1.05283,-1.89153 -0.8387,-1.6774 -0.64241,-2.37334 -1.37403,-0.49966 -1.57033,-1.07066 -1.30267,-1.1956 -1.69523,-1.08852 -1.1599,-0.39259 -3.3905,-2.37333 -2.23057,-0.80301 -2.12351,-0.28552 c 0,0 -0.95073,-0.39107 -1.4811,-0.58887 -0.46413,-0.17302 -2.07017,-0.58832 -2.60532,-0.55318 z').attr(attr).data('value','973');fr.departement974=paper.path('m 30.55297,368.95998 -2.33119,0.0446 -0.84636,0.41576 -0.96515,0.74241 -0.17818,0.16334 -0.66818,0 -1.41059,0.53454 -0.60879,0.53455 -1.94514,0.28211 -0.17818,1.02454 -0.53454,2.13817 c 0,0 -0.74449,0.49678 -0.96514,0.57909 -0.2207,0.0823 -1.45514,0.74242 -1.45514,0.74242 l -0.22273,2.2718 0.53454,1.3512 1.45514,1.72242 0.69788,0.78696 0.56424,-0.11878 -0.34151,0.16333 0.04453,3.08846 1.45515,1.8115 1.49969,1.39576 2.64301,1.55908 0.17819,-0.10394 -0.20788,0.14849 3.13301,1.88574 2.42029,0.87606 2.59846,0.44544 2.07878,0.74243 1.32151,0.25242 c 0,0 2.0367,-0.41575 2.3015,-0.41575 0.26479,0 2.37575,-0.41576 2.37575,-0.41576 l 2.16785,-0.69788 1.45515,-1.32151 -0.13363,-2.34603 0.26726,-1.47 0.5791,-0.83151 0.96515,-1.27696 0.49,-1.60362 -0.13364,-1.55909 -1.02455,-0.57909 -1.3215,-0.60878 -0.60879,-0.0446 -0.98,-1.39574 c -0.22066,-0.16454 -1.41141,-1.48698 -1.49969,-1.69272 -0.08827,-0.20574 -0.87604,-1.97484 -0.87604,-1.97484 l -0.26728,-2.7618 -1.49969,-1.44029 -1.76695,-0.98 c 0,10e-6 -1.41307,-0.82001 -1.67787,-0.86121 -0.2648,-0.0411 -2.60014,-0.53454 -2.77666,-0.53454 -0.17655,0 -1.901,0.12223 -1.94514,0.16333 l -0.22271,-0.0891 -1.63334,-0.74243 z').attr(attr).data('value','974');paper.forEach(function(elem){var data=dataGeo[elem.data("value")];elem.scale(attributes.scale.x,attributes.scale.y,0,0);elem.mouseout(function(e){this.attr({fill:attributes.fill.def});attributes.mouseout(elem,e,data);});elem.mousemove(function(e){attributes.mousemove(elem,e,data);});elem.mouseover(function(e){this[0].style.cursor="pointer";this.attr({fill:attributes.fill.hover});paper.safari();attributes.mouseover(elem,e,data);});elem.click(function(e){attributes.click(elem,e,data);});});});}})(jQuery)}
function afficheLoaderGlobal_site(){(function($){if($('#div_loaderUnload').length===0){$('body').prepend('<div id="div_loaderUnload" style="display:none;"><div class="div_loaderCSS"></div></div>');}
$('#div_loaderUnload').show();})(jQuery);}
function effaceLoaderGlobal_site(){(function($){if($('#div_loaderUnload').length===0){$('body').prepend('<div id="div_loaderUnload" style="display:none;"><div class="div_loaderCSS"></div></div>');}
$('#div_loaderUnload').hide();})(jQuery);}
function estSupportTactile(){return'ontouchstart'in document.documentElement;}
function affichePopinFancyBox(html,wrapperCss,option){(function($){var defaultOption={maxWidth:650,closeClick:false,openEffect:'none',closeEffect:'none',content:html,padding:0,wrapCSS:wrapperCss};$.fancybox(Object.assign(defaultOption,option));})(jQuery);}var NB_PHOTOS_MAX=150;function initAlbumPhoto(qsForVisu){if($("div_fiche_album")){var tabObj=new Array();var photoPrinc=document.getElementById("img_fiche_photoPrincipale");var fenetre=0;var largTotal=0;xFinTotal=0;var maxLarg=0;var maxHaut=0;var nomPhotoRef="img_fiche_photoAlbum1";var nomPhotoRefFngf="img_fiche_photoAlbumFngf1";var legendePhoto=document.getElementById("fiche_legendePhotos");if(!qsForVisu)qsForVisu="";if(!document.getElementById(nomPhotoRef)&&document.getElementById(nomPhotoRefFngf))var fngf=true;else fngf=false;for(var i=1;i<=NB_PHOTOS_MAX;i++){if(fngf)var objPhoto=document.getElementById("img_fiche_photoAlbumFngf"+i);else var objPhoto=document.getElementById("img_fiche_photoAlbum"+i);if(objPhoto){tabObj.push($(objPhoto));if(getLargeurReelleImage(objPhoto)>maxLarg)maxLarg=getLargeurReelleImage(objPhoto);if(getHauteurReelleImage(objPhoto)>maxHaut)maxHaut=getHauteurReelleImage(objPhoto);}}
for(var i=0;i<tabObj.length;i++){new Effect.Opacity(tabObj[i],{from:1,to:0.9});tabObj[i].onmouseover=function(evt){if(photoPrinc)photoPrinc.src2=photoPrinc.src;if(photoPrinc&&this.src)photoPrinc.src=this.src;this.parentNode.parentNode.addClassName("photo_active");if($("fiche_legendePhotos")){$("fiche_legendePhotos").innerHTML2=legendePhoto.innerHTML;$("fiche_legendePhotos").innerHTML=this.getAttribute("data-txt");}
new Effect.Opacity(this,{from:0.9,to:1});}
tabObj[i].onmouseout=function(evt){new Effect.Opacity(this,{from:1,to:0.9});if(photoPrinc&&photoPrinc.src2)photoPrinc.src=photoPrinc.src2;if(this.parentNode.parentNode.hasClassName("photo_active"))this.parentNode.parentNode.removeClassName("photo_active");if($("fiche_legendePhotos"))$("fiche_legendePhotos").innerHTML=legendePhoto.innerHTML2;}
tabObj[i].num=i;var larg=parseInt(tabObj[i].offsetWidth);if(larg>fenetre)fenetre=larg;largTotal+=larg;if(tabObj[i]&&tabObj[i].offsetLeft){var xFin=(parseInt(tabObj[i].offsetLeft)+larg);if(xFinTotal<xFin)xFinTotal=xFin;}
if(xFinTotal<largTotal)xFinTotal=largTotal;}
var divPrinc=$(document.getElementById("div_fiche_album"));if(!divPrinc)return;var btPrec=$(document.getElementById("spanFiche_album_prev"));var btSuiv=$(document.getElementById("spanFiche_album_next"));var ulPrinc=$(document.getElementById("lst_fiche_photos_suppl"));btSuiv.style.visibility="hidden";btPrec.style.visibility="hidden";if(xFinTotal>parseInt(divPrinc.offsetWidth)){btSuiv.style.visibility="visible";}
ulPrinc.style.position="absolute";var pas=fenetre*2;btSuiv.onmousedown=function(){$(document.getElementById("spanFiche_album_prev")).style.visibility="visible";var decal=pas*-1;if(btSuiv.hasClassName("span_verticale")){var xFinPrinc=parseInt(ulPrinc.offsetTop)+parseInt(divPrinc.offsetTop)+xFinTotal;var xFinVisu=parseInt(divPrinc.offsetTop)+parseInt(divPrinc.offsetWidth);}
else{var xFinPrinc=parseInt(ulPrinc.offsetLeft)+parseInt(divPrinc.offsetLeft)+xFinTotal;var xFinVisu=parseInt(divPrinc.offsetLeft)+parseInt(divPrinc.offsetWidth);}
var xFinApresPrinc=xFinPrinc+decal-50;if(xFinApresPrinc<xFinVisu){decal=((xFinPrinc-xFinVisu)*-1);decal=decal-10;this.style.visibility="hidden";}
if(btSuiv.hasClassName("span_verticale"))new Effect.Move(ulPrinc,{y:decal,mode:'relative'});else new Effect.Move(ulPrinc,{x:decal,mode:'relative'});}
btPrec.onmousedown=function(){$(document.getElementById("spanFiche_album_next")).style.visibility="visible";var decal=pas+50;if(btSuiv.hasClassName("span_verticale"))var xDebPrinc=parseInt(ulPrinc.offsetTop);else var xDebPrinc=parseInt(ulPrinc.offsetLeft);var xDebApresPrinc=xDebPrinc+decal;if(xDebApresPrinc>0){decal=xDebPrinc*-1;this.style.visibility="hidden";}
if(btPrec.hasClassName("span_verticale"))new Effect.Move(ulPrinc,{y:decal,mode:'relative'});else new Effect.Move(ulPrinc,{x:decal,mode:'relative'});}}}
function initAlbumPhotoJquery(){if(jQuery("#div_fiche_albumJquery").length>0){var nbParNav=jQuery("#div_fiche_albumJquery").attr("data-nbparslide");var nbPhotos=jQuery("#div_fiche_albumJquery").attr("data-nbPhotos");var continuous=false;if(jQuery("#div_fiche_albumJquery").attr("data-continuous")=="true"&&(parseInt(nbPhotos)>parseInt(nbParNav))){continuous=true;}
var sudoSlider1=jQuery("#div_fiche_albumJquery").sudoSlider({autowidth:false,slideCount:nbParNav,moveCount:nbParNav,speed:400,continuous:continuous});var i=1;var tabSudoSlider1=new Array();while(jQuery("#div_fiche_albumJquery"+i).length>0){nbParNav=jQuery("#div_fiche_albumJquery"+i).attr("data-nbparslide");var nbPhotos=jQuery("#div_fiche_albumJquery"+i).attr("data-nbPhotos");var continuous=false;if(jQuery("#div_fiche_albumJquery"+i).attr("data-continuous")=="true"&&(parseInt(nbPhotos)>parseInt(nbParNav))){continuous=true;}
tabSudoSlider1[i]=jQuery("#div_fiche_albumJquery"+i).sudoSlider({autowidth:false,slideCount:nbParNav,moveCount:nbParNav,speed:400,continuous:continuous});i++;}}
if(jQuery("#div_fiche_sliderJquery").length>0){var sudoSlider2=jQuery("#div_fiche_sliderJquery").sudoSlider({autowidth:false,speed:400,numeric:true,prevNext:false});}
if(jQuery("#div_fiche_sliderJquery_prevnext").length>0){var sudoSlider3=jQuery("#div_fiche_sliderJquery_prevnext").sudoSlider({autowidth:false,speed:400,prevNext:true});}
if(jQuery("#div_diaporamaInterne").length>0){var tabImages=new Array();jQuery("#div_diaporamaInterneListePhotos img").each(function(){tabImages.push(jQuery(this).attr("src"));});var sudoSlider4=jQuery("#div_diaporamaInterneContent").sudoSlider({ajax:tabImages,numeric:true,preloadAjax:true,fade:true,ajaxLoadFunction:function(t){var url=jQuery(this).children().attr('src');jQuery('.controls li a span').eq(t-1).html('<img src="'+url+'" />');jQuery("#div_diaporamaInterneContent img").bind("click",function(){var tabPhotosDiapo=new Array();tabPhotosDiapo.push(jQuery(this).attr("src"));jQuery(this).parent().nextAll().children("img").each(function(){tabPhotosDiapo.push(jQuery(this).attr("src"));});jQuery(this).parent().prevAll().children("img").each(function(){tabPhotosDiapo.push(jQuery(this).attr("src"));});jQuery.fancybox(tabPhotosDiapo,{prevEffect:'fade',nextEffect:'fade'});});}});}
if(jQuery(".lance_fancybox").length>0){jQuery(".lance_fancybox").bind("click",function(){jQuery(".itea_fancyboxPrincipale").trigger('click');});}
if(jQuery("#lst_fiche_photos_supplJqueryAvecSurvol").length>0&&jQuery("#img_fiche_photoPrincipale").length>0){jQuery("#lst_fiche_photos_supplJqueryAvecSurvol img").mouseover(function(){var imgHover=jQuery(this).attr("data-hover");jQuery("#img_fiche_photoPrincipale").attr("src",imgHover);jQuery("#img_fiche_photoPrincipale").parent("a").attr("href",imgHover.split("?")[0]);jQuery("#img_fiche_photoPrincipale").parent("a").attr("title",jQuery(this).parent("a").attr("title"));jQuery("#img_fiche_photoPrincipale").attr("title",jQuery(this).parent("a").attr("title"));});setTimeout(function(){var tabImg=new Array();jQuery("#lst_fiche_photos_supplJqueryAvecSurvol img").each(function(){tabImg.push(jQuery(this).attr("data-hover"));});jQuery.preLoadImages(tabImg);},5000);}
if(jQuery("#lst_fiche_photos_supplJqueryAvecSurvol").length>0&&jQuery(".div_sliderMobileContent").length>0){var changeOnClick=false;if(jQuery("#lst_fiche_photos_supplJqueryAvecSurvol").attr("data-dataChangeOnclick")=="true"){changeOnClick=true;}
if(changeOnClick){jQuery("#lst_fiche_photos_supplJqueryAvecSurvol img").click(function(){var imgHover=jQuery(this).attr("data-hover");var imgPos=jQuery(this).attr("data-pos");jQuery(".div_sliderMobileContent img").hide();jQuery(".div_sliderMobileContent img[data-pos="+imgPos+"]").attr('src',imgHover).show();setHtmlLegendePhotoSlider(jQuery(this).data('ident'),jQuery(this).data('txt'));var listeUlDefilement=jQuery('ul.infosSlide');listeUlDefilement.find('li.active').removeClass("active");listeUlDefilement.find('li[data-pos="'+imgPos+'"]').addClass("active");});}
else{jQuery("#lst_fiche_photos_supplJqueryAvecSurvol img").mouseover(function(){var imgHover=jQuery(this).attr("data-hover");var imgPos=jQuery(this).attr("data-pos");jQuery(".div_sliderMobileContent img").hide();jQuery(".div_sliderMobileContent img[data-pos="+imgPos+"]").attr('src',imgHover).show();});}}
initClicPhotoChambreHotes();}
function initAlbumPhoto_owlCarousel(){(function($){if($('#div_fiche_albumJqueryOwlCarousel').length>0){var nbPhoto=parseInt($('#div_fiche_albumJqueryOwlCarousel').data('nbphotos'));var nbParSlide=parseInt($('#div_fiche_albumJqueryOwlCarousel').data('nbparslide'));var nbAffiche=parseInt($('#div_fiche_albumJqueryOwlCarousel').data('nbaffiche'));var continuous=$('#div_fiche_albumJqueryOwlCarousel').data('continuous');var margin=parseInt($('#div_fiche_albumJqueryOwlCarousel').data('margin'));var loop=false;if(nbPhoto>nbAffiche&&continuous==true){loop=true;}
$('.div_diapoFicheOwlCarousel').owlCarousel({loop:loop,margin:margin,nav:true,responsive:{0:{items:nbAffiche,slideBy:nbParSlide}}});var changeOnClick=false;if(jQuery("#div_fiche_albumJqueryOwlCarouselContent_avecSurvol").attr("data-dataChangeOnclick")=="true"){changeOnClick=true;}
if(changeOnClick){jQuery("#div_fiche_albumJqueryOwlCarouselContent_avecSurvol img").click(function(){var imgHover=jQuery(this).attr("data-hover");var imgPos=jQuery(this).attr("data-pos");jQuery(".div_sliderMobileContent img").hide();jQuery(".div_sliderMobileContent img[data-pos="+imgPos+"]").attr('src',imgHover).show();setHtmlLegendePhotoSlider(jQuery(this).data('ident'),jQuery(this).data('txt'));var listeUlDefilement=jQuery('ul.infosSlide');listeUlDefilement.find('li.active').removeClass("active");listeUlDefilement.find('li[data-pos="'+imgPos+'"]').addClass("active");});}
else{jQuery("#div_fiche_albumJqueryOwlCarouselContent_avecSurvol img").mouseover(function(){var imgHover=jQuery(this).attr("data-hover");var imgPos=jQuery(this).attr("data-pos");jQuery(".div_sliderMobileContent img").hide();jQuery(".div_sliderMobileContent img[data-pos="+imgPos+"]").attr('src',imgHover).show();});}}})(jQuery);}
function initFancyBoxDeBase(){if(jQuery(".itea_fancybox").length>0){jQuery(".itea_fancybox").bind('click',function(){var photos=[];var actual=jQuery(this).attr('href');actual=actual.replace(/\//g,'\\\/')
Expression=new RegExp(actual)
var postion=0;jQuery.each(jQuery(".itea_fancybox[rel="+jQuery(this).attr('rel')+"]"),function(key,value){photos.push(value);if(Expression.test(value))postion=key});if(photos.length==0)photos=jQuery(this)
var paramsFancyBox={openEffect:'none',closeEffect:'none',prevEffect:'fade',nextEffect:'fade',index:postion,titlePosition:'over'};jQuery.fancybox.open(photos,paramsFancyBox);if(jQuery.browser.msie&&jQuery.browser.version<9){jQuery(".fancybox-nav").live("mouseover",function(){jQuery(this).children("span").css("visibility","visible")});jQuery(".fancybox-nav").live("mouseout",function(){jQuery(this).children("span").css("visibility","hidden")});}
return false;});}
if(jQuery(".lancerFancyboxDesVignettes").length>0){jQuery(".lancerFancyboxDesVignettes").bind('click',function(){var idListe=jQuery(this).attr('data-id');if(jQuery('#'+idListe).length>0){jQuery('#'+idListe+' a.itea_fancybox  img[data-hover="'+jQuery(this).children('img').attr('src')+'"]').trigger('click');}
return false;});}}
function init_sliderMobile(){jQuery('body').delegate('.div_sliderMobile ul.infosSlide li','click',function(){jQuery(this).parent().children('li').removeClass('active');jQuery(this).addClass('active');var pos=jQuery(this).attr('data-pos');jQuery(this).closest('.div_sliderMobile').children('.div_sliderMobileContent').find('img').hide();var photoAmontrer=jQuery(this).closest('.div_sliderMobile').children('.div_sliderMobileContent').find('img[data-pos='+pos+']');photoAmontrer.attr('src',photoAmontrer.attr('data-original'));photoAmontrer.show();setHtmlLegendePhotoSlider(photoAmontrer.data("ident"),photoAmontrer.attr("title"));if(photoAmontrer.next().length>0){photoAmontrer.next().attr('src',photoAmontrer.next().attr('data-original'));}});jQuery('body').delegate('.div_sliderMobile .divInfosSlideNextPrev .suivant','click',function(){init_sliderMobile_defiler(this);});jQuery('body').delegate('.div_sliderMobile .divInfosSlideNextPrev .precedent','click',function(){init_sliderMobile_defiler(this,'prev');});jQuery('body').delegate('.div_sliderMobile .divInfosSlideNextPrev','click',function(){var $elem=jQuery(this);setTimeout(function(){$elem.removeClass('iteaStatMe_ALBUM_PHOTO');},300);});if(jQuery(".div_sliderMobile").length>0){if(jQuery('.div_sliderMobile ul.infosSlide').length>0){var x1=0;var x2=0;jQuery('.div_sliderMobile .div_sliderMobileContent img').bind('touchstart',function(e){x1=getCoord(e,'X');});jQuery('.div_sliderMobile .div_sliderMobileContent img').bind('touchend',function(e){x2=getCoord(e,'X');var diff=x2-x1;if(diff<-60){init_sliderMobile_defiler(this);}
else if(diff>60){init_sliderMobile_defiler(this,'prev');}});}
if(jQuery(".a_sliderMobileZoom").length>0){jQuery(".a_sliderMobileZoom").click(function(){tabTout=new Array();jQuery("img[rel='sliderMobile']").each(function(){var obj={href:jQuery(this).attr("data-zoom"),title:jQuery(this).attr("title")};tabTout.push(obj);});window.indexPhotoAffiche=0;jQuery(".div_sliderMobileContent img").each(function(){if(jQuery(this).is(":visible")){window.indexPhotoAffiche=parseInt(jQuery(this).attr("data-pos"))-1;}})
jQuery.fancybox.open(tabTout,{prevEffect:'fade',nextEffect:'fade',index:window.indexPhotoAffiche});})}
setTimeout(function(){jQuery(".div_sliderMobile").find('img[data-pos="2"]').each(function(){jQuery(this).attr("src",jQuery(this).attr("data-original"));});},3000);}}
function init_sliderMobile_defiler(element,direction){var dataPosition;var divParente=jQuery(element).parents('.div_sliderMobile');var listeUlDefilement=jQuery('ul.infosSlide[data-ident="'+jQuery(element).data("ident")+'"]',divParente);if(direction==undefined){var direction='next';}
if(direction=='prev'){dataPosition=jQuery(listeUlDefilement).find('li.active').prev().attr('data-pos');}else{dataPosition=jQuery(listeUlDefilement).find('li.active').next().attr('data-pos');}
if(jQuery(listeUlDefilement).children('[data-pos='+dataPosition+']').length==0){if(direction=='prev'){dataPosition=jQuery(listeUlDefilement).children().length;}else{dataPosition=1;}}
jQuery(listeUlDefilement).children('[data-pos='+dataPosition+']').trigger('click');addEventGa("navig_sliderMobile",direction,jQuery(element).data('labelevent'));}
function setHtmlLegendePhotoSlider(ident,txt){if(txt==undefined){txt='';}
if(jQuery('.div_sliderMobileLegende[data-ident="'+ident+'"]').length>0){if(txt.length>0){jQuery('.div_sliderMobileLegende[data-ident="'+ident+'"]').html('<div class="div_sliderMobileLegendeContent">'+txt+'</div>');}
else{jQuery('.div_sliderMobileLegende[data-ident="'+ident+'"]').html('');}}}
function initClicPhotoChambreHotes(){if(jQuery(".div_imgChambreNbPhoto").length>0){jQuery(".div_imgChambreNbPhoto").click(function(){jQuery(this).parent().find('img:first-child').trigger('click');})}}
function getCoord(e,c){return/touch/.test(e.type)?(e.originalEvent||e).changedTouches[0]['page'+c]:e['page'+c];}var _reqAjaxMoteur;var _timerPourMoteurLieu;function setCGIForLstLieu(li){if(navigator.appName=='Microsoft Internet Explorer')
var commune=li.getElementsByTagName("span")[0].getAttribute("lieu_reel");else var commune=li.getElementsByTagName("span")[0].getAttribute("lieu_reel");var cgi=li.getElementsByTagName("span")[0].getAttribute("cgi");var val_cgi=li.getElementsByTagName("span")[0].getAttribute("val_cgi");$("inpt_saisieLieu").value=commune;$("inpt_saisieLieu").onfocus=function(evt){this.value='';$("inpt_saisieLieuHidden").value='';}
$("inpt_saisieLieu").onblur=function(evt){$("inpt_saisieLieuHidden").value=this.value;}
$("inpt_saisieLieuHidden").value=commune;$("inpt_saisieLieuHidden").setAttribute("cgi",cgi);$("inpt_saisieLieuHidden").setAttribute("valeur",val_cgi);if(window.setListeByLieuSelect)setListeByLieuSelect();}
function setCGIForLstRef(li){var reference=li.getElementsByTagName("span")[0].getAttribute("lno");var departement=li.getElementsByTagName("span")[0].getAttribute("dep");$("inpt_reference").value=reference;$("inpt_reference").onfocus=function(evt){this.value='';$("inpt_saisieRefHidden").value='';this.value='';$("inpt_saisieRefDepHidden").value='';}
$("inpt_reference").onblur=function(evt){$("inpt_saisieRefHidden").value=this.value;$("inpt_saisieRefDepHidden").value=this.value;}
$("inpt_saisieRefHidden").value=reference;$("inpt_saisieRefHidden").setAttribute("cgi","LNO");$("inpt_saisieRefHidden").setAttribute("valeur",reference);$("inpt_saisieRefDepHidden").value=reference;$("inpt_saisieRefDepHidden").setAttribute("cgi","DEP");$("inpt_saisieRefDepHidden").setAttribute("valeur",departement);if(window.setListeByRefSelect)setListeByRefSelect();}
function setChmpCommuneAutoCompleter(reponse){var suffixe;var jsonarray=eval(reponse);var infos=[];for(var i=0;i<jsonarray.length;i++){(jsonarray[i].nb>1)?suffixe="s":suffixe="";infos.push(jsonarray[i].lieu+" ("+Math.round(jsonarray[i].nb)+" rponse"+suffixe+")<span cgi=\""+jsonarray[i].cgi+"\" val_cgi=\""+jsonarray[i].val_cgi+"\" lieu_reel=\""+jsonarray[i].lieuReel+"\" />");}
var typeahead=new Autocompleter.Local('inpt_saisieLieu','div_lstLieu_autocomplete',infos,{frequency:0.1,updateElement:setCGIForLstLieu,minChars:3});}
function setChmpCommuneAutoCompleterRef(reponse){var jsonarray=eval(reponse);var infos=new Array();for(var i=0;i<jsonarray.length;i++){infos.push(jsonarray[i].ref+" ("+jsonarray[i].lib+")<span lno=\""+jsonarray[i].ref+"\"dep=\""+jsonarray[i].dep+"\" />");}
var typeahead=new Autocompleter.Local('inpt_reference','div_lstRef_autocomplete',infos,{frequency:0.1,updateElement:setCGIForLstRef});}
function setAutoCompleterByLieu(idChampSaisie,divChampChoix,typeRep,priseEnCompteCrits,avecinfostour,avecInseeAffiche,avecCPAffiche){if(typeof(priseEnCompteCrits)=="undefined")priseEnCompteCrits=true;if(typeof(avecinfostour)=="undefined")avecinfostour=true;if(typeof(avecInseeAffiche)=="undefined")avecInseeAffiche=false;if(typeof(avecCPAffiche)=="undefined")avecCPAffiche=false;var url="/lib_2/ajax/infosCGI.php";var options;var foncUpdate;if(window.setListeByLieuSelect)foncUpdate=window.setListeByLieuSelect;else foncUpdate=null;var queryString=String(document.location.pathname);if(queryString.match("\\?"))queryString=queryString.split("?")[1];if(queryString.match("#"))queryString=queryString.split("#")[0];var uri=encodeURIComponent(queryString);if(jQuery("#moteur_inptUrlListe").length>0&&jQuery("#moteur_inptUrlListe").val()&&(uri==''||uri=='/'||uri=='%2F')){uri=jQuery("#moteur_inptUrlListe").val();}
if(typeRep=="lien"){var parametres="typeInfo=LISTALLLIEU&typeReponse=HTML";if(priseEnCompteCrits){parametres+="&uri="+uri;}
if(avecinfostour){parametres+='&avecinfostour=true';}
if(jQuery("#moteur_inptDistcomm").length>0){parametres+='&distcomm='+jQuery("#moteur_inptDistcomm").val();}
options={frequency:0.1,minChars:3,parameters:parametres,tokens:',',updateElement:foncUpdate}
window.autoCompleterLieu=new Ajax.Autocompleter(idChampSaisie,divChampChoix,url,options);}else if(window.setListeByLieuSelect){if(priseEnCompteCrits){var parametres="typeInfo=LISTALLLIEU&typeReponse=JS"+"&uri="+uri;}
else{var parametres="typeInfo=LISTALLLIEU&typeReponse=JS";}
if(avecinfostour){parametres+='&avecinfostour=true';}
if(avecInseeAffiche){parametres+='&avec_insee_affiche=true';}
if(avecCPAffiche){parametres+='&avec_cp_affiche=true';}
options={frequency:0.1,minChars:3,parameters:parametres,updateElement:setListeByLieuSelect,tokens:','}
window.autoCompleterLieu=new Ajax.Autocompleter(idChampSaisie,divChampChoix,url,options);}}
function setAutoCompleterByRef(idChampSaisie,divChampChoix,typeRep,communeDansAutoComplet,departements,libelleDansAutoCompleteur,gestprod){var url="/lib_2/ajax/infosCGI.php";var options;var foncUpdate;if(window.setListeByRefSelect)foncUpdate=window.setListeByRefSelect;else foncUpdate=null;var affComm="";if(communeDansAutoComplet){affComm=true;}
var dataLblac='';if(libelleDansAutoCompleteur){dataLblac='&libelleDansAutoCompleteur=false';}
if(gestprod){dataLblac=dataLblac+'&RETURNREFGESTPROD=true';}
if(departements)var depts=departements;else var depts='';if(typeRep=="lien"){options={frequency:0.1,minChars:1,parameters:"typeInfo=LISTALLREF&typeReponse=HTML&departements="+depts,tokens:',',updateElement:foncUpdate}}else if(window.setListeByRefSelect){options={frequency:0.1,minChars:1,parameters:"typeInfo=LISTALLREF&typeReponse=JS&communeDansAutoComplet="+affComm+"&departements="+depts+dataLblac,updateElement:setListeByRefSelect,tokens:','}}
window.autoCompleterRef=new Ajax.Autocompleter(idChampSaisie,divChampChoix,url,options);}
function getNomLieuByPositionCurr(position,foncQdFini){var out;var latitude=position.coords.latitude;var longitude=position.coords.longitude;var url="/lib_2/ajax/infosCGI.php";var sending="typeInfo=POSITIONCURR&latitude="+latitude+"&longitude="+longitude;appelAjaxToFunc(url,sending,foncQdFini);return out}
function moteur_initMoteurCommun(){if(jQuery(".moteur_selectOnChange").length>0){jQuery(".moteur_selectOnChange").bind('change selectmenuchange',function(){var cgi=jQuery(this).attr("name");var url=document.location.href;if(window.initClicMoteur_selectOnChange){initClicMoteur_selectOnChange(jQuery(this));}
if(jQuery("#moteur_inptUrlListe")&&jQuery("#moteur_inptUrlListe").val()){var urlSeule=url.substring(0,url.lastIndexOf("/"));var autresCGI=url.substring(url.lastIndexOf("?")+1,url.length);if(jQuery("#moteur_inptUrlListe_supprimerCGI")&&jQuery("#moteur_inptUrlListe_supprimerCGI").val()=='1'){autresCGI='';}
url=urlSeule+'/'+jQuery("#moteur_inptUrlListe").val()+'?'+autresCGI;}
if(jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url")!=undefined&&jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url").length>0){url=jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url");}
var value=this.value;url=getUrlWithLstParam(url,cgi,value);if(jQuery(this).attr('name')==='lieu'){url=removeParamGoogleMaps(url);url=supprimeCgisDansUrl(url,['lieucgi']);}
if(jQuery(this).hasClass('moteur_selectEnregistreCritere')){setCookieEnregistreCritere(cgi,value)}
if(jQuery(this).hasClass('moteur_selectLieuEnregistreCritere')){setCookieEnregistreCritere(cgi,value)}
if(estMoteurSansLien()){refreshListeWithCgi(url+'&'+jQuery('#itea_page_contentListe').attr('data-cgi'));}else{document.location.href=url;moteur_affMessageLoadingMoteur();}});}
if(jQuery(".moteur_selectLieuMultpleSansLien").length>0){jQuery(".moteur_selectLieuMultpleSansLien").bind('change selectmenuchange',function(){if(jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url")!=undefined&&jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url").length>0){url=jQuery("#"+jQuery(this).attr("id")+" option:selected").attr("data-url");jQuery(this).parents("form").attr("action",url);}});}
if(jQuery(".moteur_radioOnChange").length>0){jQuery(".moteur_radioOnChange").bind("click",function(){document.location.href=jQuery(this).attr("data-href");moteur_affMessageLoadingMoteur();});}
if(jQuery(".moteur_imitecheckbox").length>0||jQuery(".moteur_ulSimuleListe a").length>0){$$(".moteur_imitecheckbox, .moteur_ulSimuleListe a").each(function(obj){jQuery(obj).bind("click",function(evt){moteur_affMessageLoadingMoteur();});});}
if(jQuery(".moteur_enregistreCritere").length>0){jQuery(".moteur_enregistreCritere").each(function(){jQuery(this).bind("click",function(){setCookieEnregistreCritere(jQuery(this).find('.sp_nbResult').data('cgi'),'O');});});}
if(jQuery(".moteur_imiteCheckBoxPasLien").length>0){$$(".moteur_imiteCheckBoxPasLien").each(function(obj){if(obj.getAttribute('id')!='moteur_imiteCheckBoxPasDate'){jQuery(obj).bind("click",function(evt){if(jQuery(obj).hasClass("moteur_imitecheckbox_off")){jQuery(obj).removeClass("moteur_imitecheckbox_off");jQuery(obj).addClass("moteur_imitecheckbox_on");}
else{jQuery(obj).addClass("moteur_imitecheckbox_off");jQuery(obj).removeClass("moteur_imitecheckbox_on");}});}});}
if(jQuery(".moteur_imiteCheckBoxPasLienType").length>0){$$(".moteur_imiteCheckBoxPasLienType").each(function(obj){jQuery(obj).bind("click",function(evt){var inputHidden=jQuery(obj).attr("data-alt");var valueok=jQuery(obj).attr("data-valueok");if(!valueok)valueok='o';if($(inputHidden).value==valueok){$(inputHidden).value="n";}
else{$(inputHidden).value=valueok;}});});}
if(jQuery(".moteur_imiteCheckBoxPasLienChangeValue").length>0){$$(".moteur_imiteCheckBoxPasLienChangeValue").each(function(obj){jQuery(obj).bind("click",function(evt){if(jQuery(obj).attr("alt")){var inputHidden=jQuery(obj).attr("alt");}
else if(jQuery(obj).attr("data-alt").length>0)
var inputHidden=jQuery(obj).attr("data-alt");var valueok=jQuery(obj).attr("data-valueok");if(!valueok)
valueok='o';if($(inputHidden).value==valueok){$(inputHidden).value="n";jQuery('input[name="'+jQuery(this).attr('data-cgi')+'"]').val('n');jQuery(this).find(".sp_nbResult").attr("data-valeur","n");}
else{$(inputHidden).value=valueok;jQuery('input[name="'+jQuery(this).attr('data-cgi')+'"]').val(valueok);jQuery(this).find(".sp_nbResult").attr("data-valeur",valueok);}
jQuery("#"+inputHidden).trigger("change");});});}
if(jQuery(".moteur_imiteCheckBoxPasLienChangeMultiValue").length>0){$$(".moteur_imiteCheckBoxPasLienChangeMultiValue").each(function(obj){jQuery(obj).bind("click",function(evt){if(jQuery(obj).attr("alt")){var inputHidden=jQuery(obj).attr("alt");}
else if(jQuery(obj).attr("data-alt").length>0)var inputHidden=obj.getAttribute("data-alt");if($(inputHidden).value=="o"){$(inputHidden).value="n";var inputsAchanger=obj.getAttribute("data-inputsachanger");tabInputs=inputsAchanger.split(";");tabInputs.each(function(inpt){$(inpt).value="n";jQuery("*[data-alt="+inpt+"]").removeClass("moteur_imitecheckbox_on").addClass("moteur_imitecheckbox_off");});}
else{$(inputHidden).value="o";}});});}
if($("moteur_imiteCheckBoxPasDate")){jQuery("moteur_imiteCheckBoxPasDate").bind("click",function(evt){$("moteur_inptDateDeb").value="";$("moteur_selectDuree").value="";if(jQuery("moteur_imiteCheckBoxPasDate").hasClass("moteur_imitecheckbox_on")){jQuery("moteur_imiteCheckBoxPasDate").addClass("moteur_imitecheckbox_off");jQuery("moteur_imiteCheckBoxPasDate").removeClass("moteur_imitecheckbox_on");}else{jQuery("moteur_imiteCheckBoxPasDate").addClass("moteur_imitecheckbox_on");jQuery("moteur_imiteCheckBoxPasDate").removeClass("moteur_imitecheckbox_off");}});}
if($("moteur_CheckBoxAvecSansDispo")){jQuery("moteur_CheckBoxAvecSansDispo").bind("click",function(evt){$("moteur_inptDateDeb").value="";$("moteur_selectDuree").value="";});}
if($("moteur_inptTextLieu")){$("moteur_inptTextLieu").onfocus=function(evt){$("moteur_inptTextLieu").value="";$("moteur_inptTextLieuHidden").value="";if($("moteur_spanTextLieu_infotour")){$("moteur_spanTextLieu_infotour").innerHTML='';}};$("moteur_inptTextLieu").onblur=function(evt){if($("moteur_inptTextLieu").value==""){$("moteur_inptTextLieu").value=$("moteur_inptTextLieu").getAttribute("title");$("moteur_inptTextLieuHidden").value="";$$(".moteur_selectRayon").each(function(obj){obj.value="0";obj.disabled=true;});}};if($("moteur_divRechercheLieuAvecLien")){window.setListeByLieuSelect=function(li){var lieu=li.getAttribute("valreel");var cgi=li.getAttribute("cgi");var val_cgi=li.getAttribute("val_cgi");var nb=li.getAttribute("nb");$("moteur_inptTextLieu").value=lieu;$("moteur_inptTextLieuHidden").setAttribute("name",cgi);$("moteur_inptTextLieuHidden").setAttribute("value",val_cgi);}
setAutoCompleterByLieu("moteur_inptTextLieu","moteur_divLieuAutoComplete","lien");}
else if($("moteur_divRechercheLieuSansLien")){window.setListeByLieuSelect=function(li){var lieu=li.getAttribute("valreel");var cgi=li.getAttribute("cgi");var val_cgi=li.getAttribute("val_cgi");var nb=li.getAttribute("nb");if(li.childElements('span').length>1&&$("moteur_spanTextLieu_infotour")){$("moteur_spanTextLieu_infotour").innerHTML=li.childElements('span')[1].innerHTML;}
$("moteur_inptTextLieu").value=lieu;$("moteur_inptTextLieuHidden").setAttribute("name",cgi);$("moteur_inptTextLieuHidden").setAttribute("value",val_cgi);if(cgi=="INSEE"||cgi=="insee"){$$(".moteur_selectRayon").each(function(obj){obj.disabled=false;if(nb=="0")obj.value="10";});}
else{$$(".moteur_selectRayon").each(function(obj){obj.value="0";obj.disabled=true;});}}
if(jQuery("#moteur_divRechercheLieuSansLien").attr("data-priseEnCompteCriteres")=="false"){var priseEnCompteCrits=false;}
else{priseEnCompteCrits=true;}
if(jQuery("#moteur_divRechercheLieuSansLien").attr("data-avecinfostour")=="false"){var avecinfostour=false;}
else{avecinfostour=true;}
var avecInseeAffiche=false;if(jQuery('#moteur_divRechercheLieuSansLien').data('avec-insee-affiche')===true){avecInseeAffiche=true;}
var avecCPAffiche=false;if(jQuery('#moteur_divRechercheLieuSansLien').data('avec-cp-affiche')===true){avecCPAffiche=true;}
setAutoCompleterByLieu("moteur_inptTextLieu","moteur_divLieuAutoComplete","",priseEnCompteCrits,avecinfostour,avecInseeAffiche,avecCPAffiche);}}
if($("moteur_divDudgetMaxi")){var slider=$("moteur_sliderBudgetMaxiContent");var vals=new Array();for(var i=50;i<=2500;i+=50)vals.push(i);if($("moteur_hiddenPxMax").value)var valeurEnCour=$("moteur_hiddenPxMax").value;else var valeurEnCour=1500;new Control.Slider(slider.down('.moteur_handle'),slider,{range:$R(50,2500),sliderValue:valeurEnCour,values:vals,onSlide:function(value){$("moteur_spanTitreBudgetMaxiInfoPrix").innerHTML=value+" &euro;";},onChange:function(value){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"pxmax",value.toString());moteur_affMessageLoadingMoteur();}});}
if(jQuery("#sliderOnlyMaxi").length>0){if(jQuery("#moteur_inptBudgetMaxiJsliderFrom").length>0)var sliderFrom=parseInt(jQuery("#moteur_inptBudgetMaxiJsliderFrom").attr("value"));if(jQuery("#moteur_inptBudgetMaxiJsliderTo").length>0)var sliderTo=parseInt(jQuery("#moteur_inptBudgetMaxiJsliderTo").attr("value"));if(jQuery("#moteur_inptBudgetMaxiJsliderStep").length>0)var sliderStep=parseInt(jQuery("#moteur_inptBudgetMaxiJsliderStep").attr("value"));jQuery("#sliderOnlyMaxi").slider({from:sliderFrom,to:sliderTo,step:sliderStep,round:0,dimension:'&nbsp;',callback:function(value){var url=document.location.href;if(jQuery("#moteur_inptUrlListe").length>0&&jQuery("#moteur_inptUrlListe").val())url+=jQuery("#moteur_inptUrlListe").val();document.location.href=getUrlWithLstParam(url,jQuery("#sliderOnlyMaxi").data('cgi'),value);moteur_affMessageLoadingMoteur();}});}
moteur_initRegletteMiniMaxi();if($("moteurInptConfortMinMax")){var from=parseInt($("moteurInptConfortFrom").value);var to=parseInt($("moteurInptConfortTo").value);var step=parseInt($("moteurInptConfortStep").value);eval("scale = "+$('moteurInptConfortScale').value);jQuery("#moteurInptConfortMinMax").slider({from:from,to:to,step:step,scale:scale,smooth:false,round:0,dimension:"&nbsp;$",limits:false,callback:function(value){var tabEpi=value.split(";");var min=tabEpi[0];var max=tabEpi[1];if(min!=jQuery("#moteurInptFromInit").val()||max!=jQuery("#moteurInptToInit").val()){var epiMin,epiMax;if(min=="2")epiMin="3";else if(min=="3")epiMin="5";else epiMin=min;if(max=="2")epiMax="3";else if(max=="3")epiMax="5";else epiMax=max;var url=document.location.href;url=getUrlWithLstParam(url,"epi_min",epiMin);document.location.href=getUrlWithLstParam(url,"epi_max",epiMax);moteur_affMessageLoadingMoteur();}}});}
if($("moteur_divCapaciteReglette")){var slider=$("moteur_sliderCapaciteContent");var valeurMax,valeurMin;if($("moteur_hiddenCapaciteMaxReglette").value)valeurMax=parseInt($("moteur_hiddenCapaciteMaxReglette").value);else valeurMax=15;if($("moteur_hiddenCapaciteMinReglette").value)valeurMin=parseInt($("moteur_hiddenCapaciteMinReglette").value);else valeurMin=1;if($("moteur_hiddenCapaciteMax").value)var valeurEnCourMax=parseInt($("moteur_hiddenCapaciteMax").value);else var valeurEnCourMax=valeurMax;if($("moteur_hiddenCapaciteMini").value)var valeurEnCourMin=parseInt($("moteur_hiddenCapaciteMini").value);else var valeurEnCourMin=valeurMin;var vals=new Array();for(var i=valeurMin;i<=valeurMax;i+=valeurMin)vals.push(i);new Control.Slider(slider.down('#moteur_sliderCapaciteMaxi'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMax,values:vals,onSlide:function(value){$("spn_budgetInfosCapaciteMax").innerHTML=value;},onChange:function(value){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"nbp_max",value.toString());moteur_affMessageLoadingMoteur();}});new Control.Slider(slider.down('#moteur_sliderCapaciteMini'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMin,values:vals,onSlide:function(value){$("spn_budgetInfosCapaciteMin").innerHTML=value;},onChange:function(value){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"nbp_min",value.toString());moteur_affMessageLoadingMoteur();}});}
if($("moteur_divChambreReglette")){var slider=$("moteur_sliderChambreContent");var valeurMax,valeurMin;if($("moteur_hiddenChambreMaxReglette").value)valeurMax=parseInt($("moteur_hiddenChambreMaxReglette").value);else valeurMax=15;if($("moteur_hiddenChambreMinReglette").value)valeurMin=parseInt($("moteur_hiddenChambreMinReglette").value);else valeurMin=1;if($("moteur_hiddenChambreMax").value)var valeurEnCourMax=parseInt($("moteur_hiddenChambreMax").value);else var valeurEnCourMax=valeurMax;if($("moteur_hiddenChambreMini").value)var valeurEnCourMin=parseInt($("moteur_hiddenChambreMini").value);else var valeurEnCourMin=valeurMin;var vals=new Array();for(var i=valeurMin;i<=valeurMax;i+=valeurMin)vals.push(i);new Control.Slider(slider.down('#moteur_sliderChambreMaxi'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMax,values:vals,onSlide:function(value){$("spn_budgetInfosChambreMax").innerHTML=value;},onChange:function(value){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"nbchb_max",value.toString());moteur_affMessageLoadingMoteur();}});new Control.Slider(slider.down('#moteur_sliderChambreMini'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMin,values:vals,onSlide:function(value){$("spn_budgetInfosChambreMin").innerHTML=value;},onChange:function(value){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"nbchb_min",value.toString());moteur_affMessageLoadingMoteur();}});}
if($("moteur_inptDateDeb")){var chaineJoursArrivee=jQuery('#moteur_inptDateDeb').attr('data-joursArrivee')||false;var dateDebChaineJoursArrivee=false;if(chaineJoursArrivee){var formatDate='dd/mm/yy';dateDebChaineJoursArrivee=jQuery('#moteur_inptDateDeb').attr('data-debut');window.paramsJoursArriveeGeneral={chaineJoursArrivee:chaineJoursArrivee,dateDebChaineJoursArrivee:dateDebChaineJoursArrivee};}
jQuery("#moteur_inptDateDeb").click(function(evt){if(jQuery("#moteur_inptDateDeb").val()==jQuery("#moteur_inptDateDeb").attr("data-defaut"))jQuery("#moteur_inptDateDeb").val('');var langue=jQuery("body").attr("data-langue");setCalendrierGeneral("","1",langue,"","moteur_divCalendrierDebutContent",moteur_clicCalendDateDeb,"moteur_inptDateDeb","","","moteur_selectDuree","1","",6,$("moteur_inptDateDeb").value,$("moteur_selectDuree").value);if(jQuery('#moteur_divCalendrierDebut').length>0&&jQuery('#moteur_divCalendrierDebut').is(':hidden')){jQuery('#moteur_divCalendrierDebut').show('fast');}
else if(jQuery('#moteur_divCalendrierDebut').length>0){jQuery('#moteur_divCalendrierDebut').hide('fast');}});jQuery("#moteur_inptDateDeb").blur(function(evt){if(jQuery("#moteur_inptDateDeb").val()=="")jQuery("#moteur_inptDateDeb").val(jQuery("#moteur_inptDateDeb").attr("data-defaut"));});if(jQuery('#moteurBoutonResetDate').length>0){jQuery('#moteurBoutonResetDate').click(function(){if(jQuery("#moteur_inptDateDeb").val()==jQuery("#moteur_inptDateDeb").attr("data-defaut")){return false;}
jQuery('#moteur_inptDateDeb').val('N');if(jQuery("#moteur_frmDateNbj")){jQuery("#moteur_frmDateNbj").submit();}});}}
if($("moteur_imgCalendDateDeb")){jQuery("#moteur_imgCalendDateDeb").click(function(evt){if(jQuery("#moteur_selectDuree").length>0&&jQuery("#moteur_selectDuree").val()!='')var duree=jQuery('#moteur_selectDuree').val();else var duree=1;var langue=jQuery("body").attr("data-langue");setCalendrierGeneral("","1",langue,"","moteur_divCalendrierDebutContent",moteur_clicCalendDateDeb,"moteur_inptDateDeb","","","moteur_selectDuree","1","",6,jQuery("#moteur_inptDateDeb").val(),duree);if(jQuery('#moteur_divCalendrierDebut').length>0&&$('moteur_divCalendrierDebut').style.display=="none")jQuery('#moteur_divCalendrierDebut').show('fast');else if(jQuery('#moteur_divCalendrierDebut').length>0)jQuery('#moteur_divCalendrierDebut').show('fast');});}
if(jQuery("#moteur_CalenddateDeb").length>0){jQuery("#moteur_CalenddateDeb, #moteur_imgCalendDebutFinDeb").bind("click",function(){setCalendrierGeneral("","1","","","moteur_calendrierDebMoteurContent",moteur_clicCalendDateDebut,"moteur_CalenddateDeb","","","inpt_frmBandeau_nbjInit","1","",6,$("moteur_CalenddateDeb").value,window.dureeSejour);if(jQuery("#moteur_calendrierDebMoteur").is(":hidden")){if(jQuery("#moteur_CalenddateDeb").val()==jQuery("#moteur_CalenddateDeb").attr("data-defaut"))jQuery("#moteur_CalenddateDeb").val("");if(jQuery("#moteur_CalenddateFin").val()=="")jQuery("#moteur_CalenddateFin").val(jQuery("#moteur_CalenddateFin").attr("data-defaut"));jQuery("#moteur_calendrierFinMoteur").fadeOut();jQuery("#moteur_calendrierDebMoteur").fadeIn();}
else{if(jQuery("#moteur_CalenddateDeb").val()=="")jQuery("#moteur_CalenddateDeb").val(jQuery("#moteur_CalenddateDeb").attr("data-defaut"));jQuery("#moteur_calendrierDebMoteur").fadeOut();}});}
if(jQuery("#moteur_CalenddateFin").length>0){jQuery("#moteur_CalenddateFin, #moteur_imgCalendDebutFinFin").bind("click",function(){if(jQuery("#moteur_CalenddateFin").val().length>0&&jQuery("#moteur_CalenddateFin").val()!=jQuery("#moteur_CalenddateFin").attr("data-defaut")&&jQuery("#moteur_CalenddateDeb").val().length>0&&jQuery("#moteur_CalenddateDeb").val()!=jQuery("#moteur_CalenddateDeb").attr("data-defaut")){var ObjDateDeb=new OBJDate(jQuery("#moteur_CalenddateDeb").val());var ObjDateFin=new OBJDate(jQuery("#moteur_CalenddateFin").val());var duree=ObjDateFin.getNbJourEcartWithOBJDate(ObjDateDeb,"N");}
else{var duree=jQuery("#moteur_CalenddateDeb").attr("data-duree");}
setCalendrierGeneral("","1","","","moteur_calendrierFinMoteurContent",moteur_clicCalendDateFin,"moteur_CalenddateFin","","","inpt_frmBandeau_nbjInit","1","",6,$("moteur_CalenddateDeb").value,duree);if(jQuery("#moteur_calendrierFinMoteur").is(":hidden")){if(jQuery("#moteur_CalenddateFin").val()==jQuery("#moteur_CalenddateFin").attr("data-defaut"))jQuery("#moteur_CalenddateFin").val("");if(jQuery("#moteur_CalenddateDeb").val()=="")jQuery("#moteur_CalenddateDeb").val(jQuery("#moteur_CalenddateDeb").attr("data-defaut"));jQuery("#moteur_calendrierDebMoteur").fadeOut();jQuery("#moteur_calendrierFinMoteur").fadeIn();}
else{if(jQuery("#moteur_CalenddateFin").val()=="")jQuery("#moteur_CalenddateFin").val(jQuery("#moteur_CalenddateFin").attr("data-defaut"));jQuery("#moteur_calendrierFinMoteur").fadeOut();}});}
if(jQuery("#moteur_CalenddateDebOnChange").length>0){jQuery("#moteur_CalenddateDebOnChange, #moteur_imgCalendDebutFinDebOnChange").bind("click",function(){var langue="";if(jQuery("#moteur_CalenddateDebOnChange").attr("data-langue"))langue=jQuery("#moteur_CalenddateDebOnChange").attr("data-langue");setCalendrierGeneral("","1",langue,"","moteur_calendrierDebMoteurContent",moteur_clicCalendDateDebut,"moteur_CalenddateDebOnChange","","","inpt_frmBandeau_nbjInit","1","",6,$("moteur_CalenddateDebOnChange").value,window.dureeSejour);if(jQuery("#moteur_calendrierDebMoteur").is(":hidden")){if(jQuery("#moteur_CalenddateDebOnChange").val()==jQuery("#moteur_CalenddateDebOnChange").attr("data-defaut"))jQuery("#moteur_CalenddateDebOnChange").val("");if(jQuery("#moteur_CalenddateFinOnChange").val()=="")jQuery("#moteur_CalenddateFinOnChange").val(jQuery("#moteur_CalenddateFinOnChange").attr("data-defaut"));jQuery("#moteur_calendrierFinMoteur").fadeOut();jQuery("#moteur_calendrierDebMoteur").fadeIn();}
else{if(jQuery("#moteur_CalenddateDebOnChange").val()=="")jQuery("#moteur_CalenddateDebOnChange").val(jQuery("#moteur_CalenddateDebOnChange").attr("data-defaut"));jQuery("#moteur_calendrierDebMoteur").fadeOut();}});}
if(jQuery("#moteur_CalenddateFinOnChange").length>0){jQuery("#moteur_CalenddateFinOnChange, #moteur_imgCalendDebutFinFinOnChange").bind("click",function(){var langue="";if(jQuery("#moteur_CalenddateDebOnChange").attr("data-langue"))langue=jQuery("#moteur_CalenddateDebOnChange").attr("data-langue");setCalendrierGeneral("","1",langue,"","moteur_calendrierFinMoteurContent",moteur_clicCalendDateFin,"moteur_CalenddateFinOnChange","","","inpt_frmBandeau_nbjInit","1","",6,$("moteur_CalenddateFinOnChange").value,window.dureeSejour);if(jQuery("#moteur_calendrierFinMoteur").is(":hidden")){if(jQuery("#moteur_CalenddateFinOnChange").val()==jQuery("#moteur_CalenddateFinOnChange").attr("data-defaut"))jQuery("#moteur_CalenddateFinOnChange").val("");if(jQuery("#moteur_CalenddateDebOnChange").val()=="")jQuery("#moteur_CalenddateDebOnChange").val(jQuery("#moteur_CalenddateDebOnChange").attr("data-defaut"));jQuery("#moteur_calendrierDebMoteur").fadeOut();jQuery("#moteur_calendrierFinMoteur").fadeIn();}
else{if(jQuery("#moteur_CalenddateFinOnChange").val()=="")jQuery("#moteur_CalenddateFinOnChange").val(jQuery("#moteur_CalenddateFinOnChange").attr("data-defaut"));jQuery("#moteur_calendrierFinMoteur").fadeOut();}});}
if($("moteur_frmDateNbj")){$("moteur_frmDateNbj").onsubmit=function(evt){if($("moteur_selectDuree")&&$("moteur_inptDateDeb")&&$("moteur_inptDateDebValueDefaut")&&$("moteur_imiteCheckBoxPasDate")){if(!$("moteur_imiteCheckBoxPasDate").hasClassName("moteur_imitecheckbox_on")){if(($("moteur_selectDuree").value!=""&&($("moteur_inptDateDeb").value==""||$("moteur_inptDateDeb").value==$("moteur_inptDateDebValueDefaut").value))||($("moteur_selectDuree").value==""&&($("moteur_inptDateDeb").value!=""&&$("moteur_inptDateDeb").value!=$("moteur_inptDateDebValueDefaut").value))){alertAMalibu("Vous devez dfinir la date de dbut de votre sjour et sa dure.");return false;}}}};}
if(jQuery("#moteur_datePickerDeb").length>0&&jQuery("#moteur_datePickerFin").length>0){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);var imgCalDeb=$("#moteur_datePickerDeb").attr("data-calend");var imgCalFin=$("#moteur_datePickerFin").attr("data-calend");var imgCalDebText=$("#moteur_datePickerDeb").attr("data-textImage");var imgCalFinText=$("#moteur_datePickerFin").attr("data-textImage");var formatDate='dd/mm/yy';var nbMois=parseInt($("#moteur_datePickerDeb").attr("data-nbmois"));var ajoutJourAuto=true;if($("#moteur_datePickerDeb").attr("data-ajoutjourauto")=='false'){ajoutJourAuto=false;}
var slideEffect=false;if($("#moteur_datePickerDeb").attr("data-slide")=='true'){slideEffect=true;}
var idDivRel='#'+$("#moteur_datePickerDeb").attr("data-divrel");var minDateDefaut="d";var maxDateDefaut="";var maxDateFinDefaut="";var minDateFinDefaut="";if($("#moteur_datePickerDeb").data("mindate")){minDateDefaut=$("#moteur_datePickerDeb").data("mindate");minDateFinDefaut=minDateDefaut;}
if($("#moteur_datePickerFin").data("mindate")){minDateFinDefaut=$("#moteur_datePickerFin").data("mindate");}
if($("#moteur_datePickerDeb").data("maxdate")){maxDateDefaut=$("#moteur_datePickerDeb").data("maxdate");}
if($("#moteur_datePickerFin").data("maxdate")){maxDateFinDefaut=$("#moteur_datePickerFin").data("maxdate");}
if($("#moteur_datePickerDeb").attr("data-formadate")){formatDate=$("#moteur_datePickerDeb").attr("data-formadate");}
jQuery("#moteur_datePickerDeb").datepicker({showOtherMonths:true,selectOtherMonths:true,dateFormat:formatDate,defaultDate:"+1d",numberOfMonths:nbMois,fistDay:1,minDate:minDateDefaut,maxDate:maxDateDefaut,showAnim:"fadeIn",duration:"normal",beforeShow:function(){$('#ui-datepicker-div').addClass('notranslate');$("body").addClass("datepickerOpen");datePicker_gereHover("dateDeb");$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month)").die('mouseover');if(jQuery("#moteurPrincipalDate.dateFinSelected").length==0){jQuery("#label_moteur_datePickerFin_externe").css('opacity','0');}
if(window.moteurInitDatepicker){moteurInitDatepicker();}},onClose:function(){$("body").removeClass("datepickerOpen");if(jQuery("#moteurPrincipalDate.dateDebSelected").length==0||jQuery("#moteurPrincipalDate.dateDebSelected").length==1){if(jQuery("#ui-datepicker-div-copie").length!=0){jQuery('#ui-datepicker-div-copie').remove();}}
if(jQuery('#popinLimitationDatepicker').length!=0){jQuery('#popinLimitationDatepicker').fadeOut(125);}}});console.log(minDateFinDefaut);jQuery("#moteur_datePickerFin").datepicker({showOtherMonths:true,selectOtherMonths:true,dateFormat:formatDate,defaultDate:"+1d",numberOfMonths:nbMois,fistDay:1,minDate:minDateFinDefaut,maxDate:maxDateFinDefaut,showAnim:"",beforeShow:function(){$('#ui-datepicker-div').addClass('notranslate');$("body").addClass("datepickerOpen");datePicker_gereHover("dateFin");if(jQuery("#moteurPrincipalDate.dateSelected").length>0){datepicker_videDateFin();}
if(window.moteurInitDatepicker){moteurInitDatepicker();}},onClose:function(){$("body").removeClass("datepickerOpen");if(jQuery('#label_moteur_datePickerFin_externe').length!=0){jQuery("#label_moteur_datePickerFin_externe").css('opacity','1');}
if(jQuery("#moteurPrincipalDate.dateDebSelected").length>0){if(jQuery("#ui-datepicker-div-copie").length!=0){jQuery('#ui-datepicker-div-copie').remove();}}
if(jQuery('#popinLimitationDatepicker').length!=0){jQuery('#popinLimitationDatepicker').fadeOut(125);}}});$('#moteur_datePickerFin,#moteur_datePickerDeb').datepicker('option','beforeShowDay',function(date){var dateDeb=null;var dateFin=null;var maxDate=null;if($('#moteur_datePickerDeb').val().length>0&&$('#moteur_datePickerDeb').val()!=$('#moteur_datePickerDeb').attr('data-defaut')){dateDeb=new OBJDate($('#moteur_datePickerDeb').val());}
if($('#moteur_datePickerFin').val()&&$('#moteur_datePickerFin').val()!=$('#moteur_datePickerFin').attr('data-defaut')){dateFin=new OBJDate($('#moteur_datePickerFin').val());}
if(!dateFin&&!dateDeb){return[true,'',''];}
var jourIn=date.getDate();jourIn=jourIn.toString();if(jourIn.length<2){jourIn='0'+jourIn;}
var moisIn=date.getMonth()+1;moisIn=moisIn.toString();if(moisIn.length<2){moisIn='0'+moisIn;}
var dateIn=parseFloat(date.getFullYear()+moisIn+jourIn);var classe='';if(dateDeb){if(dateIn===parseFloat(dateDeb.toString('yyyymmdd'))){classe='tdCalendJour_arrivee';}
maxDate=new OBJDate($('#moteur_datePickerDeb').val());maxDate.ajoutJour(28);if(dateIn>parseFloat(maxDate.toString('yyyymmdd'))){classe='tdCalendJour_apresLimite';}}
if(dateFin){if(dateIn===parseFloat(dateFin.toString('yyyymmdd'))){classe='tdCalendJour_depart';}}
if(dateFin&&dateDeb){if(dateIn>parseFloat(dateDeb.toString('yyyymmdd'))&&dateIn<parseFloat(dateFin.toString('yyyymmdd'))){classe='tdCalendJour_periodeRecherchee';}}
var datePlusUn=new Date(date);datePlusUn.setDate(datePlusUn.getDate()+1);if(datePlusUn.getMonth()!==date.getMonth()){classe+=' jourFinMois';}
var dateMoinsUn=new Date(date);dateMoinsUn.setDate(dateMoinsUn.getDate()-1);if(dateMoinsUn.getMonth()!==date.getMonth()){classe+=' jourDebutMois';}
return[true,classe,''];});if(window.moteurInitDatepicker){jQuery(document).on('click','.ui-datepicker-next',function(){moteurInitDatepicker();});}
if(window.moteurInitDatepicker){jQuery(document).on('click','.ui-datepicker-prev',function(){moteurInitDatepicker();});}
if(slideEffect){jQuery(document).on('click','.ui-datepicker-next',function(){$(".ui-datepicker-title").hide('slide',{direction:'left'},125).show('slide',{direction:'right'},125);$(".ui-datepicker-calendar").hide('slide',{direction:'left'},125).show('slide',{direction:'right'},125)});jQuery(document).on('click','.ui-datepicker-prev',function(){$(".ui-datepicker-title").hide('slide',{direction:'right'},125).show('slide',{direction:'left'},125);$(".ui-datepicker-calendar").hide('slide',{direction:'right'},125).show('slide',{direction:'left'},125)});}
if(imgCalDeb.length>0){$("#moteur_datePickerDeb").datepicker("option","buttonImage",imgCalDeb);$("#moteur_datePickerDeb").datepicker("option","buttonImageOnly",true);$("#moteur_datePickerDeb").datepicker("option","showOn","both");$("#moteur_datePickerDeb").datepicker("option","buttonText",imgCalDebText);}
if(imgCalFin.length>0){$("#moteur_datePickerFin").datepicker("option","buttonImage",imgCalFin);$("#moteur_datePickerFin").datepicker("option","buttonImageOnly",true);$("#moteur_datePickerFin").datepicker("option","showOn","both");$("#moteur_datePickerFin").datepicker("option","buttonText",imgCalFinText);}
if($("#moteur_datePickerDeb").val().length>0&&$("#moteur_datePickerDeb").val()!=$("#moteur_datePickerDeb").attr("data-defaut")){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());dateDebut.ajoutJour(1);$("#moteur_datePickerFin").datepicker("option","minDate",dateDebut.toString());if(maxDateDefaut.length==0){var maxDate=new OBJDate($("#moteur_datePickerDeb").val());maxDate.ajoutJour(28);$('#moteur_datePickerFin').datepicker('option','maxDate',maxDate.toString());}}
if($("#moteur_datePickerFin").attr("data-onChange")=="true"){$("#moteur_datePickerFin").datepicker("option","onSelect",function(selectedDate){var dateFin=new OBJDate(selectedDate);var datesValides=false;if($("#label_moteur_datePickerFin_externe").length>0){$("#label_moteur_datePickerFin_externe .jour").html(dateFin.jour);$("#label_moteur_datePickerFin_externe .mois").html(dateFin.getLibelleMois());$("#label_moteur_datePickerFin_externe .annee").html(dateFin.annee);}
if($("#moteur_datePickerDeb").val()!=$("#moteur_datePickerDeb").attr("data-defaut")&&$("#moteur_datePickerDeb").val().length>0){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());if(dateFin.estApresStrictOBJDate(dateDebut)){datesValides=true
if($("#div_moteur_datePickerNbj").length>0){$("#div_moteur_datePickerNbj .duree").html(dateDebut.getNbJourEcartWithOBJDate(dateFin))
$("#div_moteur_datePickerNbj .titre").html($("#div_moteur_datePickerNbj").attr("data-titre"));if(dateDebut.getNbJourEcartWithOBJDate(dateFin)==1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuit"));}
else if(dateDebut.getNbJourEcartWithOBJDate(dateFin)>1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuits"));}}}}
if(datesValides){var url=document.location.href
var nbj=dateDebut.getNbJourEcartWithOBJDate(dateFin);url=getUrlWithLstParam(url,"deb",$("#moteur_datePickerDeb").val());url=getUrlWithLstParam(url,"fin",$("#moteur_datePickerFin").val());url=getUrlWithLstParam(url,"nbj",nbj.toString());url=getUrlWithLstParam(url,"checkdispopartiel",'n');if(typeof foncQdFini_changeMoteurDatePicker==='function'){foncQdFini_changeMoteurDatePicker();}
setCookieEnregistreCritere('deb',$("#moteur_datePickerDeb").val());setCookieEnregistreCritere('fin',$("#moteur_datePickerFin").val());if($('#itea_page_contentListe')&&$('#itea_page_contentListe').attr('data-post')==='true'){refreshListeWithCgi(url+'&'+$('#itea_page_contentListe').attr('data-cgi'));}else{document.location.href=url;moteur_affMessageLoadingMoteur();}}
else{if(!datesValides){$('#moteur_datePickerDeb').datepicker("setDate",dateFin.toString());if($("#label_moteur_datePickerDeb_externe").length>0){$("#label_moteur_datePickerDeb_externe .jour").html(dateFin.jour);$("#label_moteur_datePickerDeb_externe .mois").html(dateFin.getLibelleMoisCourt());$("#label_moteur_datePickerDeb_externe .annee").html(dateFin.annee);}
setTimeout(function(){$('#moteur_datePickerDeb').focus();},0);}}});}
else{$("#moteur_datePickerFin").datepicker("option","onSelect",function(selectedDate){var dateFin=new OBJDate(selectedDate);if($("#label_moteur_datePickerFin_externe").length>0){$("#label_moteur_datePickerFin_externe .jour").html(dateFin.jour);$("#label_moteur_datePickerFin_externe .mois").html(dateFin.getLibelleMoisCourt());$("#label_moteur_datePickerFin_externe .annee").html(dateFin.annee);}
if($("#moteur_datePickerDeb").val().length==0||$("#moteur_datePickerDeb").val()==$("#moteur_datePickerDeb").attr("data-defaut")){$('#moteur_datePickerDeb').datepicker("setDate",dateFin.toString());if(maxDateFinDefaut.length==0){var maxDate=new OBJDate(selectedDate);maxDate.ajoutJour(28);}
$('#moteur_datePickerFin').datepicker('option','maxDate',maxDate.toString());var dateMin=new OBJDate(selectedDate);dateMin.ajoutJour(1);if(minDateFinDefaut.length!=0){var dateMinDefaut=new OBJDate(minDateFinDefaut);if(dateMinDefaut.estApresOBJDate(dateMin)){dateMin=dateMinDefaut;}}
$("#moteur_datePickerFin").datepicker("option","minDate",dateMin.toString());if($("#label_moteur_datePickerDeb_externe").length>0){$("#label_moteur_datePickerDeb_externe .jour").html(dateFin.jour);$("#label_moteur_datePickerDeb_externe .mois").html(dateFin.getLibelleMoisCourt());$("#label_moteur_datePickerDeb_externe .annee").html(dateFin.annee);}
setTimeout(function(){$('#moteur_datePickerDeb').focus();},0);if($("#div_moteur_datePickerCgiNbj").length>0){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());$("#div_moteur_datePickerCgiNbj").attr('value','1');}
if(typeof foncQdFini_changeMoteurDatePicker==='function'){foncQdFini_changeMoteurDatePicker();}
setCookieEnregistreCritere('fin',$("#moteur_datePickerFin").val());}else{if($("#div_moteur_datePickerNbj").length>0){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());$("#div_moteur_datePickerNbj .duree").html(dateDebut.getNbJourEcartWithOBJDate(dateFin))
$("#div_moteur_datePickerNbj .titre").html($("#div_moteur_datePickerNbj").attr("data-titre"));if(dateDebut.getNbJourEcartWithOBJDate(dateFin)==1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuit"));}
else if(dateDebut.getNbJourEcartWithOBJDate(dateFin)>1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuits"));}}
if($("#div_moteur_datePickerCgiNbj").length>0){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());$("#div_moteur_datePickerCgiNbj").attr('value',dateDebut.getNbJourEcartWithOBJDate(dateFin));}}
if($(idDivRel).length>0){if(($("#moteur_datePickerFin").val().length>0&&$("#moteur_datePickerFin").val()!=$("#moteur_datePickerFin").attr("data-defaut"))&&($("#moteur_datePickerDeb").val().length>0&&$("#moteur_datePickerDeb").val()!=$("#moteur_datePickerDeb").attr("data-defaut"))){$(idDivRel).addClass('dateSelected');}
else{$(idDivRel).removeClass('dateSelected');}
if($("#moteur_datePickerFin").val().length>0&&$("#moteur_datePickerFin").val()!=$("#moteur_datePickerFin").attr("data-defaut")){$(idDivRel).addClass('dateFinSelected');}
else{$(idDivRel).removeClass('dateFinSelected');}}});}
if($("#moteur_datePickerDeb").attr("data-onChange")=="true"){$("#moteur_datePickerDeb").datepicker("option","onSelect",function(selectedDate){var dateDebut=new OBJDate(selectedDate);var datesValides=false;if($("#label_moteur_datePickerDeb_externe").length>0){$("#label_moteur_datePickerDeb_externe .jour").html(dateDebut.jour);$("#label_moteur_datePickerDeb_externe .mois").html(dateDebut.getLibelleMoisCourt());$("#label_moteur_datePickerDeb_externe .annee").html(dateDebut.annee);}
if($("#moteur_datePickerFin").val()!=$("#moteur_datePickerFin").attr("data-defaut")&&$("#moteur_datePickerFin").val().length>0){var dateFin=new OBJDate($("#moteur_datePickerFin").val());if(dateFin.estApresStrictOBJDate(dateDebut)&&dateFin.getNbJourEcartWithOBJDate(dateDebut)<=28){datesValides=true}}
if(datesValides){var url=document.location.href;var nbj=dateDebut.getNbJourEcartWithOBJDate(dateFin);url=getUrlWithLstParam(url,"deb",$("#moteur_datePickerDeb").val());url=getUrlWithLstParam(url,"fin",$("#moteur_datePickerFin").val());url=getUrlWithLstParam(url,"nbj",nbj.toString());url=getUrlWithLstParam(url,"checkdispopartiel",'n');if(typeof foncQdFini_changeMoteurDatePicker==='function'){foncQdFini_changeMoteurDatePicker();}
setCookieEnregistreCritere('deb',$("#moteur_datePickerDeb").val());setCookieEnregistreCritere('fin',$("#moteur_datePickerFin").val());document.location.href=url;moteur_affMessageLoadingMoteur();}
else{dateDebut.ajoutJour(1);$("#moteur_datePickerFin").datepicker("option","minDate",dateDebut.toString());$('#moteur_datePickerFin').datepicker("setDate",dateDebut.toString());var maxDate=new OBJDate(selectedDate);maxDate.ajoutJour(28);$('#moteur_datePickerFin').datepicker('option','maxDate',maxDate.toString());if($("#label_moteur_datePickerFin_externe").length>0&&ajoutJourAuto){$("#label_moteur_datePickerFin_externe .jour").html(dateDebut.jour);$("#label_moteur_datePickerFin_externe .mois").html(dateDebut.getLibelleMoisCourt());$("#label_moteur_datePickerFin_externe .annee").html(dateDebut.annee);}
setTimeout(function(){$('#moteur_datePickerFin').focus();},0);}});}
else{$("#moteur_datePickerDeb").datepicker("option","onSelect",function(selectedDate){var dateDebut=new OBJDate(selectedDate);var datesValides=false;datepicker_videDateFin();if($("#label_moteur_datePickerDeb_externe").length>0){$("#label_moteur_datePickerDeb_externe .jour").html(dateDebut.jour);$("#label_moteur_datePickerDeb_externe .mois").html(dateDebut.getLibelleMoisCourt());$("#label_moteur_datePickerDeb_externe .annee").html(dateDebut.annee);}
if($("#moteur_datePickerFin").val().length!=0&&$("#moteur_datePickerFin").val()!=$("#moteur_datePickerFin").attr("data-defaut")){var dateFin=new OBJDate($("#moteur_datePickerFin").val());if(dateFin.estApresStrictOBJDate(dateDebut)&&dateFin.getNbJourEcartWithOBJDate(dateDebut)<=28){datesValides=true;setCookieEnregistreCritere('deb',$("#moteur_datePickerDeb").val());if($("#div_moteur_datePickerNbj").length>0){$("#div_moteur_datePickerNbj .duree").html(dateDebut.getNbJourEcartWithOBJDate(dateFin))
$("#div_moteur_datePickerNbj .titre").html($("#div_moteur_datePickerNbj").attr("data-titre"));if(dateDebut.getNbJourEcartWithOBJDate(dateFin)==1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuit"));}
else if(dateDebut.getNbJourEcartWithOBJDate(dateFin)>1){$("#div_moteur_datePickerNbj .libelle").html($("#div_moteur_datePickerNbj").attr("data-nuits"));}}}
if($("#div_moteur_datePickerCgiNbj").length>0){var dateDebut=new OBJDate($("#moteur_datePickerDeb").val());if(ajoutJourAuto){$("#div_moteur_datePickerCgiNbj").attr('value','1');}}}
var nbAjoutJourPourMinFin=1;if($("#moteur_datePickerDeb").attr("data-ajoutjourdebpourminfin").length>0){nbAjoutJourPourMinFin=parseInt($("#moteur_datePickerDeb").attr("data-ajoutjourdebpourminfin"));}
dateDebut.ajoutJour(nbAjoutJourPourMinFin);if(minDateFinDefaut.length!=0){var dateMinDefaut=new OBJDate(minDateFinDefaut);if(dateMinDefaut.estApresOBJDate(dateDebut)){dateDebut=dateMinDefaut;}}
$("#moteur_datePickerFin").datepicker("option","minDate",dateDebut.toString());if(!datesValides){if(maxDateFinDefaut.length==0){var maxDate=new OBJDate(selectedDate);maxDate.ajoutJour(28);$('#moteur_datePickerFin').datepicker('option','maxDate',maxDate.toString());}
if($("#label_moteur_datePickerFin_externe").length>0&&ajoutJourAuto){$("#label_moteur_datePickerFin_externe .jour").html(dateDebut.jour);$("#label_moteur_datePickerFin_externe .mois").html(dateDebut.getLibelleMoisCourt());$("#label_moteur_datePickerFin_externe .annee").html(dateDebut.annee);}
setTimeout(function(){if(window.ajouterFondDatepicker){ajouterFondDatepicker();}
if(window.initPopinLimitations){initPopinLimitations();}
$('#moteur_datePickerFin').focus();},0);}
else{setTimeout(function(){if(window.ajouterFondDatepicker){ajouterFondDatepicker();}
$('#moteur_datePickerFin').focus();},0);}
if($("#div_moteur_datePickerNbj").length>0){$("#div_moteur_datePickerNbj .duree").html('1');}
if($(idDivRel).length>0){if(($("#moteur_datePickerFin").val().length>0&&$("#moteur_datePickerFin").val()!=$("#moteur_datePickerFin").attr("data-defaut"))&&($("#moteur_datePickerDeb").val().length>0&&$("#moteur_datePickerDeb").val()!=$("#moteur_datePickerDeb").attr("data-defaut"))){$(idDivRel).addClass('dateSelected');}
else{$(idDivRel).removeClass('dateSelected');}
if($("#moteur_datePickerDeb").val().length>0&&$("#moteur_datePickerDeb").val()!=$("#moteur_datePickerDeb").attr("data-defaut")){$(idDivRel).addClass('dateDebSelected');}
else{$(idDivRel).removeClass('dateDebSelected');}}});}})(jQuery);}
if($("moteur_divRechercheExpress")){$("moteur_inptRechercheExpress").onfocus=function(evt){$("moteur_inptRechercheExpress").value="";if($("inpt_referenceHidden")){$("inpt_referenceHidden").value="";}};var type=$("moteur_inptRechercheExpress").getAttribute("data-type");var dpt="";if($("moteur_inptRechercheExpress").getAttribute("data-depfiltre")){dpt=$("moteur_inptRechercheExpress").getAttribute("data-depfiltre");}
var libelleDansAutoCompleteur='';if($("moteur_inptRechercheExpress").getAttribute("data-libelleDansAutoCompleteur")){libelleDansAutoCompleteur='false';}
var gestprod=false;if(jQuery('#moteur_divRechercheExpress').attr('data-gestprod')==="true"){gestprod=true;}
setAutoCompleterByRef("moteur_inptRechercheExpress","moteur_divLieuAutoCompleteReference",type,'',dpt,libelleDansAutoCompleteur,gestprod);if(jQuery('#moteur_divRechercheExpress input[name="linkToFiche"]').length>0){var evenementSubmitSur='#moteur_divRechercheExpress form';if(jQuery(evenementSubmitSur).length==0){evenementSubmitSur=jQuery('#moteur_divRechercheExpress').closest('form');}
if(jQuery(evenementSubmitSur).length>0){jQuery(evenementSubmitSur).submit(function(event){var ident=jQuery('#inpt_referenceHidden').val()||false;if(ident){event.preventDefault;jQuery.ajax({dataType:"json",url:'/lib_2/ajax/infosDist.php',data:{INFO:'getLinkToFiche',ident:ident},async:false,success:function(data){var link=data.link||false;if(link){document.location.href=link;}}});return false;}});}}}
if(jQuery("#moteur_selectAmbiance").length>0&&jQuery("#inpt_envieDe").length>0){jQuery("#moteur_selectAmbiance").change(function(){jQuery("#inpt_envieDe").attr("name",jQuery("#moteur_selectAmbiance").val());jQuery("#inpt_envieDe").val("o");});}
if(jQuery(".sp_nbResult").length>0){setNbResultByCgi("sp_nbResult");}
if(jQuery(".span_elemSimuleListe").length>0){jQuery(".span_elemSimuleListe").bind("click",function(){var input=jQuery(this).attr("data-input");var value=jQuery(this).attr("data-value");jQuery("#"+input).attr("value",value);jQuery(this).parents(".moteur_ulSimuleListe").prev().children(".moteur_spanValueSimuleListe").text(value);jQuery(this).parents(".moteur_ulSimuleListe").hide();});}
if(jQuery(".moteur_divSimuleListeContent").length>0){jQuery(".moteur_divSimuleListeContent").toggle(function(){jQuery(this).siblings(".moteur_ulSimuleListe").show();},function(){jQuery(this).siblings(".moteur_ulSimuleListe").hide();});}
if(jQuery(".a_choixTypeFede").length>0){jQuery(".a_choixTypeFede").click(function(){if(jQuery(this).next().is(":hidden")){jQuery(this).next().show();}});}
if($("moteur_inptRechercheMutli")){$("moteur_inptRechercheMutli").onfocus=function(evt){jQuery('.ui-drp-fade').click();if(!$('moteur_divRechercheMultiSansLien')){return;}
var previousSearch=getPreviousSearch();if(!previousSearch instanceof Array||previousSearch.length==0){return;}
var voyageur='';var voyageurs='';var recherchesRecentes='';var result;if(sessionStorage['getMotsClesHistorique']!==undefined){result=JSON.parse(sessionStorage['getMotsClesHistorique']);}else{jQuery.ajax({url:'/lib_2/ajax/infosCGI.php',type:'POST',dataType:'json',async:false,data:{typeInfo:'getMotsClesHistorique'},success:function(r){sessionStorage.setItem('getMotsClesHistorique',JSON.stringify(r));result=r;}});}
voyageur=result.voyageur;voyageurs=result.voyageurs;recherchesRecentes=result.recherchesRecentes;jQuery('#moteur_divMultiAutoComplete').hide();var htmlHistorique='<div class="historique">'+'<p class="categorie">'+recherchesRecentes+'</p>'+'<ul class="itea_ul">';var selected='selected';for(var i=0;i<previousSearch.length;i++){var datePassees=false;var tabCrit=previousSearch[i].split('&');console.log('previousSearch tabCrit:',tabCrit);if(tabCrit.indexOf('lieucgi=')>0&&tabCrit.indexOf('deb=')>0){continue;}
var tabInfo=new Object();for(var j=0;j<tabCrit.length;j++){var couple=tabCrit[j].split('=');var key=couple[0];var value=couple[1];if(key==='lieucgi'){tabInfo.valreel=decodeURIComponent(decodeURIComponent(value)).replace(/\+/g,' ');}else if(key==='lno'){if(tabInfo.ref===''||tabInfo.ref===undefined){tabInfo.ref=value;}}else if(jQuery.inArray(key,['INSEE','DEP','REGION_ADM','REGION_SUP','INFOTOURFD','INFOTOUR'])!==-1){tabInfo.cgi=key;tabInfo.valcgi=value;}else if(key==='lnoident'){if(tabInfo.lnoident===''||tabInfo.lnoident===undefined){tabInfo.lnoident=value;}}else if(key==='deb'){var objDateDeb=new OBJDate(decodeURIComponent(decodeURIComponent(value)));var today=new OBJDate();if(objDateDeb.estAvant(today.toString())&&!objDateDeb.estEgale(today.toString())){datePassees=true;}
tabInfo.dateDeb=value;}else if(key==='fin'){var objDateFin=new OBJDate(decodeURIComponent(decodeURIComponent(value)));tabInfo.dateFin=value;}else if(key==='nbp_min'){tabInfo.nbPers=value;}else if(key==='urlListe'){tabInfo.url=value;}else if(key==='input-drp-arrival-name'){tabInfo.stringArrivee=decodeURIComponent(value.replace(/\+/g,' '));}else if(key==='input-drp-departure-name'){tabInfo.stringDepart=decodeURIComponent(value.replace(/\+/g,' '));;}else if(key==='longitude'){tabInfo.longitude=value;tabInfo.cgi='VILLE_ETRANGER';}else if(key==='latitude'){tabInfo.latitude=value;}}
if(datePassees){tabInfo.dateDeb='';tabInfo.dateFin='';tabInfo.stringArrivee='';tabInfo.stringDepart='';}
if(tabInfo.ref===undefined&&tabInfo.valreel===undefined&&tabInfo.dateDeb===undefined&&tabInfo.dateFin===undefined){continue;}else if(tabInfo.ref===undefined&&tabInfo.dateDeb===''&&tabInfo.dateFin===''&&tabInfo.nbPers==='n'){continue;}
htmlHistorique+="<li nbp_min='"+tabInfo.nbPers+"' deb='"+tabInfo.dateDeb+"' fin='"+tabInfo.dateFin+"' stringArrivee='"+tabInfo.stringArrivee+"' stringDepart='"+tabInfo.stringDepart+"' class='"+selected+"' onclick='fillInputsHistoriqueMoteurMulti(this);' data-numLi='"+parseInt(i+1)+"' data-url ='"+tabInfo.url+"' ";if(typeof tabInfo.valreel!=='undefined'&&tabInfo.valreel!==""&&tabInfo.valreel!=="undefined"){htmlHistorique+=' valreel="'+tabInfo.valreel+'"';if(typeof tabInfo.cgi!=='undefined'&&tabInfo.cgi!==""){htmlHistorique+=' cgi="'+decodeURIComponent(decodeURIComponent(tabInfo.cgi))+'" val_cgi="'+tabInfo.valcgi+'" ';}else if(typeof tabInfo.lnoident!=='undefined'&&tabInfo.lnoident!==""){htmlHistorique+=' lnoident="'+tabInfo.lnoident+'"';}}else if(typeof tabInfo.ref!=='undefined'&&tabInfo.ref!==""&&tabInfo.ref!=="undefined"){htmlHistorique+=' ref="'+tabInfo.ref+'" lnoident="'+tabInfo.lnoident+'" ';}
if(typeof tabInfo.longitude!=='undefined'&&typeof tabInfo.latitude!=='undefined'){htmlHistorique+=' data-longitude="'+tabInfo.longitude+'" data-latitude="'+tabInfo.latitude+'"';}
htmlHistorique+=' >';htmlHistorique+='<span class="lieu">';if(tabInfo.valreel!==undefined&&tabInfo.valreel!==""&&tabInfo.valreel!=="undefined"){htmlHistorique+=tabInfo.valreel;}else if(typeof tabInfo.ref!=='undefined'&&tabInfo.ref!==""&&tabInfo.ref!=="undefined"){htmlHistorique+=tabInfo.ref;}
htmlHistorique+='</span>';htmlHistorique+='<span class="dates"> ';if((tabInfo.dateDeb!==undefined&&tabInfo.dateDeb!=="")||(tabInfo.dateFin!==undefined&&tabInfo.dateFin!=="")){if(tabInfo.dateDeb!==undefined&&tabInfo.dateDeb!==""&&tabInfo.stringArrivee!==undefined&&tabInfo.stringArrivee!==""){htmlHistorique+='<span class="dateTxt">'+tabInfo.stringArrivee+'</span>';htmlHistorique+='<span class="dateFormatDate" style="display:none">'+objDateDeb.toString('dd.mm.yy')+'</span>';if(tabInfo.dateFin!==undefined&&tabInfo.dateFin!==""&&tabInfo.stringDepart!==undefined&&tabInfo.stringDepart!==""){htmlHistorique+=' - ';}}
if(tabInfo.dateFin!==undefined&&tabInfo.dateFin!==""&&tabInfo.stringDepart!==undefined&&tabInfo.stringDepart!==""){htmlHistorique+='<span class="dateTxt">'+tabInfo.stringDepart+'</span>';htmlHistorique+='<span class="dateFormatDate" style="display:none">'+objDateFin.toString('dd.mm.yy')+'</span>';}}
htmlHistorique+='</span>';htmlHistorique+='<span class="voyageurs">';if(tabInfo.nbPers!==undefined&&tabInfo.nbPers!==""&&tabInfo.nbPers!=="n"&&parseInt(tabInfo.nbPers)>0){htmlHistorique+=tabInfo.nbPers;if(parseInt(tabInfo.nbPers)>1){htmlHistorique+=' '+voyageurs;}else{htmlHistorique+=' '+voyageur;}}
htmlHistorique+='</span>';htmlHistorique+='</li>';if(selected==="selected"){selected="";}}
htmlHistorique+='</ul>';htmlHistorique+='</div>';jQuery('#moteur_divMultiAutoComplete').html(htmlHistorique);(function($){var divChampChoix='moteur_divMultiAutoComplete';var moteur=$('#moteur_divMultiAutoComplete');var li=$('#'+divChampChoix+' ul>li');var liSelected=$('#'+divChampChoix+' ul').find('.selected');var next,nextNum;$(window).keydown(function(e){if(e.which===40){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))+1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.eq(0).addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===38){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))-1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.last().addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===13){if($('#'+divChampChoix).is(':visible')){e.preventDefault();$('#'+divChampChoix+' ul').find('.selected').click();return false;}}
else if(e.which===9){if($('#'+divChampChoix).is(':visible')){$('#'+divChampChoix+' ul').find('.selected').click();}}});li.on('mouseenter',function(e){e.preventDefault();li.removeClass('selected');$(this).addClass('selected');});})(jQuery);jQuery('#moteur_divMultiAutoComplete').show();};var zone="init";jQuery(".moteurMultiCritere").each(function(){jQuery(this).bind("click",function(){zone="init";})
jQuery(this).on("touchstart",function(){zone="init";})});jQuery("body").bind("click",function(){if(zone!="init"){if(jQuery('#moteur_divMultiAutoComplete').is(":visible")){clickOut_moteur_inptRechercheMutli();zone="init";}}
else{zone="out";}});jQuery("body").on("touchstart",function(){if(zone!="init"){if(jQuery('#moteur_divMultiAutoComplete').is(":visible")){clickOut_moteur_inptRechercheMutli();jQuery('#moteur_inptRechercheMutli').blur();zone="init";}}
else{zone="out";}});jQuery('#moteur_inptRechercheMutli').closest('form').on('submit',function(){var chaine=jQuery(this).serialize();if((jQuery("#moteur_inptRechercheMutli").attr('name')==='lieucgi'&&jQuery("#moteur_inptRechercheMutliHidden").attr('name')==='lnoident')||(jQuery("#moteur_inptRechercheMutli").attr('name')==='lieucgi'&&jQuery('input[name="longitude"]').length>0&&jQuery('input[name="latitude"]').length>0)){jQuery("#moteur_inptRechercheMutli").attr("name","");}
setPreviousSearch(chaine);});$("moteur_inptRechercheMutli").onblur=function(evt){if($("moteur_inptRechercheMutli").value===""){$("moteur_inptRechercheMutliHidden").value="";}};$("moteur_inptRechercheMutli").on("input",function(){console.log('moteur_initMoteurCommun input '+jQuery('#moteur_inptRechercheMutli').val());if(_timerPourMoteurLieu!==undefined){try{console.log('moteur_initMoteurCommun input clearTimeout _timerPourMoteurLieu');clearTimeout(_timerPourMoteurLieu);}catch(error){console.log('moteur_initMoteurCommun input error clearTimeout');}}
var avecLien='true';var idDivMoteur='#moteur_divRechercheMulti';if($('moteur_divRechercheMultiSansLien')){avecLien='false';idDivMoteur='#moteur_divRechercheMultiSansLien';}
if(jQuery("#moteur_inptRechercheMutli").val()==''){jQuery("#moteur_inptRechercheMutliHidden").val('');jQuery("#moteur_inptRechercheMutliHidden").attr('name','');}
var priseEnCompteCrits=true;if(jQuery(idDivMoteur).attr("data-priseEnCompteCriteres")==="false"){priseEnCompteCrits=false;}
var avecinfostour=true;if(jQuery(idDivMoteur).attr("data-avecinfostour")==="false"){avecinfostour=false;}
var avecInseeAffiche=false;if(jQuery(idDivMoteur).data('avec-insee-affiche')===true){avecInseeAffiche=true;}
var dpt="";if($("moteur_inptRechercheMutli").getAttribute("data-depfiltre")){dpt=$("moteur_inptRechercheExpress").getAttribute("data-depfiltre");}
var libelleDansAutoCompleteur='';if($("moteur_inptRechercheMutli").getAttribute("data-libelleDansAutoCompleteur")){libelleDansAutoCompleteur='false';}
var gestprod=false;if(jQuery(idDivMoteur).attr('data-gestprod')==="true"){gestprod=true;}
var avecRegion=true;if(jQuery(idDivMoteur).attr('data-avecRegion')==="false"){avecRegion=false;}
var avecDep=true;if(jQuery(idDivMoteur).attr('data-avecDep')==="false"){avecDep=false;}
var avecMicroRegion=false;if(jQuery(idDivMoteur).attr('data-avecMicroRegion')==="true"){avecMicroRegion=true;}
var nbCommunesAffiche=3;if(parseInt(jQuery(idDivMoteur).attr('data-nbCommunesAffiche'))>0){nbCommunesAffiche=parseInt(jQuery(idDivMoteur).attr('data-nbCommunesAffiche'));}
var text=jQuery("#moteur_inptRechercheMutli").val();if(text.match('^[0-9a-zA-Z]+[0-9]$')!==null){jQuery("#moteur_inptRechercheMutli").attr('name','lno');}else{jQuery("#moteur_inptRechercheMutli").attr('name','lieucgi');}
_timerPourMoteurLieu=setTimeout(function(){console.log('moteur_initMoteurCommun setAutocompleteForRechercheMulti input:'+jQuery('#moteur_inptRechercheMutli').val());setAutocompleteForRechercheMulti('moteur_inptRechercheMutli','moteur_divMultiAutoComplete','',dpt,libelleDansAutoCompleteur,gestprod,priseEnCompteCrits,avecinfostour,avecInseeAffiche,avecLien,avecRegion,avecDep,avecMicroRegion,nbCommunesAffiche);},200);});jQuery("#moteur_divRechercheMulti, #moteur_divRechercheMultiSansLien").mouseleave(function(){jQuery("#moteur_divMultiAutoComplete li").removeClass('selected');});}
if(jQuery('#divConteneur_dateRangePicker').length>0){initDivDateRangePicker();}
if(jQuery('#moteurCapaciteAdultesEtEnfants').length>0){initMoteur_capacite_adultesEtEnfants();}
if(jQuery('#moteur_divRechercheMultiParApi').length>0){initMoteurMultiApi();}}
function clickOut_moteur_inptRechercheMutli(){if(jQuery('#moteur_divMultiAutoComplete .conteneurAutoCompleteur').length>0){if(jQuery(jQuery('#moteur_divMultiAutoComplete .conteneurAutoCompleteur li')[0]).find('a').length==0){jQuery('#moteur_divMultiAutoComplete .conteneurAutoCompleteur li')[0].click();}else{jQuery('#moteur_inptRechercheMutli').val('');jQuery('#moteur_inptRechercheMutli').attr('data-valeursaisie','');}}
jQuery('#moteur_divMultiAutoComplete').hide();}
function moteur_initBoutonsAfficheMasqueCriteres(){if(jQuery(".moteur_afficheMasqueCriteres").length>0){jQuery(".moteur_afficheMasqueCriteres").each(function(){var ul=jQuery(this).attr("data-ul");var nbAffiche=parseInt(jQuery(this).attr("data-nbaffiche"));var count=1;if(localStorage&&localStorage[ul]=="open"){jQuery(this).html(jQuery(this).attr("data-lblMasque"));jQuery("#"+ul).children("li:visible").each(function(){if(count>nbAffiche){jQuery(this).addClass("elemAreafficher");}
count++;});}
else{jQuery("#"+ul).children("li:visible").each(function(){if(count>nbAffiche){jQuery(this).css("display","none");jQuery(this).addClass("elemAreafficher");}
count++;});}
count--;if(count<=nbAffiche){jQuery(this).css("display","none");}
else{if(localStorage&&localStorage[ul]=="open"){jQuery(this).toggle(function(){jQuery("#"+ul).children(".elemAreafficher").css("display","none");jQuery(this).html(jQuery(this).attr("data-lblAffiche"));if(localStorage){localStorage[ul]="close";}},function(){jQuery("#"+ul).children(".elemAreafficher").css("display","");jQuery(this).html(jQuery(this).attr("data-lblMasque"));if(localStorage){localStorage[ul]="open";}});}
else{jQuery(this).toggle(function(){jQuery("#"+ul).children(".elemAreafficher").css("display","");jQuery(this).html(jQuery(this).attr("data-lblMasque"));if(localStorage){localStorage[ul]="open";}},function(){jQuery("#"+ul).children(".elemAreafficher").css("display","none");jQuery(this).html(jQuery(this).attr("data-lblAffiche"));if(localStorage){localStorage[ul]="close";}});}}});}}
function moteur_affMessageLoadingMoteur(){if($("bodyPage")){$("bodyPage").scrollTo();var txt='<div class="loaderMoteur"><div><div class="cp-spinnerLoader cp-ballsLoader"></div></div></div>';if(jQuery(".hideMeWhenReload").length>0){jQuery.each(jQuery(".hideMeWhenReload"),function(){affMsgAttenteParDessusInDiv(jQuery(this).attr('id'),"moteur",txt);});}else affMsgAttenteParDessusInDiv("bodyPage","moteur",txt);}}
function moteur_clicCalendDateDeb(evt,jour,mois,annee,etat,jrSemaine){if($("moteur_imiteCheckBoxPasDate")&&$("moteur_imiteCheckBoxPasDate").hasClassName("moteur_imitecheckbox_on")){$("moteur_imiteCheckBoxPasDate").addClassName("moteur_imitecheckbox_off");$("moteur_imiteCheckBoxPasDate").removeClassName("moteur_imitecheckbox_on");}
if($("moteur_imiteCheckBoxPasDate")&&$("moteur_imiteCheckBoxPasDate").hasClassName("moteur_imitecheckbox_off")){$("moteur_imiteCheckBoxPasDate").addClassName("moteur_imitecheckbox_on");$("moteur_imiteCheckBoxPasDate").removeClassName("moteur_imitecheckbox_off");}
if($("moteur_inptDateDeb"))$("moteur_inptDateDeb").value=jour+"/"+mois+"/"+annee;if($('moteur_divCalendrierDebut'))jQuery('#moteur_divCalendrierDebut').hide('fast');}
function moteur_clicCalendDateDebut(evt,jour,mois,annee,etat,jrSemaine){if(jQuery("#moteur_CalenddateDeb").length>0){jQuery("#moteur_CalenddateDeb").val(jour+"/"+mois+"/"+annee);var duree="";if(jQuery("#moteur_CalenddateDeb").attr("data-duree"))duree=jQuery("#moteur_CalenddateDeb").attr("data-duree");else duree="7";var ObjDateDeb=new OBJDate(jour+"/"+mois+"/"+annee);ObjDateDeb.ajoutJour(duree);jQuery("#moteur_CalenddateFin").addClass("active").val(ObjDateDeb.toString());}
if(jQuery('#moteur_calendrierDebMoteur').length>0)jQuery('#moteur_calendrierDebMoteur').fadeOut();if(jQuery("#moteur_CalenddateDebOnChange").length>0){jQuery("#moteur_CalenddateDebOnChange").attr('value',jour+"/"+mois+"/"+annee);if(jQuery("#moteur_CalenddateFinOnChange").val()==jQuery("#moteur_CalenddateFinOnChange").attr('data-defaut')||jQuery("#moteur_CalenddateFinOnChange").val()==""){var ObjDateDeb=new OBJDate(jour+"/"+mois+"/"+annee);var duree="";if(jQuery("#moteur_CalenddateDebOnChange").attr("data-duree"))duree=jQuery("#moteur_CalenddateDebOnChange").attr("data-duree");else duree="7";ObjDateDeb.ajoutJour(duree);jQuery("#moteur_CalenddateFinOnChange").attr('value',ObjDateDeb.toString());}
var url=document.location.href
if(jQuery("#moteur_inptUrlListe").length>0&&jQuery("#moteur_inptUrlListe").val())url+=jQuery("#moteur_inptUrlListe").val();url=getUrlWithLstParam(url,jQuery("#moteur_CalenddateDebOnChange").attr("name"),jour+"/"+mois+"/"+annee);url=getUrlWithLstParam(url,jQuery("#moteur_CalenddateFinOnChange").attr("name"),jQuery("#moteur_CalenddateFinOnChange").attr("value"));document.location.href=url;moteur_affMessageLoadingMoteur();}}
function moteur_clicCalendDateFin(evt,jour,mois,annee,etat,jrSemaine){if(jQuery("#moteur_CalenddateFin").length>0)jQuery("#moteur_CalenddateFin").val(jour+"/"+mois+"/"+annee);if(jQuery("#moteur_calendrierFinMoteur").length>0)jQuery("#moteur_calendrierFinMoteur").fadeOut();if(jQuery("#moteur_CalenddateFinOnChange").length>0){jQuery("#moteur_CalenddateFinOnChange").attr('value',jour+"/"+mois+"/"+annee);if(jQuery("#moteur_CalenddateDebOnChange").attr('value')==jQuery("#moteur_CalenddateDebOnChange").attr('data-defaut')){var ObjDateDeb=new OBJDate(jour+"/"+mois+"/"+annee);var duree="";if(jQuery("#moteur_CalenddateDebOnChange").attr("data-duree"))duree=jQuery("#moteur_CalenddateDebOnChange").attr("data-duree");else duree="7";ObjDateDeb.enleveJour(duree);jQuery("#moteur_CalenddateDebOnChange").attr('value',ObjDateDeb.toString());}
var url=document.location.href
if(jQuery("#moteur_inptUrlListe").length>0&&jQuery("#moteur_inptUrlListe").val())url+=jQuery("#moteur_inptUrlListe").val();url=getUrlWithLstParam(url,jQuery("#moteur_CalenddateFinOnChange").attr("name"),jour+"/"+mois+"/"+annee);url=getUrlWithLstParam(url,jQuery("#moteur_CalenddateDebOnChange").attr("name"),jQuery("#moteur_CalenddateDebOnChange").attr("value"));document.location.href=url;moteur_affMessageLoadingMoteur();}}
function setListeByRefSelect(li){jQuery("#moteur_inptRechercheExpress").val(jQuery(li).attr("ref"));if(jQuery("#inpt_referenceHidden").length>0){jQuery("#inpt_referenceHidden").val(jQuery(li).attr("ident"));}
jQuery("form input, form select").not("[type=submit]").each(function(){if(jQuery(this).attr("id")!="moteur_inptRechercheExpress"&&jQuery(this).attr("id")!="inpt_referenceHidden"){jQuery(this).val("");}});}
function setAutocompleteForRechercheMulti(idChampSaisie,divChampChoix,communeDansAutoComplet,departements,libelleDansAutoCompleteur,gestprod,priseEnCompteCrits,avecinfostour,avecInseeAffiche,avecLien,avecRegion,avecDep,avecMicroRegion,nbCommunesAffiche){(function($){if(typeof(priseEnCompteCrits)==="undefined")priseEnCompteCrits=true;if(typeof(avecinfostour)==="undefined")avecinfostour=true;if(typeof(avecInseeAffiche)==="undefined")avecInseeAffiche=false;if(typeof(avecRegion)==="undefined")avecRegion=true;if(typeof(avecDep)==="undefined")avecDep=true;if(typeof(avecMicroRegion)==="undefined")avecMicroRegion=false;if(typeof(nbCommunesAffiche)==="undefined")nbCommunesAffiche=3;var url="/lib_2/ajax/infosCGI.php";var valInput=$('#'+idChampSaisie).val();var moteur=$('#'+divChampChoix);if(valInput.length===0){moteur.empty();moteur.hide();return;}
var data={departements:departements,valInput:valInput,typeInfo:'AUTOCOMPLETEMULTI',avecRegion:avecRegion,avecDep:avecDep,avecMicroRegion:avecMicroRegion,nbCommunesAffiche:nbCommunesAffiche,RETURNLNKTOFICHE:true,avecinfostour:avecinfostour};if(communeDansAutoComplet){data={affComm:true};}
if(libelleDansAutoCompleteur){data={libelleDansAutoCompleteur:false};}
if(gestprod){data={RETURNREFGESTPROD:true};}
if(avecLien==='false'){data.TYPEREPONSE='JS';}
if(_reqAjaxMoteur!==undefined){try{_reqAjaxMoteur.abord();}catch(error){console.log('setAutocompleteForRechercheMulti error abord');}}
_reqAjaxMoteur=$.ajax({url:url,type:'GET',data:data,beforeSend:function(){if(moteur.find('li').length===0){moteur.hide();}},success:function(rep){moteur.empty();moteur.append('<div class="conteneurAutoCompleteur">'+rep+'</div>');if(window.moteurInitAutoCompletMultiple){moteurInitAutoCompletMultiple();}
$('#'+divChampChoix+' ul>li').each(function(){$(this).attr('onClick','onClickLiMoteurAutoCompleteMulti(this,'+avecLien+')');});if(rep.length>0){moteur.show();}
else{moteur.hide();}
var li=$('#'+divChampChoix+' ul>li');var liSelected=$('#'+divChampChoix+' ul').find('.selected');$(window).keydown(function(e){if(e.which===40){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))+1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.eq(0).addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===38){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))-1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.last().addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===13){if($('#'+divChampChoix).is(':visible')){e.preventDefault();$('#'+divChampChoix+' ul').find('.selected').trigger('click');return false;}}
else if(e.which===9){if($('#'+divChampChoix).is(':visible')){$('#'+divChampChoix+' ul').find('.selected').trigger('click');}}});li.on('mouseenter',function(e){e.preventDefault();li.removeClass('selected');$(this).addClass('selected');});}});})(jQuery);}
function fillInputMoteurRechercheMulti(element){(function($){$('#moteur_inptLong').attr('name','');$('#moteur_inptLat').attr('name','');$('#moteur_inptRayon').attr('name','');if(typeof $(element).attr('ref')!=='undefined'){$('#moteur_inptRechercheMutli').val($(element).attr('ref'));var ident=$(element).attr("ident");$("#moteur_inptRechercheMutliHidden").attr("name","lnoident");$("#moteur_inptRechercheMutliHidden").attr("value",ident);}else{$('#moteur_inptRechercheMutli').val($(element).attr('valreel'));var cgi=$(element).attr("cgi");if(cgi==='VILLE_ETRANGER'){$('#moteur_inptLong').attr('name','longitude');$('#moteur_inptLong').val($(element).data('longitude'));$('#moteur_inptLat').attr('name','latitude');$('#moteur_inptLat').val($(element).data('latitude'));$('#moteur_inptRayon').attr('name','rayon');$('#moteur_inptRayon').val('20');}else if(typeof cgi!=='undefined'){var val_cgi=$(element).attr("val_cgi");$("#moteur_inptRechercheMutliHidden").attr("name",cgi);$("#moteur_inptRechercheMutliHidden").attr("value",val_cgi);}else{var ident=$(element).attr("ident");$("#moteur_inptRechercheMutliHidden").attr("name","lnoident");$("#moteur_inptRechercheMutliHidden").attr("value",ident);}}
if($(element).attr('data-url').length>0){var url=$(element).attr('data-url');if(url.split('.').pop().length===0||(url.split('.').pop()!=='html'&&url.split('.').pop()!=='php')){url+='.html';}
if(url.substring(0,1)!=='/'){url='/'+url;}
$('#moteur_inptRechercheMutli').parents('form').attr('action',url);$('#urlListeHidden').val($(element).attr('data-url'));}
$('#moteur_divMultiAutoComplete').hide();})(jQuery);}
function getPreviousSearch(){var pastSearches=[];if(window.localStorage["pastSearches"]){pastSearches=JSON.parse(window.localStorage["pastSearches"]);}
return pastSearches;}
function setPreviousSearch(chaine){var pastSearches=[];if(window.localStorage["pastSearches"]){pastSearches=JSON.parse(localStorage["pastSearches"]);for(var i=0;i<pastSearches.length;i++){if(chaine===pastSearches[i]){return;}}}
pastSearches.unshift(chaine);if(pastSearches.length>5){pastSearches.pop();}
window.localStorage["pastSearches"]=JSON.stringify(pastSearches);}
function fillInputsHistoriqueMoteurMulti(element){(function($){if(typeof $(element).attr('valreel')!=='undefined'){var lieu=$(element).attr('valreel');var cgi=$(element).attr('cgi');var valcgi=$(element).attr('val_cgi');}else if(typeof $(element).attr('ref')!=='undefined'){var ref=$(element).attr('ref');}
var lnoident=$(element).attr('lnoident');var nbPers=$(element).attr('nbp_min');var deb=$(element).attr('deb');var fin=$(element).attr('fin');var stringArrivee=$(element).attr('stringArrivee');var stringDepart=$(element).attr('stringDepart');var url=$(element).attr('data-url');var valDefaut=jQuery('#moteur_inptRechercheMutli').attr('data-defaut');$('#moteur_inptLong').attr('name','');$('#moteur_inptLat').attr('name','');$('#moteur_inptRayon').attr('name','');if(lieu!==undefined&&lieu!=='undefined'&&lieu!==''){$('#moteur_inptRechercheMutli').val(decodeURIComponent(decodeURIComponent(lieu)).replace(/\+/g,' '));$("#moteur_inptRechercheMutliHidden").attr("name",'');$("#moteur_inptRechercheMutliHidden").attr("value",'');if(cgi==='VILLE_ETRANGER'){$('#moteur_inptLong').attr('name','longitude');$('#moteur_inptLong').val($(element).data('longitude'));$('#moteur_inptLat').attr('name','latitude');$('#moteur_inptLat').val($(element).data('latitude'));$('#moteur_inptRayon').attr('name','rayon');$('#moteur_inptRayon').val('20');}else if(cgi!==undefined&&cgi!=='undefined'&&cgi!==''){$("#moteur_inptRechercheMutliHidden").attr("name",cgi);$("#moteur_inptRechercheMutliHidden").attr("value",valcgi);}else if(lnoident!==undefined&&lnoident!=='undefined'&&lnoident!==''){$("#moteur_inptRechercheMutliHidden").attr("name","lnoident");$("#moteur_inptRechercheMutliHidden").attr("value",lnoident);}}else if(ref!==undefined&&ref!=='undefined'&&ref!==''){$('#moteur_inptRechercheMutli').val(ref);$("#moteur_inptRechercheMutliHidden").attr("name","lnoident");$("#moteur_inptRechercheMutliHidden").attr("value",lnoident);}else{$('#moteur_inptRechercheMutli').val(valDefaut);}
if(deb!=='undefined'&&deb!==""){deb=decodeURIComponent(decodeURIComponent(deb));$("#input-drp-start-id").val(deb);if(stringArrivee!=='undefined'&&stringArrivee!==""){$('#input-drp-arrival-id').val(stringArrivee);if(window.setDateHisto){setDateHisto();}}}
else{$('#input-drp-arrival-id').val('');$("#input-drp-start-id").val('');}
if(fin!=='undefined'&&fin!==""){fin=decodeURIComponent(decodeURIComponent(fin));$("#input-drp-end-id").val(fin);if(stringDepart!=='undefined'&&stringDepart!==""){$('#input-drp-departure-id').val(stringDepart);if(window.setDateHisto){setDateHisto();}}}else{$("#input-drp-end-id").val('');$('#input-drp-departure-id').val('');if(deb!=='undefined'&&deb!==""){$(".drp-end-container").click();}}
if(nbPers!=='undefined'&&nbPers!==""&&nbPers!=="n"){$("#moteur_selectDenbp_min").val(parseInt(nbPers));if($("#moteurPrincipalCapacite .ui-selectmenu-button").length>0){$("#moteur_selectDenbp_min").selectmenu("refresh");}}else{$("#moteur_selectDenbp_min").val('n');if($("#moteurPrincipalCapacite .ui-selectmenu-button").length>0){$("#moteur_selectDenbp_min").selectmenu("refresh");}}
if(url!=='undefined'&&url!==""){var urlDecode=decodeURIComponent(url);$('#urlListeHidden').val(urlDecode);if(urlDecode.split('.').pop().length===0||(urlDecode.split('.').pop()!=='html'&&urlDecode.split('.').pop()!=='php')){urlDecode+='.html';}
if(urlDecode.substring(0,1)!=='/'){urlDecode='/'+urlDecode;}
$('#moteur_inptRechercheMutli').parents('form').attr('action',urlDecode);}else{$('#urlListeHidden').val('liste');$('#moteur_inptRechercheMutli').parents('form').attr('action','/liste.html');}
if(window.setMajMoteurResponsive){setMajMoteurResponsive();}
$('#moteur_divMultiAutoComplete').hide();})(jQuery);}
function initDatePickerMarkup(e){(function($){$(e).datepicker('widget').find('td').mouseover(function(){currentDate=new Date($(this).attr('data-year')+"/"+(parseInt($(this).attr('data-month'))+1)+"/"+$(this).text());selectedDate=$(e).datepicker('getDate');if(selectedDate===null){selectedDate=new Date();}
allTds=$(this).parents('table.ui-datepicker-calendar').find('td');allTds.removeClass('ui-datepicker-mouseover1')
found=false;if(currentDate<selectedDate){for(i=0;i<allTds.length;i++){if(allTds[i]==this){found=true;}
if($(allTds[i]).hasClass('ui-datepicker-today')||$(allTds[i]).hasClass('ui-datepicker-current-day')){break;}
if(found){$(allTds[i]).addClass('ui-datepicker-mouseover1');}}}else if(currentDate>selectedDate){for(i=0;i<allTds.length;i++){if(found){$(allTds[i]).addClass('ui-datepicker-mouseover1');}
if($(allTds[i]).hasClass('ui-datepicker-today')||$(allTds[i]).hasClass('ui-datepicker-current-day')){found=true;}
if(allTds[i]==this){break;}}}});})(jQuery);}
function refreshListeWithCgi(url){(function($){if(jQuery('#divgmap3').length>0&&jQuery('#divgmap3').attr('data-cartedeplace')==='1'){url=getUrlAvecLstParamsGoogleMaps(url);}
var params=url.substr(url.indexOf('?')+1);var baseUrl=url.substr(0,url.indexOf('?'));var tabParams=params.split('&');var tabKey=[];var html="<form id='formRechercheListe' action='"+baseUrl+"' method='post' style='display:hidden'>";for(var i=0;i<tabParams.length;i++){var couple=tabParams[i].split('=');var key=couple[0];var value=couple[1];if(tabKey.indexOf(key)!==-1){continue;}
tabKey.push(key);html+='<input type="hidden" name="'+key+'" value="'+value+'">';}
html+='</form>';$('body').append(html);$('#formRechercheListe').submit();moteur_affMessageLoadingMoteur();})(jQuery);}
function datePicker_gereHover(inputDate){(function($){if($('#moteur_datePickerDeb').val()&&$('#moteur_datePickerDeb').val()!=$("#moteur_datePickerDeb").attr("data-defaut")&&inputDate=="dateFin"){var dateDeb=new OBJDate($('#moteur_datePickerDeb').val());$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month):not(.tdCalendJour_arrivee)").live('mouseover',function(){var moisHover=parseInt($(this).data('month'))+1;var dateFin=new OBJDate($(this).find('a').text()+'/'+moisHover+'/'+$(this).data('year'));$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month)").each(function(){var moisTd=parseInt($(this).data('month'))+1;var dateTd=new OBJDate($(this).find('a').text()+'/'+moisTd+'/'+$(this).data('year'));if(dateTd.estComprisEntre(dateDeb,dateFin)){$(this).addClass('tdCalendJour_periodeSurvolee');}
else{$(this).removeClass('tdCalendJour_periodeSurvolee');}});if($('#moteurPrincipalDate.dateSelected ').length==0){if($(".ui-datepicker-calendar td.tdCalendJour_periodeSurvolee").length==0){$(".ui-datepicker-calendar td.tdCalendJour_arrivee").addClass('td_debSansHover');}
else{$(".ui-datepicker-calendar td.tdCalendJour_arrivee").removeClass('td_debSansHover');}}});$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month):not(.ui-datepicker-unselectable)").live('mouseleave',function(){$(".ui-datepicker-calendar td").each(function(){$(this).removeClass('tdCalendJour_periodeSurvolee');});if($('#moteurPrincipalDate.dateSelected').length==0){if($(".ui-datepicker-calendar td.tdCalendJour_arrivee").length>0){$(".ui-datepicker-calendar td.tdCalendJour_arrivee").addClass('td_debSansHover');}}});}
else{$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month):not(.tdCalendJour_arrivee)").die('mouseover');$(".ui-datepicker-calendar td:not(.ui-datepicker-other-month):not(.ui-datepicker-unselectable)").die('mouseleave');}
setTimeout(function(){if($('#moteurPrincipalDate.dateSelected').length==0){if($(".ui-datepicker-calendar td.tdCalendJour_arrivee").length>0){$(".ui-datepicker-calendar td.tdCalendJour_arrivee").addClass('td_debSansHover');}}},0);})(jQuery);}
function datepicker_videDateFin(){if(jQuery('#moteur_datePickerDeb').val()!=""&&jQuery('#moteur_datePickerFin').val()!=""&&jQuery('#moteur_datePickerDeb').val()!=jQuery('#moteur_datePickerDeb').attr('data-defaut')&&jQuery('#moteur_datePickerFin').val()!=jQuery('#moteur_datePickerFin').attr('data-defaut')){var dateDebut=new OBJDate(jQuery('#moteur_datePickerDeb').val());var dateFin=new OBJDate(jQuery('#moteur_datePickerFin').val());if(dateFin.estAvantOBJDate(dateDebut)){jQuery("#moteur_datePickerFin").datepicker('setDate',null);jQuery("#moteur_datePickerFin").val(jQuery("#moteur_datePickerFin").attr('data-defaut'));jQuery("#label_moteur_datePickerFin_externe").css('opacity','0');jQuery("#label_moteur_datePickerFin_externe span").each(function(){jQuery(this).text('');});jQuery("#moteurPrincipalDate").removeClass('dateSelected dateFinSelected');}}}
function initDivDateRangePicker(){var formatDate=jQuery("#divConteneur_dateRangePicker").attr('data-formatDate');var maxRange=jQuery("#divConteneur_dateRangePicker").attr('data-maxRange');var firstWeekDay=parseInt(jQuery("#divConteneur_dateRangePicker").attr('data-firstWeekDay'));var clearCross='';var forceDepartureSelection=false;if(jQuery("#divConteneur_dateRangePicker").attr('data-forcedepartureselection')=='true'){forceDepartureSelection=true;}
if(jQuery("#divConteneur_dateRangePicker").attr('data-nextmonthimg').length>0){var nextMonthSrc=jQuery("#divConteneur_dateRangePicker").attr('data-nextmonthimg');}else{var nextMonthSrc='/imgs_defaut/dateRangePicker/next.svg';}
if(jQuery("#divConteneur_dateRangePicker").attr('data-prevmonthimg').length>0){var prevMonthSrc=jQuery("#divConteneur_dateRangePicker").attr('data-prevmonthimg');}else{var prevMonthSrc='/imgs_defaut/dateRangePicker/prev.svg';}
if(jQuery("#divConteneur_dateRangePicker").attr('data-avecClearCross').length>0){if(jQuery("#divConteneur_dateRangePicker").attr('data-avecClearCross')=='true'){var clearCross='<div class="ui-drp-clear-cross" ><img src="../../img/css/close.svg" /></div>';}}
jQuery("#divConteneur_dateRangePicker").dateRangePicker({maxRange:maxRange,previousButton:'<img alt="Mois suivant" src="'+prevMonthSrc+'" />',nextButton:'<img alt="Mois suivant" src="'+nextMonthSrc+'" />',separator:'<div class="separator"><img src="/imgs_defaut/dateRangePicker/arrow_606060.svg" alt="separator" /></div>',picto:'',clearCross:clearCross,nameStart:'deb',nameEnd:'fin',dateFormat:formatDate,readonly:true,allowPrevious:false,firstWeekDay:firstWeekDay,forceDepartureSelection:forceDepartureSelection},{selectedRange:dateRangePickerSelectedRange,inputsCleared:dateRangePickerInputsCleared,openingPopup:dateRangePickerOpenPopup,selectedStart:dateRangePickerSelectedStart});}
function dateRangePickerSelectedRange(){if(window.initClickDrpRangeSelected){initClickDrpRangeSelected();}
if(jQuery('#divConteneur_dateRangePicker[data-onchange="true"]').length>0){var nameDateDebut=jQuery('#input-drp-start-id').attr('name');var valueDateDebut=jQuery('#input-drp-start-id').val();var nameDateFin=jQuery('#input-drp-end-id').attr('name');var valueDateFin=jQuery('#input-drp-end-id').val();moteur_affMessageLoadingMoteur();var urlRedirect=window.location.href;if(window.location.href.indexOf('?')==-1){urlRedirect+="?";}
else{urlRedirect+="&";}
urlRedirect+=nameDateDebut+"="+valueDateDebut+"&"+nameDateFin+"="+valueDateFin;if(jQuery('input[name="nbj"]').length>0){var ObjDateDeb=new OBJDate(jQuery("#input-drp-start-id").val());var ObjDateFin=new OBJDate(jQuery("#input-drp-end-id").val());var ecartNbj=ObjDateDeb.getNbJourEcartWithOBJDate(ObjDateFin,true);urlRedirect+="&nbj="+ecartNbj;}
window.location.href=(urlRedirect);}}
function dateRangePickerInputsCleared(){if(window.initClickDrpInputsCleared){initClickDrpInputsCleared();}
dateRangePickerSelectedRange();}
function dateRangePickerOpenPopup(){if(window.initDrpOpen_look){initDrpOpen_look();}}
function dateRangePickerSelectedStart(){if(window.initDrpStartSelected_look){initDrpStartSelected_look();}}
function onClickLiMoteurAutoCompleteMulti(element,avecLien){(function($){fillInputMoteurRechercheMulti(element);if(window.initClickPropositionLieu){initClickPropositionLieu();}
if(avecLien){var cgi,value;if(typeof $(element).attr('ref')!=='undefined'){cgi='lnoident';value=$(element).attr("ident");}else{var cgi=$(element).attr("cgi");if(typeof cgi!=='undefined'){value=$(element).attr("val_cgi");}else{cgi='lnoident';value=$(element).attr("ident");}}
var urlListe=document.location.href;if($(element).data("url")&&$(element).data("url").length>0){urlListe=$(element).data("url");}
var url=getUrlWithLstParam(urlListe,cgi,value);var inputDistcomm=$('.moteur_inptRechercheMutli').siblings('input[name="distcomm"]');if(inputDistcomm!==undefined&&inputDistcomm.length>0){url=getUrlWithLstParam(url,'distcomm',inputDistcomm.val());}
url=removeParamGoogleMaps(url);document.location.href=url;moteur_affMessageLoadingMoteur();}})(jQuery);}
function moteur_initRegletteMiniMaxi(){if($("moteur_divDudgetreglette")){var slider=$("moteur_sliderBudgetregletteContent");var valeurMax,valeurMin;if($("moteur_hiddenPxMaxReglette").value)valeurMax=parseInt($("moteur_hiddenPxMaxReglette").value);else valeurMax=2500;if($("moteur_hiddenPxMinReglette").value)valeurMin=parseInt($("moteur_hiddenPxMinReglette").value);else valeurMin=50;if($("moteur_hiddenPxMax").value)var valeurEnCourMax=parseInt($("moteur_hiddenPxMax").value);else var valeurEnCourMax=valeurMax;if($("moteur_hiddenPxMini").value)var valeurEnCourMin=parseInt($("moteur_hiddenPxMini").value);else var valeurEnCourMin=valeurMin;var vals=new Array();for(var i=valeurMin;i<=valeurMax;i+=valeurMin)vals.push(i);var regletteOnchange=true;if(jQuery("#moteur_divDudgetreglette").attr("data-onchange")=='false'){regletteOnchange=false;}
new Control.Slider(slider.down('#moteur_sliderBudgetMaxi'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMax,values:vals,onSlide:function(value){$("spn_budgetInfosPrixMax").innerHTML=value;jQuery("#moteur_hiddenPxMax").val(value);},onChange:function(value){if(regletteOnchange){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"pxmax",value.toString());moteur_affMessageLoadingMoteur();}}});new Control.Slider(slider.down('#moteur_sliderBudgetMini'),slider,{range:$R(valeurMin,valeurMax),sliderValue:valeurEnCourMin,values:vals,onSlide:function(value){$("spn_budgetInfosPrixMin").innerHTML=value;jQuery("#moteur_hiddenPxMini").val(value);},onChange:function(value){if(regletteOnchange){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"pxmin",value.toString());moteur_affMessageLoadingMoteur();}}});}}
function setCookieEnregistreCritere(cgi,value){var date=new OBJDate();date.ajoutJour(30);var dateExpire=new Date(date.getAnnee(),date.getMois()-1,date.getJour());var cookie="critereEnregistre_"+cgi;setCookie(cookie.toUpperCase(),value.toUpperCase(),dateExpire);}
function removeCookieEnregistreCritere(cgi){var cookie="critereEnregistre_"+cgi;var date=new OBJDate();date.enleveJour(30);var dateExpire=new Date(date.getAnnee(),date.getMois()-1,date.getJour());setCookie(cookie.toUpperCase(),'',dateExpire);}
function removeParamGoogleMaps(url){var urlSeule=url.substring(0,url.indexOf("?"));var cgi=url.substring(url.indexOf("?")+1,url.length);var tabCgiGM=['zoom','centrex','centrey','minlat','maxlat','minlng','maxlng'];var tabCgi=cgi.split('&');var tabCgiRetour=[];for(var i=0;i<tabCgi.length;i++){var infosCgi=tabCgi[i].split('=');if(tabCgiGM.indexOf(infosCgi[0])===-1){tabCgiRetour.push(tabCgi[i]);}}
return urlSeule+'?'+tabCgiRetour.join('&');}
function supprimeCgisDansUrl(url,tabCgisASupprimer){var urlSeule=url.substring(0,url.indexOf("?"));var cgi=url.substring(url.indexOf("?")+1,url.length);var tabCgi=cgi.split('&');var tabCgiRetour=[];for(var i=0;i<tabCgi.length;i++){var infosCgi=tabCgi[i].split('=');if(tabCgisASupprimer.indexOf(infosCgi[0])===-1){tabCgiRetour.push(tabCgi[i]);}}
return urlSeule+'?'+tabCgiRetour.join('&');}
function initMoteur_capacite_adultesEtEnfants(){jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible').click(function(){if(jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .simuleInput.opened').length>0){fermerMoteur_capacite_adultesEtEnfants();}
else{ouvrirMoteur_capacite_adultesEtEnfants();}});var nbMinAdultes=jQuery('#moteurCapaciteAdultesEtEnfants').attr('data-nbminadultes');var nbAdultes=jQuery('#inputCapaciteAdultes').val();var nbEnfants=jQuery('#inputCapaciteEnfants').val();jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee a.btn_modifie').click(function(){ajouterEnleverMoteur_capacite_adultesEtEnfants(jQuery(this),nbMinAdultes);});jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee a.btn_enleve').addClass('disabled');jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .enfant a.btn_ajoute').addClass('disabled');if(nbAdultes>0){jQuery('#inputCapaciteAdultes').val(0);for(var i=0;i<nbAdultes;i++){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneAdultes a.btn_ajoute').get(0).click();}
if(nbAdultes==nbMinAdultes){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneAdultes a.btn_enleve').addClass('disabled');}
jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneAdultes a.btn_ajoute').removeClass('disabled');}
else{if(nbMinAdultes>0){for(var i=0;i<nbMinAdultes;i++){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneAdultes a.btn_ajoute').get(0).click();}
jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee a.btn_enleve').addClass('disabled');jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee a.btn_ajoute').removeClass('disabled');}}
if(nbEnfants>0){jQuery('#inputCapaciteEnfants').val(0);for(var i=0;i<nbEnfants;i++){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneEnfants a.btn_ajoute').get(0).click();}}
var nbp_total=parseInt(jQuery('#inputCapaciteAdultes').val())+parseInt(jQuery('#inputCapaciteEnfants').val());jQuery('#inputCapaciteAdultesEtEnfants').val(nbp_total);if(jQuery('#boutonMettreAJourCapacite').length>0){jQuery('#boutonMettreAJourCapacite').click(function(){var nameNbpTotal=jQuery('#inputCapaciteAdultesEtEnfants').attr('name');var valueNbpTotal=jQuery('#inputCapaciteAdultesEtEnfants').val();var nameNbpAdultes=jQuery('#inputCapaciteAdultes').attr('name');var valueNbpAdultes=jQuery('#inputCapaciteAdultes').val();var nameNbpEnfants=jQuery('#inputCapaciteEnfants').attr('name');var valueNbpEnfants=jQuery('#inputCapaciteEnfants').val();if(window.location.href.indexOf('?')==-1){window.location.href=(window.location.href+"?"+nameNbpTotal+"="+valueNbpTotal+"&"+nameNbpAdultes+"="+valueNbpAdultes+"&"+nameNbpEnfants+"="+valueNbpEnfants);}else{window.location.href=(window.location.href+"&"+nameNbpTotal+"="+valueNbpTotal+"&"+nameNbpAdultes+"="+valueNbpAdultes+"&"+nameNbpEnfants+"="+valueNbpEnfants);}});}}
function ouvrirMoteur_capacite_adultesEtEnfants(){jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .simuleInput').removeClass("closed").addClass('opened');jQuery('#moteurCapaciteAdultesEtEnfants').addClass('opened');jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee').fadeIn();if(window.ouvrirMoteur_capacite_adultesEtEnfants_look){ouvrirMoteur_capacite_adultesEtEnfants_look();}}
function fermerMoteur_capacite_adultesEtEnfants(){jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .simuleInput').removeClass("opened").addClass('closed');jQuery('#moteurCapaciteAdultesEtEnfants').removeClass('opened');jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee').fadeOut();if(window.fermerMoteur_capacite_adultesEtEnfants_look){fermerMoteur_capacite_adultesEtEnfants_look();}}
function ajouterEnleverMoteur_capacite_adultesEtEnfants(elementClique,nbMinAdultes){var typePersonne=elementClique.attr('data-typePersonne');var typeBouton=elementClique.attr('data-typeBouton');var nbMax=jQuery('#moteurCapaciteAdultesEtEnfants #inputCapaciteAdultesEtEnfants').attr('data-nbmax');var spanValeurMasque=jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .'+typePersonne+' p .valeur');var spanLblMasque=jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .'+typePersonne+' p .lbl');var spanLblVisible=jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .plein .lbl.'+typePersonne);var inputMasque=jQuery('#moteurCapaciteAdultesEtEnfants #inputCapaciteAdultesEtEnfants');var inputMasqueAdultes=jQuery('#moteurCapaciteAdultesEtEnfants #inputCapaciteAdultes');var inputMasqueEnfants=jQuery('#moteurCapaciteAdultesEtEnfants #inputCapaciteEnfants');var valInputMasque=parseInt(inputMasque.attr('value'));var valInputMasqueAdultes=parseInt(inputMasqueAdultes.attr('value'));var valInputMasqueEnfants=parseInt(inputMasqueEnfants.attr('value'));var valueAvant=parseInt(spanValeurMasque.html());var valueApres,nbMin;if(typePersonne=="enfant"){nbMin=0;}
else{nbMin=nbMinAdultes;}
if(typeBouton=="ajoute"){if(valueAvant<nbMax&&!(typePersonne=="enfant"&&valInputMasqueAdultes==0)){valueApres=valueAvant+1;valInputMasque++;if(typePersonne=="enfant"){valInputMasqueEnfants++;}else{valInputMasqueAdultes++;}}
else{return;}}
else{if(valueAvant>nbMin){valueApres=valueAvant-1;valInputMasque--;if(typePersonne=="enfant"){valInputMasqueEnfants--;}else{valInputMasqueAdultes--;}}
else{return;}}
inputMasque.attr('value',valInputMasque);inputMasqueAdultes.attr('value',valInputMasqueAdultes);inputMasqueEnfants.attr('value',valInputMasqueEnfants);spanValeurMasque.html(valueApres);jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .simuleInput.plein .val.'+typePersonne).html(valueApres);if(valInputMasqueAdultes==0){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee a.btn_modifie').addClass('disabled');jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .adulte a.btn_ajoute').removeClass('disabled');}
else if(valueApres==nbMin||valueApres==nbMax){elementClique.addClass('disabled');}
else{jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .'+typePersonne+' a.btn_modifie').removeClass('disabled');}
if(valueApres==1){if(valueAvant==2){spanLblMasque.html(spanLblMasque.attr('data-singulier'));spanLblVisible.html(spanLblVisible.attr('data-singulier'));}
else{jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .vide').hide();jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .plein').show();if(typePersonne=="adulte"){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .enfant a.btn_ajoute').removeClass('disabled');}}}
else if(valueApres==0){if(valInputMasque==0){jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .plein').hide();jQuery('#moteurCapaciteAdultesEtEnfants .partieVisible .vide').show();}
if(typePersonne=="adulte"){for(var i=valInputMasqueEnfants;i>0;i--){jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .ligneEnfants a.btn_enleve').get(0).click();}}}
else if(valueApres==nbMax){var i=nbMax-1
if(valueAvant==i){spanValeurMasque.html(valueApres+' '+jQuery('#moteurCapaciteAdultesEtEnfants .partieMasquee .'+typePersonne+' p').attr('data-etplus'));}}
else{if(valueAvant==1){spanLblMasque.html(spanLblMasque.attr('data-pluriel'));spanLblVisible.html(spanLblVisible.attr('data-pluriel'));}}}
function initMoteurMultiApi(){(function($){var zone="init";$(".moteurMultiCritereParApi").each(function(){$(this).bind("click",function(){zone="init";});$(this).on("touchstart",function(){zone="init";});});$("body").bind("click",function(){if(zone!=="init"){if($('#moteur_divMultiParApiAutoComplete').is(":visible")){$('#moteur_divMultiParApiAutoComplete').hide();zone="init";}}
else{zone="out";}});$("body").on("touchstart",function(){if(zone!=="init"){if($('#moteur_divMultiParApiAutoComplete').is(":visible")){$('#moteur_divMultiParApiAutoComplete').hide();$('#moteur_inptRechercheMutliParApi').blur();zone="init";}}
else{zone="out";}});$("#moteur_inptRechercheMutliParApi").on("input",function(){clearTimeout($(this).data('timer'));var avecLien=true;if($('#moteur_divRechercheMultiParApiSansLien')){avecLien=false;}
$(this).data('timer',setTimeout(function(){console.log('initMoteurMultiApi setAutocompleteForRechercheMulti');setAutocompleteForRechercheMultiByApi("moteur_inptRechercheMutliParApi","moteur_divMultiParApiAutoComplete",avecLien);},200));});})(jQuery);}
function setAutocompleteForRechercheMultiByApi(idChampSaisie,divChampChoix,avecLien){(function($){var url="/lib_2/ajax/infosCGI.php";var valInput=$('#'+idChampSaisie).val();var typeReponse=null;if(!avecLien){typeReponse='JS';}
var moteur=$('#'+divChampChoix);$.when($.ajax(url,{data:{valInput:valInput,typeInfo:'autocompleteByApi',typeReponse:typeReponse},dataType:'html'}),$.ajax(url,{data:{valInput:valInput,typeInfo:'autocompleteNomHebs',typeReponse:typeReponse},dataType:'html'})).then(function(dataApi,dataNomHeb){var rep=dataApi[0]+dataNomHeb[0];moteur.empty();moteur.append('<div class="conteneurAutoCompleteur">'+rep+'</div>');$('#'+divChampChoix+' ul>li:not(.heb)').each(function(){$(this).attr('onClick','onClickLiMoteurAutoCompleteApiHere(this)');});if(rep.length>0){moteur.show();}
else{moteur.hide();return;}
var li=$('#'+divChampChoix+' ul>li');var liSelected=$('#'+divChampChoix+' ul').find('.selected');$(window).keydown(function(e){if(e.which===40){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))+1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.eq(0).addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===38){li.removeClass('selected');nextNum=parseInt(liSelected.attr('data-numLi'))-1;next=$('#'+divChampChoix+' ul').find("[data-numLi='"+nextNum+"']");if(next.length>0){liSelected=next.addClass('selected');}else{liSelected=li.last().addClass('selected');}
if(liSelected.offset().top+liSelected.height()>moteur.offset().top+moteur.height()||liSelected.offset().top<moteur.offset().top){moteur.scrollTo(liSelected);}}else if(e.which===13){if($('#'+divChampChoix).is(':visible')){e.preventDefault();$('#'+divChampChoix+' ul').find('.selected').click();return false;}}
else if(e.which===9){if($('#'+divChampChoix).is(':visible')){$('#'+divChampChoix+' ul').find('.selected').click();}}});li.on('mouseenter',function(e){e.preventDefault();li.removeClass('selected');$(this).addClass('selected');});},function(err){console.log(err);});})(jQuery);}
function onClickLiMoteurAutoCompleteApiHere(element){(function($){var idHere=$(element).attr('data-idhere');var rayon=$(element).attr('data-rayon');var pays=$(element).attr('data-pays');var region=$(element).attr('data-region');var dep=$(element).attr('data-dep');var commune=$(element).attr('data-commune');var lib=$(element).attr('data-valreel');$('#idLocationHere').val(idHere);$('#rayon').val(rayon);$('#moteur_inptRechercheMutliParApi').val(lib);resetAndFillChampsLieu(pays,region,dep,commune);$('#moteur_divMultiParApiAutoComplete').hide();$('#moteur_divMultiParApiAutoComplete').empty();if($('#inpt_moteurApiHereAvecLien').val()=='true'){$('#form_moteurLieuApiHere').submit();}})(jQuery);}
function resetAndFillChampsLieu(pays,region,dep,ville){(function($){$('#pays').val('');$('#region').val('');$('#dep').val('');$('#commune').val('');if(pays!==undefined){$('#pays').val(pays);}
if(region!==undefined){$('#region').val(region);}
if(dep!==undefined){$('#dep').val(dep);}
if(ville!==undefined){$('#commune').val(ville);}})(jQuery);}function trim(str,chars){return ltrim(rtrim(str,chars),chars);}
function ltrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("^["+chars+"]+","g"),"");}
function rtrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("["+chars+"]+$","g"),"");}
function str_replace(haystack,needle,replacement){var temp=haystack.split(needle);return temp.join(replacement);}
function str_replace_reg(haystack,needle,replacement){var r=new RegExp(needle,'g');return haystack.replace(r,replacement);}
sprintfWrapper={init:function(){if(typeof arguments=="undefined"){return null;}
if(arguments.length<1){return null;}
if(typeof arguments[0]!="string"){return null;}
if(typeof RegExp=="undefined"){return null;}
var string=arguments[0];var exp=new RegExp(/(%([%]|(\-)?(\+|\x20)?(0)?(\d+)?(\.(\d)?)?([bcdfosxX])))/g);var matches=new Array();var strings=new Array();var convCount=0;var stringPosStart=0;var stringPosEnd=0;var matchPosEnd=0;var newString='';var match=null;while(match=exp.exec(string)){if(match[9]){convCount+=1;}
stringPosStart=matchPosEnd;stringPosEnd=exp.lastIndex-match[0].length;strings[strings.length]=string.substring(stringPosStart,stringPosEnd);matchPosEnd=exp.lastIndex;matches[matches.length]={match:match[0],left:match[3]?true:false,sign:match[4]||'',pad:match[5]||' ',min:match[6]||0,precision:match[8],code:match[9]||'%',negative:parseInt(arguments[convCount])<0?true:false,argument:String(arguments[convCount])};}
strings[strings.length]=string.substring(matchPosEnd);if(matches.length==0){return string;}
if((arguments.length-1)<convCount){return null;}
var code=null;var match=null;var i=null;for(i=0;i<matches.length;i++){if(matches[i].code=='%'){substitution='%'}
else if(matches[i].code=='b'){matches[i].argument=String(Math.abs(parseInt(matches[i].argument)).toString(2));substitution=sprintfWrapper.convert(matches[i],true);}else if(matches[i].code=='c'){matches[i].argument=String(String.fromCharCode(parseInt(Math.abs(parseInt(matches[i].argument)))));substitution=sprintfWrapper.convert(matches[i],true);}else if(matches[i].code=='d'){matches[i].argument=String(Math.abs(Math.floor(parseFloat(matches[i].argument))));substitution=sprintfWrapper.convert(matches[i]);}else if(matches[i].code=='f'){matches[i].argument=String(Math.abs(parseFloat(matches[i].argument)).toFixed(matches[i].precision?matches[i].precision:6));substitution=sprintfWrapper.convert(matches[i]);}else if(matches[i].code=='o'){matches[i].argument=String(Math.abs(parseInt(matches[i].argument)).toString(8));substitution=sprintfWrapper.convert(matches[i]);}else if(matches[i].code=='s'){matches[i].argument=matches[i].argument.substring(0,matches[i].precision?matches[i].precision:matches[i].argument.length);substitution=sprintfWrapper.convert(matches[i],true);}else if(matches[i].code=='x'){matches[i].argument=String(Math.abs(parseInt(matches[i].argument)).toString(16));substitution=sprintfWrapper.convert(matches[i]);}else if(matches[i].code=='X'){matches[i].argument=String(Math.abs(parseInt(matches[i].argument)).toString(16));substitution=sprintfWrapper.convert(matches[i]).toUpperCase();}else{substitution=matches[i].match;}
newString+=strings[i];newString+=substitution;}
newString+=strings[i];return newString;},convert:function(match,nosign){if(nosign){match.sign='';}
else{match.sign=match.negative?'-':match.sign;}
var l=match.min-match.argument.length+1-match.sign.length;var pad=new Array(l<0?0:l).join(match.pad);if(!match.left){if(match.pad=="0"||nosign){return match.sign+pad+match.argument;}
else{return pad+match.sign+match.argument;}}
else{if(match.pad=="0"||nosign){return match.sign+match.argument+pad.replace(/0/g,' ');}else{return match.sign+match.argument+pad;}}}}
sprintf=sprintfWrapper.init;function pad(str,len,pad,dir){var STR_PAD_LEFT=1;var STR_PAD_RIGHT=2;var STR_PAD_BOTH=3;if(typeof(len)=="undefined"){var len=0;}
if(typeof(pad)=="undefined"){var pad=' ';}
if(typeof(dir)=="undefined"){var dir=STR_PAD_RIGHT;}
if(len+1>=str.length){switch(dir){case STR_PAD_LEFT:str=Array(len+1-str.length).join(pad)+str;break;case STR_PAD_BOTH:var right=Math.ceil((padlen=len-str.length)/2);var left=padlen-right;str=Array(left+1).join(pad)+str+Array(right+1).join(pad);break;default:str=str+Array(len+1-str.length).join(pad);break;}}
return str;}
function traiteRetourChariot(chaine,remplacement){return str_replace(new String(chaine),"\n",remplacement);}
function enleveDomaineCurr(chaine){var loc=new String(document.location);var tabPart=loc.split('/');var httpHost=tabPart[2];var domaine=document.location.protocol+'//'+httpHost;return str_replace(chaine,domaine,'');}
function traiteTexteAvantReqAjax(chaine){chaine=chaine.replace(//g,'euros');chaine=encodeURIComponent(chaine);return chaine;}
function getPatternUrlValide(){return'/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/=]*)$/';}var regexPrix=new RegExp(/^[0-9]*[\.|,]?[0-9]{0,2}$/);function addValidateOnLiveValidationEmail(objLiveValidation,langue,obligatoire,failureMessage,info,domaine){if(obligatoire===undefined){obligatoire=false;}
var message_obligatoire;var message_email_invalide;if(langue==='FRANCAIS'){message_obligatoire='Champ obligatoire';message_email_invalide='Adresse mail non valide';}else{message_obligatoire='Required field';message_email_invalide='Invalid email';}
if(failureMessage!==undefined&&failureMessage.length>0){message_obligatoire=failureMessage;message_email_invalide=failureMessage;}
if(obligatoire){objLiveValidation.add(Validate.Presence,{failureMessage:message_obligatoire});}
var args={};if(info){args.info=info;}
if(domaine){args.domaine=domaine;}
objLiveValidation.add(Validate.Email,{failureMessage:message_email_invalide});objLiveValidation.add(Validate.Custom,{against:function(value,args){return checkEmailIteaPourValidate(value,args);},args:args,failureMessage:message_email_invalide});}
function checkEmailIteaPourValidate(value,args){var check=true;var info=args.info||'checkEmail';var domaine=args.domaine||'';(function($){var request=$.ajax({type:'POST',url:domaine+'/lib_2/ajax/infosDist.php',async:false,dataType:'json',data:{info:info,val:value}});request.success(function(retour){if(retour.code!=='OK'){check=false;}});request.error(function(xhr,status,thrown){console.log('checkEmailIteaPourValidatevalue appel ajax impossible');check=true;});})(jQuery);return check;}
function checkForm(frm,funcQdFini,funcQdEchec){(function($){var tabChkInput=getTabChmpForm(frm);var id='';var validate;var mode;var tabAValider=[];for(var i=0;i<tabChkInput.length;i++){id=$(tabChkInput[i]).attr('id');if($(tabChkInput[i]).attr('modecheck')!=undefined){mode=$(tabChkInput[i]).attr('modecheck');validate=new LiveValidation(id,{validMessage:"Ok",onlyOnSubmit:true});if(mode=='checkChpObligatoire'){validate.add(Validate.Presence,{failureMessage:"Champ obligatoire"});}else if(mode=='checkMailObligatoire'){validate.add(Validate.Presence,{failureMessage:"Champ obligatoire"});validate.add(Validate.Email,{failureMessage:"Adresse mail non valide"});}else if(mode=='checkMail'){validate.add(Validate.Email,{failureMessage:"Adresse mail non valide"});}else if(mode=='checkChampInteger'){validate.add(Validate.Numericality,{onlyInteger:true,notANumberMessage:"Code postal incorrect"});validate.add(Validate.Length,{is:5,wrongLengthMessage:"Code postal incorrect"});}else if(mode=='checkChampDieseInterdit'){validate.add(Validate.Format,{pattern:/#/,failureMessage:"Caractere # interdit"});}else if(mode=='checkCaptcha'){validate.add(Validate.Custom,{against:function(value,args){var succes=true;var tabRep=$.ajax({url:'lib_2/ajax/infosDist.php',data:{info:'checkCodeSecu',val:value},async:false}).responseText;eval("var tabRetour="+tabRep);if(tabRetour.code.toUpperCase()=='ERR'){succes=false;}
return succes;},failureMessage:"Verification non valide"});}else if(mode=='checkChampTelephone'){validate.add(Validate.Format,{pattern:/(^0[1-9][\s]?([0-9]{2}[\s]?){3}[0-9]{2}$|^00[0-9,\s]+[0-9]$)/,failureMessage:"Tlphone incorrect"});validate.add(Validate.Length,{minimum:6,tooShortMessage:"Tlphone incorrect"});validate.add(Validate.Length,{maximum:20,tooLongMessage:"Tlphone incorrect"});}else{debugLogJS('checkForm, cas non gr : '+mode);}
tabAValider.push(validate);}}
if(LiveValidation.massValidate(tabAValider)){funcQdFini();}else if(funcQdEchec){funcQdEchec();}})(jQuery);}
function checkByInput(chpInput,mode,chpInputControl,funcQdFini,nbVerifAFaire,funcQdEchec){}
function viderChp(chpInput){if($(chpInput).hasClassName("chpInptErreurDetecte")){$(chpInput).removeClassName("chpInptErreurDetecte");$(chpInput).removeClassName("chpInptAucuneErreur");var msg=chpInput.value.substring(2);var idx_debmsg=msg.indexOf("--");if(idx_debmsg>0){var reste=msg.substring(idx_debmsg+2);chpInput.value=reste;}
else if($(chpInput).getAttribute("data-defaut")&&$(chpInput).getAttribute("data-defaut")==$(chpInput).value){chpInput.value="";}}
else if($(chpInput).getAttribute("data-defaut")&&$(chpInput).getAttribute("data-defaut")==$(chpInput).value){chpInput.value="";}}
function checkFormMotMagique(frm,frmMotMagique){var frmSubmit=true;if(frmMotMagique.motmagique.value){var message="Vous avez saisi un code promotion, merci de le valider avant de passer &agrave; l'&eacute;tape suivante.";alertAMalibu(message);frmSubmit=false;}
if(frmSubmit)frm.submit();}
function checkFormMotMagiqueByLien(frmMotMagique){if(frmMotMagique.motmagique.value){var message="Vous avez saisi un code promotion, merci de le valider avant de passer &agrave; l'&eacute;tape suivante.";alertAMalibu(message);return false;}
else{return true;}}
function verifConnexionB2B(){debugLogJS('verifConnexionB2B');}
function traiteVerifConnexionB2B(reponse){debugLogJs('traiteVerifConnexionB2B on passe encore');var retour=reponse.childNodes[0].childNodes[0].nodeValue;var formulaire=$("formIdent");var msg=unescape($("msgErr").value);if(retour=="OK")formulaire.submit();else alertAMalibu(msg);}
function verifBonB2B(){debugLogJS('verifBonB2B');}
function traiteVerifBonB2B(reponse){debugLogJs('traiteVerifBonB2B on passe encore');var retour=reponse.childNodes[0].childNodes[0].nodeValue;if(retour=="OK"){effaceDivAvecTransparence();rechargeEnteteBon();}else{if($("div_errNumBon"))$("div_errNumBon").innerHTML=reponse.childNodes[1].childNodes[0].nodeValue;else alertAMalibu(reponse.childNodes[1].childNodes[0].nodeValue);}}
function rechargeEnteteBon(){debugLogJS('rechargeEnteteBon');}
function rechargeListe(){debugLogJs('rechargeListe on passe encore');setListByForm($("frmBonTO"));}
function validFormAssurance(){debugLogJs('validFormAssurance on passe encore');$("frm_assur").submit();}
function checkFormAvecFuncQdFini(frm,funcQdFini){debugLogJs('checkFormAvecFuncQdFini on passe encore');var tabChkInput=getTabChmpForm(frm);var nbVerifAFaire=0;nbChampVerifie=0;for(var i=0;i<tabChkInput.length;i++){if(tabChkInput[i].getAttribute("modecheck"))nbVerifAFaire++;}
for(var i=0;i<tabChkInput.length;i++){var chpInputControl=null;var chpControle=tabChkInput[i].getAttribute("chpcontrol");if(chpControle){chpInputControl=$(chpControle);if(!chpInputControl)chpInputControl=chpControle;}
var modechk=tabChkInput[i].getAttribute("modecheck")
if(modechk){checkByInput(tabChkInput[i],modechk,chpInputControl,funcQdFini,nbVerifAFaire);}}}
function completeVilleAvecCP(table){debugLogJS('completeVilleAvecCP');}
function initValidationFormulaires(fonctionSiOk,fonctionSiErr){(function($){$(document).ready(function(){$.validator.setDefaults({debug:false});$.extend($.validator.messages,{required:$('#inpt_validate_obligatoire').val(),email:$('#inpt_validate_verifMail').val(),url:$('#inpt_validate_verifUrl').val(),date:$('#inpt_validate_verifDate').val(),number:$('#inpt_validate_verifNombre').val(),telephone:$('#inpt_validate_verifTel').val(),equalTo:$('#inpt_validate_verifEgalA').val(),egalA:$('#inpt_validate_verifEgalA').val(),listeDefautInterdit:$('#inpt_validate_listeDefautInterdit').val(),captcha:$('#inpt_validate_verifCaptcha').val(),maxlength:$.validator.format("Taille maxi : {0} caractres."),minlength:$.validator.format("Taille mini : {0} caractres.")});$.validator.addMethod("telephone",function(value,element){return this.optional(element)||(value.length==10&&!isNaN(value));});$.validator.addMethod("listeDefautInterdit",function(value,element){if($(element).is('select')){var defaut=$(element).children(':first').val();return value!==defaut;}else{return true;}});$.validator.addMethod("egalA",function(value,element){var elemComparaison=$(element).attr('data-egalA');if($('#'+elemComparaison).length>0){return($('#'+elemComparaison).val()==value);}});$.validator.addMethod("captcha",function(value,element){var succes=true;var tabRep=$.ajax({url:'lib_2/ajax/infosDist.php',data:{info:'checkCodeSecu',val:value},async:false}).responseText;eval("var tabRetour="+tabRep);if(tabRetour.code.toUpperCase()=='ERR'){succes=false;}
return succes;});$.validator.addClassRules({obligatoire:{required:true},verifNom:{maxlength:50,number:false},verifMail:{email:true},verifTel:{telephone:true},verifUrl:{url:true},verifCP:{number:true,minlength:5,maxlength:5},verifCaptcha:{captcha:true},listeDefautInterdit:{listeDefautInterdit:true}});$('form.form_validate').each(function(){$(this).validate({onkeyup:false,errorPlacement:function(error,element){$(element).siblings('.LV_validation_message').remove();var spanError='<span class="LV_validation_message LV_invalid">'+error.html()+'</span>';$(element).after(spanError);},success:function(error,element){var msgOk=$('#inpt_validate_OK').val();$(element).siblings('.LV_validation_message').remove();var spanOk='<span class="LV_validation_message LV_valid">'+msgOk+'</span>';$(element).after(spanOk);},submitHandler:function(){$(this).find('submit').hide();if(typeof(fonctionSiErr)=='function'){fonctionSiOk();}},invalidHandler:function(){if(typeof(fonctionSiErr)=='function'){fonctionSiErr();}}});});});})(jQuery);}
function initMailCheck(input){(function($){var pluginMailCheck=$.fn.mailcheck||false;if(!pluginMailCheck){$.getScript('/lib_2/js/api/Mailcheck_1.1.2/src/mailcheck.min.js',function(){Mailcheck.defaultDomains.push('9online.fr','aliceadsl.fr','aol.com','aol.fr','arcor.de','bbox.fr','belgacom.net','bluewin.ch','bnpparibas.com','btinternet.com','caramail.com','cegetel.net','club-internet.fr','dbmail.com','free.fr','freenet.de','gmail.com','gmx.de','gmx.fr','gmx.net','googlemail.com','hetnet.nl','hotmail.be','hotmail.co.uk','hotmail.com','hotmail.fr','icloud.com','infonie.fr','laposte.net','libero.it','libertysurf.fr','live.be','live.fr','mac.com','me.com','msn.com','netcourrier.com','neuf.fr','noos.fr','nordnet.fr','ntlworld.com','numericable.com','numericable.fr','orange.fr','outlook.com','outlook.fr','pandora.be','planet.nl','scarlet.be','sfr.fr','skynet.be','t-online.de','tele2.fr','telenet.be','tiscali.co.uk','tiscali.fr','videotron.ca','voila.fr','wanadoo.fr','web.de','worldonline.fr','xs4all.nl','yahoo.co.uk','yahoo.com','yahoo.de','yahoo.es','yahoo.fr','ymail.com');$.get('/lib_2/ajax/infosDist.php','info=motCleMailCheck',function(data){try{window.libelleMailCheck=data.libelle;}
catch(e){debugLogJS('verifs.js initCheckMail logg on a pas pu rcuprer le libelle');}},'json');setSuggestionMailCheck(input);});}
else{setSuggestionMailCheck(input);}})(jQuery);}
function setSuggestionMailCheck(input){(function($){var pluginMailCheck=$.fn.mailcheck||false;if(!pluginMailCheck){initMailCheck(input);}
else{$(input).blur(function(){$('.divMailCheckSuggestion').remove();$(input).mailcheck({suggested:function(element,suggestion){var html='<div class="divMailCheckSuggestion" style="display:none;clear:both;">';html+='<ul class="ulMailCheckSuggestion ui-front ui-menu ui-widget ui-widget-content">';html+='<li class="ui-menu-item ui-corner-all ui-widget"><a href="javascript:void(0)" class="aSuggestionMailCheck" data-value="'+suggestion.full+'">'+window.libelleMailCheck+' <strong>'+suggestion.full+'</strong> ?</a></li>';html+='</ul></div>';$(input).parent('div').append(html);$('.divMailCheckSuggestion').show('fast');$('.ulMailCheckSuggestion').css({'width':'90%'});$('.aSuggestionMailCheck').click(function(){var val=$(this).attr('data-value');$(input).val(val);$('.divMailCheckSuggestion').hide('fast');$(input).focus();});},empty:function(element){$('.divMailCheckSuggestion').remove();}});});}})(jQuery);}
function checkCodeSecu(value,args){var check=true;(function($){$.ajax({type:'POST',url:'/lib_2/ajax/infosDist.php',async:false,data:{info:'checkCodeSecu',val:value},dataType:'json',success:function(retour){if(retour.code!=='Ok'){check=false;}}});})(jQuery);return check;}
function getLiveValidationCaptcha(){var langue=jQuery("body").attr("data-langue");var tabMessages=getTabMessagesValidationFormulaireByLangue(langue);var codeSecu=new LiveValidation("captcha",{validMessage:tabMessages.valid,onlyOnSubmit:true});codeSecu.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});codeSecu.add(Validate.Custom,{against:function(value,args){return checkCodeSecu(value,args);},failureMessage:tabMessages.captcha});return codeSecu;}function afficheMoteurDates(idSelection,ident){var html="<div id='divPanier_moteurDate'></div>";html+="<a id='a_valider' onclick='setDatesPanier("+idSelection+");'>Valider</a>";html+="<a id='a_retour' onclick='effaceDivAvecTransparence();'>Retour</a>";afficheDivAvecTransparence(html,400,200);var adr="/lib_2/ajax/contenuFenetre.php";var sending=getInfoSession()+"&element=critere&typeInfo=date&ident="+ident;affUrlInDiv("divPanier_moteurDate",adr,sending);}
function setDatesPanier(idSelection){var adr="/lib_2/ajax/gerePanier.php";var sending="action=defDatesSelect&idSelect="+idSelection+"&jour="+document.getElementById('jour').value+"&mois="+document.getElementById('mois').value+"&annee="+document.getElementById('annee').value+"&duree="+document.getElementById('duree').value;effaceDivAvecTransparence();affUrlInDiv("divPanier_visu",adr,sending);}
function refreshPanier(){var divVisu="divPanier_visu";var divVisuNombre="divPanier_visuNb";var divVisuContenuNombre="spanPanier_nbOffres";var objDivVisu=$(divVisu);var objDivVisuNombre=$(divVisuNombre);var objDivVisuConteueNombre=$(divVisuContenuNombre);if(objDivVisu)affSelectionPanierDetails();if(objDivVisuNombre)affSelectionPanierNombre();if(objDivVisuConteueNombre)affSelectionPanierContenuNombre();}
function affSelectionPanierNombre(champTri,typeTri){var adr="/lib_2/ajax/gerePanier.php";var sending="action=affichePanierNombre";affUrlInDiv("divPanier_visuNb",adr,sending,"<img width=15px height=15px src='/config_v3/imgs_defaut/rouegrise.gif' />");}
function affSelectionPanierContenuNombre(){var adr="/lib_2/ajax/gerePanier.php";var sending="action=affichePanierContenuNombre";affUrlInDiv("spanPanier_nbOffres",adr,sending,"<img width=15px height=15px src='/config_v3/imgs_defaut/rouegrise.gif' />");}
function affSelectionPanierDetails(champTri,typeTri){var adr="/lib_2/ajax/gerePanier.php";if(!champTri)champTri="classement_epi";if(!typeTri)typeTri="tri_croissant";var sending="action=affichePanier&champTri="+champTri+"&typeTri="+typeTri+getInfoSession("PHPSESSID");affUrlInDiv("divPanier_visu",adr,sending,"<img width=30px height=30px src='/config_v3/imgs_defaut/rouegrise.gif' />Recherche en cours...Merci de patienter");}
function affSelectionPanierMini(){debugLogJS('affSelectionPanierMini');}
function afficheTabComparateur(nomIdDiv,champTri,typeTri){affSelectionPanierDetails(champTri,typeTri);}
function affEnregistrePanier(mdp){var html="<div id='divPanier_enregistrePanier'>";html+="<span id='spPanier_selectionEnregistree'>Votre slection a bien t enregistre.</span>";html+="<span id='spPanier_msgMdp'>Vous pouvez vous reconnectez utltrieurement avec le mot de passe suivant :</span>";html+="<span id='spPanier_mdp'>"+mdp+"</span>";html+="<a id='a_ok' onclick='effaceDivAvecTransparence();'>OK</a>";html+="</div>";afficheDivAvecTransparence(html,300,200);}
function affEchecEnregistrePanier(){var html="<div id='divPanier_enregistrePanier'>";html+="<span id='spPanier_selectionEnregistree'>Votre slection n'a p tre enregistre.</span>";html+="<span id='spPanier_msgMdp'>Merci de ressayer utltrieurement.</span>";html+="<a id='a_ok' onclick='effaceDivAvecTransparence();'>OK</a>";html+="</div>";afficheDivAvecTransparence(html,300,200);}
function initForPanier_v5(){if(typeof panierEstInit!='undefined'){return;}
(function($){$(".a_valideAjoutBoutiqueV5").live('click',function(){var params={action:"ajoutePanier_v5",panier_v5:"1"};params.codeProd=$(this).attr("data-codeprod");params.idTarif=$(this).attr("data-idtarif");params.qte=$("#nbprod_"+params.idTarif).val();var bouton=$(this);params.reload=bouton.attr('data-reload');$.ajax({type:"POST",url:"/lib_2/ajax/gerePanier.php",async:false,data:params,beforeSend:function(){var reload=bouton.attr('data-reload');if(reload){moteur_affMessageLoadingMoteur();}
else{attenteInDiv($('#div_liste_panierHautNonDate'));}},success:function(retour){if($('input[name="accesResa"]').val()=='O'){location.href=retour;}
else{var reload=bouton.attr('data-reload');if(reload){location.reload();}
else{if($('#div_liste_panierHautNonDate').length>0){$('#div_liste_panierHautNonDate').html(retour);}
if(typeof foncQdClick_a_valideAjoutBoutiqueV5==='function'){foncQdClick_a_valideAjoutBoutiqueV5();}}}}});});$('body').delegate('.boutiqueFNGF','click',function(){var codeProd=$(this).attr('data-codeprod');var idTarif=$('[name="choixTarifProdBoutique_'+codeProd+'"]').val();if(!idTarif){return;}
var qte=1;if($('form.formAjoutPanierComplet .select_compoNbPers[data-code="'+codeProd+'"][data-idtarif="'+idTarif+'"]:visible').length>0){qte=$('form.formAjoutPanierComplet .select_compoNbPers[data-code="'+codeProd+'"][data-idtarif="'+idTarif+'"]:visible').val();}
var objParams={codeProd:codeProd,idTarif:idTarif,qte:qte};ajouterAuPanierBoutique(objParams,null,window.majAffichagePanier);});$('body').delegate('.panier_detailsProduit .select_compoNbPers','change',function(){var objParams={codeProd:$(this).data('code'),idTarif:$(this).data('idtarif'),qte:$(this).val(),action:'setQuantite'};ajouterAuPanierBoutique(objParams,null,window.majAffichagePanier);});$('body').delegate('.formAjoutPanierComplet .selectIdTarifPourPanier','change',function(){var idTarif=$(this).val();$('.stockUnTarif .divTarifSelectQuantite').hide();$('.stockUnTarif .divTarifSelectQuantite[data-tarif="'+idTarif+'"]').slideDown('fast');});$(".a_enleveProdPanierV5").live('click',function(){var codeProd=$(this).attr("data-codeprod");var idTarif=$(this).attr("data-idtarif");$.ajax({type:"POST",url:"/lib_2/ajax/gerePanier.php",async:false,data:{panier_v5:"1",action:"supprimePanier_v5",codeProd:codeProd,idTarif:idTarif},beforeSend:function(){},success:function(){location.reload();}});});$(document).ready(function(){$('.boutiqueFNGF').each(function(){var codeProd=$(this).data('codeprod');var idTarif=$('[name="choixTarifProdBoutique_'+codeProd+'"]').val();if(!idTarif){$(this).addClass('pasDeStock');return;}});});initDivAjoutPanierComplet();panierEstInit=true;if(typeof foncQdFini_initForPanier_v5==='function'){foncQdFini_initForPanier_v5();}})(jQuery);}
function initDivAjoutPanierComplet(){(function($){$(document).ready(function(){if($('.formAjoutPanierComplet').length===0){return;}
$('.formAjoutPanierComplet .selectIdTarifPourPanier').trigger('change');if($('.formAjoutPanierComplet .inputIdTarifPourPanier').length>0){$('.stockUnTarif .select_compoNbPers').show('fast');}
$('.stockUnTarif').show('fast');});})(jQuery);}
function majAffichagePanier(retourAjax){(function($){try{$('.boutiquePanierNbProds').html(retourAjax.nb);$.each(retourAjax.divs,function(index,html){if($('.'+index).length>0){$('.'+index).replaceWith(html);var fonctionInit=$('.'+index).attr('data-fonctioninit');if(fonctionInit){window[fonctionInit]();}}});if(retourAjax.html){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:retourAjax.html,afterClose:function(){}});}}
catch(e){}})(jQuery);}
function ajouterAuPanierBoutique(tabParams,quelleReponseAjax,callback){(function($){var retourAjax=quelleReponseAjax||false;var params=tabParams;if(!params.action){params.action='ajoutePanier_v5';}
params.panier_v5='1';params.retourAjax=retourAjax;$.ajax({type:"POST",url:"/lib_2/ajax/gerePanier.php",async:false,dataType:'json',data:params,beforeSend:function(){afficheLoaderGlobal_site();},success:function(retour){if(callback){(callback)(retour);}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function initLienMultiResa(){(function($){$('.aLienMultiResa').click(function(){var tabInputs=$('input',this);var tabProds=[];$(tabInputs).each(function(){var lienResa=$(this).attr('data-link');var obj={ident:$(this).attr('data-ident'),link:lienResa};tabProds.push(obj);});supprimeFlagMultiResaDansLocalStorage();if(tabProds.length>0){var link=tabProds[0].link;window.open(link);}
window.addEventListener('message',function(event){var retour=JSON.parse(event.data)||false;if(retour){$.each(tabProds,function(index,obj){if(obj.ident==retour.prodBooked){tabProds.splice(index,1);return false;}});}
if(tabProds.length>0){var link=tabProds[0].link;if(!link.match(/jour/)&&!link.match(/mois/)&&!link.match(/annee/)){var sejour=localStorage.getItem('queryStringMultiResa')||false;if(sejour){link+='&'+sejour;}}
var param={link:link};event.source.postMessage(JSON.stringify(param),'*');}},false);});})(jQuery);}
function creerLienCgi(){(function($){$.ajax({type:"POST",url:"./ajax/appelsAjax.php",data:"action=getPopInLienCgi",success:function(result){$('body').append(result);var popin=$('#popinLienCgi').dialog({modal:true,autoOpen:true,width:550,dialogClass:'popinLienCgi',position:{my:"center top",at:"center top",of:'body'},open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog|ui).hide();},buttons:[{text:"Annuler","class":'ui-state-information',click:function(){$(this).dialog("close");$('#popinLienCgi').remove();}},{text:"Copier et fermer","class":'ui-state-information btnCopierLienCgi',click:function(){$('#btnCopieLienCgi').click();$(this).dialog("close");$('#popinLienCgi').remove();}}]});initDatePickerPopInLienCgi();$("#inputLienSelect").on('input',function(){majUrlLienCgi($('.dateLienCgi input:checked').val());});$('.dateLienCgi').on('change',function(){if($('#divInputDateLienCgi input').attr('disabled')==='disabled'){$('#divInputDateLienCgi input').removeAttr('disabled');}else{$('#divInputDateLienCgi input').attr('disabled','disabled');}
var val=$('.dateLienCgi input:checked').val();majUrlLienCgi(val);});var clipboard=new Clipboard('#btnCopieLienCgi');}});})(jQuery);}
function initDatePickerPopInLienCgi(){(function($){var minDate=new OBJDate();$('#input_dateDebResaLienCgi, #input_dateFinResaLienCgi').datepicker({dateFormat:'dd/mm/yy',numberOfMonths:3,changeMonth:true,changeYear:true,showOn:'focus',minDate:minDate.toString()});minDate.ajoutJour(1);$("#input_dateFinResaLienCgi").datepicker("option","minDate",minDate.toString());$("#input_dateFinResaLienCgi").datepicker('refresh');$('#input_dateDebResaLienCgi').datepicker('option','onSelect',function(selectedDate){var objDateDeb;var objDateFin;var objDateFinLimite=new OBJDate(selectedDate);var ecart;if($('#input_dureeResaLienCgi').val()&&!$('#input_dateFinResaLienCgi').val()){objDateDeb=new OBJDate(selectedDate);objDateFinLimite=new OBJDate(objDateDeb.toString());objDateFinLimite.ajoutJour(1);objDateDeb.ajoutJour($('#input_dureeResaLienCgi').val());$('#input_dateFinResaLienCgi').val(objDateDeb.toString());}else if($('#input_dateFinResaLienCgi').val()){objDateDeb=new OBJDate(selectedDate);objDateFinLimite=new OBJDate(objDateDeb.toString());objDateFinLimite.ajoutJour(1);objDateFin=new OBJDate(objDateDeb.toString());objDateFin.ajoutJour($('#input_dureeResaLienCgi').val());ecart=objDateFin.getNbJourEcartWithOBJDate(objDateDeb,"N");$('#input_dateFinResaLienCgi').val(objDateFin.toString());}
majUrlLienCgi('1',selectedDate);$("#input_dateFinResaLienCgi").datepicker("option","minDate",objDateFinLimite.toString());$("#input_dateFinResaLienCgi").datepicker('refresh');$(this).trigger('keyup');$('#input_dureeResaLienCgi').focus();});$('#input_dateFinResaLienCgi').datepicker('option','onSelect',function(selectedDate){var objDateFin;if($('#input_dureeResaLienCgi').val()&&!$('#input_dateDebResaLienCgi').val()){objDateFin=new OBJDate(selectedDate);objDateFin.enleveJour($('#input_dureeResaLienCgi').val());$('#input_dateDebResaLienCgi').val(objDateFin.toString());majUrlLienCgi('1',objDateFin.toString());}else if($('#input_dateDebResaLienCgi').val()){rempliDureeRechercheReservation();majUrlLienCgi('1');}
$(this).trigger('keyup');$('#input_dureeResaLienCgi').focus();});$('body').delegate('#input_dureeResaLienCgi','keyup',function(){var objDateDeb;var objDateFin;var objDateFinLimite=new OBJDate();if($('#input_dateDebResaLienCgi').val()){objDateDeb=new OBJDate($('#input_dateDebResaLienCgi').val());$('#input_dateDebResa').val(objDateDeb.toString());objDateFinLimite=new OBJDate(objDateDeb.toString());objDateFinLimite.ajoutJour(1);$("#input_dateFinResaLienCgi").datepicker("option","minDate",objDateFinLimite.toString());$("#input_dateFinResaLienCgi").datepicker('refresh');}
if($('#input_dateFinResaLienCgi').val()){objDateFin=new OBJDate($('#input_dateFinResaLienCgi').val());$('#input_dateFinResaLienCgi').val(objDateFin.toString());}
if($('#input_dureeResaLienCgi').val()){if($('#input_dateDebResaLienCgi').val()){objDateDeb.ajoutJour($('#input_dureeResaLienCgi').val());$('#input_dateFinResaLienCgi').val(objDateDeb.toString());majUrlLienCgi('1');}else if($('#input_dateFinResaLienCgi').val()){objDateFin.enleveJour($('#input_dureeResaLienCgi').val());$('#input_dateDebResaLienCgi').val(objDateFin.toString());majUrlLienCgi('1',objDateFinLimite.toString());}}});$('#input_dateDebResaLienCgi, #input_dateFinResa').blur(function(){if($(this).val()){var objDate=new OBJDate($(this).val());$(this).val(objDate.toString());}
rempliDureeRechercheReservation();});$('label.trigger-input-date-picker').click(function(){if($('#'+$(this).attr('for')).attr('disabled')!=='disabled'){$('#'+$(this).attr('for')).datepicker('show');}});})(jQuery);}
function rempliDureeRechercheReservation(){(function($){var dateDeb=$('#input_dateDebResaLienCgi').val();var dateFin=$('#input_dateFinResaLienCgi').val();if(dateDeb===undefined||dateFin===undefined||dateFin.length===0||dateDeb.length===0){return;}
var objDateFin=new OBJDate(dateFin);var objDateDeb=new OBJDate(dateDeb);var ecart=objDateFin.getNbJourEcartWithOBJDate(objDateDeb,"N");$('#input_dureeResaLienCgi').val(ecart);})(jQuery);}
function majUrlLienCgi(avecDates,newDate){(function($){var baseUrl=$('#inputLienSelect').val();if(baseUrl.length===0){baseUrl=$('#valueBaseLienCgi').val();}
var queryString=$('#queryStringLienCgi').val();if(avecDates==="1"&&($('#input_dateDebResaLienCgi').val()!==""||(newDate!==""&&newDate===null&&newDate===undefined))){if(newDate===null||newDate===undefined){var objDateDeb=new OBJDate($('#input_dateDebResaLienCgi').val());}else{var objDateDeb=new OBJDate(newDate);}
var nbJour=$('#input_dureeResaLienCgi').val();var txtDateDeb="";var txtNbJour="";if(objDateDeb.toString().length>0){txtDateDeb="&DEB="+objDateDeb.toString('ddmmyyyy');}
if(nbJour!==""&&nbJour!="0"){txtNbJour="&NBJ="+nbJour;}
queryString+=txtDateDeb+txtNbJour;}
$('#inputLienCgiComplet').val(baseUrl+queryString);})(jQuery);}
function affAttenteListe(idDivGene){if(!idDivGene)idDivGene="div_contentListe";affMsgAttenteParDessusInDiv(idDivGene);}
function affAttenteMoteur(classMoteur){$$('.'+classMoteur).each(function(elt){affMsgAttenteParDessusInDiv(elt,"_moteur");});}
function effAttenteMoteur(classMoteur){$$('.'+classMoteur).each(function(elt){effaceMsgAttenteParDessus("_moteur");});}
function setParamCgiEtRefreshList(querystring,params){affAttenteListe();setCGIByAjax(querystring,true,refreshListe,params);}
function refreshListe(ok,params){var typeInfo,idDiv,idPageArboDiv="";if(params&&params.idDiv)idDiv=params.idDiv
if(!idDiv)idDiv="divLst_generale";if(params&&params.arboDiv)idPageArboDiv=params.arboDiv;if(params&&params.typeInfo)typeInfo=params.typeInfo;else typeInfo="visu_structAllId";var url="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&";sending+="typeInfo="+typeInfo+"--"+idPageArboDiv+"&";sending+=getInfoSession("PHPSESSID");sending+="&CGISCUR="+escape(getQueryString());if(params&&params.cgis)sending+="&CGIS="+escape(params.cgis);if(params&&params.saveCrits)sending+="&SAVECRIT=O";if(params&&params.avecGestionPage==false)sending+="&PAGINATION=N";else sending+="&PAGINATION=O";affUrlInDiv(idDiv,url,sending,"aucun",function(retour){checkPageSiAfficheVraiPrixDansListe();if(window.gmap)window.gmap.reload();checkPageSiDivForChargePrixInLst();effAttenteMoteur(params.classDivMoteur);gereAffichageTriParPrix();if(window.onRefreshList)onRefreshList();});}
function refreshListeAvecQueProp(queProp,accs){$$(".iteaListeArboDiv").each(function(elt){refreshListe(null,{"cgis":"QUEPROP="+queProp+"&ACC="+accs,"saveCrits":false,"arboDiv":elt.getAttribute("arbodiv"),"idDiv":elt.getAttribute("id")});});}
function finRefreshList(params){setForNavigPage();checksForListe();if(window.onRefreshList)onRefreshList();if(params)if(params.objForm)reactiveForm(params.objForm);effaceMsgAttenteParDessus();effAttenteMoteur();}
function reloadListe(idDiv,idArboDiv){affAttenteListe();var url="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&";sending+="typeInfo=visu_structReload--"+idArboDiv;affUrlInDiv(idDiv,url,sending,"aucun",function(retour){finRefreshList(null);});}
function gereAffichageTriParPrix(result){if(result=="toutestok"||$('itea_divForPrixOkInObjLst')){if($('div_liste_critereTriHautAvecImgPrix')){var obj=$('div_liste_critereTriHautAvecImgPrix');if(obj.childNodes[0].childNodes[0]){obj.childNodes[0].childNodes[0].style.visibility="visible";}}}}
function gaTrackMoteurAjax(querystring){var params=new String(querystring).split("&");var paramsOut=new Array();for(var i=0;i<params.length;i++){var chpsparam=params[i].split("=");var variable=chpsparam[0];var valeur=chpsparam[1];if(variable&&valeur)paramsOut.push(variable+"-"+valeur);}
paramsOut.sort();var lnkVirtuel="/liste/"+paramsOut.join("/");gaTrack(lnkVirtuel);return true;}
function setListByForm(form){var qs=getQueryStringByForm(form)+"&critinit=O";desactiveForm(form);gaTrackMoteurAjax(qs);if(!$("divLst_generale")||($($("divLst_generale").parentNode)&&$($("divLst_generale").parentNode).hasClassName("iteaDivDynamique_listeOffre"))){affMsgAttenteParDessusInDiv("page_content");var url="/liste?";if($("divNomHttpHostSiteInit"))url="http://"+$("divNomHttpHostSiteInit").innerHTML+url;document.location.href=url+qs;}else{affAttenteListe();refreshListe(null,{'objForm':form,'saveCrits':true,'cgis':qs,'avecGestionPage':true});}}
function setDivNbEtNavigation(){(function($){$('div.navigListe').each(function(index){$.post('/lib_2/ajax/contenuFenetre.php',{element:'HTML_navigPage',suffixe:$(this).data('suffixe'),nbmarge:$(this).data('nbmarge'),inverse:$(this).data('inverse'),affichenumerospages:$(this).data('affichenumerospages')},function(rep){$(this).html(rep);console.log('setDivNbEtNavigation');console.log(rep);});});})(jQuery);}
function setNbResultByCgi(classe,obj){var lstCgi="";var tabInfos=new Array();var cpt=0;if(obj){var enfants=obj.descendants();enfants.each(function(obj2){if(obj2.hasClassName(classe)){if(obj2.getAttribute("cgi").length>0&&obj2.getAttribute("valeur").length>0){obj2.innerHTML="<img src=/config_v3/imgs_defaut/chargement_3Points.gif id=imgChargementAffParamCGI class=imgChargementAffParamCGI width=10/>";if(lstCgi.length>1)lstCgi+="|";if(obj2.getAttribute("data-cgi")){var cgi=obj2.getAttribute("data-cgi");var valeur=obj2.getAttribute("data-valeur");}
else{var cgi=obj2.getAttribute("cgi");var valeur=obj2.getAttribute("valeur")}
lstCgi+=cgi+"-"+obj2.getAttribute("valeur");tabInfos[cpt]=new Array();tabInfos[cpt]["cgi"]=cgi;tabInfos[cpt]["valeur"]=valeur;tabInfos[cpt]["id"]=obj2.getAttribute("id");cpt++;}}});}
else{if(classe){$$('.'+classe).each(function(obj){if(obj.getAttribute("data-cgi")){var cgi=obj.getAttribute("data-cgi");var valeur=obj.getAttribute("data-valeur");}
else{var cgi=obj.getAttribute("cgi");var valeur=obj.getAttribute("valeur")}
if(cgi.length>0&&valeur.length>0){obj.innerHTML="<img src=/config_v3/imgs_defaut/chargement_3Points.gif id=imgChargementAffParamCGI class=imgChargementAffParamCGI width=10/>";if(lstCgi.length>1)lstCgi+="|";lstCgi+=cgi+"-"+valeur;tabInfos[cpt]=new Array();tabInfos[cpt]["cgi"]=cgi;tabInfos[cpt]["valeur"]=valeur;tabInfos[cpt]["id"]=obj.getAttribute("id");cpt++;}});}}
if(lstCgi.length==0){return;}
var adr="/lib_2/ajax/infosCGI.php";var sending="typeInfo=NBRESULTBYCGI&CGI="+lstCgi;if(estSurPanier())
sending+="&mode=panier";appelAjaxToFunc(adr,sending,function(reponse){if(reponse){var tabRep=eval("("+reponse+")");var tabRepAcc=tabRep["ACC"];var tabRepAmb=tabRep["AMB"];var tabRepCrit=tabRep["CRIT"];var tabRepThemat=tabRep["THEMAT"];var tabRepInfosGeo=tabRep["INFOS_GEO"];var tabRepPaiement=tabRep["PAIEMENT"];var tabRepImperatifs=tabRep["IMPERATIFS"];var tabRepOffre=tabRep["OFFRE"];var tabRepCritDyn=tabRep["CRITDYN"];if(is_array(tabRepAcc)){tabRepAcc.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["type_web"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){elt.innerHTML="("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepInfosGeo)){tabRepInfosGeo.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["insee"]==info["valeur"].toUpperCase()){var elt=$(info["id"]);if(rep["nb"]>0)elt.innerHTML="("+format_nb(rep["nb"],"."," ")+")";else{elt.parentNode.parentNode.parentNode.removeChild(elt.parentNode.parentNode.parentNode.firstChild);}}
else if(rep["dpt"]==info["valeur"].toUpperCase()){var elt=$(info["id"]);if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}
else if(rep["region"]==info["valeur"].toUpperCase()){var elt=$(info["id"]);if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}
else if(rep["infotourfd"]==info["valeur"]){var elt=$(info["id"]);if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepAmb)){tabRepAmb.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi_amb"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepCrit)){tabRepCrit.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepThemat)){tabRepThemat.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepOffre)){tabRepOffre.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepCritDyn)){tabRepCritDyn.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepPaiement)){tabRepPaiement.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}
if(is_array(tabRepImperatifs)){tabRepImperatifs.each(function(rep){var tailleInfo=tabInfos.length;for(var i=0;i<tailleInfo;i++){var info=tabInfos[i];if(rep["cgi"]==info["cgi"].toUpperCase()){var elt=$(info["id"]);if(rep['nb']===undefined){elt.classList.add('sp_nb_result_ne_pas_effacer_laisser_vide');}else if(rep["nb"]>0){if($(elt).hasClassName("sp_nbResultSansParanthese"))elt.innerHTML=format_nb(rep["nb"],"."," ");else elt.innerHTML=" ("+format_nb(rep["nb"],"."," ")+")";}}}});}}
if(obj){var enfants=obj.descendants();enfants.each(function(objGen){if(objGen.hasClassName(classe)){var reg1=new RegExp("(img)","g");if((!objGen.innerHTML.length>0||objGen.innerHTML.match(reg1))&&!objGen.hasClassName("sp_nb_result_ne_pas_effacer")&&!objGen.hasClassName("sp_nb_result_ne_pas_effacer_laisser_vide")){objGen.parentNode.parentNode.parentNode.parentNode.style.display="none";}
else if(objGen.hasClassName("sp_nb_result_ne_pas_effacer")&&objGen.innerHTML.match(reg1)){objGen.innerHTML="(0)";}
else if(objGen.hasClassName("sp_nb_result_ne_pas_effacer_laisser_vide")&&objGen.innerHTML.match(reg1)){objGen.innerHTML="";}}});}else{$$('.'+classe).each(function(obj){var reg1=new RegExp("(img)","g");if((!obj.innerHTML.length>0||obj.innerHTML.match(reg1))&&!obj.hasClassName("sp_nb_result_ne_pas_effacer")&&!obj.hasClassName("sp_nb_result_ne_pas_effacer_laisser_vide")){var liToClean=obj.up('li');if(liToClean){liToClean.style.display="none";}
else{obj.parentNode.parentNode.parentNode.parentNode.style.display="none";}}
else if(obj.hasClassName("sp_nb_result_ne_pas_effacer")&&obj.innerHTML.match(reg1)){obj.innerHTML="(0)";}
else if(obj.hasClassName("sp_nb_result_ne_pas_effacer_laisser_vide")&&obj.innerHTML.match(reg1)){obj.innerHTML="";}});if(jQuery('.moteur_divCritsCombi').length>0){jQuery.each(jQuery('.moteur_divCritsCombi'),function(){if(jQuery(this).children('ul.moteur_ulCritsCombi').find('li[style]').length==jQuery(this).children('ul.moteur_ulCritsCombi').find('li').length){jQuery(this).hide();}});}}
effaceMsgAttenteParDessus();if(window.moteur_initBoutonsAfficheMasqueCriteres)moteur_initBoutonsAfficheMasqueCriteres();if(typeof(setNbResultByCgi_foncQdFini)=='function'){setNbResultByCgi_foncQdFini();}});}
function setListByClassName(classe,classDivMoteur,foncAvant){var result=true;if(foncAvant){result=foncAvant();}
if(result){var qs=getQueryStringByClassName(classe);gaTrackMoteurAjax(qs);if(!$("divLst_generale")||($($("divLst_generale").parentNode)&&$($("divLst_generale").parentNode).hasClassName("iteaDivDynamique_listeOffre"))){affMsgAttenteParDessusInDiv("page_content");var url="/liste?";if($("divNomHttpHostSiteInit"))url="http://"+$("divNomHttpHostSiteInit").innerHTML+url;document.location.href=url+qs;}else{window.objCarte=$('divgmap3');affAttenteListe();affAttenteMoteur(classDivMoteur);refreshListe(null,{'saveCrits':true,'cgis':qs,'avecGestionPage':true,'idDiv':"page_content",'classDivMoteur':classDivMoteur});}}}
function checkForListeDivDynamique(){var avecGestionPage,url="/lib_2/ajax/contenuFenetre.php";var sending=getInfoSession("PHPSESSID")+"element=objProd&";sending+="typeInfo=visu_structAllId";$$(".iteaDivDynamique_listeOffre").each(function(element){var cgis=element.getAttribute("cgis");idDivGene=element.id;idPageArboDiv=element.getAttribute("idArboDiv");if($$(".iteaDivDynamique_listeOffre").length>1)avecGestionPage=false;else avecGestionPage=true;refreshListe(true,{'idDiv':element.id,'arboDiv':idPageArboDiv,'typeInfo':'visu_structLstDyn','cgis':cgis,'avecGestionPage':avecGestionPage});});}
function refreshNumeroPage(prefix_id_navigPage,numPage,classe,foncQdfini){var tabSuffPossible=new Array("","_haut","_bas");var tabTypeNav=new Array("int","num");for(var i=0;i<tabSuffPossible.length;i++){for(var j=0;j<2;j++){var obj=$(prefix_id_navigPage+tabSuffPossible[i]+"_"+tabTypeNav[j]+"_"+numPage);if(obj){setClassForObj_uniqClass(obj,classe+tabSuffPossible[i]);}}}
if(foncQdfini)foncQdfini(numPage);}
function afficheListeByAjx_setPage(numPage,foncQdFini){var adr="/lib_2/ajax/contenuFenetre.php";var tabDivLst=getInfoArboDiv();cleanAllAJAXcall();affAttenteListe();if($('ul_navigListeNumerosPage_haut')){$('ul_navigListeNumerosPage_haut').innerHTML="";affMsgAttenteInDiv("ul_navigListeNumerosPage_haut");}
if($('ul_navigListeNumerosPage_bas')){$('ul_navigListeNumerosPage_bas').innerHTML="";affMsgAttenteInDiv("ul_navigListeNumerosPage_bas");}
checkNombrePage(numPage);for(var i=0;i<tabDivLst.length;i++){var idDiv=tabDivLst[i]["ID"];var idArboDiv=tabDivLst[i]["arboDiv"];var sendingLst="element=objProd&typeInfo=visu_structByIdSetPage-"+numPage+"-"+idArboDiv+getInfoSession("PHPSESSID");sendingLst+="&CGISCUR="+escape(getQueryString());affUrlInDiv(idDiv,adr,sendingLst,"aucun",function(evt){checkPageSiAfficheVraiPrixDansListe();checkPageSiDivForChargePrixInLst();effaceMsgAttenteParDessus();if(foncQdFini)foncQdFini();if(window.onRefreshListChgtTriEtPage)onRefreshListChgtTriEtPage();});}}
function selectThisInMenu(obj,classePasSelect,classeSelect){obj.removeClassName(classePasSelect);obj.addClassName(classeSelect);var arret;}
function goToNavigPage(prefix_id_navigPage,numPage_suiv,numPage_curr,classe){var tabSuffPossible=new Array("_haut","_bas");for(var i=0;i<tabSuffPossible.length;i++){var obj_curr=document.getElementById(prefix_id_navigPage+tabSuffPossible[i]+"_"+numPage_curr);var obj_suiv=document.getElementById(prefix_id_navigPage+tabSuffPossible[i]+"_"+numPage_suiv);var obj_ul=document.getElementById("ul_navigListeNumerosPage"+tabSuffPossible[i]);if(obj_curr&&obj_suiv&&obj_ul){var x_curr=parseInt(obj_curr.offsetLeft);var x_suiv=parseInt(obj_suiv.offsetLeft);var decal=parseInt(x_curr-x_suiv);setClassForObj(obj_suiv,classe+tabSuffPossible[i]);new Effect.Move(obj_ul,{x:decal,mode:'relative'});}}}
function setTriOpenDiv(obj,nomDiv){if(!nomDiv){var nomDiv=obj.getAttribute("idDivLst");}
var lst=$(nomDiv);if(!lst.showing){lst.style.display="block";lst.showing=true;var chps=nomDiv.split("_");var suffixe=chps.pop();var adr="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&typeInfo=getDivTri-"+suffixe;appelAjaxToFunc(adr,sending,function(reponse){if(reponse)$(nomDiv).update(reponse);});}else{lst.style.display="none";lst.showing=false;}}
function afficheListeByAjx_setTri_bySelect(){if(jQuery(".select_triListe").length>0){jQuery(".select_triListe").bind('change selectmenuchange',function(){var fonc=jQuery(this).find("option:selected").attr("data-fonction");var ordre=jQuery(this).find("option:selected").attr("data-ordre");var url=document.location.href;url=getUrlWithLstParam(url,"order_by",fonc);url=getUrlWithLstParam(url,"order_by_tri",ordre);if(estMoteurSansLien()){refreshListeWithCgi(url+'&'+jQuery('#itea_page_contentListe').attr('data-cgi'));jQuery('#select_triListe_haut').selectmenu("close");}else{document.location.href=url
moteur_affMessageLoadingMoteur();}});}}
function afficheListeByAjx_setTri(tabDivLst,objSelect,prefixIdObjPiloteTri){var tabSuffPossible=new Array("","_haut","_bas");var objSelectHtml=objSelect.innerHTML;for(var i=0;i<tabSuffPossible.length;i++){var objPiloteTri=$(prefixIdObjPiloteTri+tabSuffPossible[i]);if(objPiloteTri){objPiloteTri.innerHTML=objSelectHtml;var objLst=$(objPiloteTri.getAttribute("idDivLst"));objLst.hide();}}
var fonc=objSelect.getAttribute("fonction");var ordre=objSelect.getAttribute("ordre");var imgNonClic;$$(".imgTri").each(function(element){imgNonClic=element.getAttribute("srcImgNonClic");if(imgNonClic)element.src=imgNonClic;});var libelle=objSelect.getAttribute("libelle");if(libelle=="O"){if(ordre=="croissant"){ordre="decroissant";imgClic=objSelect.previousSibling.firstChild.nextSibling.firstChild.getAttribute("srcImgClic");objSelect.previousSibling.firstChild.nextSibling.firstChild.src=imgClic;}
else{ordre="croissant";imgClic=objSelect.previousSibling.firstChild.firstChild.getAttribute("srcImgClic");objSelect.previousSibling.firstChild.firstChild.src=imgClic;}
objSelect.setAttribute("ordre",ordre);}
var adr="/lib_2/ajax/contenuFenetre.php";affAttenteListe();var idDiv=tabDivLst[1];var idArboDiv=tabDivLst[0];var sendingLst="element=objProd&typeInfo=visu_structByIdSetTri-"+fonc+"/"+ordre+"-"+idArboDiv+getInfoSession("PHPSESSID");if(!$(idDiv))idDiv=$("itea_page_contentListe");sendingLst+="&CGISCUR="+escape(getQueryString());affUrlInDiv(idDiv,adr,sendingLst,"aucun",function(evt){effaceMsgAttenteParDessus();checkPageSiAfficheVraiPrixDansListe();checkPageSiDivForChargePrixInLst();if(window.onRefreshListChgtTriEtPage)onRefreshListChgtTriEtPage();for(var i=0;i<tabSuffPossible.length;i++){var objPiloteTri=$(prefixIdObjPiloteTri+tabSuffPossible[i]);if(objPiloteTri){objPiloteTri.innerHTML=objSelectHtml;}}});refreshNumeroPage('li_navigListeNumeroPage',1,'li_navigListeNumeroPageSelect');setForNavigPage();}
function afficheListeByAjx_setTriPanier(tabDivLst,objSelect,prefixIdObjPiloteTri){var tabSuffPossible=new Array("","_haut","_bas");for(var i=0;i<tabSuffPossible.length;i++){var objPiloteTri=$(prefixIdObjPiloteTri+tabSuffPossible[i]);if(objPiloteTri){objPiloteTri.innerHTML=objSelect.innerHTML;var objLst=$(objPiloteTri.getAttribute("idDivLst"));objLst.hide();}}
var fonc=objSelect.getAttribute("fonction");var ordre=objSelect.getAttribute("ordre");var imgNonClic;$$(".imgTri").each(function(element){imgNonClic=element.getAttribute("srcImgNonClic");if(imgNonClic)element.src=imgNonClic;});var imgClic=objSelect.firstChild.getAttribute("srcImgClic");if(imgClic)objSelect.firstChild.src=imgClic;var adr="/lib_2/ajax/gerePanier.php";affAttenteListe();var idDiv=tabDivLst[1];var idArboDiv=tabDivLst[0];var sendingLst="action=setTri&champTri="+fonc+"&typeTri="+ordre+"&idArboDiv="+idArboDiv;if(!$(idDiv)){idDiv=$$(".iteaListeArboDiv")[0];}
sendingLst+="&CGISCUR="+escape(getQueryString());affUrlInDiv(idDiv,adr,sendingLst,"aucun",function(evt){effaceMsgAttenteParDessus();checkPageSiAfficheVraiPrixDansListe();checkPageSiDivForChargePrixInLst();if(window.onRefreshListChgtTriEtPage)onRefreshListChgtTriEtPage();});refreshNumeroPage('li_navigListeNumeroPage',1,'li_navigListeNumeroPageSelect');setForNavigPage();}
function initChangeNombreElementParPage(){if(jQuery(".select_choix_elem").length>0){jQuery(".select_choix_elem").bind('change selectmenuchange',function(){var nb=jQuery(this).find("option:selected").attr("value");var url=document.location.href;url=getUrlWithLstParam(url,"nbparpage",nb);if(estMoteurSansLien()){refreshListeWithCgi(url+'&'+jQuery('#itea_page_contentListe').attr('data-cgi'));}else{document.location.href=url;moteur_affMessageLoadingMoteur();}});}}
function changeNombreElementParPage(idselect,fctQdFini,valeurBrute){var url=document.location.href;document.location.href=getUrlWithLstParam(url,"nbparpage",valeurBrute);return;}
function changeNombreElementParPagePanier(idselect,fctQdFini,valeurBrute){var adr="/lib_2/ajax/gerePanier.php";affAttenteListe();var idDiv="page_content";var sendingLst="action=changePage";if(valeurBrute){sendingLst+="&valeur="+valeurBrute;}else{sendingLst+="&valeur="+$(idselect).value;}
affUrlInDiv(idDiv,adr,sendingLst,"aucun",function(evt){if(window.onRefreshListChgtTriEtPage)onRefreshListChgtTriEtPage();if(fctQdFini){window[fctQdFini]();}});refreshNumeroPage('li_navigListeNumeroPage',1,'li_navigListeNumeroPageSelect');}
function checkNombrePage(page){}
function checkNbElemParPage(suffixe){return;if(suffixe=="haut")var suffixe2="bas"
else var suffixe2="haut";if($('select_choix_elem_'+suffixe2)){$('select_choix_elem_'+suffixe2).value=$('select_choix_elem_'+suffixe).value;}}
function gereNbElementsPageForListe(id,value,fctQdFini,estsurPanier){if(jQuery('#'+id+'bas li').length>0){jQuery('#'+id+'bas li').removeClass('selected');jQuery('#'+id+'bas li[data-value='+value+']').addClass('selected');}
if(jQuery('#'+id+'haut li').length>0){jQuery('#'+id+'haut li').removeClass('selected');jQuery('#'+id+'haut li[data-value='+value+']').addClass('selected');}
changeNombreElementParPage('',fctQdFini,value)}
function checksForListe(){checkNombrePage();checkPageSiDivForAbecedaireCommune();checkPageSiDivForNbResult();checkPageSiAfficheVraiPrixDansListe();checkPageSiDivForChargePrixInLst();checkPageSiDivTriEtDivPage();gereAffichageTriParPrix();}
function checkPageSiDivTriEtDivPage(){var url="/lib_2/ajax/infosDist.php";var sending="info=NBRESULTS";if($$(".effaceQdPasResult").length>0){appelAjaxToFunc(url,sending,function(reponse){if(reponse){eval("var result="+reponse);$$(".effaceQdPasResult").each(function(elt){if(result.nb_result>0)elt.style.display="block";else elt.style.display="none";});}});}}
function checkPageSiAfficheVraiPrixDansListe(){$$(".itea_divLstPrix1StructAjax").each(function(elt){var deb=elt.getAttribute("deb");if(!deb)return;var url="/lib_2/ajax/infosDist.php";var sending="info=REQ4&ident="+elt.getAttribute("ident")+"&deb="+deb+"&nbj="+elt.getAttribute("nbj")+"&dpt="+elt.getAttribute("dpt");appelAjaxToFunc(url,sending,function(reponse){if(reponse){var objParentCourant=elt.parentNode;var firstChild=elt.children;if(firstChild[0]){if(firstChild[0]&&!firstChild[0].hasClassName("span_lst_libelle_avant_prix")){htmlSpanAvantPrix="<span class='span_lst_libelle_avant_prix'></span>";}else{if(firstChild[0]&&firstChild[0].hasClassName("span_lst_libelle_avant_prix"))
htmlSpanAvantPrix="<span class='span_lst_libelle_avant_prix_vous_aimerez_aussi span_lst_libelle_avant_prix'></span>";else htmlSpanAvantPrix="";}}
eval("var infosPrix="+reponse);if(infosPrix&&infosPrix.prix_promo>0&&parseInt(infosPrix.prix_promo)!=parseInt(infosPrix.prix_normal)){if(elt.hasClassName("prixArrondi"))html="<span class='prixListeAvantPromo'>"+parseInt(Math.round(infosPrix.prix_normal))+"&nbsp;&euro;</span>";else html="<span class='prixListeAvantPromo'>"+infosPrix.prix_normal+"&nbsp;&euro;</span>";if(elt.hasClassName("prixArrondi"))html+="<span class='prixListePromo'>"+parseInt(Math.round(infosPrix.prix_promo))+"&nbsp;&euro;</span>";else html+="<span class='prixListePromo'>"+infosPrix.prix_promo+"&nbsp;&euro;</span>";}else{if(elt.hasClassName("prixArrondi"))html="<strong><span class='prixListeNormal'>"+parseInt(Math.round(infosPrix.prix_normal))+"&nbsp;&euro;</span></strong>";else html="<span class='prixListeNormal'>"+infosPrix.prix_normal+"&nbsp;&euro;</span>";}
elt.innerHTML=html;if(objParentCourant){firstChild=objParentCourant.children;objParentCourant.innerHTML=htmlSpanAvantPrix+objParentCourant.innerHTML;if(firstChild[0]&&firstChild[0].hasClassName("span_lst_libelle_avant_prix_vous_aimerez_aussi")){chargeMotCleDsDiv(firstChild[0],"LBL_TARIF_SEJOUR_AVANT_VOUS_AIMEREZ");}
else if(firstChild[0]&&firstChild[0].hasClassName("span_lst_libelle_avant_prix")){chargeMotCleDsDiv(firstChild[0],"LBL_TARIF_SEJOUR_AVANT");}}}});});}
function checkPageSiDivForChargePrixInLst(){$$(".itea_divForLoadNewPrixInLstForDate").each(function(elt){if(!elt.getAttribute("deb"))return;var url="lib_2/ajax/infosDist.php";var sending="info=SETPXINOBJLST&deb="+elt.getAttribute("deb")+"&nbj="+elt.getAttribute("nbj");appelAjaxToFunc(url,sending,function(reponse){});});$$(".itea_divForDispoBaseNatForDate").each(function(elt){$$(".div_bt_reserverDispogiteFNGF").each(function(elt){elt.style.display="none";});var url="lib_2/ajax/infosDist.php";if(!elt.getAttribute("deb"))return;var sending="info=SETDISPOINOBJLSTDBNAT&instance_exe="+elt.getAttribute("instance_exe")+"&instance="+elt.getAttribute("instance")+"&dpt="+elt.getAttribute("dpt")+"&type_gite="+elt.getAttribute("type_gite")+"&id_famille="+elt.getAttribute("id_famille")+"&deb="+elt.getAttribute("deb")+"&nbj="+elt.getAttribute("nbj")+"&ope="+elt.getAttribute("ope");appelAjaxToFunc(url,sending,function(reponse){if(reponse){checkPageAfficheBtResaSiDispogiteResa();checkPageSiDivForNbResult();checkNombrePage();}});});var tabExec=new Array();$$(".itea_divForPrixBaseNatForDate").each(function(elt){var url="lib_2/ajax/infosDist.php";if(!elt.getAttribute("deb"))return;if(tabExec[elt.getAttribute("instance_exe")+"_"+elt.getAttribute("dpt")+"_"+elt.getAttribute("type_gite")+"_"+elt.getAttribute("id_famille")+"_"+elt.getAttribute("deb")+"_"+elt.getAttribute("nbj")]!=true){var sending="info=SETPXINOBJLSTDBNAT&instance_exe="+elt.getAttribute("instance_exe")+"&instance="+elt.getAttribute("instance")+"&dpt="+elt.getAttribute("dpt")+"&type_gite="+elt.getAttribute("type_gite")+"&id_famille="+elt.getAttribute("id_famille")+"&deb="+elt.getAttribute("deb")+"&nbj="+elt.getAttribute("nbj")+"&ope="+elt.getAttribute("ope")+"&pomxj="+elt.getAttribute("pomxj");tabExec[elt.getAttribute("instance_exe")+"_"+elt.getAttribute("dpt")+"_"+elt.getAttribute("type_gite")+"_"+elt.getAttribute("id_famille")+"_"+elt.getAttribute("deb")+"_"+elt.getAttribute("nbj")]=true;appelAjaxToFunc(url,sending,function(reponse){gereAffichageTriParPrix(reponse);});}});}
function checkPageAfficheBtResaSiDispogiteResa(){var url="lib_2/ajax/infosDist.php";var sending="info=GETIDENTDISPOGITERESERVABLE";appelAjaxToFunc(url,sending,function(reponse){if(reponse){var tabIdentBtAAfficher=new String(reponse).evalJSON();$A(tabIdentBtAAfficher).each(function(ident){var bt=$("btResaDispoGite_"+ident);if(bt)bt.style.display="block";});}});}
function checkPageSiDivForNbResult(){if(!getCookie("__sess_")&&!getCookie("__sessV5_")&&window.foncQdPadCookie){window.foncQdPadCookie();return false;}
$$(".itea_div_liste_infoNbResultat_ajx").each(function(elt){var adr="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&typeInfo=getNbResult";sending+="&CGISCUR="+escape(getQueryString());if(estSurPanier())sending+="&mode=panier";appelAjaxToFunc(adr,sending,function(reponse){if(reponse)$(elt).update(reponse);if(window.refreshNbPageInNav)window.refreshNbPageInNav();});});$$(".itea_div_liste_infoDetailsNbResultatGestionProp_ajx").each(function(elt){var adr="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&typeInfo=getNbResultDetailsProp";sending+="&CGISCUR="+escape(getQueryString());appelAjaxToFunc(adr,sending,function(reponse){if(reponse)$(elt).update(reponse);});});$$('.itea_div_liste_InfoCritCourant').each(function(elt){var adr="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&typeInfo=getInfoCritCourant";sending+="&CGISCUR="+escape(getQueryString());if(estSurPanier())sending+="&mode=panier";elt.innerHTML="";affMsgAttenteInDiv(elt.id);appelAjaxToFunc(adr,sending,function(reponse){if(reponse)$(elt).update(reponse);});});}
function checkPageSiDivForAbecedaireCommune(){$$(".itea_divForABCDEF_commune").each(function(elt){var adr="/lib_2/ajax/contenuFenetre.php";var sending="element=objProd&typeInfo=abcdef_commune";appelAjaxToFunc(adr,sending,function(reponse){if(reponse){$(elt).style.display="block";$(elt).update(reponse);}});});}
function goToDansListeByPageEtId(numPage,pageCurr,idSeq,tabDiv){if(numPage==pageCurr){Effect.ScrollTo('liLst_elem_'+idSeq);scrollToAncre('liLst_elem_'+idSeq);}else{window.idSeqToScroll=idSeq;window.numPageSuiv=numPage;window.numPageCurr=pageCurr;afficheListeByAjx_setPage_v2(tabDiv,numPage,function(){goToNavigPage('li_navigListeNumeroPage',window.numPageSuiv,window.numPageCurr,'li_navigListeNumeroPageSelect');scrollToAncre('liLst_elem_'+window.idSeqToScroll);Effect.ScrollTo('liLst_elem_'+window.idSeqToScroll);});}}
function getInfoArboDiv(){var i=0;var infos="[";$$(".iteaListeArboDiv").each(function(obj){infos+='{"arboDiv":"'+obj.readAttribute("arboDiv")+'",';infos+='"ID":"'+obj.readAttribute("ID")+'"},';i++;});infos=infos.substr(0,infos.length-1);infos+="]";return eval(infos);}
function showResaInPopIn(addr,sending,w,h,titreDiv){if(!w||!h){if(getVersionIE()<9){w=parseInt(document.documentElement.clientWidth)*0.9;h=parseInt(document.documentElement.clientHeight)*0.9;}else{w=parseInt(window.innerWidth)*0.9;h=parseInt(window.innerHeight)*0.9;}
if(!w)w=800;if(!h)h=600;}
var html_init="<iframe src='"+addr+"?"+sending+"' name='frame_resa' frameborder='0' id='frame_resa' width='"+w+"' height='100%'>\n\
       <img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br />\n\
      </iframe>";afficheDivAvecTransparenceAbsolue(html_init,w,h,null,titreDiv);}
function showContactPropCentraleInPopIn(addr,w,h,titreDiv){if(!w||!h){if(getVersionIE()<9){w=parseInt(document.documentElement.clientWidth)*0.9;h=parseInt(document.documentElement.clientHeight)*0.9;}else{w=parseInt(window.innerWidth)*0.9;h=parseInt(window.innerHeight)*0.9;}
if(!w)w=800;if(!h)h=600;}
var html_init="<iframe src='"+addr+"' name='frame_contact_prop_centrale' frameborder='0' id='frame_contact_prop_centrale' width='"+w+"' height='100%'>\n\
       <img src=/config_v3/imgs_defaut/loading/roue16x16.gif /><br />\n\
      </iframe>";afficheDivAvecTransparenceAbsolue(html_init,w,h,null,titreDiv);}
function showTelPropInPopin(elt){var infoTel=$(elt.children[1]);if(infoTel.hasClassName("span_lst_NumeroTelPropOuvert")){infoTel.removeClassName("span_lst_NumeroTelPropOuvert");jQuery(elt).nextAll(".sp_infoContactPropParTel").removeClass("sp_infoContactPropParTelOuvert");jQuery(elt).toggleClass("open");}else{infoTel.addClassName("span_lst_NumeroTelPropOuvert");jQuery(elt).nextAll(".sp_infoContactPropParTel").addClass("sp_infoContactPropParTelOuvert");jQuery(elt).toggleClass("open");}}
function getUrlWithLstCgi(lstCgis,urlListe,queryString){var url;if(urlListe){url=urlListe+"?";if(queryString)url+=queryString;else{var url2=document.location.href;if(url2.match("\\?"))url2=url2.split("?")[1];if(url2.match("#"))url2=url2.split("#")[0];url+=url2;}}else url=document.location.href;url=url.replace(document.location.hash,"");if(lstCgis){var hash="";if(lstCgis.match("#")){hash=lstCgis.split("#")[1];lstCgis=lstCgis.split("#")[0];}
lstCgis.split("&").each(function(cgis){var cgi=cgis.split("=")[0];var val=cgis.split("=")[1];url=getUrlWithLstParam(url,cgi,val);});if(hash.length>0)url+="#"+hash;}
return url;}
function getUrlWithLstParam(urlBase,cgi,valeur){cgi=cgi.toLowerCase();valeur=valeur.toLowerCase();urlBase=String(urlBase);var reg_exp=RegExp("page=[0-9]+","gi");urlBase=urlBase.replace(reg_exp,"");var reg_exp=RegExp("&&","gi");urlBase=urlBase.replace(reg_exp,"&");if(jQuery('#divgmap3').length>0&&jQuery('#divgmap3').attr('data-cartedeplace')==='1'){urlBase=getUrlAvecLstParamsGoogleMaps(urlBase);}
if(urlBase.match(cgi+"=")){if(urlBase.match(cgi+"=.*?&")){var reg_exp=RegExp(cgi+"=.*?&","gi");urlBase=urlBase.replace(reg_exp,cgi+"="+valeur+"&");}
if(urlBase.match(cgi+"=[^&]*")){var reg_exp=RegExp(cgi+"=[^&]*","gi");urlBase=urlBase.replace(reg_exp,cgi+"="+valeur);}}else{if(!urlBase.match("\\?"))urlBase+="?";else urlBase+="&";urlBase+=cgi+"="+valeur;}
return urlBase;}
function getUrlAvecLstParamsGoogleMaps(urlBase){var valCgiGM={};var tabCgiGM=['zoom','centrex','centrey','minlat','maxlat','minlng','maxlng'];if(_leafletMap!==undefined){var bounds=_leafletMap.getBounds();valCgiGM.zoom=_leafletMap.getZoom();valCgiGM.minlat=bounds.getSouth();valCgiGM.maxlat=bounds.getNorth();valCgiGM.minlng=bounds.getWest();valCgiGM.maxlng=bounds.getEast();}else if(window.gmap!==undefined){var gmap=$('#divgmap3').gmap('get','map');valCgiGM.zoom=gmap.getZoom();valCgiGM.minlat=gmap.getBounds().getSouthWest().lat();valCgiGM.maxlat=gmap.getBounds().getNorthEast().lat();valCgiGM.minlng=gmap.getBounds().getSouthWest().lng();valCgiGM.maxlng=gmap.getBounds().getNorthEast().lng();}
valCgiGM.centrex=(parseFloat(valCgiGM.maxlat)+parseFloat(valCgiGM.minlat))/2;valCgiGM.centrey=(parseFloat(valCgiGM.maxlng)+parseFloat(valCgiGM.minlng))/2;tabCgiGM.each(function(cgi){if(urlBase.match(cgi+"=.*?&")){var reg_exp=RegExp(cgi+"=.*?&","gi");urlBase=urlBase.replace(reg_exp,cgi+"="+valCgiGM[cgi]+"&");}else{if(!urlBase.match("\\?")){urlBase+='?';}else{urlBase+='&';}
urlBase+=cgi+'='+valCgiGM[cgi];}});return urlBase;}
function ajouterAuPanier(ident,indiceListe,dansFiche,callback){(function($){$.ajax({type:"POST",dataType:'xml',url:"/lib_2/ajax/gerePanier.php",data:"action=ajoutPanier&ident="+ident+'&indiceListe='+indiceListe+'&dansFiche='+dansFiche,success:function(result){var code=$(result).find('CODEERR').text();if(code=='OK'){var date=new OBJDate();date.ajoutJour(30);var dateExpire=new Date(date.getAnnee(),date.getMois()-1,date.getJour());setCookie('AJOUTPANIERACTIVE','O',dateExpire);if(typeof window[callback]=='function'){window[callback](result);}}else{$('<div class="divInfos">Une erreur est survenue, veuillez rafraichir la page</div>').dialog({modal:true});}}});})(jQuery);}
function afficheRetourAjaxPanier(tabInfosXml){try{var html="<div id='divChargementAjx'>"+jQuery(tabInfosXml).find('HTML').text()+'</div>';afficheDivAvecTransparence(html,350,200);}
catch(e){return;}}
function ajouterClassePanier(numHeb){if(numHeb){if(jQuery('.li_elemListe[data-numheber="'+numHeb+'"]').length>0){jQuery('.li_elemListe[data-numheber="'+numHeb+'"]').addClass('li_elemListe_dansPanier');}
if(jQuery('.a_ajoutPanier[data-numheber="'+numHeb+'"]').length>0){jQuery('.a_ajoutPanier[data-numheber="'+numHeb+'"]').addClass('a_dansPanier');}
if(jQuery('.a_retirePanier[data-numheber="'+numHeb+'"]').length>0){jQuery('.a_retirePanier[data-numheber="'+numHeb+'"]').addClass('a_dansPanier');}}}
function supprimerClassePanier(numHeb){if(numHeb){if(jQuery('.li_elemListe[data-numheber="'+numHeb+'"]').length>0){jQuery('.li_elemListe[data-numheber="'+numHeb+'"]').removeClass('li_elemListe_dansPanier');}
if(jQuery('.a_ajoutPanier[data-numheber="'+numHeb+'"]').length>0){jQuery('.a_ajoutPanier[data-numheber="'+numHeb+'"]').removeClass('a_dansPanier');}
if(jQuery('.a_retirePanier[data-numheber="'+numHeb+'"]').length>0){jQuery('.a_retirePanier[data-numheber="'+numHeb+'"]').removeClass('a_dansPanier');}}}
function suppSelectionPanier(ident,nothide){var adr="/lib_2/ajax/gerePanier.php";var sending="action=supprPanier&ident="+ident;appelAjaxXMLToFunc(adr,sending,function(response){if(response){var identToHide=jQuery(response).find('ident').text();var ul=jQuery('#ul_lst > li').get();var divToHide;jQuery(ul).each(function(){var attr;for(i=0;i<jQuery('a',this).length;i++){attr=jQuery(jQuery('a',this)[i]).attr('data-ident');if(attr!=undefined){break;}}
if(attr==identToHide){divToHide=this;}});if(!nothide||nothide==undefined){var tabDivs=jQuery(response).find('divToChange');for(i=0;i<tabDivs.length;i++){jQuery('#'+jQuery(tabDivs[i]).find('name').text()).html(jQuery(tabDivs[i]).find('content').text());}
jQuery(divToHide).hide('slow');}
var elem=jQuery("#a_fiche_envoi_ami");if(elem.length==0){elem=jQuery("#a_fiche_envoi_ami_txt");}
if(elem.length>0&&elem.attr("onclick")){var onclick=elem.attr("onclick");onclick=onclick.replace(identToHide,"");onclick=onclick.replace("%2C%2C","%2C");elem.attr("onclick",onclick);}}});var numHeb='';var tabIdent=ident.split('.');numHeb=tabIdent[2];supprimerClassePanier(numHeb)}
function launchResaBureau(a){(function($){var url='/resa/etape1.php?idcontact='+$('body').data('idcontact')+'&k='+$('body').data('k')+'&ident='+$(a).data('ident');if($(a).data('deb')){url+='&deb='+$(a).data('deb');}
if($(a).data('duree')){url+='&duree='+$(a).data('duree');}
console.log('launchResaBureau url='+url);window.open(url,'_blank');})(jQuery);}
function getHtmlDivTarifBureauGite(prixNormal,prixPromo){return getHtmlDivTarifBureau(prixNormal,prixPromo)+'<span class="span_lst_libelle_apres_prix">pour le sjour</span>';}
function getHtmlDivTarifBureauChambre(prixNormal,prixPromo){return getHtmlDivTarifBureau(prixNormal,prixPromo)+'<span class="span_lst_libelle_apres_prix">(base 2 pers.)</span>';}
function getHtmlDivTarifBureau(prixNormal,prixPromo){var html;prixNormal=prixNormal.replace('.00','');if(prixPromo>0&&jQuery.isNumeric(prixPromo)){prixPromo=prixPromo.replace('.00','');var pourcentagePromo=Math.round(((prixPromo-prixNormal)/prixNormal)*100);html='<span class="prixListeAvantPromo">'+prixNormal+'<span class="lblEuro"></span></span>';html+='<span class="prixListePromo">'+prixPromo+'<span class="lblEuro"></span></span>';html+='<span class="prixListePourcentagePromo" style="display:none;">'+pourcentagePromo+'%</span>';}else{html='<span class="prixListeNormal" data-prix="'+prixNormal+'" data-prix-promo="">'+prixNormal+'<span class="lblEuro"></span></span>';}
return html;}
function transformePrixAPartirDeByAjax(){(function($){console.log('transformePrixAPartirDeByAjax');$.ajax('/lib_2/ajax/infosDist.php?INFO=INFOSPRIX').done(function(data,textStatus,jqXHR){console.log('transformePrixAPartirDeByAjax data',data);$.each($('div.prixAPartirDe'),function(){var ident=$(this).data('ident');if(data[ident]===undefined){return;}
var prixNormal=data[ident]['prix_normal'];var prixPromo=data[ident]['prix_promo'];console.log('transformePrixAPartirDeByAjax ident',ident,prixNormal,prixPromo);if($(this).data('classegite')=='1'){$(this).html(getHtmlDivTarifBureauGite(prixNormal,prixPromo));$(this).addClass('avecPrixSejour');}
if($(this).data('classechambre')=='1'){$(this).html(getHtmlDivTarifBureauChambre(prixNormal,prixPromo));$(this).addClass('avecPrixSejour');}});$.each($('a.a_BoutonResaBureau'),function(){var ident=$(this).data('ident');if(data[ident]===undefined){return;}
var planning_vente=data[ident]['planning_vente'];if(planning_vente===undefined){return;}
if(planning_vente.match(/^r+$/)){$(this).html('Rserver');return;}
if(planning_vente.match(/n/)){$(this).html('Rserver LD');}});});})(jQuery);}
function transformeDistanceByAjax(){(function($){console.log('transformeDistanceByAjax');var insee=getParamFromURL('insee');if(!insee){insee=getParamFromURL('INSEE')}
$.ajax('/lib_2/ajax/infosDist.php?INFO=INFOSDISTANCE&INSEE='+insee).done(function(data,textStatus,jqXHR){if(data['distance']===undefined){return;}
var nomCommune;if(data['nomCommune']===''){nomCommune=getParamFromURL('lieucgi');}else{nomCommune=data['nomCommune'];}
$.each($('span.sp_distanceFromCommune'),function(){var ident=$(this).data('ident');var avecTemps=$(this).data('avectemps');var memeCommune=$(this).data('memecommune');if(data['distance'][ident]===undefined){return;}
console.log('transformeDistanceByAjax ident',data['distance'][ident],ident);var html='<span class="sp_lblDedistComm"';if(data['distance'][ident]['distance_route']!==undefined){var distanceRouteKm=format_nb(data['distance'][ident]['distance_route']/1000,2);var tempsRouteMin=format_nb(data['distance'][ident]['temps_route']/60);html+='title="en voiture par la route, donnes OpenStreetMap">';html+='<i class="fa fa-road" aria-hidden="true"></i>  '+distanceRouteKm+'Km';if(avecTemps){html+=' ('+tempsRouteMin+'min)';}
html+=' du centre de '+nomCommune;}else if(data['distance'][ident]['distance_oiseau']!==undefined){var distanceVolKm=format_nb(data['distance'][ident]['distance_oiseau'],2);html+='title=" vol d oiseau">';html+='<i class="fa fa-circle-o" aria-hidden="true"></i>  '+distanceVolKm+'Km du centre de '+nomCommune;}
html+='</span>';$(this).html(html);$('li.li_elemListe[data-ident="'+ident+'"] p.p_distFromCommune').hide();});});})(jQuery);}
jQuery(document).ready(function(){if(yaDateAGererBureauITEA()){transformePrixAPartirDeByAjax();}else{jQuery('a#bureauPrintSelectionPDF').removeAttr('disabled');jQuery('a#bureauPrintSelectionPDF i.loader').remove();}
if(yaInseeAGererBureauITEA()){transformeDistanceByAjax();}});function init_affichage_ajout_panier(){if(jQuery('.li_elemListe.li_elemListe_dansPanier').length>0){jQuery('.li_elemListe.li_elemListe_dansPanier .a_ajoutPanier').addClass('a_dansPanier');}}
function trackMe(ident,idpage,nouvelleVersion){var adr="/lib_2/ajax/gereTracker.php";var sending=getInfoSession()+"&ident="+ident+"&idpage="+idpage+"&nouvelleVersion="+nouvelleVersion
jQuery.ajax({type:"POST",url:adr,data:sending});}
function executeGAFNGF(params){var month;(function($){var objParamStringified=$('#inputParamsGAFNGF',$('#form_envoiMailProp')).val();var listeParams=eval('('+objParamStringified+')');var tabPartiesDateDeb=params.dateDeb.split("/");var tabPartiesDateFin=params.dateFin.split("/");var objDateDeb=new Date(tabPartiesDateDeb[2],tabPartiesDateDeb[1],tabPartiesDateDeb[0]);month=new String(objDateDeb.getMonth());if(month.length==1)month="0"+month;listeParams.dateDeb=objDateDeb.getFullYear()+"-"+month+"-"+objDateDeb.getDate();var objDateFin=new Date(tabPartiesDateFin[2],tabPartiesDateFin[1],tabPartiesDateFin[0]);month=new String(objDateFin.getMonth());if(month.length==1)month="0"+month;listeParams.dateFin=objDateFin.getFullYear()+"-"+month+"-"+objDateFin.getDate();var nbj2=objDateDeb.getTime()/86400000;var nbj1=objDateFin.getTime()/86400000;var nbj=Math.round(nbj1-nbj2);nbj=Math.abs(nbj);listeParams.quantite=nbj.toString();listeParams.semaine=objDateDeb.getFullYear()+"-"+getNumSemaine(objDateDeb.getFullYear(),objDateDeb.getMonth(),objDateDeb.getDate());listeParams.nbParticipant=params.nbParticipant;_gaq=_gaq||[];_gaq.push(['wa._setAccount',listeParams.ID]);_gaq.push(['wa._setCustomVar',1,'Code_postal',listeParams.CP]);_gaq.push(['wa._setCustomVar',2,'Nb_adultes',listeParams.nbParticipant]);_gaq.push(['wa._setCustomVar',3,'date_debut',listeParams.dateDeb]);_gaq.push(['wa._setCustomVar',4,'numero_semaine',listeParams.semaine]);_gaq.push(['wa._setCustomVar',5,'type_resa',listeParams.typeResa]);_gaq.push(['wa._addTrans',listeParams.numResa,listeParams.affiliation,listeParams.prixTotal,listeParams.fraisDossier,listeParams.assurance,listeParams.CP,listeParams.dpt,'FRANCE']);_gaq.push(['wa._addItem',listeParams.numResa,listeParams.dpt+'_'+listeParams.codeProd,listeParams.nomProd,listeParams.categProd,listeParams.prixLoc,listeParams.quantite]);_gaq.push(['wa._trackTrans']);if($("script[src$='google-analytics.com/ga.js']").length==0){(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();}})(jQuery);}
function executeGTM_criteo(){(function($){var tabParamsGTM_criteo=$('#inputParamsGTM_criteo').val();var listeParams=eval('('+tabParamsGTM_criteo+')');if(typeof(dataLayer)!='undefined'){dataLayer.push({'Transaction_Id':listeParams.Transaction_Id,'Product_Id':listeParams.Product_Id,'Price':listeParams.prix,'event':'Criteo_Contact'});}})(jQuery);}
function addEventGa(category,action,label){(function($){var typeGa=$("#bodyPage").attr("data-ga-type");if(typeGa==''){return;}
if(typeGa=="UA"){if(typeof ga=='function'){ga('send','event',category,action,label);}}
else{var _gaq=_gaq||[];_gaq.push(['_trackEvent',category,action,label]);}})(jQuery);}function transformChmpFormToSpan(obj){var childs=obj.childNodes;for(var i=0;i<childs.length;i++){var child=childs[i];var id;if((child.tagName=='INPUT'&&(child.type=='text'||child.type=='number'||child.type=='tel'))||(child.tagName=='TEXTAREA')){var valeur="";if(child.tagName=="TEXTAREA"){var idObj=child.id;valeur=$(idObj).value;if(!valeur)valeur=child.innerHTML;if(!valeur)valeur=child.value;}else valeur=child.value;var newElem=document.createElement("SPAN");newElem.innerHTML="<strong>"+valeur+"</strong>";obj.replaceChild(newElem,child);}
if(child.tagName=="INPUT"&&(child.type=="checkbox"||child.type=="radio")){if(child.checked||$(child).checked||(child.id&&$(child.id).checked))child.setAttribute("checked","checked");}
if(child.tagName=="SELECT"){if(child.id){var newElem=document.createElement("SPAN");newElem.innerHTML="<strong>"+$(child.id).options[$(child.id).selectedIndex].value+"</strong>";obj.replaceChild(newElem,child);}else obj.removeChild(child);}
if(child.childNodes.length>0)child=transformChmpFormToSpan(child)}
return obj;}
function getTabChmpForm(obj){var childs=obj.childNodes;var tabOut=new Array();var tabFils=new Array();for(var i=0;i<childs.length;i++){var child=childs[i];if((child.tagName=="INPUT"&&child.type=="text")||(child.tagName=="INPUT"&&child.type=="checkbox")||(child.tagName=="INPUT"&&child.type=="email")||(child.tagName=="INPUT"&&child.type=="tel")||(child.tagName=="INPUT"&&child.type=="date")||(child.tagName=="INPUT"&&child.type=="number")||(child.tagName=="TEXTAREA")||(child.tagName=="SELECT")){tabOut.push(child);}
if(child.childNodes.length>0){tabFils=jQuery.merge(tabFils,getTabChmpForm(child));}}
if(tabFils.length>0){tabOut=jQuery.merge(tabOut,tabFils);}
return tabOut;}
function supprDomElem(obj){if(obj){var parent=obj.parentNode;if(parent){parent.removeChild(obj);return true;}else return false;}else return false;}
function dupliqueDomElemversHautByObj(obj){if(obj){var parent=obj.parentNode;if(parent){var newObj=obj.cloneNode(true);parent.insertBefore(newObj,obj);newObj=modifIdForObj(newObj);return newObj;}else{return false;}}else{return false;}}
function dupliqueDomElemversBasByObj(obj){if(obj){var parent=obj.parentNode;if(parent){var newObj=obj.cloneNode(true);parent.insertBefore(newObj,obj.nextSibling);newObj=modifIdForObj(newObj);return newObj;}else return false;}else return false;}
function setIdUniqueToObj(obj){if(obj&&!obj.id){var str=new String();if(obj.getAttribute&&obj.getAttribute("class")!="undefined")str=new String(obj.getAttribute("class"));if(str.length==0&&obj.tagName&&obj.tagName!="undefined")str=new String(obj.tagName).toLower();if(str.length==0)str=new String("obj");obj.id=str+"-"+getUniqueId(5);}}
function modifIdForObj(obj){if(!obj)return null;else{if(obj.id){var def=false;var idCurr=new String(obj.id);var re=new RegExp(".*-[0-9]+");if(re.test(idCurr)){var tabChps=idCurr.split("-")
tabChps.pop();idCurr=tabChps.join("-");}
for(var j=1;j<500&&!def;j++){var newId=idCurr+"-"+j;var obj2=document.getElementById(newId);if(!obj2){def=true;obj.id=newId;}}}else setIdUniqueToObj(obj);var childs=obj.childNodes;if(childs&&childs.length){for(var i=0;i<childs.length;i++){var child=childs[i];if(child)child=modifIdForObj(child);}}
return obj;}}
Array.prototype.in_array=function(p_val){for(var i=0,l=this.length;i<l;i++){if(this[i]==p_val){return true;}}
return false;}
Array.prototype.deleteItem=function(p_val){for(var i=0,l=this.length;i<l;i++){if(this[i]==p_val){this[i]="";return true;}}
return false;}
Array.prototype.merge=function(tabAConcat){for(var i=0;i<tabAConcat.length;i++){this.push(tabAConcat[i]);}
return true;}
String.prototype.getTabChInCaract=function(caract){var idx_deb=-1,idx_fin=-1;var tab=new Array();for(var i=0;i<this.length;i++){if(this[i]==caract){if(idx_deb<0)idx_deb=i+1;else{idx_fin=i;var ch=this.substring(idx_deb,idx_fin);tab.push(ch);idx_deb=-1;idx_fin=-1;}}}
return tab;}
String.prototype.remplaceStr=function(chaine_a_remplacer,chaine_remplacement){var idx_deb=-1,idx_fin=-1;idx_deb=this.indexOf(chaine_a_remplacer);var ch_deb=this.substring(0,idx_deb);var ch_fin=this.substring((idx_deb+chaine_a_remplacer.length),this.length);var ch=ch_deb+chaine_remplacement+ch_fin;return new String(ch);}
String.prototype.stripTags=function(){return this.replace(/<\/?[^>]+>/gi,'');}
String.prototype.yaTags=function(){var er=/<\/?[^>]+>/gi;return er.test(this);}
function getTextSelectInDocument(){var txt;if(window.getSelection){txt=window.getSelection().toString();}
else if(document.getSelection){txt=document.getSelection();}
else if(document.selection){txt=document.selection.createRange().text;}
return txt;}function afficheLoaderGlobal(){jQuery('#div_loaderUnload').show();}
function effaceLoaderGlobal(){jQuery('#div_loaderUnload').hide();}
function initCptClient(estCompteClientFNGF){(function($){initFormsCptClient();if($('#form_modifCoordCli').length){initFormCoordonneesClient();}
if($('#form_chg_mdp').length){initFormModifPass();}
init_champsConnexion();init_paiement_paybox();initCentralPayCompteClient();if($('.couplagePaybox').length>0){$('.couplagePaybox #a_btChoixPaiementReserver').on('click',function(){setFormPaiementCptCliPayboxPourCouplageAvecCPay();});}
if(typeof initSaisieANCV_CVCO!=='undefined'){initSaisieANCV_CVCO(false);}
initChoixPaiementAncv();initModifsResa();initActionCreerAvis();initEffectsCptClient();if(estCompteClientFNGF==1){initCptClientGDF();}else{cptGDF_initActionsNewPass(true);}
$('.lienReserverDeNouveau').click(function(e){e.stopPropagation();});initModalTaxeSejour();initCautionCompteClient();if($('#div_btnPaiementCbLdCptCli').length>0){initBtnPaiementCbLdCptCli();}
if($('#div_rbstAvoirCptCli').length>0){initRemboursementAvoirCompteClient();}})(jQuery);}
function initCentralPayCompteClient(){(function($){console.log('PASSE initCentralPayCompteClient');if(typeof initSaisieCB_centralPay!=='undefined'){initSaisieCB_centralPay();$("#a_btChoixPaiementANCV").click(function(){setFormPaiementCptCliANCVCentralPay();});initPopinConfirmeEANCV();$('input[name="choixPaiementCB"]').on('change',function(){gereActionsChoixMontantLibre(this);});gereModifChoixMontantLibre();}else if($('.formCentralPay').length>0){$("#a_btChoixPaiementANCV").click(function(){setFormPaiementCptCliANCVCentralPay();});initPopinConfirmeEANCV();}
if($('.div_unPaiementPossible').length>0){$('.div_unPaiementPossible > div.titre').bind('click',function(){$('.div_unPaiementPossible').removeClass('open');$(this).parent().addClass('open');});}})(jQuery);}
function initFormsCptClient(){(function($){$('#a_submit_recup_email').click(function(event){event.preventDefault();var vars=$('#form_recup_email').serialize();var url=urlCptClient;$.ajax({url:url,data:vars,beforeSend:function(xhr){afficheLoaderGlobal_site();},success:function(data){displayValidationSendPassword(data);},complete:function(jqXHR,textStatus){effaceLoaderGlobal_site();}});});})(jQuery);}
function displayValidationSendPassword(response){(function($){response='<p>'+response+'</p>';getNewDivToBody('divGraph_affDialog','dialogJquery');$("#divGraph_affDialog").dialog({buttons:{"OK":function(){$(this).dialog("close");}},modal:true}).html(response);})(jQuery);}
function log_client(reponse){(function($){if(reponse=='1'){var loc=$('#a_login_cpt_client').attr('data-href');$(location).attr('href',loc);}
else{$('#p_ident_error').show("0.3");}})(jQuery);}
function initFormCoordonneesClient(){(function($){$('#form_modifCoordCli').validationEngine({promptPosition:"topLeft",scroll:true,ajaxFormValidation:true,onAjaxFormComplete:refreshAccountWithXMLAndHtml,ajaxFormValidationURL:urlCptClient,dataTypeAjaxFormResponse:'xml'});$('#a_comfirm_saisie_coord').click(function(event){event.preventDefault();$('#form_modifCoordCli').submit();});})(jQuery);}
function initFormModifPass(){(function($){var tabAValider=[];var mdp=new LiveValidation("newPass_input",{validMessage:$("#inpt_msgOk").val()});mdp.add(Validate.Format,{pattern:/^(?=.*[0-9]+.*)(?=.*[A-Z]+.*)(?=.*[a-z]+.*)[0-9a-zA-Z-_]{8,}$/,failureMessage:$("#inpt_msgSeulementChiffresLettres").val()});mdp.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});tabAValider.push(mdp);var mdpConfirm=new LiveValidation("newPassConfirm_input",{validMessage:$("#inpt_msgOk").val()});mdpConfirm.add(Validate.Confirmation,{match:"newPass_input",failureMessage:$("#inpt_msgCorresMdp").val()});tabAValider.push(mdpConfirm);$('#a_valid_enreg_pass').click(function(event){$('#div_msgErreursInfosClient,#div_msgValideInfosClient').html('').hide('fast');event.preventDefault();$.ajax({url:urlCptClient,data:'action=CHECKCLIENTPASS&oldPass='+$('#oldPass_input').val(),success:function(reponse){if(reponse=='1'){if(LiveValidation.massValidate(tabAValider)){$('#form_chg_mdp').submit();}}
else{$('#div_msgErreursInfosClient').html('<p>'+reponse+'</p>').show('fast');}}});});})(jQuery);}
function init_champsConnexion(){(function($){if($("#div_ligneIdentCptClient_Email #input_email").length){$("#div_ligneIdentCptClient_Email #input_email").live("focus",function(){if($(this).val()==$(this).attr("data-defaut"))$(this).val("");});$("#div_ligneIdentCptClient_Email #input_email").live("blur",function(){if($(this).val()=="")$(this).val($(this).attr("data-defaut"));});$("#div_ligneIdentCptClient_Password #input_motPasse").live("focus",function(){if($(this).val()==$(this).attr("data-defaut"))$(this).val("");});$("#div_ligneIdentCptClient_Password #input_motPasse").live("blur",function(){if($(this).val()=="")$(this).val($(this).attr("data-defaut"));});}})(jQuery);}
function init_paiement_paybox(){(function($){$('#a_boutonValiderCptClientPbx').unbind('click');$('#a_boutonValiderCptClientPbx').bind('click',function(){if(!$('#a_boutonValiderCptClientPbx').is('.disabled')){setFormPaiementCptCliPaybox();}});initPaiementVersementCompteClient();})(jQuery);}
function refreshAccount(response){(function($){var message=response.getElementsByTagName('MESSAGE')[0].textContent;if(message){message='<p>'+message+'</p>';}
var valid=response.getElementsByTagName('VALIDATION')[0].textContent;getNewDivToBody('divGraph_affDialog','dialogJquery');$("#divGraph_affDialog").dialog({buttons:{"OK":function(){$(this).dialog("close");}},modal:true,close:function(){if(valid=='1'){refreshPage();}}}).html(message);})(jQuery);}
function refreshAccountWithXMLAndHtml(form,response){(function($){var message=response.getElementsByTagName('MESSAGE')[0].textContent;if(message){message='<p>'+message+'</p>';}
var valid=response.getElementsByTagName('VALIDATION')[0].textContent;getNewDivToBody('divGraph_affDialog','dialogJquery');$("#divGraph_affDialog").dialog({buttons:{"OK":function(){$(this).dialog("close");}},modal:true,close:function(){if(valid=='1'){redirectAccueil();}}}).html(message);})(jQuery);}
function refreshPage(){window.location.reload();}
function redirectAccueil(){document.location.href='?';}
function initEffectsCptClient(){(function($){$('.div_to_bounce').each(function(){if($(this).attr('show')=='1'){$(this).show('bounce',{distance:40},500);}});})(jQuery);}
function initModifsResa(){(function($){$('input[name="inputTypeClientAssurance"]').each(function(){if($(this).is(':checked')){$('.divFormuleAssurance').hide();$('.divFormuleAssuranceType'+$(this).val()).show();}});$('#a_valid_modif_assurance').click(function(event){event.preventDefault();var vars=$('#frmChgtAssurance').serialize();var url=urlCptClient;$.ajax({url:url,data:vars,success:function(data){var tabRep=$.parseJSON(data);if(tabRep.CODE=='OK'){refreshPage();}
else{alertAJquery(tabRep.MESSAGE);}},error:function(){}});});$('#a_modif_nb_pers').click(function(event){event.preventDefault();var vars=$('#frmChgtNbPers').serialize();var url=urlCptClient;$.ajax({url:url,data:vars,success:function(data){refreshAccount(data);}});});$('.inpt_choixFormuleAssurance').change(function(){affMsgAttenteParDessusInDiv('frmChgtAssurance');$.ajax({type:'POST',url:urlCptClient,data:$('#frmChgtAssurance').serialize(),success:function(data){refreshPage();}});});$('input[name="inputTypeClientAssurance"]').click(function(){$('.divFormuleAssurance').hide();$('.divFormuleAssuranceType'+$(this).val()).show();});$('#lienSupprimeAutoriseDebitAuto').click(function(){var data='action=supprimeDebitAuto';data+='&instance='+$(this).data('instance');data+='&exe='+$(this).data('exe');data+='&numero_resa='+$(this).data('numero-resa');data+='&pre-resa='+$(this).data('pre-resa');$.ajax({type:'POST',url:urlCptClient,data:data,beforeSend:function(xhr){afficheLoaderGlobal_site();},complete:function(jqXHR,textStatus){},success:function(data){if(data.code==='KO'){effaceLoaderGlobal_site();return false;}
refreshPage();}});});})(jQuery)}
function initActionCreerAvis(){(function($){$('.btCreerAvisDetailResa').click(function(){var data='action=creerAvis';data+='&instance='+$(this).data('instance');data+='&exe='+$(this).data('exe');data+='&numero_resa='+$(this).data('numero-resa');data+='&pre_resa='+$(this).data('pre-resa');$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){return false;}
window.open(tabRetour.url);}});});})(jQuery);}
function initCompteClientV5surV4(){(function($){if($('#compteClientV5surV4').length>0){$('head').append('<link rel="stylesheet" media="screen" href="../config_v3/css_defaut/v5/commun/defaut/compte_client.css" type="text/css" />');$('head').append('<link rel="stylesheet" media="screen" href="../config_v3/css_defaut/v5/admin/jquery/jquery-ui.min.css" type="text/css" />');$('head').append('<link rel="stylesheet" media="screen" href="../config_v3/css_defaut/v5/admin/jquery/validationEngine.jquery.css" type="text/css" />');$('#compteClientV5surV4').slideDown('fast');initCptClient();var tab=$('img,input',$('#compteClientV5surV4'));$('img,input',$('#compteClientV5surV4')).each(function(){var src=$(this).attr('src')||'';if(src.match(/^\/imgs_defaut/)){$(this).attr('src','/config_v3/'+$(this).attr('src'));}});if($('.div_itea_GMAP',$('#compteClientV5surV4')).length>0){loadScriptGoogleMap();window.setTimeout(function(){chargeGMap();},2000);}}})(jQuery)}
function initCptClientGDF(){cptGDF_initActionsListeResas();cptGDF_initActionsDetailResas();cptGDF_initActionsDetailFavoris();cptGDF_initActionsDetailFicheVisitee();cptGDF_initActionsProfil();cptGDF_initActionsPopInPaiement();cptGDF_initActionsBandeau();cptGDF_initAfficheDetailViaFrance();}
function cptGDF_initActionsPopInPaiement(){(function($){$('body').undelegate('.payer_compte_fngf','click');$('body').delegate('.payer_compte_fngf','click',function(){var data='action=getHTML_formCptCliPaiement';data+='&instance='+$(this).data('instance');data+='&numresa='+$(this).data('numresa');data+='&exercice='+$(this).data('exercice');data+='&id_famille='+$(this).data('id_famille');$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
$.fancybox($('#'+$(this).data('idformpaiement')),{maxWidth:800,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,padding:0,wrapCSS:'popin_compteGDF popin_paiementCompteGDF',content:tabRetour.html});init_paiement_paybox();}});});})(jQuery);}
function cptGDF_initActionsListeResas(){(function($){$('#div_plusDeResaEnCours a').click(function(){$('div.compteGDF_uneResa_enCours').show();});$('#div_plusDeResaPassees a').click(function(){$('div.compteGDF_uneResa_passees').show();});$('#div_plusDeResaAnnulees a').click(function(){$('div.compteGDF_uneResa_annulees').show();});})(jQuery);}
function cptGDF_initActionsDetailResas(){var tabAValider;(function($){if($(".afficheDetail a").length>0){$(".afficheDetail a").unbind('click');$(".afficheDetail a").click(function(){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueDetailResa(numResa);});}
if($(".cptGDF_afficheAvis").length>0){$(".cptGDF_afficheAvis").unbind('click');$(".cptGDF_afficheAvis").click(function(){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueAvisResa(numResa);});}
if($(".compteGDF_detailMontant").length>0){$(".compteGDF_detailMontant").unbind('click');$(".compteGDF_detailMontant").click(function(e){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueDetailMontants(numResa);e.stopPropagation();});}
if($('.compteGDF_detailMontantsSejour-overlay').length>0){$(".compteGDF_detailMontantsSejour-overlay").unbind('click');$('.compteGDF_detailMontantsSejour-overlay').click(function(){var numResa=$(this).data("numresa");$(this).hide();$('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]').hide();});}
if($(".compteGDF_titreDoc a").length>0){$(".compteGDF_titreDoc a").unbind('click');$(".compteGDF_titreDoc a").click(function(){$(this).toggleClass("opened");var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueDetailDocs(numResa);});}
if($(".compteGDF_afficheCarte").length>0){$(".compteGDF_afficheCarte").unbind('click');$(".compteGDF_afficheCarte").click(function(){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueCarteResa(numResa,false);});}
if($(".compteGDF_afficheCarteinPopin").length>0){$(".compteGDF_afficheCarteinPopin").unbind('click');$(".compteGDF_afficheCarteinPopin").click(function(){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueCarteResa(numResa,true);});}
if($(".contentCarteFermer a").length>0){$(".contentCarteFermer a").unbind('click');$(".contentCarteFermer a").click(function(){var numResa=$(this).attr("data-numresa");cptGDF_afficheMasqueCarteResa(numResa);});}
if($(".contentDetailContactEventEtPartage .sp_partageResauxSociaux").length>0){$(".contentDetailContactEventEtPartage .sp_partageResauxSociaux").unbind('click');$(".contentDetailContactEventEtPartage .sp_partageResauxSociaux").click(function(){if($(this).next().is(":hidden")){$(this).toggleClass("opened");$(this).next().show("blind");}
else{$(this).next().hide("blind")
$(this).toggleClass("opened");}});}
$('body').undelegate('.btEnvoiMessageCptGDF','click');$('body').delegate('.btEnvoiMessageCptGDF','click',function(){var data='action=getHTML_popInMailProp';data+='&ident_resa='+$(this).data('ident-resa');data+='&type_dest='+$(this).data('type-dest');data+='&dest='+$(this).data('dest');$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
widget_affichePopinMailPropCptGDF(tabRetour.html);tabAValider=[];var txtMailCptGDF=new LiveValidation('textarea_formMessageCptGDF',{validMessage:' ',onlyOnSubmit:true});txtMailCptGDF.add(Validate.Presence,{failureMessage:$('#inpt_msgChampObligatoire_messageCptGDF').val()});tabAValider.push(txtMailCptGDF);}});});$('body').undelegate('#btValidEnvoiMessageCptGDF','click');$('body').delegate('#btValidEnvoiMessageCptGDF','click',function(e){e.preventDefault();if(LiveValidation.massValidate(tabAValider)){var $divMsgInfo=$('#div_msgEnvoiMessagePropCptGDF');$.ajax({type:'POST',url:urlCptClient,data:'action=envoiMailProp&'+$('#form_envoiMessageCptGDF').serialize(),beforeSend:function(){setMsgInfoCptGDF($divMsgInfo);},success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
if(tabRetour.code==='KO'){$divMsgInfo.addClass("ko").removeClass("ok");setMsgInfoCptGDF($divMsgInfo,tabRetour.msg);return false;}
$('#form_envoiMessageCptGDF').hide();$divMsgInfo.addClass("ok").removeClass("ko");$('.divPopInMailPropCptGDFTitre').hide();setMsgInfoCptGDF($divMsgInfo,tabRetour.msg);}});}});})(jQuery);}
function cptGDF_afficheMasqueDetailResa(numResa){(function($){if($('.contentDetail[data-numresa="'+numResa+'"]').is(":hidden")){$('.contentDetail[data-numresa="'+numResa+'"]').show('blind');$('.afficheDetail a[data-numresa="'+numResa+'"]').text($('.afficheDetail a[data-numresa="'+numResa+'"]').attr("data-lbl-masque"));var htmlActivite=$('.contentDetail[data-numresa="'+numResa+'"]').find('.contentDetailActivites').html();if(htmlActivite.length==0){var tab=numResa.split('_');var data='action=getHTML_activiteProdCptCli';data+='&instance='+tab[0];data+='&exercice='+tab[1];data+='&numresa='+tab[2];data+='&typeresa='+tab[3];$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
$('.contentDetail[data-numresa="'+numResa+'"]').find('.contentDetailActivites').html(tabRetour.html);$('.contentDetailActivites .titreDetail').click(function(){if($(this).next().is(":hidden")){$(this).next().show("blind");}
else{$(this).next().hide("blind");}});}});}}
else{$('.contentDetail[data-numresa="'+numResa+'"]').hide('blind');$('.afficheDetail a[data-numresa="'+numResa+'"]').text($('.afficheDetail a[data-numresa="'+numResa+'"]').attr("data-lbl-affiche"));var offset=$('.compteGDF_uneResa[data-numresa="'+numResa+'"]').offset().top;$('html, body').animate({scrollTop:offset-80},'slow');}
$('.afficheDetail a[data-numresa="'+numResa+'"]').toggleClass("opened");})(jQuery);}
function cptGDF_afficheMasqueAvisResa(numResa){(function($){if($('.contentAvis[data-numresa="'+numResa+'"]').is(":hidden")){$('.contentAvis[data-numresa="'+numResa+'"]').show("blind",function(){rendVisibleEcran('.compteGDF_uneResa[data-numresa="'+numResa+'"]',100);});}
else{$('.contentAvis[data-numresa="'+numResa+'"]').hide("blind");}
$('.contentAvis a[data-numresa="'+numResa+'"]').toggleClass("opened");})(jQuery);}
function cptGDF_afficheMasqueCarteResa(numResa,popin){(function($){if(popin){var idDivCarte=$('.contentCarte[data-numresa="'+numResa+'"]').children(".div_itea_GMAP").attr("id");var lat=$('.compteGDF_afficheCarteinPopin[data-numresa="'+numResa+'"]').data("latitude");var long=$('.compteGDF_afficheCarteinPopin[data-numresa="'+numResa+'"]').data("longitude");var coords=lat+','+long;$.fancybox({href:'https://maps.google.com/maps?hl=fr&q='+coords+'&ie=UTF8&t=m&z=10&iwloc=B&output=embed&z=12',type:'iframe',width:'90%',height:'90%',autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,padding:0,wrapCSS:'popin_compteGDF popin_carte_cptGDF'});}
else{if($('.contentCarte[data-numresa="'+numResa+'"]').is(":hidden")){$('.contentCarte[data-numresa="'+numResa+'"]').show();var idDivCarte=$('.contentCarte[data-numresa="'+numResa+'"]').children(".div_itea_GMAP").attr("id");iteaGMAP_initForListe(idDivCarte);}
else{$('.contentCarte[data-numresa="'+numResa+'"]').hide();}}})(jQuery);}
function cptGDF_initAfficheDetailViaFrance(){(function($){$('.contentDetailActivites .a_viaFranceDetail').live('click',function(){var id=$(this).attr('data-id');var type=$(this).attr('data-type');var div=$(this).parents('.div_lagendaContent');$.ajax({type:'POST',url:'/lib_2/ajax/infosDist.php',data:{info:'getHTMLDetail_viaFrance',id:id,type:type},success:function(result){if(result.length>0){div.find('.div_viaFrance_detailElement').html('<div class="div_viaFrance_detailElementContent">'+result+'</div>');$.fancybox(div.find('.div_viaFrance_detailElement'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,padding:0,wrapCSS:'popin_compteGDF popin_detailEventViaFrance_cptGDF'});}else{}}});});})(jQuery);}
function cptGDF_afficheMasqueDetailMontants(numResa){(function($){if($(document).width()<768){$.fancybox($('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,padding:0,wrapCSS:'popin_compteGDF popin_detailMontants_cptGDF'});}
else{if($('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]').is(":hidden")){if($(document).width()>=768){$('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]').show("blind");}
else{$('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]').show();}
$('.compteGDF_detailMontantsSejour-overlay[data-numresa="'+numResa+'"]').show();}
else{$('.compteGDF_detailMontantsSejour[data-numresa="'+numResa+'"]').hide("blind");}}})(jQuery);}
function cptGDF_afficheMasqueDetailDocs(numResa){(function($){if($('.compteGDF_detailDoc[data-numresa="'+numResa+'"]').is(":hidden")){$('.compteGDF_detailDoc[data-numresa="'+numResa+'"]').show("blind");}
else{$('.compteGDF_detailDoc[data-numresa="'+numResa+'"]').hide("blind");}})(jQuery);}
function cptGDF_initActionsDetailFavoris(){(function($){$('body').undelegate('.bt_cptGDF_editFavori','click');$('body').delegate('.bt_cptGDF_editFavori','click',function(){var favoriId=$(this).attr('data-id');afficheMasqueTitreFavori(favoriId);$('#inpt_cptGDF_modifFavori_'+favoriId).val($('#div_cptGDF_modifFavori_'+favoriId).text()).focus();});$('body').undelegate('.bt_cptGDF_validmodifFavori','click');$('body').delegate('.bt_cptGDF_validmodifFavori','click',function(e){e.preventDefault();enregistreModifFavori($(this).attr('data-id'));});$('body').undelegate('.bt_cptGDF_delFavori','click');$('body').delegate('.bt_cptGDF_delFavori','click',function(){var favoriId=$(this).attr('data-id');var libelleFavori=$('#div_cptGDF_modifFavori_'+favoriId).text();$('#popIn_delFavori_cptGDF_btConfirm').attr('data-id',favoriId);$('#popIn_delFavori_cptGDF_libelle').html(libelleFavori);widget_affichePopin_delFavori_cptGDF();});$('body').undelegate('#popIn_delFavori_cptGDF_btConfirm','click');$('body').delegate('#popIn_delFavori_cptGDF_btConfirm','click',function(){delFavori($(this).attr('data-id'));});$('body').undelegate('.btDelFavoriHeber','click');$('body').delegate('.btDelFavoriHeber','click',function(){delFavoriHeber($(this).attr('data-id'),$(this).attr('data-favori-id'),$(this).attr('data-ref'));});$('body').undelegate('.btAfficheLstFavoriHeber, .div_cptGDF_titreFavori','click');$('body').delegate('.btAfficheLstFavoriHeber, .div_cptGDF_titreFavori','click',function(){$(this).afficheLstFavoriHeber();});$('body').undelegate('.div_cptGDF_principalFavori_partage_lbl','click');$('body').delegate('.div_cptGDF_principalFavori_partage_lbl','click',function(){var favoriId=$(this).attr('data-id');if($('.div_cptGDF_principalFavori_partage_listeReseaux[data-id="'+favoriId+'"]').hasClass("closed")){$('.div_cptGDF_principalFavori_partage_listeReseaux[data-id="'+favoriId+'"]').removeClass("closed").addClass("opened");}
else{$('.div_cptGDF_principalFavori_partage_listeReseaux[data-id="'+favoriId+'"]').removeClass("opened").addClass("closed");}});$('body').undelegate('.div_partageResauxSociaux_lbl','click');$('body').delegate('.div_partageResauxSociaux_lbl','click',function(){var partageId=$(this).attr('data-id');if($('.div_partageResauxSociaux_listeReseaux[data-id="'+partageId+'"]').hasClass("closed")){$('.div_partageResauxSociaux_listeReseaux[data-id="'+partageId+'"]').removeClass("closed").addClass("opened");}
else{$('.div_partageResauxSociaux_listeReseaux[data-id="'+partageId+'"]').removeClass("opened").addClass("closed");}});$('body').undelegate('.bt_cptGDF_ficheEnvoiAmi','click');$('body').delegate('.bt_cptGDF_ficheEnvoiAmi','click',function(){var favoriId=$(this).attr('data-id');var divfavoriHeber=$('#div_cptGDF_favoriHeber_'+favoriId);var divMsgInfo=$('#lstFavoriHeber_msgInfo_'+favoriId);var data='action=GET_TABINFO_ENVOIMAILAMI_CPTGDF';data+='&id='+favoriId;$.ajax({type:'POST',url:urlCptClient,data:data,beforeSend:function(){divfavoriHeber.hide();divMsgInfo.text('');},success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){divfavoriHeber.show();divMsgInfo.text(tabRetour.msg).show();}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
sendThisToFriend(tabRetour.cmd,tabRetour.w,tabRetour.h,tabRetour.titreDiv,tabRetour.objet,tabRetour.url,tabRetour.lien,tabRetour.message,tabRetour.tabident);}});});$('body').undelegate('.bt_cptGDF_partageSiteExterne','click');$('body').delegate('.bt_cptGDF_partageSiteExterne','click',function(){var favoriId=$(this).attr('data-id');var url=$(this).attr('data-url');var divfavoriHeber=$('#div_cptGDF_favoriHeber_'+favoriId);var divMsgInfo=$('#lstFavoriHeber_msgInfo_'+favoriId);var data='action=GET_URL_PARTAGE_CPTGDF';data+='&id='+favoriId;$.ajax({type:'POST',url:urlCptClient,data:data,beforeSend:function(){divfavoriHeber.hide();divMsgInfo.text('');},success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){divfavoriHeber.show();divMsgInfo.text(tabRetour.msg).show();}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
window.open(url+tabRetour.url);}});});})(jQuery);}
function afficheMasqueTitreFavori(favoriId){(function($){$('.div_cptGDF_titreFavori_'+favoriId).toggle();})(jQuery);}
function setMsgInfoFavoriExistantCptGDF(favoriId,msg){(function($){setMsgInfoCptGDF($('#cptGDF_detailFavori_msgInfo_'+favoriId),msg);})(jQuery);}
function enregistreModifFavori(favoriId){(function($){var newLibelle=$('#inpt_cptGDF_modifFavori_'+favoriId).val();var newLibelleTraite=traiteTexteAvantReqAjax($('#inpt_cptGDF_modifFavori_'+favoriId).val());if(newLibelleTraite.trim().length===0){setMsgInfoFavoriExistantCptGDF(favoriId,$('#div_cptGdf_lbl_error_favori_lib_vide').text());return false;}
setMsgInfoFavoriExistantCptGDF(favoriId);var data='action=UPDATE_FAVORI';data+='&id='+favoriId;data+='&libelle='+newLibelleTraite;$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){setMsgInfoFavoriExistantCptGDF(favoriId,tabRetour.msg);return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
setMsgInfoFavoriExistantCptGDF(favoriId);$('#div_cptGDF_titreActuelFavori_'+favoriId).html(newLibelle);afficheMasqueTitreFavori(favoriId);$('#div_cptGDF_modifFavori_'+favoriId).html(newLibelle);}});})(jQuery);}
function delFavori(favoriId){(function($){var data='action=DEL_FAVORI';data+='&id='+favoriId;$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);$.fancybox.close();if(tabRetour.code==='KO'){setMsgInfoFavoriExistantCptGDF(favoriId,tabRetour.msg);return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
setMsgInfoFavoriExistantCptGDF(favoriId);$('#li_cptGDF_detailFavori_'+favoriId).remove();if($('.li_cptGDF_detailFavori').length===0){$('#compteGDF_pasDeFavoris').show();}}});})(jQuery);}
function delFavoriHeber(id,favoriId,ref){(function($){var divMsgInfo=$('#favoriHeber_msgInfo_'+id);divMsgInfo.text('');var data='action=DEL_FAVORI_HEBER';data+='&favori_id='+favoriId;data+='&ref='+ref;$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){divMsgInfo.text(tabRetour.msg).show();}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
var delay=600;var liFavoriHeber=$('#li_cptGDF_detailFavoriHeber_'+id);liFavoriHeber.hide(delay);setTimeout(function(){liFavoriHeber.remove();if($('.liDetailFavoriHeber_'+favoriId).length===0){$('#div_cptGDF_favoriHeber_'+favoriId).hide();$('#btAfficheLstFavoriHeber_'+favoriId).toggleClass('opened',false);}},delay);}});})(jQuery);}
(function($){$.fn.afficheLstFavoriHeber=function(){var favoriId=this.attr('data-id');var nomUl='ul_cptGDF_favoriHeber_'+favoriId;var ul=$('#'+nomUl);var divfavoriHeber=$('#div_cptGDF_favoriHeber_'+favoriId);var divMsgInfo=$('#lstFavoriHeber_msgInfo_'+favoriId);$(".btAfficheLstFavoriHeber[data-id='"+favoriId+"']").toggleClass('opened');if($(".btAfficheLstFavoriHeber[data-id='"+favoriId+"']").hasClass('opened')){var data='action=AFFICHE_LST_FAVORI_HEBER';data+='&id='+favoriId;$.ajax({type:'POST',url:urlCptClient,data:data,beforeSend:function(){ul.html('');divMsgInfo.text('').hide();divfavoriHeber.show();affMsgAttenteInDiv(nomUl);},success:function(result){var tabRetour=JSON.parse(result);ul.html('');if(tabRetour.code==='KO'){if(tabRetour.msg){divMsgInfo.text(tabRetour.msg).show();}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
ul.hide();ul.html(tabRetour.html);ul.show("blind");rendVisibleEcran(ul,270);}});}else{divfavoriHeber.hide("blind");}};})(jQuery);function widget_affichePopin_delFavori_cptGDF(){(function($){$.fancybox($('#popIn_delFavori_cptGDF'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_compteGDF popin_compteGDF_delFavoris'});})(jQuery);}
function widget_affichePopin_delLstFicheVisitee_cptGDF(){(function($){$.fancybox($('#popIn_delLstFicheVisitee_cptGDF'),{autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_compteGDF popin_compteGDF_delHistorique'});})(jQuery);}
function widget_affichePopin_deconnecteSiteExt_cptGDF(){(function($){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,href:'#cptGDF_popInDeconnecteSiteExt',wrapCSS:'popin_compteGDF popin_compteGDF_deconnectExterne'});})(jQuery);}
function widget_affichePopinMailPropCptGDF(html){(function($){$.fancybox({maxWidth:650,minWidth:600,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_compteGDF_envoiMessage',fitToView:false});})(jQuery);}
function cptGDF_initActionsDetailFicheVisitee(){var delaiMasquage=600;(function($){$('body').undelegate('.compteGDF_lstFicheVisitee_titreDate','click');$('body').delegate('.compteGDF_lstFicheVisitee_titreDate','click',function(){var date_visite=$(this).data('datevisite');if($('ul[data-datevisite='+date_visite+']').is(":hidden")){$('ul[data-datevisite='+date_visite+']').show("blind");rendVisibleEcran('ul[data-datevisite='+date_visite+']',270)}
else{$('ul[data-datevisite='+date_visite+']').hide("blind");}
$(this).toggleClass('closed');});$('body').undelegate('.btDelFicheVisitee','click');$('body').delegate('.btDelFicheVisitee','click',function(){var ref=$(this).data('ref');var date_visite=$(this).data('datevisite');var liDate=$('li[data-datevisite='+date_visite+']');var ulFiche=$('ul[data-datevisite='+date_visite+']');var liFiche=$('li[data-ref='+ref+']');var conteneurMsgInfo=$('#div_ficheVisitee_msgInfo_'+ref);var data='action=DEL_FICHE_VISITEE';data+='&ref='+ref;$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){setMsgInfoCptGDF(conteneurMsgInfo,tabRetour.msg);}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
setMsgInfoCptGDF(conteneurMsgInfo);liFiche.hide(delaiMasquage);setTimeout(function(){liFiche.remove();if(ulFiche.children().length===0){liDate.remove();}},delaiMasquage);}});});$('body').undelegate('#bt_cptGDF_delLstFicheVisitee','click');$('body').delegate('#bt_cptGDF_delLstFicheVisitee','click',function(){if($('#ul_cptGDF_ficheVisitee_date').html().length===0){return false;}
widget_affichePopin_delLstFicheVisitee_cptGDF();});$('body').undelegate('#popIn_delLstFicheVisitee_cptGDF_btConfirm','click');$('body').delegate('#popIn_delLstFicheVisitee_cptGDF_btConfirm','click',function(){$.ajax({type:'POST',url:urlCptClient,data:'action=DEL_LST_FICHE_VISITEE',success:function(result){var tabRetour=JSON.parse(result);$.fancybox.close();if(tabRetour.code==='KO'){if(tabRetour.msg){setMsgInfoCptGDF($('#cptGDF_delLstFicheVisitee_msgInfo'),tabRetour.msg);}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
var ulFicheVisiteeDate=$('#ul_cptGDF_ficheVisitee_date');ulFicheVisiteeDate.hide(delaiMasquage);setTimeout(function(){ulFicheVisiteeDate.html('');$("#compteGDF_pasDeHistorique").show();},delaiMasquage);}});});})(jQuery);}
function cptGDF_majJauge(){(function($){var data='action=getHTML_remplissageJauge';$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
$('div.div_jaugeProfilBandeau').html(tabRetour.html);}});})(jQuery);}
function cptGDF_initActionsProfil(){(function($){cptGDF_initTouchOutDatepicker();cptGDF_initBoutonsModifierInfos();cptGDF_initCheckOuiNon();cptGDF_initCheckboxes();cptGdf_initInputChampsVides();cptGdf_initActionsSuppCompte();autocompleteurCpVille($('#inpt_CP'),$('#inpt_ville'));$('#inpt_dateNaissance').change(function(){$(this).val($.trim($(this).val()));});if($('#inpt_validInfosPersos').length>0){var tabChampsLV=getTabChampsLV_infosPersos();}
$('#inpt_validInfosPersos').click(function(){if(!LiveValidation.massValidate(tabChampsLV)){var infos=$('#form_infosProfil').serialize();errLogJS('liveValidationInfosPersoCompteGdF',infos);return;}
var infosObligatoires=true;$('.div_saisieInfosPersoCptGDF .inpt_obligatoire').each(function(){if($(this).val()==''){infosObligatoires=false;}});if(!infosObligatoires){afficheMessageInfosObligatoires();var infos=$('#form_infosProfil').serialize();errLogJS('infosObligatoiresCompteGdF',infos);return;}
var form=$('#form_infosProfil');var formData=new FormData(form[0]);if($('#inpt_newsletterFd_responsive').not(':visible').length>0){$('#inpt_newsletterFd_responsive').attr('name','ne_pas_prendre_en_compte_newsletter_fd');formData.append('ne_pas_prendre_en_compte_newsletter_fd','O');}
if($('#inpt_newsletterPart_responsive').not(':visible').length>0){$('#inpt_newsletterPart_responsive').attr('name','ne_pas_prendre_en_compte_newsletter_part');formData.append('ne_pas_prendre_en_compte_newsletter_part','O');}
$.ajax({processData:false,contentType:false,type:'POST',url:urlCptClient,data:formData,beforeSend:function(){},success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){afficheMessageRetour_cptGDF(tabRetour);}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
if(tabRetour.cheminPhoto){remplacePhotoProfilApresModif(tabRetour.cheminPhoto);}
afficheMessageRetour_cptGDF(tabRetour);cptGDF_initDivProfil($('#div_profilInfosPersos'));effaceLiveValidation();cptGDF_majJauge();$('#inpt_mailCptGdf').val($('#inpt_email').val());if(tabRetour.action==='getLandingPage'){window.location.href='/?getLandingPage=1';}}});if($('#inpt_validCentresInterets').is(':visible')){$('#inpt_validInfosPersos').parent('.div_btnValidProfilCptGDF').hide();$('#inpt_validCentresInterets').click();}});$('#div_profilMesOffres input').change(function(){var newsletter_fd='N';if($('#inpt_newsletterFd').is(':checked')){newsletter_fd='O';}
var newsletter_part='N';if($('#inpt_newsletterPart').is(':checked')){newsletter_part='O';}
$.ajax({url:urlCptClient,data:{action:'enregistreOffresGDF',newsletter_fd:newsletter_fd,newsletter_part:newsletter_part},beforeSend:function(){},success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}}});});$('.select_typeSejour').change(function(){var nb=$(this).find('option:selected').attr('nb');var inptTypeSejour=$(this).attr('data-typesejour');$('#'+inptTypeSejour).attr('checked',(nb>0)).change();});$('.div_centresInteretsCptGDF input').change(function(){if($(this).is(':checked')){$('label[for="'+$(this).attr("id")+'"]').addClass('selected');}else{$('label[for="'+$(this).attr("id")+'"]').removeClass('selected');}});$('#inpt_validCentresInterets').click(function(){var tabCI=new Array();var tabPS=new Array();var tabTD=new Array();var tabTH=new Array();var tabTS=new Array();$('.div_centresInteretsCptGDF input').each(function(){if($(this).is(':checked')){tabCI.push(($(this).val()));}});$('.div_periodesSejoursCptGDF input').each(function(){if($(this).is(':checked')){tabPS.push(($(this).val()));}});$('.div_typesDestinationsCptGDF input').each(function(){if($(this).is(':checked')){tabTD.push(($(this).val()));}});$('.div_typesHebergementsCptGDF input').each(function(){if($(this).is(':checked')){tabTH.push(($(this).val()));}});$('.div_typesSejoursCptGDF input').each(function(){if($(this).is(':checked')){tabTS.push(($(this).val()));}});$('.div_typesSejoursCptGDF select').each(function(){var inptTypeSejour=$(this).attr('data-typeSejour');if($('#'+inptTypeSejour).is(':checked')){tabTS.push(($(this).val()));}});$.ajax({url:urlCptClient,data:{action:'enregistreCentresInterets',tabCI:tabCI,tabPS:tabPS,tabTD:tabTD,tabTH:tabTH,tabTS:tabTS},beforeSend:function(){},success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
afficheMessageRetour_cptGDF(tabRetour);cptGDF_majJauge();cptGDF_initDivProfil($('#div_profilCentresInterets'));}});if($('#inpt_validInfosPersos').is(':visible')){$('#inpt_validCentresInterets').parent('.div_btnValidProfilCptGDF').hide();$('#inpt_validInfosPersos').click();}});$('.a_suppPhotoProfil').click(function(){affichePopinSuppPhotoProfil();});$('.a_modifInfosConnexion').click(function(){$.ajax({type:'POST',url:urlCptClient,data:{action:'envoiMailModifInfosConnexion'},success:function(result){var tabRetour=JSON.parse(result);affichePopinModifInformationsConnexion(tabRetour.html);}});});$('#inpt_modifInfosConnexion').click(function(){if($(this).data('site-externe')!==undefined){widget_affichePopin_deconnecteSiteExt_cptGDF();}else{var email=$('#inpt_mailCptGdf').val();var ancienMdp=$('#inpt_mdpdCptGdf').val();var nouveauMdp=$('#inpt_nouveauMdpCptGdf').val();var confirmMdp=$('#inpt_confirmMdpCptGdf').val();if(email!=''&&ancienMdp!=''&&nouveauMdp!=''&&confirmMdp!=''){if(nouveauMdp==confirmMdp&&ancienMdp!=nouveauMdp){$.ajax({url:urlCptClient,data:{action:'metAJourMotDePasse',email:email,ancienMdp:ancienMdp,nouveauMdp:nouveauMdp},beforeSend:function(){},success:function(result){var tabRetour=JSON.parse(result);if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
afficheMessageRetour_cptGDF(tabRetour);cptGDF_initDivProfil($('#div_profilInfosConnexion'));}});}else{}}else{}}});})(jQuery);cptGDF_initActionsNewPass();cptGDF_initActionsDeconnecteSiteExt();}
function cptGDF_initTouchOutDatepicker(){(function($){$(document).bind('touchstart',function(e){var ele=$(e.toElement);if(!ele.hasClass("hasDatepicker")&&!ele.hasClass("ui-datepicker")&&!ele.hasClass("ui-icon")&&!$(ele).parent().parents(".ui-datepicker").length)
$(".hasDatepicker").datepicker("hide");});})(jQuery);}
function getTabChampsLV_infosPersos(){var retour=[];(function($){var nom=new LiveValidation("inpt_nom",{validMessage:' '});nom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(nom);var prenom=new LiveValidation("inpt_prenom",{validMessage:' '});prenom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(prenom);var dateNaissance=new LiveValidation("inpt_dateNaissance",{validMessage:' ',onlyOnSubmit:true});dateNaissance.add(Validate.Format,{pattern:/(^[0-9]{8}$)/,failureMessage:$("#inpt_formatDateNaissanceIncorrect").val()});dateNaissance.add(Validate.Custom,{against:function(value){var jour=parseInt(value.substr(0,2));var mois=parseInt(value.substr(2,2));mois--;if(jour>31||mois>12||annee<1900){return false;}
var annee=parseInt(value.substr(4,4));var dateSaisie=new Date(annee,mois,jour,12,0,0,0);if(dateSaisie.getDay()>6||dateSaisie.getDay()<0||dateSaisie.getMonth()>12||dateSaisie.getMonth()<0||dateSaisie.getFullYear()<1900){return false;}
return true;},failureMessage:$("#inpt_dateNaissanceIncorrect").val()});dateNaissance.add(Validate.Custom,{against:function(value){var date_courante=new Date();var jour=parseInt(value.substr(0,2));var mois=parseInt(value.substr(2,2));mois--;var annee=parseInt(value.substr(4,4));var dateSaisie=new Date(annee,mois,jour,12,0,0,0);if(getEcartAnneeEntreObjsDates(date_courante,dateSaisie)<18){return false;}
return true;},failureMessage:$("#inpt_dateNaissanceIncorrectPas18Ans").val()});retour.push(dateNaissance);var adresse=new LiveValidation("inpt_adresse",{validMessage:' '});adresse.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(adresse);var cp=new LiveValidation("inpt_CP",{validMessage:' '});cp.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(cp);var ville=new LiveValidation("inpt_ville",{validMessage:' '});ville.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(ville);var tel=new LiveValidation("inpt_telephone",{validMessage:' ',onlyOnBlur:true});tel.add(Validate.Format,{pattern:/(^0[1-9][\s]?([0-9]{2}[\s]?){3}[0-9]{2}$|^00[0-9,\s]+[0-9]$)/,failureMessage:$("#inpt_msgTelIncorrect").val()});tel.add(Validate.Length,{minimum:6,tooShortMessage:$("#inpt_msgTelIncorrect").val()});tel.add(Validate.Length,{maximum:20,tooLongMessage:$('#inpt_msgTelIncorrect').val()});retour.push(tel);if($('#inpt_email:visible').length>0){var email=new LiveValidation("inpt_email",{validMessage:' ',onlyOnBlur:true});addValidateOnLiveValidationEmail(email,undefined,true,$("#inpt_msgMailNonValide").val());email.add(Validate.Custom,{against:function(value,args){var ancienEmail=$('#inpt_ancienEmail').val();if(ancienEmail!=value){var args={};args.info='checkEmailClientCompilNotExist';return checkEmailIteaPourValidate(value,args);}else{return true;}},failureMessage:$('#inpt_msgMailCompteExistant').val()});retour.push(email);}
var adresse=new LiveValidation("select_pays",{validMessage:' '});adresse.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(adresse);var csp=new LiveValidation('select_csp',{validMessage:' '});csp.add(Validate.Presence,{failureMessage:$('#inpt_msgVide').val()});retour.push(csp);})(jQuery);return retour;}
function afficheMessageRetour_cptGDF(tabRetour){(function($){if(!tabRetour.msg||tabRetour.msg==''){return;}
var classe='confirm';if(tabRetour.code=='KO'){classe='erreur';}
$('.div_messageRetourProfil').removeClass("confirm").removeClass("erreur").addClass(classe);$('.div_messageRetourProfil').text(tabRetour.msg);$('.div_messageRetourProfil').fadeIn().delay(5000).fadeOut();$('html, body').animate({scrollTop:0},'fast');})(jQuery);}
function cptGDF_initActionsNewPass(decoFinTraitement){(function($){if($('#btNewPassCptGdf_email').length===0){return false;}
var seDecoLorsDuRedirect=false;if(decoFinTraitement===true){seDecoLorsDuRedirect=true;}
var tabAValider=[];var mdp=new LiveValidation('inptNewPassCptGdf_newpass',{validMessage:' ',onlyOnBlur:true});mdp.add(Validate.Presence,{failureMessage:$('#inptNewPass_msgChampObligatoire').val()});mdp.add(Validate.Format,{pattern:/^[0-9a-zA-Z-_]+$/,failureMessage:$('#inptNewPass_msgSeulementChiffresLettres').val()});mdp.add(Validate.Length,{minimum:4,tooShortMessage:$('#inptNewPass_msgNbCar').val()});tabAValider.push(mdp);var mdpConfirm=new LiveValidation('inptNewPassCptGdf_newpass_confirm',{validMessage:' ',onlyOnBlur:true});mdpConfirm.add(Validate.Presence,{failureMessage:$('#inptNewPass_msgChampObligatoire').val()});mdpConfirm.add(Validate.Confirmation,{match:'inptNewPassCptGdf_newpass',failureMessage:$('#inptNewPass_msgCorresMdp').val()});tabAValider.push(mdpConfirm);$(this).unbind('click');$('#btNewPassCptGdf_email').bind('click',function(e){e.preventDefault();if(LiveValidation.massValidate(tabAValider)){$('#btNewPassCptGdf_email').hide();$('#btNewPassCptGdf_loader').show();var tabArgs=getVarsFromUrl();var data='action=reinitMotDePasse';data+='&newpass='+$('#inptNewPassCptGdf_newpass').val();if(tabArgs.login!==undefined&&tabArgs.pass!==undefined){data+='&email='+tabArgs.login;data+='&pass='+tabArgs.pass;}
if(tabArgs.loginGdf!==undefined&&tabArgs.passGdf!==undefined){data+='&email='+tabArgs.loginGdf;data+='&pass='+tabArgs.passGdf;}
$.ajax({type:'POST',url:urlCptClient,data:data,dataType:'json',success:function(tabRetour){if(tabRetour.code==='KO'){setMsgInfoCptGDF($('#newPassCptGDF_msgInfo'),tabRetour.msg);return false;}
setMsgInfoCptGDF($('#newPassCptGDF_msgInfo'));widget_affichePopinNewPassModifieCptGDF(tabRetour.msg,seDecoLorsDuRedirect);},complete:function(){$('#btNewPassCptGdf_email').show();$('#btNewPassCptGdf_loader').hide();}});}});})(jQuery);}
function cptGDF_initActionsDeconnecteSiteExt(){(function($){$('body').undelegate('.inpt_modifSiteExterne','click');$('body').delegate('.inpt_modifSiteExterne','click',function(){widget_affichePopin_deconnecteSiteExt_cptGDF();});$('body').undelegate('#cptGDF_btDeconnecteSiteExt','click');$('body').delegate('#cptGDF_btDeconnecteSiteExt','click',function(){var data='action=deconnecteSiteExt';data+='&site='+$(this).data('site');$.ajax({type:'POST',url:urlCptClient,data:data,success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){setMsgInfoCptGDF($('#cptGDF_deconnecteSiteExt_msgInfo'),tabRetour.msg);return false;}
setMsgInfoCptGDF($('#cptGDF_deconnecteSiteExt_msgInfo'));widget_affichePopinConfirmDemandePassword_cptGDF_mailEnvoye(tabRetour.msg);}});});})(jQuery);}
function cptGDF_initBoutonsModifierInfos(){(function($){$('.div_profilCptGDF:not(.sansDisabled)').each(function(){cptGDF_initDivProfil($(this));});$('.a_enteteProfilCptGDF_modifier').click(function(){var divAModifier=$(this).parents('.div_profilCptGDF');divAModifier.find('input, select').attr('disabled',false);divAModifier.find('.div_btnValidProfilCptGDF').show();});})(jQuery);}
function cptGDF_initCheckOuiNon(){(function($){$('.inptOuiNon').change(function(){var idLabel=$(this).attr('data-label');if($(this).is(':checked')){$('#'+idLabel).addClass('Oui');$('#'+idLabel).removeClass('Non');}else{$('#'+idLabel).addClass('Non');$('#'+idLabel).removeClass('Oui');}});})(jQuery);}
function cptGDF_initCheckboxes(){(function($){$('.div_contentProfilCptGDF input[type=checkbox]').change(function(){$('label[for='+$(this).attr('id')+']').toggleClass('selected',$(this).is(':checked'));});})(jQuery);}
function cptGDF_initDivProfil(divProfil){(function($){divProfil.find('input, select').attr('disabled',true);divProfil.find('.div_btnValidProfilCptGDF').hide();})(jQuery);}
function cptGdf_initActionsSuppCompte(){(function($){$('body').undelegate('#a_suppCompteGdf','click');$('body').delegate('#a_suppCompteGdf','click',function(){$.fancybox($('#div_confirmSuppCptGdf'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_compteGDF popin_suppCpt_cptGDF'});});$('body').undelegate('#popIn_supp_cptGDF_retourCompte','click');$('body').delegate('#popIn_supp_cptGDF_retourCompte','click',function(){$.fancybox.close();});$('body').undelegate('#popIn_supp_cptGDF_btConfirm','click');$('body').delegate('#popIn_supp_cptGDF_btConfirm','click',function(){$.ajax({type:'POST',url:urlCptClient,data:'action=supprimeCompteGdf',success:function(result){var tabRetour=JSON.parse(result);$.fancybox.close();if(tabRetour.code==='KO'){if(tabRetour.msg){setMsgInfoCptGDF($('#cptGDF_delLstFicheVisitee_msgInfo'),tabRetour.msg);}
return false;}
$.fancybox($('#div_suppEffectCptGdf'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_compteGDF popin_suppEffectCpt_cptGDF',afterClose:function(){document.location.href='/';}});}});});})(jQuery);}
function visualiseEtCropPhoto(idInputFile,foncApresCrop){var fichier=document.getElementById(idInputFile).files;var fileReader=new FileReader();fileReader.onloadend=function(e){afficheLoaderGlobal();rotateImage(e.target.result,function(src){effaceLoaderGlobal();affichePopinCropPhotoProfil(src,foncApresCrop);});};fileReader.readAsDataURL(fichier[0]);}
function rotateImage(original_src,callback){var rotated_src;var exifImg=new Image;exifImg.onload=function(){EXIF.getData(exifImg,function(){var orientation=EXIF.getTag(this,"Orientation");var canvas=jQuery('<canvas id="canvas_exif" width="'+exifImg.width+'" height="'+exifImg.height+'"></canvas>');canvas.attr('origin-clean','true');jQuery("body").append(canvas);var ctx=jQuery("#canvas_exif")[0].getContext('2d');ctx.translate(exifImg.width*0.5,exifImg.height*0.5);switch(orientation){case 2:ctx.translate(canvas.width,0);ctx.scale(-1,1);break;case 3:ctx.translate(canvas.width,canvas.height);ctx.rotate(Math.PI);break;case 4:ctx.translate(0,canvas.height);ctx.scale(1,-1);break;case 5:ctx.rotate(0.5*Math.PI);ctx.scale(1,-1);break;case 6:ctx.rotate(0.5*Math.PI);ctx.translate(0,-canvas.height);break;case 7:ctx.rotate(0.5*Math.PI);ctx.translate(canvas.width,-canvas.height);ctx.scale(-1,1);break;case 8:ctx.rotate(-0.5*Math.PI);ctx.translate(-canvas.width,0);break;}
ctx.translate(-exifImg.width*0.5,-exifImg.height*0.5);ctx.drawImage(exifImg,0,0);rotated_src=jQuery("#canvas_exif")[0].toDataURL();jQuery("#canvas_exif").remove();callback(rotated_src);});};exifImg.src=original_src;}
function affichePopinCropPhotoProfil(src,foncApresCrop){jQuery('#div_croppieContainer').html('');var vanilla=new Croppie(document.getElementById('div_croppieContainer'),{viewport:{width:150,height:150,type:'circle'},boundary:{width:300,height:300}});vanilla.bind(src);document.querySelector('.btn_valideCrop').addEventListener('click',function(ev){vanilla.result('canvas').then(function(src){jQuery('#input_srcImageCropped').val(src);foncApresCrop();jQuery.fancybox.close();});});jQuery.fancybox(jQuery('#div_popinCropPhotoProfil'),{maxWidth:1000,autoDimensions:false,openEffect:'none',closeEffect:'none',wrapCSS:'popin_compteGDF popin_compteGDF_modifPhoto',fitToView:false,padding:0});}
function uploadPhotoProfilApresCrop(){(function($){var src=$('#input_srcImageCropped').val();$.ajax({type:'POST',url:urlCptClient,data:{action:'modifiePhotoProfil',src:encodeURIComponent(src)},beforeSend:function(){},success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){afficheMessageRetour_cptGDF(tabRetour);}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
remplacePhotoProfilApresModif(tabRetour.cheminPhoto);afficheMessageRetour_cptGDF(tabRetour);cptGDF_majJauge();}});})(jQuery);}
function remplacePhotoProfilApresCrop(){(function($){var src=$('#input_srcImageCropped').val();$('.img_photoProfil.infosPersos:visible').attr('src',src);$('#inpt_photoBase64').val(src);})(jQuery);}
function remplacePhotoProfilApresModif(src){(function($){$('.img_photoProfil').attr('src',src);$('.div_photoProfilBandeau_suppPhoto').show();})(jQuery);}
function widget_affichePopinNewPassModifieCptGDF(html,decoFinTraitement){(function($){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_validReinitMotDePasse_cptGDF',afterClose:function(){if(decoFinTraitement){document.location.href=window.location.pathname+'?deconnexionChangementPass=1';}else{document.location.href='/';}}});})(jQuery);}
function affichePopinSuppPhotoProfil(){(function($){$.fancybox($('#popIn_suppPhoto_cptGDF'),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_compteGDF popin_compteGDF_suppPhotoProfil'});$('body').undelegate('#popIn_suppPhoto_cptGDF_btConfirm','click');$('body').delegate('#popIn_suppPhoto_cptGDF_btConfirm','click',function(){$.ajax({type:'POST',url:urlCptClient,data:{action:'supprimePhotoProfil'},success:function(result){var tabRetour=JSON.parse(result);if(tabRetour.code==='KO'){if(tabRetour.msg){afficheMessageRetour_cptGDF(tabRetour);}
return false;}
if(!traiteRepKoCnxCptGDF(tabRetour)){return false;}
$.fancybox.close();remplacePhotoProfilApresModif(tabRetour.cheminPhoto);afficheMessageRetour_cptGDF(tabRetour);cptGDF_majJauge();$('.div_photoProfilBandeau_suppPhoto').hide();}});});})(jQuery);}
function affichePopinModifInformationsConnexion(html){(function($){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,wrapCSS:'popin_compteGDF popin_modifInfosConnexion_cptGDF'});})(jQuery);}
function widget_affichePopinConfirmDemandePassword_cptGDF_mailEnvoye(html){(function($){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:html,afterClose:function(){$('#btDisconnectCptGDF').click();}});})(jQuery);}
function cptGDF_initActionsBandeau(){(function($){$('#sp_fermeJaugeProfil').click(function(){$('.div_jaugeProfilBandeau').hide();});})(jQuery);}
function afficheMessageInfosObligatoires(){(function($){var msg=$('#div_profilInfosPersos .div_msgInfosObligatoires').text();afficheMessageRetour_cptGDF({code:'KO',msg:msg});})(jQuery);}
function cptGdf_initInputChampsVides(){(function($){$('input.inpt_profilChampVide').unbind('blur');$('input.inpt_profilChampVide').bind('blur',function(){if($(this).val()!=''){$(this).removeClass('inpt_profilChampVide');}})})(jQuery);}
function effaceLiveValidation(){(function($){$('span.LV_validation_message').hide();})(jQuery);}
function cptGDF_chargeListeResasAnnulees(){(function($){var nbResasAffichees=$('.compteGDF_uneResa_annulees').length;$.ajax({type:'POST',url:urlCptClient,data:{action:'getHTML_listeDossiersAnnules',offset:nbResasAffichees},beforeSend:function(){afficheLoaderGlobal()},success:function(result){var tabRetour=JSON.parse(result);$('#div_chargeResaAnnulees').before(tabRetour.html);if(tabRetour.toutEstAffiche){$('#div_chargeResaAnnulees').hide();}
effaceLoaderGlobal();}});})(jQuery);}
function cptGDF_chargeListeResasEnCours(){(function($){var nbResasAffichees=$('.compteGDF_uneResa_enCours').length;$.ajax({type:'POST',url:urlCptClient,data:{action:'getHTML_listeResasEnCours',offset:nbResasAffichees},beforeSend:function(){afficheLoaderGlobal()},success:function(result){var tabRetour=JSON.parse(result);$('#div_plusDeResaEnCours').before(tabRetour.html);if(tabRetour.toutEstAffiche){$('#div_plusDeResaEnCours').hide();}
cptGDF_initActionsDetailResas();effaceLoaderGlobal();}});})(jQuery);}
function cptGDF_chargeListeResasPassees(){(function($){var nbResasAffichees=$('.compteGDF_uneResa_passees').length;$.ajax({type:'POST',url:urlCptClient,data:{action:'getHTML_listeResasPassees',offset:nbResasAffichees},beforeSend:function(){afficheLoaderGlobal()},success:function(result){var tabRetour=JSON.parse(result);$('#div_plusDeResaPassees').before(tabRetour.html);if(tabRetour.toutEstAffiche){$('#div_plusDeResaPassees').hide();}
cptGDF_initActionsDetailResas();effaceLoaderGlobal();}});})(jQuery);}
function afficherIframeYousign(){(function($){var tel=$("input[type='radio'][name='choixTel']:checked").val();if(tel=='0'){tel=$('#autreTel').val();if(tel==""){return;}}
var element=$('#validerTelYousign');var exercice=element.attr('data-exercice');var numero_resa=element.attr('data-numeroresa');var instance=element.attr('data-instance');var type_resa=element.attr('data-typeresa');$('#choixTelYousign').hide();$.ajax({type:'POST',url:urlCptClient,data:{action:'initYousign',exercice:exercice,numResa:numero_resa,instance:instance,typeresa:type_resa,tel:tel},beforeSend:function(){afficheLoaderGlobal();$('#div_btn_valider_signtureYousign').html('<img src="../../config_v3/imgs_defaut/loading/ajax-loader.gif" />').show();},success:function(retour){retour=JSON.parse(retour);effaceLoaderGlobal();if(retour==='KO'||retour===""||retour===undefined||retour.code==='KO'){$('#div_btn_valider_signtureYousign').hide();if(isNullOrUndefinedOrEmpty(retour.msg)){var msgErreur="Il y a eu une erreur lors de la gnration du contrat de votre rservation n"+numero_resa+". Veuillez essayer plus tard.";}else{var msgErreur=retour.msg;}
$('#txtPopUpCM').html(msgErreur);$('#titlePopUpCM').html("Il y a eu une erreur lors de la gnration du contrat");$('#popUpError').show();}else{$('#popUpError').hide();$('#div_signatureYousign').hide();$('#divHeaderCompteClient').hide();$('#main_signatureContrat').show();$('#iframeYousign').attr('src',retour.srcIframe);}}});})(jQuery);}
function initFormTelYousign(){(function($){$('#formChoixTel #autre').attr('checked','checked');})(jQuery);}
function retourValidationEnregistreCartePourCaution_centralPay(){location.reload();}
function initCautionCompteClient(){(function($){$('#div_detailRefusPriseCaution').dialog({modal:true,autoOpen:false,width:'auto',height:'auto'});$('#sp_refusePriseCaution').unbind('click');$('#sp_refusePriseCaution').bind('click',function(){$('#div_detailRefusPriseCaution').dialog('open');});$('#sp_valideRefusPriseCaution').unbind('click');$('#sp_valideRefusPriseCaution').bind('click',function(){var commentaireClient=$('#textarea_commClient').val();if(commentaireClient.length>0){refusePriseCaution(commentaireClient);}else{$('#div_msgCommObligatoire').show();}});$('#div_acceptePriseCaution').dialog({modal:true,autoOpen:false,width:'auto',height:'auto'});$('#sp_acceptePriseCaution').unbind('click');$('#sp_acceptePriseCaution').bind('click',function(){$('#div_acceptePriseCaution').dialog('open');});$('#sp_valideAcceptePriseCaution').unbind('click');$('#sp_valideAcceptePriseCaution').bind('click',function(){acceptePriseCaution();});})(jQuery);}
function refusePriseCaution(commentaireClient){(function($){var idObjet=$('#div_priseCaution').attr('data-idobjet');var tabInfosIdObjetPayable=getTabInfosIdObjetPayable(idObjet);$.ajax({type:'POST',url:'/lib_2/ajax/passerelleBureauLocal.php',data:{url:'lib_bureau/ajax/caution.php',instance:tabInfosIdObjetPayable['instance'],exercice:tabInfosIdObjetPayable['exercice'],action:'clientRefusePriseCaution',idObjet:idObjet,commentaireClient:commentaireClient},beforeSend:function(){afficheLoaderGlobal_site();},success:function(result){$('#div_msgRetourRefusPriseCaution').show();$('.div_infosPriseCaution').hide();console.log('refusePriseCaution result : ',result);},error:function(){$('#div_msgRetourErreurPriseCaution').show();console.log('refusePriseCaution error');},complete:function(){effaceLoaderGlobal_site();$('#div_detailRefusPriseCaution').dialog('close');}});})(jQuery);}
function acceptePriseCaution(){(function($){var idObjet=$('#div_priseCaution').attr('data-idobjet');var tabInfosIdObjetPayable=getTabInfosIdObjetPayable(idObjet);$.ajax({type:'POST',url:'/lib_2/ajax/passerelleBureauLocal.php',data:{url:'lib_bureau/ajax/caution.php',instance:tabInfosIdObjetPayable['instance'],exercice:tabInfosIdObjetPayable['exercice'],action:'clientAcceptePriseCaution',idObjet:idObjet},beforeSend:function(){afficheLoaderGlobal()},success:function(result){$('#div_msgRetourAcceptePriseCaution').show();$('.div_infosPriseCaution').hide();console.log('acceptePriseCaution result : ',result);},error:function(){$('#div_msgRetourErreurPriseCaution').show();console.log('acceptePriseCaution error');},complete:function(){effaceLoaderGlobal();$('#div_acceptePriseCaution').dialog('close');}});})(jQuery);}
function ouvreModaleAnnulationResa(instance,numResa,exercice){(function($){var html='<div id="formMotifAnnulation">'+'<p class="titre">Annulation de la rservation n'+numResa+' '+$('#dateCreation').text()+'</p>'+'<p class="titreMotif">Veullez indiquer le motif de votre annulation :</p>'+'<textarea id="motifAnnulation" class="block"></textarea>'+'<div class="btnsActionsAnnulation">'+'<button class="btn_annulResaFermer" onclick="jQuery.fancybox.close()">Fermer</button>'+'<button class="btn_annulResaConfirme" onclick="annuleResa(\''+instance+'\','+numResa+','+exercice+')">Confirmer l\'annulation</button>'+'</div>';'</div>';affichePopinFancyBox(html,'',{width:560,autoDimensions:false,autoScale:false});})(jQuery);}
function test(){return'<span>Annuler le dossier</span>';}
function annuleResa(instance,numResa,exercice){(function($){var motif=$('#motifAnnulation').val();$.ajax({type:'POST',url:urlCptClient,data:{action:'annuleDossierGp',numeroDossier:numResa,exercice:exercice,instance:instance,motif:motif},beforeSend:function(xhr){afficheLoaderGlobal_site();},complete:function(jqXHR,textStatus){},success:function(data){if(data.code==='KO'){effaceLoaderGlobal_site();return false;}
refreshPage();}});})(jQuery);}
function initBtnPaiementCbLdCptCli(){(function($){$('#div_btnPaiementCbLdCptCli > button').unbind('click');$('#div_btnPaiementCbLdCptCli > button').bind('click',function(){$('#detailResaCptCliModifinfosPaiement').show();$('#tr_recapPrixFd').show();$('#div_btnPaiementCbLdCptCli').hide();if($('#tr_recapPrixTotalAvecFraisCbLd').length>0){$('#tr_recapPrixTotal').hide();$('#tr_recapPrixTotalAvecFraisCbLd').show();}
if($('#td_recapPrixMontantAPayerAvecFraisCbLd').length>0){$('#td_recapPrixMontantAPayer').hide();$('#td_recapPrixMontantAPayerAvecFraisCbLd').show();}});if($('#div_btnPaiementCbLdCptCli').data('retour3ds')==='O'){$('#div_btnPaiementCbLdCptCli > button').click();}})(jQuery);}
function ouvreModaleDemandeAnnulationResa(numResa){(function($){affichePopinFancyBox($('.div_modalDemandeAnnulation[data-dossier="'+numResa+'"]').html(),'modaleDemandeAnnulation',{width:560,autoDimensions:false,autoScale:false});return false;})(jQuery);}
function ouvreModalRemboursementAvoir(){(function($){$('#div_modalRemboursementAvoir').dialog({modal:true,autoOpen:false,width:'500',height:'auto'});$('#div_modalRemboursementAvoir').dialog('open');if($('.div_saisieIbanRemboursementAvoir').length>0){$('.div_saisieIbanRemboursementAvoir').iban();}})(jQuery);}
function initRemboursementAvoirCompteClient(){(function($){$('#btn_demandeRbstAvoir').unbind('click');$('#btn_demandeRbstAvoir').bind('click',function(){$('#div_rbstAvoirCptCliOk').hide();$('#div_rbstAvoirCptCliKo').hide();if($('#select_modeRbstAvoir').val()==='V'){demandeRemboursementAvoirVirement();return;}});})(jQuery);}
function demandeRemboursementAvoirVirement(){(function($){if($('.div_saisieIbanRemboursementAvoir').iban('estValide')){demandeRemboursement({iban:$('.div_saisieIbanRemboursementAvoir').iban('getValeur')},'R');}})(jQuery);}
function demandeRemboursement(params,statut){(function($){$('#div_modalRemboursementAvoir').dialog('close');var data={url:'lib_bureau/ajax/avoir.php',instance:$('#div_modalRemboursementAvoir input[name="instance"]').val(),avoir_remboursable:{id_avoir:$('#div_modalRemboursementAvoir input[name="id_avoir"]').val(),statut:statut},action:'demandeRemboursementAvoir'};$.ajax({url:'/lib_2/ajax/passerelleBureauLocal.php',data:$.extend(data,params),beforeSend:function(){afficheLoaderGlobal_site();},success:function(){$('#div_rbstAvoirCptCliOk').show();$('#div_rbstAvoirCptCli').hide();},error:function(erreur){if(erreur&&erreur.responseJSON){if(erreur.responseJSON.code==='ERR_IBAN_INVALIDE'){$('#div_rbstAvoirCptCliKo').show();$('#p_rbstAvoirCptCliKo_ibanInvalide').show();return;}}
$('#p_rbstAvoirCptCliKo_ibanInvalide').html($('#p_rbstAvoirCptCliKo_ibanInvalide')).show();},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function ouvreModaleAnnulationRemboursementResa(identResa){(function($){$('.div_modalErreurRemboursementCB[data-dossier="'+identResa+'"]').dialog({modal:true,autoOpen:false,width:'auto',height:'auto',dialogClass:'modalErrRemboursementCb',draggable:false});$('.div_modalAnnulation[data-dossier="'+identResa+'"]').dialog({modal:true,autoOpen:false,width:'auto',height:'auto',dialogClass:'modalAnnulationRemboursementResa',draggable:false});$('.div_modalAnnulation[data-dossier="'+identResa+'"] .div_actionAnnulation').show();$('.div_modalAnnulation[data-dossier="'+identResa+'"] .divMsgErr').hide();$('.div_modalAnnulation[data-dossier="'+identResa+'"]').dialog('open');initGestionModesRemboursements();})(jQuery);}
function initGestionModesRemboursements(){(function($){if($('.div_saisieIbanRemboursement').length>0){$('.div_saisieIbanRemboursement').iban();}
$('input[name="modeRemboursement"]').change(function(){$('.div_saisieComplementaireModeRemboursement').hide();if($(this).val()==='VIR'){$('.div_saisieIbanRemboursement').show();}
if($(this).val()==='CBR'){$('.div_saisieRemboursementCb').show();}});})(jQuery);}
function confirmeAnnulationResa(identResa){(function($){if(verifSaisieAnnulationResa()===false){return;}
var data={url:'bureau_local/php/webservices/gestionReservation.php',instance:$('.div_modalAnnulation[data-dossier="'+identResa+'"] input[name="instance"]').val(),identResa:identResa,action:'annulationResaCptCli',motifAnnulation:$('.div_modalAnnulation[data-dossier="'+identResa+'"] select.select_motifAnnulationClient').val()};if($('.div_modalAnnulation[data-dossier="'+identResa+'"] textarea.ta_msgAnnulationClient').val()!==""){data.commentaire=$('.div_modalAnnulation[data-dossier="'+identResa+'"] textarea.ta_msgAnnulationClient').val();}
$.ajax({url:'/lib_2/ajax/passerelleBureauLocal.php',data:data,beforeSend:function(){afficheLoaderGlobal_site();},success:function(){remboursementSuiteAnnulation(identResa);},error:function(){$('.div_modalAnnulation[data-dossier="'+identResa+'"] .div_actionAnnulation').hide();$('.div_modalAnnulation[data-dossier="'+identResa+'"] .div_msgErreurAnnulation').show();effaceLoaderGlobal_site();}});})(jQuery);}
function verifSaisieAnnulationResa(){jQuery('.divMsgErr').hide();if(jQuery('select.select_motifAnnulationClient').val()===''){jQuery('.div_msgSelectMotifAnnulation').show();return false;}
if(jQuery('input[name="modeRemboursement"]').length>0&&!jQuery('input[name="modeRemboursement"]:checked').val()){jQuery('.div_msgSelectModeRemboursement').show();return false;}
if(jQuery('#inpt_valideCgv').attr('checked')!=='checked'){jQuery('.div_msgCheckboxCgv').show();return false;}
if(jQuery('#inpt_valideCga').length>0&&jQuery('#inpt_valideCga').attr('checked')!=='checked'){jQuery('.div_msgCheckboxCga').show();return false;}
if(jQuery('.div_saisieIbanRemboursement').length>0&&jQuery('.div_saisieIbanRemboursement').is(':visible')&&!jQuery('.div_saisieIbanRemboursement').iban('estValide')){jQuery('.div_msgSaisieIban').show();return false;}
if(jQuery('.div_saisieRemboursementCb').length>0&&jQuery('.div_saisieRemboursementCb').is(':visible')&&!jQuery('input[name="inptSelectCarteARembourser"]:checked').val()){jQuery('.div_msgSelectCb').show();return false;}
return true;}
function remboursementSuiteAnnulation(identResa){(function($){var modeRemboursement=$('input[name="modeRemboursement"]:checked').val();var tabIdentResa=identResa.split('_');var data={url:'bureau_local/php/webservices/gestionReservation.php',instance:tabIdentResa[0],exercice:tabIdentResa[2],identResa:identResa,action:'gereRemboursementAnnulationCptCli',modeRemboursement:modeRemboursement};if(modeRemboursement==='VIR'){data.iban=$('.div_saisieIbanRemboursement').iban('getValeur');}else if(modeRemboursement==='CBR'){data.transactionId=jQuery('input[name="inptSelectCarteARembourser"]:checked').val();data.modeCentralPay=jQuery('input[name="inptSelectCarteARembourser"]:checked').data('mode');}
$.ajax({url:'/lib_2/ajax/passerelleBureauLocal.php',data:data,beforeSend:function(){afficheLoaderGlobal_site();},success:function(){refreshPage();},error:function(){effaceLoaderGlobal_site();$('.div_modalAnnulation[data-dossier="'+identResa+'"]').dialog('close');$('.div_modalErreurRemboursementCB[data-dossier="'+identResa+'"]').dialog('open');}});})(jQuery);}
(function($){$.fn.iban=function(methodOrOptions){var methods={init:function(params){this.data('iban',new Iban(this,params));return this;},estValide:function(){return this.data('iban').estValide();},getValeur:function(){return this.data('iban').getValeur();}};if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof methodOrOptions==="object"||!methodOrOptions){return methods.init.apply(this,arguments);}else{$.error("Method "+methodOrOptions+" does not exist");}
function Iban(elem,params){$.getScript('/lib_2/api_externe/iban.js_0.0.7/iban.js');this.init=function(){this.elem=jQuery(elem);this.initParams(params);this.inputVal=this.elem.find('input[name="iban"]');this.inputVal.focus(function(){this.spSaisieIbanKo.hide();}.bind(this));this.inputVal.blur(function(){this.inputVal.val(this.inputVal.val().replace(/ /g,'').toUpperCase());}.bind(this));this.inputFile=this.elem.find('input[name="fichierIban"]');this.inputFile.change(function(){this.uploadFile();}.bind(this));this.spSaisieIbanKo=this.elem.find('.sp_msgSaisieIbanKo');this.spSaisieFichierIbanKo=this.elem.find('.sp_msgSaisieFichierIbanKo');this.spSaisieFichierIbanOk=this.elem.find('.sp_msgSaisieFichierIbanOk');this.spSaisieFichierIbanObligatoire=this.elem.find('.sp_msgSaisieFichierIbanObligatoire');};this.initParams=function(params){this.ibanUploaded=false;this.setFileRequired(params);};this.setFileRequired=function(){this.fileRequired=false;if(params&&params.fileRequired){this.fileRequired=true;}else if(this.elem.data('filerequired')){this.fileRequired=true;}};this.estValide=function(){if(IBAN.isValid(this.getValeur())&&(!this.fileRequired||this.ibanUploaded)){return true;}
if(this.fileRequired&&!this.ibanUploaded){this.spSaisieFichierIbanObligatoire.show();}
this.spSaisieIbanKo.show();return false;};this.getValeur=function(){return this.inputVal.val();};this.uploadFile=function(){this.spSaisieFichierIbanObligatoire.hide();this.spSaisieFichierIbanKo.hide();this.spSaisieFichierIbanOk.hide();var formData=new FormData();formData.append('action','uploadIbanClientToPcs');formData.append('ibanFile',this.inputFile.prop('files')[0]);$.ajax({url:'/lib_2/ajax/gereCptClient.php',type:'POST',processData:false,contentType:false,dataType:'json',data:formData,success:function(){this.ibanUploaded=true;this.spSaisieFichierIbanOk.show();}.bind(this),error:function(){this.spSaisieFichierIbanKo.show();}});};this.init();}};})(jQuery);jQuery(document).ajaxComplete(function(){majNumEtapes();});majNumEtapes();function recupParamSiteModeOuverturePaybox(){if(jQuery('#form_formPbx').length){return jQuery('#form_formPbx').attr('ouverture_paybox');}}
function pbxInPopUp(){return(recupParamSiteModeOuverturePaybox()=="POPUP");}
function setFormPaiementCptCliPaybox(){(function($){if($('#a_boutonValiderCptClientPbx').attr('disabled')=="disabled"){return false;}
if($("#div_validFormPbx").length){$("#div_validFormPbx").hide();}
var quelPaiement='solde';var montant_a_payer=$("#inpt_solde_cptCliPbx").val();if($("#input_paiement_cbVersPbx").length&&$("#input_paiement_cbVersPbx:checked").length){if(verifMontantVersement()){montant_a_payer=parseFloat($("#inpt_vers_cptClient").val())*100;}else{alertAMalibu('Le montant saisi est incorrect.');return false;}
quelPaiement='versement';}
if($("#input_paiement_cbAcomptePbx").length&&$("#input_paiement_cbAcomptePbx:checked").length){quelPaiement='acompte';montant_a_payer=$("#inpt_acompte_cptCliPbx").val();}
if($("#input_paiement_cbSoldeANCVPbx").length&&$("#input_paiement_cbSoldeANCVPbx:checked").length){quelPaiement='soldeANCV';}
if($("#input_paiement_cbAcompteANCVPbx").length&&$("#input_paiement_cbAcompteANCVPbx:checked").length){quelPaiement='acompteANCV';}
var montant_a_payer_for_trw=montant_a_payer;var adr="/lib_2/ajax/infosDist.php";var exe=$("#form_formPbx").attr("exercice");var type_resa=$("#form_formPbx").attr("type_resa");var nom_instance=$("#form_formPbx").attr("nom_instance");var base=$("#form_formPbx").attr("base");var numero_resa=$("#form_formPbx").attr("numero_resa");var idsession='PHPSESSID='+$("#form_formPbx").attr("idsession");var dpt=$("#form_formPbx").attr("dpt");var sending="info=REGLTCPTCLIPBX&numero_resa="+numero_resa+"&exercice="+exe+"&type_resa="+type_resa+"&nom_instance="+nom_instance+"&base="+base+"&montant_a_payer="+montant_a_payer_for_trw+"&dpt="+dpt+"&"+idsession+"&quelPaiement="+quelPaiement;$.ajax({url:adr,method:'POST',data:sending,contentType:"application/x-www-form-urlencoded",success:function(retour){eval("var tabRetour="+retour);if(tabRetour.code=="OK"){majFormPaybox(tabRetour);validerFormulairePaybox();}else{location.reload();}},beforeSend:function(){$('#a_boutonValiderCptClientPbx').addClass('disabled');},error:function(){$('#a_boutonValiderCptClientPbx').removeClass('disabled');}});})(jQuery);}
function setFormPaiementCptCliPayboxPourCouplageAvecCPay(){(function($){$('.erreurCouplagePaybox').hide();var quelPaiement='solde';var montant_a_payer=$("#inpt_solde_cptCliPbx").val();if($('input[name=choixPaiementCB]:visible:checked').val()==='acompte'){quelPaiement='acompte';montant_a_payer=$("#inpt_acompte_cptCliPbx").val();}else if($('input[name=choixPaiementCB]:visible:checked').val()==='montantlibre'){$('#input_montantVersement').removeClass('errSaisie');var regMontant=new RegExp('^[0-9]+([.]{1}[0-9]{1,2})?$');var montantLibre=$('#input_montantVersement').val();if(regMontant.test(montantLibre)){montant_a_payer=parseFloat(montantLibre)*100;}else{$('#input_montantVersement').addClass('errSaisie');return false;}
quelPaiement='versement';}
var exe=$("#form_formPbx").attr("exercice");var type_resa=$("#form_formPbx").attr("type_resa");var nom_instance=$("#form_formPbx").attr("nom_instance");var base=$("#form_formPbx").attr("base");var numero_resa=$("#form_formPbx").attr("numero_resa");var idSession=$("#form_formPbx").attr("idsession");var dpt=$("#form_formPbx").attr("dpt");$.ajax({url:'/lib_2/ajax/infosDist.php',method:'POST',data:{info:'REGLTCPTCLIPBX',PHPSESSID:idSession,numero_resa:numero_resa,exercice:exe,type_resa:type_resa,nom_instance:nom_instance,base:base,montant_a_payer:montant_a_payer,dpt:dpt,quelPaiement:quelPaiement},contentType:"application/x-www-form-urlencoded",success:function(retour){eval("var tabRetour="+retour);if(tabRetour.code=="OK"){majFormPaybox(tabRetour);validerFormulairePaybox();}else{$('.erreurCouplagePaybox').html(tabRetour.msg);$('.erreurCouplagePaybox').show();$('#a_btChoixPaiementReserver').removeClass('disabled');}},beforeSend:function(){$('#a_btChoixPaiementReserver').addClass('disabled');},error:function(){$('#a_btChoixPaiementReserver').removeClass('disabled');}});})(jQuery);}
function setFormPaiementCptCliANCVCentralPay(){(function($){var quelPaiement='soldeANCV';var montant_a_payer=$("#inpt_solde_cptCliPbx").val();if($("input[name='choixPaiementANCV']").length&&$("input[name='choixPaiementANCV']:checked").length&&$("input[name='choixPaiementANCV']:checked").val()==='acompte'){quelPaiement='acompteANCV';montant_a_payer=$("#inpt_acompte_cptCliPbx").val();}
var exe=$("#form_formPbx").attr("exercice");var type_resa=$("#form_formPbx").attr("type_resa");var nom_instance=$("#form_formPbx").attr("nom_instance");var base=$("#form_formPbx").attr("base");var numero_resa=$("#form_formPbx").attr("numero_resa");var idSession=$("#form_formPbx").attr("idsession");var dpt=$("#form_formPbx").attr("dpt");$.ajax({url:'/lib_2/ajax/infosDist.php',method:'POST',data:{info:'REGLTCPTCLIPBX',PHPSESSID:idSession,numero_resa:numero_resa,exercice:exe,type_resa:type_resa,nom_instance:nom_instance,base:base,montant_a_payer:montant_a_payer,dpt:dpt,quelPaiement:quelPaiement},contentType:"application/x-www-form-urlencoded",dataType:'json',success:function(tabRetour){if(tabRetour.code==="OK"){majFormPaybox(tabRetour);validerFormulairePaybox();}else{location.reload();}},beforeSend:function(){$('#a_btChoixPaiementPopinEANCV').addClass('disabled');},error:function(){$('#a_btChoixPaiementPopinEANCV').removeClass('disabled');}});})(jQuery);}
var lang="";var onEstSurUnSiteAnglaisEtFautMettreLeSigneEuroDevantLeMontant;var urlAJAX="/lib_2/ajax/gereResa.php?";var idSession;var errDossierNull="dossierNull";var chainePlanning="";var dateDebPlanning="";var infoBulles="";var nbJours="";var objDateDeb;var objDateFin;var nbMois;var txtAttente="<p id='p_msgAttente'><img id='img_roueAttente' style='margin:auto' src=/config_v3/imgs_defaut/loading/ajax-loader2.gif /></p>";var txtVerifDispos="<p id='p_msgAttente'><img id='img_roueAttente' style='margin:auto' src=/config_v3/imgs_defaut/loading/loader.gif /></p>";var txtErreurPrix='<p id="p_msgErreur">Une erreur est survenue lors du calcul du prix de votre rservation. Si le problme persiste, contactez la centrale de rservation.</p>';var gestprod=false;var rafraichirSurUrlActuelleApresSelectDateFin=false;var modeCalculPrixSurFiche=false;var afficheRecapPrix;var defaultDateDebut=null;function initLangue(){(function($){lang=$("body").attr("data-langue");if(lang=="ANGLAIS")
lang="en-GB";else if(lang=="HOLLANDAIS")
lang="nl";else if(lang=="ALLEMAND")
lang="de";else
lang="fr";if(lang=="en-GB")
onEstSurUnSiteAnglaisEtFautMettreLeSigneEuroDevantLeMontant=true;else
onEstSurUnSiteAnglaisEtFautMettreLeSigneEuroDevantLeMontant=false;})(jQuery);}
function getIdSessionInHtml(){var idSess;(function($){idSess=$("body").attr("data-iditea");if(!idSess){idSess=$('.data-iditea').attr('id');}
if(urlAJAX.indexOf("PHPSESSID")==-1){urlAJAX+='PHPSESSID='+idSess;}})(jQuery);return'PHPSESSID='+idSess;}
function ajoutePHPSESSID_history(){var params=recupParamsUrl();if(params.PHPSESSID){return;}
history.replaceState(null,'',location.pathname.replace('//','/')+location.search+'&'+getIdSessionInHtml());}
function recupParamsUrl(){var params=location.search.substring(1).split('&');var retour=[];for(var i=0;i<params.length;i++){var param=params[i].split('=');retour[param[0]]=param[1];}
return retour;}
function getInstanceInUrl(){var params=recupParamsUrl();if(!params.ident)
return"";var tabIdent=params.ident.split(".");var tabInstance=tabIdent[0].split("_");return tabInstance[0];}
function getNumHeberInUrl(){var params=recupParamsUrl();if(!params.ident)
return"";var tabIdent=params.ident.split(".");return tabIdent[2];}
function retourEtape1(msg){alertAMalibu(msg);setTimeout(function(){var pos=location.search.length;var tmp="?";if(location.search.indexOf("PHPSESSID")>-1){pos=location.search.indexOf("PHPSESSID");pos--;tmp=location.search.substr(0,pos);}else{tmp=location.search;}
location.href="/resa/etape1.php"+tmp;},3000);}
function initBtnsFooter(){(function($){if(false&&navigator.appVersion.indexOf("Chrome")>-1){$(".a_btnFooter[href$='.pdf']").fancybox({type:'iframe',titleShow:false,autoScale:false,width:"90%",height:"90%"});if($("#a_valideCGV").length>0){$("#a_valideCGV[href$='.pdf']").fancybox({type:"iframe",titleShow:false,autoScale:false,width:"90%",height:"90%"});}}
$(".a_btnFooter[href^='#div']").fancybox({fitToView:false,maxWidth:"800",maxHeight:"600"});})(jQuery);}
function initGooglePlusResa(){(function($){_idBtnConnexionGoogle='div_btnConnexionGoogle';if($('#div_btnConnexionGoogle').is('.compteGdf')){_fctGooglePlusOK=authentificationGoogleCompteGdf;_fctGooglePlusKO=authentificationGoogleCompteGdfKO;}else{_fctGooglePlusOK=resaGooglePlusOK;_fctGooglePlusKO=resaGooglePlusKO;}
$('#div_pasdecomptegdf').click(function(){_idBtnConnexionGoogle='div_btnConnexionGoogle_creaCptGDF';_fctGooglePlusOK=checkIfCompteFNGFGoogleExiste;_fctGooglePlusKO=resaGooglePlusKO;initBtnGooglePlus();});$('#div_connexioncomptegdf>p').click(function(){_idBtnConnexionGoogle='div_btnConnexionGoogle';if($('#div_btnConnexionGoogle').is('.compteGdf')){_fctGooglePlusOK=authentificationGoogleCompteGdf;_fctGooglePlusKO=authentificationGoogleCompteGdfKO;}else{_fctGooglePlusOK=resaGooglePlusOK;_fctGooglePlusKO=resaGooglePlusKO;}
initBtnGooglePlus();})})(jQuery);}
function resaGooglePlusOK(accessToken,tabInfosUser){(function($){$('.div_connexionReseau').hide();majFormClientResa_reseauSocial(tabInfosUser);})(jQuery);}
function resaGooglePlusKO(erreur){}
function checkIfCompteFNGFGoogleExiste(accessToken,tabInfosUser){(function($){var data='email='+tabInfosUser.email+'&type=connexionCompteGdf';if($('#div_btnConnexionGoogle_creaCptGDF').data('sessid')){data+='&phpsessid='+$('#div_btnConnexionGoogle_creaCptGDF').data('sessid');}
if($('#div_btnConnexionGoogle_creaCptGDF').data('idsrv')){data+='&idsrv='+$('#div_btnConnexionGoogle_creaCptGDF').data('idsrv');}
data+='&connectGoogle=1';$.ajax({type:'POST',url:urlAJAX,data:data,success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='KO'){creaCptGDFGoogle(tabInfosUser);}else{if(window.opener&&window.location.host!=window.opener.location.host){window.opener.postMessage('reload','*');}else{var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}}
if(window.opener&&window.location.host!=window.opener.location.host){window.close();}}});})(jQuery);}
function creaCptGDFGoogle(tabInfosUser){(function($){$.ajax({type:"POST",url:urlAJAX,dataType:'json',data:{type:"getMsgCreaCptGDF"},success:function(result){$('#div_msgChoixReseauxSociauxOuSaisieFormulaire span').html(result.msg);}});$('#div_saisieClientPassword').hide();$('#inpt_connectGoogle').val('O');majFormClientResa_reseauSocial(tabInfosUser);if(tabInfosUser.email){$('#inpt_mailClient').attr('disabled','disabled');$('#inpt_confirmMailClient').attr('disabled','disabled');}
$('#inpt_mdpClient').val(tabInfosUser.id);})(jQuery);}
function checkIfCompteFNGFFacebookExiste(tabInfosUser){(function($){var data='email='+tabInfosUser.email+'&type=connexionCompteGdf';if($('#div_btnConnexionFacebook_creaCptGDF').data('sessid')){data+='&phpsessid='+$('#div_btnConnexionFacebook_creaCptGDF').data('sessid');}
if($('#div_btnConnexionFacebook_creaCptGDF').data('idsrv')){data+='&idsrv='+$('#div_btnConnexionFacebook_creaCptGDF').data('idsrv');}
data+='&connectFacebook=1';$.ajax({type:'POST',url:urlAJAX,data:data,success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='KO'){creaCptGDFFacebook(tabInfosUser);}else{if(window.opener&&window.location.host!=window.opener.location.host){window.opener.postMessage('reload','*');}else{var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}}
if(window.opener&&window.location.host!=window.opener.location.host){window.close();}}});})(jQuery);}
function creaCptGDFFacebook(tabInfosUser){(function($){$.ajax({type:"POST",url:urlAJAX,dataType:'json',data:{type:"getMsgCreaCptGDF"},success:function(result){$('#div_msgChoixReseauxSociauxOuSaisieFormulaire span').html(result.msg);}});$('#div_saisieClientPassword').hide();$('#inpt_connectFB').val('O');majFormClientResa_reseauSocial(tabInfosUser);if(tabInfosUser.email){$('#inpt_mailClient').attr('disabled','disabled');$('#inpt_confirmMailClient').attr('disabled','disabled');}
$('#inpt_mdpClient').val(tabInfosUser.id);})(jQuery);}
function initEtape1(){(function($){$.ajaxSetup({timeout:100000});initLangue();idSession=getIdSessionInHtml();ajoutePHPSESSID_history();nbMois=$("#inpt_nbMoisCalend").val();if(!nbMois){nbMois=2;}
initBtnsFooter();$('#divBoutonAfficheDetailsVerifDate').click(function(){$('#divInfosResaITEA').show();}).show();$.datepicker.setDefaults($.datepicker.regional[lang]);init_btnModifierDates();$(".div_uneEtapeRecap:hidden:first").parent().addClass('div_uneEtapeCurr');$('span.sp_choixModeResa').click(function(){var loc=$(this).attr('data-href');location.href=loc;});if($('#input_testDatepickerResa').length>0){initDatepickersResa();initChangeJourRef();initChangeHeureDebFin();}else{afficherMasquerCalendrier();initDatepickersDateNaissance();}
if($("#div_uneEtape_compoFamilleGite").length>0){setEventsForGite();}else if($("#div_uneEtape_compoFamilleChambre").length>0){setEventsForChambre();}
$(".div_uneEtapeGrisee *").attr("disabled",true);if($('#div_uneEtape_selectionOrigine').length>0){$('input[name="radio_selectionOrigine"]').change(function(){var origine=$('input[name="radio_selectionOrigine"]:checked').val();$.ajax({type:'POST',url:urlAJAX,data:{type:'setTypeDossier_resaBureau',origine:origine},success:function(reponse){var tabRetour=XMLToArray(reponse);if(tabRetour.code=='OK'){afficheEffaceRecapPrix(tabRetour);}}});$('.divInfoModificationOrigineTauxCommission').slideDown('fast');});}
$('body').delegate('.select_compoAnimaux','change',function(){var prefixId=$(this).attr('data-num');var nbMax=$("#inpt_nbAnimauxMax"+prefixId).val();var nbMaxReel;try{nbMaxReel=parseInt($(this).attr('data-nbAnimaux'));}
catch(e){nbMaxReel=nbMax;}
affectAnimaux(prefixId);if($(".option.animal").length>0){afficheEffaceOptions("Animaux");}
else{$("#div_recapOptionsAnimaux").hide();etapeCourante($("#div_uneEtapeAnimaux"),true);}
if($("#select_compoAnimauxChien"+prefixId).val()==0&&$("#select_compoAnimauxChat"+prefixId).val()==0)
$("#div_recapOptionsAnimaux").hide();$("#div_uneEtapeAnimaux").find(".inpt_validEtape").val("Oui");var nbSelect=$(this).val();nbSelect=nbMax-nbSelect;var i=1;while(i<=nbSelect&&i>0){if($(this).is($("#select_compoAnimauxChien"+prefixId))){if($("#select_compoAnimauxChat"+prefixId).children("[value='"+i+"']").length==0){$("#select_compoAnimauxChat"+prefixId).append("<option value='"+i+"'>"+i+"</option>");}}
else{if($("#select_compoAnimauxChien"+prefixId).children("[value='"+i+"']").length==0){$("#select_compoAnimauxChien"+prefixId).append("<option value='"+i+"'>"+i+"</option>");}}
i++;}
for(i=nbMax;i>nbSelect;i--){if($(this).is($("#select_compoAnimauxChien"+prefixId))){$("#select_compoAnimauxChat"+prefixId).children("[value='"+i+"']").remove();}
else{$("#select_compoAnimauxChien"+prefixId).children("[value='"+i+"']").remove();}}
if(prefixId>0){var numOption=$(this).closest('tr.optionChambre').attr('numoption');var valFinale=parseInt($("#select_compoAnimauxChat"+prefixId).val())+parseInt($("#select_compoAnimauxChien"+prefixId).val());afficheEffaceOptionsSupplementaireObligatoires(numOption,prefixId,valFinale);}
if((nbMaxReel!=parseInt(nbMax))&&nbMaxReel>=0){var valSelected=parseInt($(this).val());if($(this).is($("#select_compoAnimauxChien"+prefixId))){$('option',"#select_compoAnimauxChat"+prefixId).each(function(){if((parseInt($(this).val())+valSelected)>nbMaxReel){$(this).addClass('surcapacite');}
else{$(this).removeClass('surcapacite');}});}
if($(this).is($("#select_compoAnimauxChat"+prefixId))){$('option',"#select_compoAnimauxChien"+prefixId).each(function(){if((parseInt($(this).val())+valSelected)>nbMaxReel){$(this).addClass('surcapacite');}
else{$(this).removeClass('surcapacite');}});}
var nbChats=parseInt($("#select_compoAnimauxChat"+prefixId).val());var nbChiens=parseInt($("#select_compoAnimauxChien"+prefixId).val());var divMessage;if(prefixId){divMessage=$(this).parents('.div_uneEtapeAnimaux').find('.messageSurcapaciteAnimaux');}
else{divMessage=$('.messageSurcapaciteAnimaux','#div_uneEtapeAnimaux');}
if(nbMaxReel<(nbChiens+nbChats)&&!estResaBureauProp()){$(divMessage).show('fast');}
else{$(divMessage).hide();}}});if($('#div_uneEtape_assuranceAnnul').length>0){$('#div_uneEtape_assuranceAnnul').css('display','none');}
initAssurance();$('body').delegate('input:radio','change',function(){var btRadio=$(this);var regexAnimaux=/^animaux[0-9]*$/;if(regexAnimaux.test(btRadio.attr('name'))){if(btRadio.val()=="Oui"){btRadio.closest('.div_uneEtapeContentText').find('.div_compoAnimaux').show();btRadio.closest('.div_uneEtapeContentText').find('.div_recapOptionsAnimaux').show();}
else{btRadio.closest('.div_uneEtapeContentText').find('.div_compoAnimaux').hide();btRadio.closest('.div_uneEtapeContentText').find('.div_recapOptionsAnimaux').hide();btRadio.closest('.div_uneEtapeContentText').find(".select_compoAnimaux").val(0);btRadio.closest('.div_uneEtapeContentText').find(".select_compoAnimaux").trigger('change');etapeCourante($("#div_uneEtapeAnimaux"),true);}}});initActionsMotMagique(false);$(".a_modifEtape").click(function(){$(this).siblings("h3").find(".sp_lblEtape").validationEngine("hide");$(this).parents(".div_uneEtape").find(".div_uneEtapeRecap").hide("slow");$(".div_uneEtapeCurr").removeClass('div_uneEtapeCurr');$(this).parents(".div_uneEtape").addClass('div_uneEtapeCurr');$(this).parents(".div_uneEtape").find(".div_uneEtapeContent").show("slow",function(){$(this).parents(".div_uneEtape").find(".div_uneEtapeContent").css("overflow","");});$(this).hide();});if($('#fraisDossierPV').length>0){$('#fraisDossierPV').keypress(function(event){var charCode=event.which;if(charCode>31&&((charCode<48||charCode>57)&&charCode!==44&&charCode!==46)){event.preventDefault();}
if(charCode>31){var val=$(this).val()+String.fromCharCode(charCode);var regex=/^(\d)*([\.,]){0,1}(\d)*$/;if(!regex.test(val)){event.preventDefault();}}});$('#buttonFraisDossierPV').click(function(){$.ajax({type:"POST",url:urlAJAX,data:{type:"affecteFraisDossier",frais:$('#fraisDossierPV').val()},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){var tabRetour=XMLToArray(result);if(tabRetour.code=='OK'){afficheEffaceRecapPrix(tabRetour);}
else{tabRetour.msg=tabRetour.msg||false;if(tabRetour.msg){alertAJquery(tabRetour.msg);}}
$('#sp_recapFraisDossier').html(tabRetour.htmlRecapFraisDossier);effaceMsgAttenteParDessus("recapPrix");etapeCourante($("#div_uneEtape_fraisDossier"),true);}});});$('#buttonAnnuleFraisDossierPV').click(function(){$('#fraisDossierPV').val('');$.ajax({type:"POST",url:urlAJAX,data:{type:"affecteFraisDossier",frais:''},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){var tabRetour=XMLToArray(result);if(tabRetour.code=='OK'){afficheEffaceRecapPrix(tabRetour);}
else{tabRetour.msg=tabRetour.msg||false;if(tabRetour.msg){alertAJquery(tabRetour.msg);}}
$('#sp_recapFraisDossier').html(tabRetour.htmlRecapFraisDossier);effaceMsgAttenteParDessus("recapPrix");etapeCourante($("#div_uneEtape_fraisDossier"),true);}});});}
$('#a_btnRecalculPrix').click(function(){questionRecalculAuto();});$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm), #div_btnConfirmer_1 > a:not(.a_btnAttenteConfirm)").click(function(){$(this).hide();$(".a_btnAttenteConfirm").show();if($("#inpt_motMagique").length>0){if($("#inpt_motMagique").val()!=""){verifMotMagique(true,false);}else{$("#div_motMagique > span.confirmSaisie").hide();}}
if($("#div_motMagique > span.confirmSaisie.ko:visible").length==0&&etapesValid()){enregistreElementsAvantValidationEtape1();var paramsURL=location.search;paramsURL+='&div_btnConfirmer=1';if($(this).is('#div_btnConfirmer > a:not(.a_btnAttenteConfirm)')){var numeroEtape='2';if($('#divNumeroProchaineEtape').attr('data-prochaineetape')){numeroEtape=$('#divNumeroProchaineEtape').attr('data-prochaineetape');}
if(paramsURL.indexOf("PHPSESSID")>-1){location.href='etape'+numeroEtape+'.php'+paramsURL;}else{location.href='etape'+numeroEtape+'.php'+paramsURL+"&"+idSession;}}else{$('#div_btnConfirmer_2 > a:not(.a_btnAttenteConfirm)').click();}}
$(".a_btnAttenteConfirm").hide();$(this).show();});$('#divBoutonTerminerModification').click(function(){enregistreElementsAvantValidationEtape1();if(etapesValid()){terminerModifResa();}});$('.inpt_modifHoraires').live('blur',function(){setHeuresArriveeDepart();});initModifPrixResaBureau();initModalTaxeSejour();})(jQuery);}
function afficherMasquerCalendrier(tabParam){(function($){if($("#div_choixModeResaGEGS").length>0){var modeResa=$("input:radio[name=modeResa]:checked").val();}
var tabData={type:"getPlanningDeb",modeResa:modeResa}
if(tabParam){tabData={type:"getPlanningDeb",modeResa:modeResa,ident:tabParam.ident,instance:tabParam.instance,exercice:tabParam.exercice,estpresentsurfiche:true}
if(!nbMois){nbMois=1}
if(tabParam.modefiche){rafraichirSurUrlActuelleApresSelectDateFin=true;}
if(tabParam.modeFicheV8){modeCalculPrixSurFiche=true;}}
$(".sp_fermerCal").click(function(){$(this).parents(".div_calendDateDebFin").hide();});$("#inpt_resaDateDeb").click(function(){if($("#div_choixModeResaGEGS").length>0){modeResa=$("input:radio[name=modeResa]:checked").val();tabData.modeResa=modeResa;}
$("#div_calendrierDeb").show().addClass("open");$("#div_msgErreursDateDeb").hide();$("#div_calendrierFin").hide().removeClass("open");$.ajax({type:"POST",url:urlAJAX,async:false,data:tabData,beforeSend:function(){$("#div_roueDatepickerDeb").show();},success:function(result){eval("var tabDispos="+result);if(tabDispos.code==errDossierNull){retourEtape1(tabDispos.msg);}
else if(tabDispos.errTechnq){afficheMsgErrTechnq(tabDispos.msg,tabDispos.titre,tabDispos.ident,true);}
else if(tabDispos.code=="OK"){chainePlanning=tabDispos.chaineDispo;dateDebPlanning=tabDispos.dateDeb;dateFinPlanning=tabDispos.dateFin;infoBulles=tabDispos.infoBulle;initDatePickerDeb();}
else{alertAMalibu(tabDispos.msg);$("#div_calendrierDeb").hide().removeClass("open");$("#div_uneEtape_date").find(".inpt_validEtape").val("Non");}
$("#div_roueDatepickerDeb").hide();}});return false;});$("#inpt_resaDateFin").click(function(){var regDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");$("#div_calendrierDeb").hide().removeClass("open");if(regDate.test($("#inpt_resaDateDeb").val())){if($('#div_datepickerFin').text()==''){if($('#div_datepickerDeb').text()==''){$("#inpt_resaDateDeb").trigger('click')}
setDateDeb($('#inpt_resaDateDeb').val())
initDatePickerFin();}else{$("#div_calendrierFin").show().addClass("open");}}
else{$("#div_msgErreursDateDeb").show();$("#div_calendrierDeb").show().addClass("open");if(tabParam&&tabParam.modeFicheV8){ouvreDatePickerDateDeb_packDivDatesTarifs();}}
return false;});initChangeJourRef();initChangeHeureDebFin();})(jQuery);}
function initResumeEtapes(){(function($){$(".inpt_validEtape").each(function(){var classe,li,divParente,numero,titre,id;divParente=$(this).parents('.div_uneEtape');numero=$(divParente).find('.sp_numEtape').text();titre=$(divParente).find('.sp_lblEtape').text();id=$(divParente).attr('id');if($(this).val()!='Oui'){classe="notValid";}
else{classe="valid";}
li="<li class='"+classe+"' id='resume_"+id+"'>";li+="<a href='#"+id+"'>"+numero+". "+titre+"</a>";li+="</li>";if($('#resume_'+id).length>0){$('#resume_'+id).remove();}
$('#recapEtapesValidees > ol').append(li);});})(jQuery);}
function setEventsForGite(){(function($){$("#div_optionsSuppl").find("tr:last").addClass("last");$("#div_infosOptionsObligatoiresContent").find("tr:last").addClass("last");$("#div_infosOptionsAnimauxContent").find("tr:last").addClass("last");$("#select_compoFamilleAdulte").change(function(){metAJourListeFamille();afficheEffaceOptions("Adultes");if($(this).val()==0){if(estResaGP()){$("#div_infoCompoFamilleQuestionEnfants").hide();$(".div_infoCompoFamilleReponseEnfants input").attr("checked",false);$("#div_infoCompoFamilleEnfants, #div_compoFamilleDateNaissanceEnfants, #div_compoFamilleDateNaissanceBebes").hide();$(".select_compoFamilleAgeEnfants").val(0);$(".select_compoFamilleAgeBebes").val(0);$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");}
else{if($('#select_compoFamilleEnfant').val()==0){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");}
if(!estResaBureauProp()&&!estResaBureauGestloc()){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");}}}
else{$("#div_infoCompoFamilleQuestionEnfants").show();$(this).children("[value='0']").remove();if($('#inpt_enfantsNon').is(':checked')||!estResaGP()){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");}}
affectFamille();});if($("#inpt_nbEnfants")){metAJourListeFamille();$("#select_compoFamilleEnfant").val($("#inpt_nbEnfants").val());}
$("#select_compoFamilleEnfant").change(function(){metAJourListeFamille();$(".td_ageEnfants").hide();if($(this).val()!=0){for(var i=1;i<=$(this).val();i++){$("#td_ageEnfant_"+i).show();}
$("#div_compoFamilleDateNaissanceEnfants").show("slow");if(estResaBureauProp()||estResaBureauGestloc()){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");}else{if($(".select_compoFamilleAgeEnfants[value=0]:visible").length==0){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");}
else{$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");}
verifCompoFamilleGiteAdultes();}}
else{$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");$("#div_compoFamilleDateNaissanceEnfants").hide("slow");$(".select_compoFamilleAgeEnfants").val(0);verifCompoFamilleGiteAdultes();}
afficheEffaceOptions("Adultes");affectFamille();videDatesNaissanceNonVisibles();});$("#select_compoFamilleBebe").change(function(){if(bebeDansCapacite()){metAJourListeFamille();}
$(".td_ageBebe").hide();if($(this).val()!=0){for(var i=1;i<=$(this).val();i++){$("#td_ageBebe_"+i).show();}
$("#div_compoFamilleDateNaissanceBebes").show("slow");if(estResaBureauProp()||estResaBureauGestloc()){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");}}else{$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Oui");$("#div_compoFamilleDateNaissanceBebes").hide("slow");$(".select_compoFamilleBebe").val(0);verifCompoFamilleGiteAdultes();}
affectFamille("bebes");videDatesNaissanceNonVisibles();});$("input:radio[name=enfants]").change(function(){if($(this).val()=="Oui"){$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");$("#div_infoCompoFamilleEnfants").show("slow");}
else{if($("#select_compoFamilleEnfant").val()>0||$("#select_compoFamilleBebe").val()>0){$("#select_compoFamilleEnfant").val(0);$('#select_compoFamilleBebe').val(0);if($("tr.option.indiv.obligatoire:not(.animal):visible").length>0){afficheEffaceOptions("Adultes");}
affectFamille();$("#div_infoCompoFamilleEnfants").hide("slow");$("#div_compoFamilleDateNaissanceEnfants, #div_compoFamilleDateNaissanceBebes, #div_compoFamille_msgReinitEnfant").hide();}
if($(".option.obligatoire:not(.animal)").length>0){$("#div_recapOptionsObligatoires > ul").html(getXHTML_recapOptionsObligatoires());$("#div_recapOptionsObligatoires").show();}
$("#div_infoCompoFamilleEnfants").hide();etapeCourante($("#div_uneEtape_compoFamilleGite"),true);}
verifCompoFamilleGiteAdultes();});$(".select_compoFamilleAgeEnfants, .select_compoFamilleAgeBebe").change(function(){if($(".select_compoFamilleAgeEnfants[value=0]:visible").length==0&&$(".select_compoFamilleAgeBebe[value=0]:visible").length==0){$("#div_recapOptionsObligatoires").find("ul").html(getXHTML_recapOptionsObligatoires());etapeCourante($("#div_uneEtape_compoFamilleGite"),true);}
else{$("#div_uneEtape_compoFamilleGite").find(".inpt_validEtape").val("Non");}
verifCompoFamilleGiteAdultes();});$(".pasdeDateEnfants").click(function(){if($(this).attr('data-ok')=='1'){$(this).attr('data-ok','0');etapeCourante($("#div_uneEtape_compoFamilleGite"),false);}else{$(this).attr('data-ok','1');etapeCourante($("#div_uneEtape_compoFamilleGite"),true);}
return false;});$(".select_optionAdultes, .select_optionEnfants, .select_optionAnimaux, .select_optionGroupe").change(function(){affectOptions();});initListesDureeOption();})(jQuery);}
function setEventsForChambre(){(function($){if($(".inpt_chambre:checked").length>0){$("#div_uneEtape_compoFamilleChambre").find(".inpt_validEtape").val("Oui");}
$(".div_uneChambreTarifsOption").each(function(){$(this).find("tr:last").addClass("last");});$(".inpt_chambre").change(function(){var numChambre=getNumChambreByElem($(this));var annulChoix=false;if($(this).attr('data-annulChoix')){annulChoix=true;$(this).removeAttr('data-annulChoix');}
affectChambre(numChambre,annulChoix);if($(this).attr("checked")=="checked"){$(this).siblings("span").show();}
else{$(this).siblings("span").hide();if($("#select_compoFamilleAdulte_"+numChambre).val()>0){$("#select_compoFamilleAdulte_"+numChambre).val(0);$("#select_compoFamilleAdulte_"+numChambre).change();}}});$(".select_compoFamilleAdulte").change(function(){var numChambre=getNumChambreByElem($(this));metAJourListeFamille(numChambre);var divUneChambreTarifsOption=$(this).parents('.div_uneChambreContent').find('.div_uneChambreTarifsOption');var elemsDivUneChambreTarifsOption=divUneChambreTarifsOption.find('*');if($(this).val()==0){$("#div_infoCompoFamilleQuestionEnfants_"+numChambre).hide();$(".inpt_optionChambre_"+numChambre).attr("disabled",true);$(".select_optionChambre_"+numChambre).attr("disabled",true);$("#inpt_enfantsNon_"+numChambre).attr("checked",false);$("#inpt_enfantsOui_"+numChambre).attr("checked",false);if(parseInt($('#select_compoFamilleEnfant_'+numChambre).val())===0){$('#div_infoCompoBebes_'+numChambre).hide();elemsDivUneChambreTarifsOption.attr('disabled',true);divUneChambreTarifsOption.toggleClass('div_uneChambreTarifsOptionGrisee',true);if($("#inpt_chambre_"+numChambre).attr("checked")=="checked"){$("#inpt_chambre_"+numChambre).attr("checked",false);$("#inpt_chambre_"+numChambre).change();}}
if($(".inpt_chambre:checked").length==0)
$(this).parents(".div_uneEtape").find(".inpt_validEtape").val("Non");}else{if($("#inpt_chambre_"+numChambre).attr("checked")==undefined){$("#inpt_chambre_"+numChambre).attr("checked",true);$("#inpt_chambre_"+numChambre).change();}
$('#div_infoCompoBebes_'+numChambre).show();$(".inpt_optionChambre_"+numChambre).attr("disabled",false);$(".select_optionChambre_"+numChambre).attr("disabled",false);$("#div_infoCompoFamilleQuestionEnfants_"+numChambre).show();elemsDivUneChambreTarifsOption.attr('disabled',false);divUneChambreTarifsOption.toggleClass('div_uneChambreTarifsOptionGrisee',false);mettreAjourListeRepas(numChambre);etapeCourante($("#div_uneEtape_compoFamilleChambre"),true);}
affectFamille("Adultes",numChambre);});$(".input_choixEnfants").change(function(){var numChambre=getNumChambreByElem($(this));if($(this).val()=="Oui"){$(this).parents(".div_uneEtape").find(".inpt_validEtape").val("Non");$("#div_infoCompoFamilleEnfants_"+numChambre).show("slow");$("#div_compoFamilleDateNaissanceEnfants_"+numChambre).show("slow");}
else{if($("#select_compoFamilleEnfant_"+numChambre).val()>0||$("#select_compoFamilleBebe_"+numChambre).val()>0){$("#select_compoFamilleEnfant_"+numChambre+", #select_compoFamilleBebe_"+numChambre).val(0);affectFamille("",numChambre);}
$("#div_infoCompoFamilleEnfants_"+numChambre).hide("slow");$("#div_compoFamilleDateNaissanceEnfants_"+numChambre).hide("slow");etapeCourante($("#div_uneEtape_compoFamilleChambre"),true);$('.select_compoFamilleAgeEnfants_'+numChambre).val(0);}});if($(".inpt_nbEnfants").length>0){$(".inpt_nbEnfants").each(function(){var numChambre=getNumChambreByElem($(this));metAJourListeFamille(numChambre);$("#select_compoFamilleEnfant_"+numChambre).val($("#inpt_nbEnfants_"+numChambre).val());});}
$(".select_compoFamilleEnfant").change(function(){var numChambre=getNumChambreByElem($(this));metAJourListeFamille(numChambre);$(".td_ageEnfants_"+numChambre).hide();var divUneChambreTarifsOption=$(this).parents('.div_uneChambreContent').find('.div_uneChambreTarifsOption');var elemsDivUneChambreTarifsOption=divUneChambreTarifsOption.find('*');if($(this).val()!=0){for(var i=1;i<=$(this).val();i++){$("#td_ageEnfant_"+i+"_"+numChambre).show();}
$("#div_compoFamilleDateNaissanceEnfants_"+numChambre).show("slow");if($("#inpt_chambre_"+numChambre).attr("checked")==undefined){$("#inpt_chambre_"+numChambre).attr("checked",true);$("#inpt_chambre_"+numChambre).change();}
elemsDivUneChambreTarifsOption.attr('disabled',false);divUneChambreTarifsOption.toggleClass('div_uneChambreTarifsOptionGrisee',false);$('#div_infoCompoBebes_'+numChambre).show();}
else{$("#div_compoFamilleDateNaissanceEnfants_"+numChambre).hide("slow");if(parseInt($('#select_compoFamilleAdulte_'+numChambre).val())===0){$("#inpt_chambre_"+numChambre).attr("checked",false);$("#inpt_chambre_"+numChambre).change();elemsDivUneChambreTarifsOption.attr('disabled',true);divUneChambreTarifsOption.toggleClass('div_uneChambreTarifsOptionGrisee',true);$('#div_infoCompoBebes_'+numChambre).hide();}}
mettreAjourListeRepas(numChambre);affectFamille("Enfants",numChambre);});$(".select_compoFamilleBebe").change(function(){if(bebeDansCapacite()){metAJourListeFamille(getNumChambreByElem($(this)));}
var numChambre=getNumChambreByElem($(this));$(".td_ageBebe_"+numChambre).hide();if($(this).val()!=0){for(var i=1;i<=$(this).val();i++){$("#td_ageBebe_"+i+"_"+numChambre).show();}
$("#div_compoFamilleDateNaissanceBebes_"+numChambre).show("slow");etapeCourante($("#div_uneEtape_compoFamilleChambre"),true);}
else{$("#div_compoFamilleDateNaissanceBebes_"+numChambre).hide("slow");}
affectFamille("bebes",numChambre);});$(".select_compoFamilleAgeEnfants, .select_compoFamilleAgeBebe").change(function(){var numChambre=getNumChambreByElem($(this));if(($(".select_compoFamilleAgeEnfants_"+numChambre+":visible").length==1||$(".select_compoFamilleAgeEnfants_"+numChambre+"[value=0]:visible").length==0)&&$(".select_compoFamilleAgeBebe_"+numChambre+"[value=0]:visible").length==0){}});$(".inpt_optionChambre").live('change',function(){var numChambre=getNumChambreByElem($(this));if($(this).attr("checked")==undefined){$(this).parent().next().next().children("select.select_optionChambre").val(0);}
else{var nbAdultes=$("#select_compoFamilleAdulte_"+numChambre).val();$(this).parent().next().next().children("select.select_optionChambre").val(nbAdultes);}
affectOptionsChambre();});$(".select_optionChambre").live('change',function(){affectOptionsChambre();});initListesDureeOption(true);})(jQuery);}
function mettreAjourListeRepas(numChambre){if(numChambre){jQuery.each(jQuery(".optionChambre[numchambre="+numChambre+"] .select_optionChambre").not('.select_optionChambre_enfants,.forfaitaire'),function(){var nbRepasAdultesAvant=jQuery(this).val()
var nbAdultes=parseInt(jQuery("#select_compoFamilleAdulte_"+numChambre).val());var nbRepasEnfantsAvant=0;var nbEnfants=0;if(jQuery("#select_compoFamilleEnfant_"+numChambre)){nbEnfants=parseInt(jQuery("#select_compoFamilleEnfant_"+numChambre).val());}
var nbNuits=1;if(!jQuery(this).is('.parJour')&&jQuery("#sp_recapDatesDuree")){nbNuits=jQuery("#sp_recapDatesDuree").html();}
var htmlAdultes='<option selected="selected" value="0">-</option>';var nbOptionsMax=(nbAdultes+nbEnfants)*nbNuits;for(i=1;i<(nbOptionsMax+1);i++){htmlAdultes+='<option value="'+i+'">'+i+'</option>';}
jQuery(this).html(htmlAdultes);if(jQuery(this).parent().children(".select_optionChambre_enfants"+numChambre).length>0){var maDivEnfant=jQuery(this).parent().children(".select_optionChambre_enfants"+numChambre);nbRepasEnfantsAvant=jQuery(maDivEnfant).val();var htmlEnfants='<option';if(nbRepasEnfantsAvant==0){htmlEnfants+=' selected="selected"';}
htmlEnfants+=' value="0">-</option>';for(i=1;i<(nbEnfants*nbNuits+1);i++){htmlEnfants+='<option';if(nbRepasEnfantsAvant==i){htmlEnfants+=' selected="selected"';}
htmlEnfants+=' value="'+i+'">'+i+'</option>';}
jQuery(maDivEnfant).html(htmlEnfants);}
if(nbRepasAdultesAvant<=nbOptionsMax){jQuery(this).val(nbRepasAdultesAvant);}else{jQuery(this).val(nbOptionsMax);affectOptionsChambre();}});}else{jQuery.each(jQuery("#div_selectionChambre div.div_uneChambre"),function(){if(jQuery(this).attr('num').length>0){mettreAjourListeRepas(jQuery(this).attr('num'))}});}}
function getNumChambreByElem(elem){var numChambre;(function(){numChambre=elem.parents(".div_uneChambre").attr("num");})(jQuery);return numChambre;}
function initDatePickerDeb(){(function($){var dateDeb=new Date();var dayNamesMin=$.datepicker._defaults.dayNamesMin;if(rafraichirSurUrlActuelleApresSelectDateFin||modeCalculPrixSurFiche){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);dayNamesMin=$.datepicker._defaults.dayNamesShort;}
$("#div_datepickerDeb").datepicker({numberOfMonths:[1,nbMois],dateFormat:'dd/mm/yy',minDate:dateDebPlanning,maxDate:dateFinPlanning,defaultDate:defaultDateDebut,dayNamesMin:dayNamesMin,beforeShowDay:setJourDebut,onSelect:function(dateDeb){setDateDeb(dateDeb);initDatepickersDateNaissance();}});if(typeof(objDateDeb)!='undefined'){$("#div_datepickerDeb").datepicker('setDate',objDateDeb);}})(jQuery);}
function initDatePickerFin(){(function($){$("#div_datepickerFin").datepicker({numberOfMonths:[1,nbMois],dateFormat:'dd/mm/yy',defaultDate:new Date(),beforeShowDay:setJour,onSelect:function(dateFin){setDateFin(dateFin);}});})(jQuery);}
function initDatePickerNaissanceParticipant(){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);$('.dateNaissanceParticipant').each(function(){$(this).datepicker({dateFormat:'dd/mm/yy',changeMonth:true,showOtherMonths:true,selectOtherMonths:true,changeYear:true,maxDate:0,yearRange:'-100:+0'});});})(jQuery);}
function initChangeJourRef(){(function($){if($('#select_resaJourReference')){$("#select_resaJourReference").change(function(){var dateDeb=$("#inpt_resaDateDeb").val();var dateFin=$("#inpt_resaDateFin").val();var tabData={type:"verifDates",dateDeb:dateDeb,dateFin:dateFin};if($('#select_resaJourReference')&&$('#select_resaJourReference').val()!=null){tabData.jour_ref=$('#select_resaJourReference').val();}
if(gestprod){tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateFin}}
ajaxVerifDates(tabData);});}})(jQuery);}
function initChangeHeureDebFin(){(function($){if($('#select_heureArrivee').length==0){return;}
$('#select_heureDepart').unbind('change');$('#select_heureArrivee').unbind('change');$('#select_heureDepart').bind('change',function(){var dateDeb=$("#inpt_resaDateDeb").val();var dateFin=$("#inpt_resaDateFin").val();var tabData={type:"verifDates",dateDeb:dateDeb,dateFin:dateFin};if($('#select_resaJourReference')&&$('#select_resaJourReference').val()!=null){tabData.jour_ref=$('#select_resaJourReference').val();}
tabData.heureDeb=$('#select_heureArrivee').val()||null;tabData.heureFin=$('#select_heureDepart').val()||null;if(gestprod){tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateFin}}
ajaxVerifDates(tabData);});$('#select_heureArrivee').bind('change',function(){var dateDeb=$("#inpt_resaDateDeb").val();var dateFin=$("#inpt_resaDateFin").val();var tabData={type:"verifDates",dateDeb:dateDeb,dateFin:dateFin};if($('#select_resaJourReference')&&$('#select_resaJourReference').val()!=null){tabData.jour_ref=$('#select_resaJourReference').val();}
tabData.heureDeb=$('#select_heureArrivee').val()||null;tabData.heureFin=$('#select_heureDepart').val()||null;if(gestprod){tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateFin}}
ajaxVerifDates(tabData);});})(jQuery);}
function setDateDeb(dateDeb){(function($){objDateDeb=new Date();objDateDeb.setFullYear(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));objDateDeb.setHours(0);objDateDeb.setMinutes(0);objDateDeb.setSeconds(0);if(infoBulles){var objDateDebPlanning=new Date(dateDebPlanning.substr(6,4),dateDebPlanning.substr(3,2)-1,dateDebPlanning.substr(0,2));var ecart=Math.round(ecartDate(objDateDeb,objDateDebPlanning));var infoBulle=infoBulles[ecart];}
$("#inpt_resaDateDeb").val(dateDeb);if(estResaBureauGestloc()||estResaBureauProp()){$('#select_heureArrivee').prop('disabled',false);}
if($("#div_choixDateFin").length>0){if($("#div_choixDateFin").length>0){if($("#inpt_resaDateFin").val()!="Dpart"){var dateFin=$("#inpt_resaDateFin").val();objDateFin=new Date();objDateFin.setFullYear(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));objDateFin.setHours(0);objDateFin.setMinutes(0);objDateFin.setSeconds(0);}}
if(objDateFin&&objDateDeb>objDateFin){$("#inpt_resaDateFin").val("Dpart");}
$("#div_calendrierDeb").hide().removeClass("open");$("#div_roueDatepickerFin").show();var tabData={type:"getPlanningFin",dateDeb:dateDeb,infoBulle:infoBulle};if(gestprod){tabData={type:"getPlanningFin_GP",dateDeb:dateDeb};}
if(modeCalculPrixSurFiche){tabData.estpresentsurfiche=true;}
$.ajax({type:"POST",url:urlAJAX,async:false,data:tabData,beforeSend:function(){$("#div_calendrierFin").show().addClass("open");},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else if(tabResult.pack){$('#inpt_resaDateFin').val(tabResult.dateFin);setDateFin(tabResult.dateFin);}else{dateDebPlanning=tabResult.dateDeb;chainePlanning=tabResult.chaineDispo;infoBulles=tabResult.infoBulle;initDatePickerFin();if(estResaVoitureNouveauScript()){$("#div_datepickerFin").datepicker("option","minDate",new Date(objDateDeb.getFullYear(),objDateDeb.getMonth(),objDateDeb.getDate()));}
else{$("#div_datepickerFin").datepicker("option","minDate",new Date(objDateDeb.getFullYear(),objDateDeb.getMonth(),objDateDeb.getDate()+1));}
$("#div_datepickerFin").datepicker("option","maxDate",tabResult.dateFin);$("#div_datepickerFin").datepicker("setDate",new Date(objDateDeb.getFullYear(),objDateDeb.getMonth(),objDateDeb.getDate()+1));$("#div_datepickerDeb").datepicker("destroy");}
$("#div_roueDatepickerFin").hide();}});}
else if($("#div_choixNbNuits").length>0){initListeNbNuits(infoBulle);$("#div_choixNbNuits").show();}
else if($('#div_uneEtape_billetChoixPresta').length>0){objDateFin=new Date();var timestampDeb=Date.UTC(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));var timestampFin=timestampDeb+(24*60*60*1000);objDateFin.setTime(timestampFin);$("#div_calendrierDeb").hide().removeClass("open");tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateDeb};ajaxVerifDates(tabData);}})(jQuery);}
function setDateFin(dateFin){(function($){var dateDeb=$("#inpt_resaDateDeb").val();objDateDeb.setFullYear(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));if(objDateFin==undefined){objDateFin=new Date();objDateFin.setHours(0);objDateFin.setMinutes(0);objDateFin.setSeconds(0);}
objDateFin.setFullYear(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));if(rafraichirSurUrlActuelleApresSelectDateFin){var tabArgs=getVarsFromUrl()||[];var search='';for(var prop in tabArgs){if(prop&&prop!='deb'&&prop!='nbj'&&prop!='exe'){search+=prop+'='+tabArgs[prop]+'&';}}
location.search=search+'&deb='+dateDeb+'&nbj='+ecartDate(objDateFin,objDateDeb);return;}
$("#div_confirmDispos span:first-child").hide();$("#div_confirmDispos span:last-child").hide();$("#inpt_resaDateFin").val(dateFin);if(estResaBureauGestloc()||estResaBureauProp()){$('#select_heureDepart').prop('disabled',false);}
$("#div_calendrierFin").hide().removeClass("open");var tabData={type:"verifDates",dateDeb:dateDeb,dateFin:dateFin};if($('#select_resaJourReference')&&$('#select_resaJourReference').val()!=null){tabData.jour_ref=$('#select_resaJourReference').val();}
if(gestprod){tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateFin}}
ajaxVerifDates(tabData);})(jQuery);}
function ajaxVerifDates(tabData,callbackOK){(function($){if(modeCalculPrixSurFiche){tabData.avecDeuxLibelles=$("#a_btnReserver_packDivDatesTarifs").attr("data-avecDeuxLibelles");if($('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').length>0){var tabAttributs=$('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').attr('data-attributsDiv');var listeAttr=eval('('+tabAttributs+')');tabData.listeAttrDivChambres=listeAttr;}
tabData.instance=$('#div_choixDates_packDivDatesTarifs').attr('data-instance');tabData.ident=$('#div_choixDates_packDivDatesTarifs').attr('data-ident');tabData.exercice=$('#div_choixDates_packDivDatesTarifs').attr('data-exercice');tabData.estpresentsurfiche=true;tabData.nbAdultes=$('#widgetFNGF_selectCapacite option:selected').val();tabData.phpsessid=$('#bodyPage').attr('data-iditea');tabData.forcereload=$('#div_choixDates_packDivDatesTarifs').attr('data-forcereload');if($('#widgetFNGF_selectChambre').length>0){tabData['numChambre']=$('#widgetFNGF_selectChambre option:selected').val();tabData['annulChoix']=true;tabData['removeChambres']='O';}}
$.ajax({type:"POST",url:urlAJAX,data:tabData,beforeSend:function(){$("#div_uneEtape_date").find(".inpt_validEtape").val("Non");affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);if($('.div_uneEtape_prodGP').length>0){var idDivProd=$('.div_uneEtape_prodGP').attr('id');affMsgAttenteParDessusInDiv(idDivProd,"recapPrix",txtVerifDispos);}
if(modeCalculPrixSurFiche){$('.tarifFicheApartirDe').html('<img src="../../config_v3/imgs_defaut/loading/ajax-loader.gif" />').show();}
afficheLoaderGlobal_site();},success:function(result){var tabRetour=XMLToArray(result);afficheInfosVerifDateITEA(tabRetour);if(tabRetour.code==errDossierNull){retourEtape1(tabRetour.msg);}
else if(tabRetour.errTechnq){gereDivAlertResaJoursIdentiques(tabRetour.htmlAlertResasJoursIdentiques);gereDivModifHoraires(tabRetour.htmlModifHoraires);var avecFormContact=false;if(tabRetour.avecFormContact){avecFormContact=true;}
var msg=tabRetour.msg;afficheMsgErrTechnq(msg,tabRetour.titre,tabRetour.ident,avecFormContact,tabRetour.destinataire);if(modeCalculPrixSurFiche){$('.tarifFicheApartirDe').hide();reinitDatepickers_packDivTarifs();}}
else{if(tabRetour.code=="OK"){console.log('tabRetourOK ');if(tabRetour.chambresDispo){$('#widgetFNGF_selectChambre option').attr('disabled',true);for(var i=0;i<tabRetour.chambresDispo.length;i++){$('#widgetFNGF_selectChambre option[value="'+tabRetour.chambresDispo[i]+'"]').removeAttr('disabled');}
if($('#widgetFNGF_selectChambre option:selected').is(':disabled')){$('#widgetFNGF_selectChambre option[value="default"]').prop('selected',true);$('.widgetFNGF_divSelectCapacite').hide();}}
if($('#widgetFNGF_selectChambre').length>0||$('#widgetFNGF_selectCapacite').length>0){var dateDeb=$('#inpt_resaDateDebCal').val();var dateFin=$('#inpt_resaDateFinCal').val();var objDateDebWidget=new OBJDate(dateDeb);var objDateFinWidget=new OBJDate(dateFin);if(typeof objDateDebWidget==='object'&&objDateDebWidget!==null&&typeof objDateFinWidget==='object'&&objDateFinWidget!==null&&$('#a_btnReserver_packDivDatesTarifs').attr('data-lienresa')){var datesSejour='jour='+objDateDebWidget.getJour()+'&mois='+objDateDebWidget.getMois()+'&annee='+objDateDebWidget.getAnnee()+'&duree='+objDateDebWidget.getNbJourEcartWithOBJDate(objDateFinWidget,'O');var newLienResa=$('#a_btnReserver_packDivDatesTarifs').attr('data-lienresa');if(newLienResa.match(/deb=[0-9]{2}\/[0-9]{2}\/[0-9]{4}&fin=[0-9]{2}\/[0-9]{2}\/[0-9]{4}/g)){newLienResa=newLienResa.replace(/deb=[0-9]{2}\/[0-9]{2}\/[0-9]{4}&fin=[0-9]{2}\/[0-9]{2}\/[0-9]{4}/g,datesSejour);}else if(newLienResa.match(/jour=[0-9]{1,2}&mois=[0-9]{1,2}&annee=[0-9]{4}&duree=[0-9]{1,3}/g)){newLienResa=newLienResa.replace(/jour=[0-9]{1,2}&mois=[0-9]{1,2}&annee=[0-9]{4}&duree=[0-9]{1,3}/g,datesSejour);}else{newLienResa+='&'+datesSejour;}
if($('#widgetFNGF_selectChambre').length==0&&$('#widgetFNGF_selectCapacite').length>0){newLienResa+='&adultes='+$('#widgetFNGF_selectCapacite option:selected').val();}
$('#a_btnReserver_packDivDatesTarifs').attr('data-lienresa',newLienResa);}}
console.log('modeCalculPrixSurFiche',modeCalculPrixSurFiche);if(modeCalculPrixSurFiche){if(tabRetour.exeMajFiche){var tabInfosActualisation={deb:tabRetour.dateDebMajFiche,nbj:tabRetour.nbjMajFiche,exe:tabRetour.exeMajFiche};if(actualisePageFiche(tabInfosActualisation)!==false){return;}}
majDivTarifAPartirDe(tabRetour);if(tabRetour.htmlDivChambres||tabRetour.htmlDatesSejoursAlternatifs){majDivChambres_packDivDatesTarifs(tabRetour);}else{majTarifsSelectionne(tabData.dateDeb,tabData.dateFin);}
if(typeof callbackOK==='function'){callbackOK();}
return;}
if(tabRetour.modeResa!=undefined){manageChangementTypeResa(tabRetour);return;}
if(typeof(dataLayer)!='undefined'){if(tabRetour.date_non_disponible==1){ajouteOuRemplaceDansDataLayer({'event':'availability','availability':false});}else{ajouteOuRemplaceDansDataLayer({'event':'availability','availability':true});}}
if(tabRetour.maj){rechargementPageMAJ(tabRetour);return;}
if($('#div_uneEtape_compoFamilleGite').length===0&&$('#div_uneEtape_compoFamilleChambre').length===0&&tabRetour.html_choixCompoFamille){$('#div_uneEtape_date').after(tabRetour.html_choixCompoFamille);if($("#div_uneEtape_compoFamilleGite").length>0){setEventsForGite();}else{setEventsForChambre();}}
gereDivAlertResaJoursIdentiques(tabRetour.htmlAlertResasJoursIdentiques);if($('#div_choixJourReference').length>0){$('#div_choixJourReference').show();}
$(".div_uneChambre").each(function(){if($(this).find(".inpt_chambre").attr("checked")==undefined)
$(this).find(".select_optionChambre").attr("disabled",true);});$("tfoot").find("input").attr("disabled",true);$("#div_uneEtape_date").next(".div_uneEtape").removeClass('div_uneEtapeGrisee');$("#div_uneEtape_date").next(".div_uneEtape").find('*').attr("disabled",false);if($('#div_uneEtape_selectionOrigine').length>0){$("#div_uneEtape_selectionOrigine").next(".div_uneEtape").removeClass('div_uneEtapeGrisee');$("#div_uneEtape_selectionOrigine").next(".div_uneEtape").find('*').attr("disabled",false);}
if($('#input_testDatepickerResa').length>0){var dateDeb=$("#inpt_resaDateDeb").val();objDateDeb=new Date();objDateDeb.setFullYear(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));var dateFin=$("#inpt_resaDateFin").val();objDateFin=new Date();objDateFin.setFullYear(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));}
objDateDeb.setHours(0,0,0);objDateFin.setHours(0,0,0);nbJours=ecartDate(objDateFin,objDateDeb);$("#sp_confirmDispos_nbNuits").html(nbJours);$('#div_confirmDispos span.confirmSaisie.ko').html('').hide();$("#div_recapInfos").html(tabRetour.recapInfos);if($("#p_recapDatesSelectionnees").length>0&&tabRetour.recapDatesTxt){$("#p_recapDatesSelectionnees").html(tabRetour.recapDatesTxt);$("#div_choixDates").hide();$("#div_recapDateSelectionnees").show();}
$(".sp_nbNuits").html(tabRetour.nbNuits);gereDivModifHoraires(tabRetour.htmlModifHoraires);gereDivAlertHorairesBloquants(tabRetour.htmlAlertHorairesBloquants);if(tabRetour.htmlModifJourReference){$('.div_choixJourReference').replaceWith(tabRetour.htmlModifJourReference);initChangeJourRef();initChangeHeureDebFin();}
if(tabRetour.msgInfoModeResa){$('.infosModeResa').html(tabRetour.msgInfoModeResa);$('.infosModeResa').show();}
else{$('.infosModeResa').html('');$('.infosModeResa').hide();}
if($("#div_uneEtape_compoFamilleGite").length>0){afficheEffaceRecapPrix(tabRetour);majListesDureeOption();}
else if($("#div_uneEtape_compoFamilleChambre").length>0){if(!tabRetour.dateNonModifiee){$(".div_uneChambre").each(function(){$(this).hide();for(var i=0;i<tabRetour.chambresDispo.length;i++){if($(this).attr("num")==tabRetour.chambresDispo[i]){$(this).show();if(tabRetour.planVenteChambres){$('#select_compoFamilleAdulte_'+tabRetour.chambresDispo[i]).attr('data-planVente',tabRetour.planVenteChambres[tabRetour.chambresDispo[i]]);}}}});}
if($(".div_uneChambre:visible").find(".inpt_chambre:checked").length==0){$("#div_recapPrix").hide();if($(".div_uneChambre:not(visible)").find(".inpt_chambre:checked").length>0){$(".div_uneChambre:not(visible)").find(".inpt_chambre:checked").each(function(){$(this).attr("checked",false);var num=$(this).parents(".div_uneChambre").attr("num");$("#tr_prixChambre_"+num).hide();});}}
else{metAJourRecapPrixForChambre();}
if(tabRetour.htmlOptionsChambres){tabRetour.htmlOptionsChambres.each(function(elem){var idElement=elem.idElement;var html=elem.html;var nbAdultes=elem.nbAdultes;var div_uneChambreTarifsOption=$('#'+idElement).find('.div_uneChambreTarifsOption');div_uneChambreTarifsOption.html(html);if(nbAdultes===''||nbAdultes==='0'){div_uneChambreTarifsOption.toggleClass('div_uneChambreTarifsOptionGrisee',true);div_uneChambreTarifsOption.find('*').attr('disabled',true);}});}
majListesDureeOption(true);}else if($('.div_uneEtape_prodGP').length>0){$('.div_uneEtapeMsgErreur').remove();if($('.div_conteneurApresChoixPresta').length>0){$('.div_conteneurApresChoixPresta').show();}
var idDivProd=$('.div_uneEtape_prodGP').attr('id');$(".div_uneEtape_prodGP").replaceWith(tabRetour.HTML_choixChambre);$(".div_uneEtape_prodGP").removeClass('div_uneEtapeGrisee');if(tabRetour.HTML_choixChambre.length==0){$('.div_uneEtapeMsgErreur.div_aucuneDispo').show();}
if(tabRetour.recapInfos.length>0){$("#div_recapInfosEtPrix").show();}
if(!afficheRecapPrix){$("#div_recapPrix").hide();}
majNumEtapes();if(idDivProd=='div_uneEtape_packageChoixTarif'){chargeAlternatives();}
initDescTarifQTip();reinitSelectionLignesFactures();if($('.inputHeureVoiture').length>0){$('#div_selectionVoiture .inputHeureVoiture').each(function(){var heuresAutorisees=$(this).data('heures_autorisees');$(this).datetimepicker({datepicker:false,format:'H:i',step:30,validateOnBlur:false,allowTimes:heuresAutorisees});});}
if($('.div_uneEtapeMsgErreur').length==0){$('#div_boutonsResa').show();}}
$("#sp_recapDateDeb").html(tabData.dateDeb);$("#sp_recapDateFin").html(tabData.dateFin);$("#sp_recapDatesDuree").html(nbJours);if(nbJours>1){$("#sp_recapDateLblNuits").css("display","inline");$("#sp_recapDateLblNuit").css("display","none");}
else{$("#sp_recapDateLblNuits").css("display","none");$("#sp_recapDateLblNuit").css("display","inline");}
var elemToREmove=$("#div_uneEtape_date .div_uneEtapeRecap").find('.classForcageParametresPV');$(elemToREmove).remove();if(typeof(tabRetour.explicationsForcagePV)!='undefined'){$("#div_uneEtape_date .div_uneEtapeRecap").append(tabRetour.explicationsForcagePV);}
etapeCourante($("#div_uneEtape_date"),true);var modeDevis=tabRetour.modeDevis||false;if(modeDevis){$('.div_uneEtapeRecap','#div_uneEtape_date').hide();}
$("#div_msgDatesNull").hide();$("#div_recapInfos").show();$("#div_uneEtape_date").find(".inpt_validEtape").val("Oui");initCanevasResaCouplee(tabRetour.reinitCanevas);mettreAjourListeRepas();gereInfosMultiResa();if(typeof foncQdFini_valideDateEtape1!=='undefined'){foncQdFini_valideDateEtape1();}
if(tabRetour.questionRecalculAuto){questionRecalculAuto();}
if(typeof callbackOK==='function'){callbackOK();}}
else{if(modeCalculPrixSurFiche){majDivTarifAPartirDe(tabRetour);if(tabRetour.htmlDivChambres){majDivChambres_packDivDatesTarifs(tabRetour);}else{majTarifsSelectionne(tabData.dateDeb,tabData.dateFin);}
return;}
gereDivModifHoraires(tabRetour.htmlModifHoraires);gereDivAlertResaJoursIdentiques(tabRetour.htmlAlertResasJoursIdentiques);gereDivAlertHorairesBloquants(tabRetour.htmlAlertHorairesBloquants);if(tabRetour.errLD!=undefined||(tabRetour.dispo&&tabRetour.dispo==='OCC')){effaceMsgAttenteParDessus("recapPrix");$('#div_recapPrix').hide();$("#inpt_resaDateFin").val("Dpart");$("#inpt_resaDateDeb").val("Arrive");alertAJquery(tabRetour.msg);return;}
if(tabRetour.avecFormContact){sendThisToProp(tabRetour.ident,800,600,tabRetour.titre,"O");}
if(tabRetour.datesProches&&typeof(dataLayer)!='undefined'){dataLayer.push({'event':'resa_datesProches'});}
if(typeof(dataLayer)!='undefined'){ajouteOuRemplaceDansDataLayer({'event':'availability','availability':false});}
invalideSaisieDates(tabRetour.msg);}}
initFancyBoxDeBase();effaceMsgAttenteParDessus("recapPrix");},complete:function(){effaceLoaderGlobal_site();}});})(jQuery)}
function initPrix(){(function($){if(location.search.indexOf("PHPSESSID")>-1){afficheRecapPrix=true;}
var dateDeb=$("#inpt_resaDateDeb").val();var dateFin;objDateDeb=new Date();objDateDeb.setFullYear(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));if($("#div_choixDateFin").length>0){dateFin=$("#inpt_resaDateFin").val();objDateFin=new Date();objDateFin.setFullYear(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));}
else if($("#div_choixNbNuits").length>0){initListeNbNuits();var duree=$("#inpt_nbNuits").val();duree=parseInt(duree);objDateFin=new Date();objDateFin.setFullYear(objDateDeb.getFullYear(),objDateDeb.getMonth(),objDateDeb.getDate()+duree);var jour,mois,annee;if(objDateFin.getDate().toString().length==1)
jour="0"+objDateFin.getDate();else
jour=objDateFin.getDate();if(objDateFin.getMonth().toString().length==1)
mois="0"+(objDateFin.getMonth()+1);else
mois=objDateFin.getMonth()+1;annee=objDateFin.getFullYear();dateFin=jour+"/"+mois+"/"+annee;}
$("#inpt_resaDateDeb").click();if($("#div_uneEtape_date").find(".inpt_validEtape").val()=="Oui"){$("#sp_fermerCalDateDeb").click();if($('#input_testDatepickerResa').length>0){setInputDateDebResa(dateDeb);initDatepickersDateNaissance();if($('#div_uneEtape_billetChoixPresta').length==0&&$('#div_uneEtape_packageChoixTarif').length==0){setInputDateFinResa(dateFin);}else{$("#sp_fermerCalDateFin").click();}}else{setDateDeb(dateDeb);if($('#div_uneEtape_billetChoixPresta').length==0&&$('#div_uneEtape_packageChoixTarif').length==0){setDateFin(dateFin);}}}})(jQuery);}
function initListeNbNuits(infoBulle){(function($){var dateDeb=$("#inpt_resaDateDeb").val();var duree=$("#inpt_nbNuits").val();$.ajax({type:"POST",url:urlAJAX,data:{type:"getListeNbNuits",dateDeb:dateDeb,duree:duree,infoBulle:infoBulle},beforeSend:function(){$("#img_roueDatePicker").show();},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){$("#select_nbNuits").html(tabResult.listeNbNuits);}}
$("#img_roueDatePicker").hide();}});})(jQuery);}
function ecartDate(date1,date2){var unJour=24*60*60*1000;return Math.round((date1.getTime()-date2.getTime())/(unJour));}
function setJourDebut(date){return setJour(date,true);}
function setJour(date,datepickerDeb){var ObjDateDeb=new Date(dateDebPlanning.substr(6,4),dateDebPlanning.substr(3,2)-1,dateDebPlanning.substr(0,2));var ecart=Math.round(ecartDate(date,ObjDateDeb));var caractere=chainePlanning.charAt(ecart);var infoBulle;if(infoBulles)
infoBulle=infoBulles[ecart];else
infoBulle="";var sejour='';if(typeof(objDateDeb)!='undefined'&&typeof(objDateFin)!='undefined'&&objDateFin){var ecartDateDeb=Math.round(ecartDate(objDateDeb,ObjDateDeb));var ecartDateFin=Math.round(ecartDate(objDateFin,ObjDateDeb));if(ecartDateDeb<=ecart&&ecartDateFin>=ecart){sejour='sejour';if(ecart==ecartDateDeb){sejour+=' dateArrivee';}
if(ecart==ecartDateFin){sejour+=' dateFin';}}}
var classe=sejour+' ';var caracterePrecedent=chainePlanning.charAt(ecart-1);var caractereSuivant=chainePlanning.charAt(ecart+1);var tabCaracteresNonCliquables=['i','o','r','n'];if(caractere.length>0&&caracterePrecedent.length>0){if(datepickerDeb===true){if(jQuery.inArray(caractere,tabCaracteresNonCliquables)>-1&&jQuery.inArray(caracterePrecedent,tabCaracteresNonCliquables)===-1){classe+='debutResa ';}
if(jQuery.inArray(caractere,tabCaracteresNonCliquables)===-1&&jQuery.inArray(caracterePrecedent,tabCaracteresNonCliquables)>-1){classe+='finResa ';}}else{if(jQuery.inArray(caractere,tabCaracteresNonCliquables)===-1&&jQuery.inArray(caractereSuivant,tabCaracteresNonCliquables)>-1){classe+='debutResa ';}}}
if(caractere==="."||caractere==="A"){classe+='cliquable';return[true,classe,infoBulle];}
else if(caractere=="o"||caractere=="O"){classe+='option';return[false,classe];}
else if(caractere=="r"||caractere=="R"){classe+='resa';return[false,classe];}
else if(caractere==="l"||caractere==="L"){classe+='libre';if(gestprod){return[false,classe];}else{return[true,classe];}}
else if(caractere=="n"){classe+='occupe';return[false,classe];}
else if(caractere=="b"){classe+='avantDatesPossibles';return[false,classe];}
else if(caractere=="j"){classe+='dateArrivee';return[false,classe];}
else if(caractere=="i"){classe+='intention';return[false,classe];}
else if(caractere=="d"){classe+='devis';return[true,classe];}
else if(caractere=="f"){classe+='forcage';return[true,classe];}
else if(!caractere&&ecart>=chainePlanning.length){classe+='occupe';return[false,classe];}else if(caractere=="?"||caractere=="a"){classe+='inconnu';if(gestprod){return[false,classe];}else{return[true,classe];}}
else if(ecart>=0){return[false,"inconnu"];}else{return[false,"avantDatesPossibles"];}}
function metAJourListeFamille(numChambre){(function($){$("#div_compoFamille_msgReinitEnfant").hide();var suffixe="";if(numChambre){suffixe="_"+numChambre;}
var idSelectEnfants="#select_compoFamilleEnfant"+suffixe;var idSelectAdultes="#select_compoFamilleAdulte"+suffixe;var idSelectBebes="#select_compoFamilleBebe"+suffixe;var capacite=parseInt($(idSelectAdultes).attr('data-capacite'));if($(idSelectAdultes).attr('data-surcapacite')==='true'){capacite*=2;}
var capaciteReel;try{capaciteReel=parseInt($("#select_compoFamilleAdulte"+suffixe).attr('data-capacite'));}catch(e){capaciteReel=capacite;}
var nbAdultes=parseInt($(idSelectAdultes).val());var nbEnfants=parseInt($(idSelectEnfants).val())||0;var nbBebes=parseInt($(idSelectBebes).val())||0;if(bebeDansCapacite()){console.log('metAJourListeFamille ya bebeDansCapacite suffixe : ',suffixe);var nbBebesMax=$('#inpt_nbBebesMax'+suffixe).val();console.log('nbBebesMax input ',nbBebesMax);if(nbBebesMax>(capacite-nbAdultes-nbEnfants)){nbBebesMax=capacite-nbAdultes-nbEnfants;}
if(nbBebesMax<=-1){nbBebesMax=0;}
console.log('nbBebesMax ',nbBebesMax);if($(idSelectAdultes).attr('data-surcapacite')==='true'){supprimeSurcapacite(idSelectBebes);metAJourListeEnfants(idSelectBebes,nbBebesMax);ajouteSurcapacite(idSelectBebes,(nbAdultes+nbEnfants),capaciteReel);supprimeSurcapacite(idSelectAdultes);var nbMaxAdulte=$(idSelectAdultes).attr('data-max-adulte');if(isNullOrUndefinedOrEmpty(nbMaxAdulte)||nbMaxAdulte===null||nbMaxAdulte===0||nbMaxAdulte===''){nbMaxAdulte=capacite;}
ajouteSurcapacite(idSelectAdultes,(nbEnfants+nbBebes),nbMaxAdulte);}else{metAJourListeEnfants(idSelectBebes,nbBebesMax);}
if(nbBebesMax===0){$(idSelectBebes).attr('disabled',true);}else{$("#div_infoCompoBebes"+suffixe).show();$(idSelectBebes).attr('disabled',false);}
if(nbBebes>nbBebesMax){$("#div_compoFamille_msgReinitBebe").show("pulsate",{times:3},"slow");$("#div_compoFamilleDateNaissanceBebes"+suffixe).hide();}}
nbBebes=parseInt($(idSelectBebes).val())||0;var nbEnfantsMax=$('#inpt_nbEnfantsMax'+suffixe).val();if(nbEnfantsMax>(capacite-nbAdultes)){nbEnfantsMax=capacite-nbAdultes;}
if(bebeDansCapacite()){nbEnfantsMax-=nbBebes;}
if(nbEnfantsMax<=-1){nbEnfantsMax=0;}
if($(idSelectAdultes).attr('data-surcapacite')==='true'){supprimeSurcapacite(idSelectEnfants);metAJourListeEnfants(idSelectEnfants,nbEnfantsMax);if(bebeDansCapacite()){ajouteSurcapacite(idSelectEnfants,(nbAdultes+nbBebes),capaciteReel);}else{ajouteSurcapacite(idSelectEnfants,nbAdultes,capaciteReel);}
supprimeSurcapacite(idSelectAdultes);var nbMaxAdulte=$(idSelectAdultes).attr('data-max-adulte');if(isNullOrUndefinedOrEmpty(nbMaxAdulte)||nbMaxAdulte===null||nbMaxAdulte===0||nbMaxAdulte===''){nbMaxAdulte=capaciteReel;}
if(bebeDansCapacite()){ajouteSurcapacite(idSelectAdultes,(nbEnfants+nbBebes),nbMaxAdulte);}else{ajouteSurcapacite(idSelectAdultes,nbEnfants,nbMaxAdulte);}}else{metAJourListeEnfants(idSelectEnfants,nbEnfantsMax);}
if(nbEnfantsMax==0){$(idSelectEnfants).attr('disabled',true);}else{$("#div_infoCompoEnfants"+suffixe).show();$(idSelectEnfants).attr('disabled',false);}
if(nbEnfants>nbEnfantsMax){$("#div_compoFamille_msgReinitEnfant").show("pulsate",{times:3},"slow");$("#div_compoFamilleDateNaissanceEnfants"+suffixe).hide();}})(jQuery);}
function bebeDansCapacite(){return jQuery('#inpt_bebeDansCapacite').length>0;}
function supprimeSurcapacite(idSelect){(function($){if($(idSelect+' optgroup.surcapacite').length===0){return;}
$(idSelect+' option.surcapacite').removeClass('surcapacite');if($(idSelect+' optgroup.surcapacite').length>0){$(idSelect+' optgroup.surcapacite option').each(function(){$(idSelect).append($(this));});$(idSelect+' optgroup.surcapacite').remove();}})(jQuery);}
function metAJourListeEnfants(idSelectEnfants,nbMaxEnfants){(function($){if(parseInt($(idSelectEnfants+" option:last-child").val())<nbMaxEnfants){var valAjout=parseInt($(idSelectEnfants+" option:last-child").val());while(parseInt($(idSelectEnfants+" option:last-child").val())<parseInt(nbMaxEnfants)){valAjout++;$(idSelectEnfants).append("<option value='"+valAjout+"'>"+valAjout+"</option>");}}
else{while(parseInt($(idSelectEnfants+" option:last-child").val())>parseInt(nbMaxEnfants)){$(idSelectEnfants+" option:last-child").remove();}}})(jQuery);}
function ajouteSurcapacite(idSelect,ajout,capaciteMax){(function($){var valOptionLastChild=parseInt($(idSelect+' option:last-child').val());if((valOptionLastChild+ajout)>capaciteMax){$(idSelect).append('<optgroup class="surcapacite" label="Surcapacit"></optgroup>');}
$(idSelect+' option').each(function(){if(parseInt($(this).val())>0&&(parseInt($(this).val())+ajout)>capaciteMax){$(this).addClass('surcapacite');$(idSelect+' optgroup.surcapacite').append($(this));}});})(jQuery);}
function videDatesNaissanceNonVisibles(){jQuery('.inpt_dateNaissance:not(:visible)').val('');}
function affecteDatesNaissanceAvecCoherence(){(function($){var tabDatesNaissance={};$('.div_uneChambreSelection, #div_uneEtape_compoFamilleGite').each(function(){var tabDates=construireTableauDatesNaissance(this);var index=$(this).data('num_idch')||'gite';tabDatesNaissance[index]=tabDates;});$.ajax({type:'POST',url:urlAJAX,async:false,data:{type:'enregistreDatesNaissance',tabDatesNaissance:tabDatesNaissance},dataType:'json',success:function(JSONResult){console.log('enregistreDatesNaissance success result : ',JSONResult);}});})(jQuery);}
function construireTableauDatesNaissance(element){var tabDatesNaissance={};(function($){var nb=parseInt($('.select_compoFamilleEnfant',element).val());var date;for(var i=1;i<=nb;i++){date=$('.inpt_dateNaissance.enfant[data-id="'+i+'"]',element).val();if(parseInt(date)>0){tabDatesNaissance['enfant_'+i]=date;}}
nb=parseInt($('.select_compoFamilleBebe',element).val());for(var i=1;i<=nb;i++){date=$('.inpt_dateNaissance.bebe[data-id="'+i+'"]',element).val();if(parseInt(date)>0){tabDatesNaissance['bebe_'+i]=date;}}})(jQuery);return tabDatesNaissance;}
function etapeCourante(elem,repli){(function($){if($("#inpt_avecRepli").length>0){if(elem.attr("id")!="div_uneEtape_compoFamilleChambre"){elem.find(".a_modifEtape").show();if(repli){elem.children(".div_uneEtapeContent").hide("slow");elem.children(".div_uneEtapeRecap").show("slow");}
if(elem.hasClass('div_uneEtapeCurr')){elem.next().addClass('div_uneEtapeCurr');elem.removeClass('div_uneEtapeCurr');if(elem.next().children(".div_uneEtapeRecap").is(":visible")){etapeCourante(elem.next(),repli);}}}}
else if(elem.attr("id")=="div_uneEtape_date"){$("#div_uneEtape_date > div.div_uneEtapeRecap").show();}
elem.find(".inpt_validEtape").val("Oui");elem.removeClass('div_uneEtapeAValider');$("#div_msgErreurs").hide();})(jQuery);}
function afficheEffaceOptions(typeOptions){(function($){switch(typeOptions){case"Animaux":$("tr.animal").each(function(){var nbAnimaux=(parseInt($("#select_compoAnimauxChat").val())+parseInt($("#select_compoAnimauxChien").val()));if(nbAnimaux>0){$(this).find(".sp_optionObligatoire").html(nbAnimaux);$(this).find(".inpt_optionObligatoire").val(nbAnimaux);$(this).parents("#div_infosOptionsAnimaux").show();}
else{if($(this).is(":not(.obligatoire)")){$(this).find(".select_optionAnimaux").val(0);$(this).find(".inpt_optionIndiv").checked=false;$(this).find(".inpt_optionIndiv").attr("checked",false);}
$(this).parents("#div_infosOptionsAnimaux").hide();}});break;case"AnimauxChambre":break;case"Adultes":if(parseInt($("#select_compoFamilleAdulte").val())>0){$("#div_infosOptionsObligatoires").show();}else{$("#div_infosOptionsObligatoires").hide();}
$("tr.indiv.obligatoire:not(.animal)").each(function(){if(parseInt($("#select_compoFamilleAdulte").val())>0){if($(this).children("td").children("span").has("input.inpt_optionEnfants").length){var nbEnfants=(parseInt($("#select_compoFamilleEnfant").val()));var nbAdultes=(parseInt($("#select_compoFamilleAdulte").val()));$(this).find("span.sp_optionEnfants").html(nbEnfants);$(this).find("input.inpt_optionEnfants").val(nbEnfants);$(this).find("span.sp_optionAdultes").html(nbAdultes);$(this).find("input.inpt_optionAdultes").val(nbAdultes);}
else{var nbPers=0;if(!isNaN(parseInt($("#select_compoFamilleAdulte").val()))){nbPers+=parseInt($("#select_compoFamilleAdulte").val());}
if(!isNaN(parseInt($("#select_compoFamilleEnfant").val()))){nbPers+=parseInt($("#select_compoFamilleEnfant").val());}
$(this).find(".sp_optionObligatoire").html(nbPers);$(this).find(".inpt_optionObligatoire").val(nbPers);}
$(this).show();$(this).parents("#div_infosOptionsObligatoires").show();}
else{$(this).hide();$(this).parents("#div_infosOptionsObligatoires").hide();}});break;}})(jQuery);}
function afficheEffaceOptionsSupplementaireObligatoires(numOption,numchambre,valFinale){(function($){$('#select_optionChambre_'+numOption+'_'+numchambre).val(valFinale);$('#select_optionChambre_'+numOption+'_'+numchambre).trigger('change');if($('#remplace_select_optionChambre_'+numOption+'_'+numchambre)){if(valFinale=='0'){valFinale='-';}
$('#remplace_select_optionChambre_'+numOption+'_'+numchambre).html(valFinale);}})(jQuery);}
function initListesDureeOption(optionsChambre){(function($){if(optionsChambre){if($('.div_uneChambreTarifsOption .select_dureeForOption').length>0){$('.div_uneChambreTarifsOption .select_dureeForOption').live('change',function(){affectOptionsChambre();});}}else{$('#div_resaContent').delegate('.select_dureeForOption','change',function(){affectOptions();});if($('#div_infosOptionsAnimauxContent .select_dureeForOption').length>0){$('#div_infosOptionsAnimauxContent .select_dureeForOption').change(function(){affectOptions();});}}})(jQuery);}
function majListesDureeOption(optionsChambre){(function($){if((estResaBureauGestloc()||estResaBureauProp())&&!modifieResaExistante()){$('#div_optionsSuppl .select_dureeForOption,#div_infosOptionsObligatoiresContent .select_dureeForOption, #div_infosOptionsAnimauxContent .select_dureeForOption').each(function(){$(this).val(nbJours);});}
$('#div_optionsSuppl .select_dureeForOption, .div_uneChambreTarifsOption .select_dureeForOption').each(function(){var nbMax=nbJours*2;$(this).find('option').each(function(){var duree=$(this).val();if(duree<=nbMax){$(this).show();}else{$(this).hide();}});});if(optionsChambre){affectOptionsChambre();}else{affectOptions();}})(jQuery);}
function metAJourRecapPrix(){(function($){if($(".option:visible:has(input:checked)").length>0){affectOptions();}
else{$.ajax({type:"POST",url:urlAJAX,data:{type:"recupPrix"},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{afficheEffaceRecapPrix(tabResult);}
effaceMsgAttenteParDessus("recapPrix");}});}})(jQuery);}
function metAJourRecapPrixForChambre(){(function($){$.ajax({type:"POST",url:urlAJAX,data:{type:"recupPrixForChambre"},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);$('#div_confirmDispos span.confirmSaisie.ko').html('').hide();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else if(tabResult.code==='KO'){$('#div_recapInfosEtPrix').hide();$('#div_confirmDispos').find('.ko').text(tabResult.msg).show();}
else{afficheEffaceRecapPrix(tabResult);}
effaceMsgAttenteParDessus("recapPrix");}});})(jQuery);}
function verifMotMagique(nepaseffacer,reload){(function($){var motMagique=$("#inpt_motMagique").val();var dateDeb=$("#inpt_resaDateDeb").val();var dateFin=$("#inpt_resaDateFin").val();$.ajax({type:"POST",url:urlAJAX,data:{type:"verifMotMagique",motMagique:motMagique,dateDeb:dateDeb,dateFin:dateFin},async:false,beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){$("#div_motMagique").find(".ok").show();$("#div_motMagique").find(".ko").hide();if(gestprod){afficheEffaceRecapPrix_Prod(tabResult);}else{afficheEffaceRecapPrix(tabResult);}}
else{$("#div_motMagique").find(".ko").show();$("#div_motMagique").find(".ok").hide();}}
effaceMsgAttenteParDessus("recapPrix");if(reload){document.location.reload();}}});if(!nepaseffacer){$("#inpt_motMagique").val("");}})(jQuery);}
function afficheEffaceRecapPrix(tabResult){(function($){var effacerPrix=tabResult.effacerPrix||false;if(effacerPrix=='1'){$('#div_recapPrix').hide();return;}
var numOpt;if(tabResult.acompteSansAssurance){tabResult.acompte=tabResult.acompteSansAssurance;$(".tr_prixAssurAnnul").hide();$(".sp_recapAvecAssurAnnul").hide();$(".sp_recapSansAssurAnnul").show();}
else{$(".tr_prixAssurAnnul").show();}
if(tabResult.motsMagiques=="Oui"){$("#div_uneEtape_motMagique").show();}
if(tabResult.promo&&tabResult.promo.length>0){$("#tr_prixPromotion").show();}else{$("#tr_prixPromotion").hide();}
if(tabResult.htmlInfoBullePromo&&tabResult.htmlInfoBullePromo.length>0){$('#sp_infoBulleAidePromos').html(tabResult.htmlInfoBullePromo);setEventForQtip();$('.i_helperInfoBulle[data-qhelp="sp_infoBulleAidePromos"]').show();}else{$('#sp_infoBulleAidePromos').html('');$('.i_helperInfoBulle[data-qhelp="sp_infoBulleAidePromos"]').hide();}
if(tabResult.tauxRemise&&tabResult.tauxRemise.length>0)
$("#tr_prixRemise").show();else
$("#tr_prixRemise").hide();if(tabResult.options&&tabResult.options.length>0){$("#tr_prixOptions").show();}
$("td.td_prixTotal").html(tabResult.total);if(tabResult.prixModifie&&$('#input_prixModifieBureau')){$('#input_prixModifieBureau').val(tabResult.prixModifie);}
if($('td.td_solde').length>0&&tabResult.solde){$('td.td_solde').html(tabResult.solde);}
if(tabResult.location){$("#td_prixLocation").html(tabResult.location);$("#td_prixLocationFraisDossierInclus").html(tabResult.locationFraisDossierInclus);}else{$(".td_prixChambre").parent().hide();var prixChambres=tabResult.prixChambres;if(prixChambres){for(var i=0;i<prixChambres.length;i++){var num=prixChambres[i].numChambre;var prixAdu=prixChambres[i].prixAdu;$(".td_prixChambre[numchambre="+num+"]").html(prixAdu);$(".td_prixChambre[numchambre="+num+"]").parent().show();}}}
$(".tr_prixOptionsChambre").hide();$(".tr_prixOptionChambre").hide();$(".tr_prixOptionsChambre").removeClass('show');var prixOptions=tabResult.prixOptions;if(prixOptions){for(var i=0;i<prixOptions.length;i++){numChambre=prixOptions[i].numChambre;numOption=prixOptions[i].numOption;prixAdu=prixOptions[i].prixAdu;prixEnf=prixOptions[i].prixEnf;dureeSelect=prixOptions[i].dureeSelect;if(prixEnf&&prixEnf!='0 &euro;'){if(prixAdu!='0 &euro;'){prixAdu=prixAdu+"<br/>"+prixEnf;}else{prixAdu=prixEnf;}}
if(prixAdu=='0 &euro;'){$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").html('');$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parent().hide();if(!$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parents(".tr_prixOptionsChambre").hasClass('show')){$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parents(".tr_prixOptionsChambre").hide();$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parents(".tr_prixOptionsChambre").addClass('hide');}}else{$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").html(prixAdu);$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parent().show();$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parents(".tr_prixOptionsChambre").show();$(".td_prixOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"]").parents(".tr_prixOptionsChambre").addClass('show');}
if(parseInt(dureeSelect)>0){$(".td_nomOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"] .sp_lblDureeOptionChambre").show();$(".td_nomOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"] .sp_dureeOptionChambre").text(dureeSelect);}else{$(".td_nomOptionChambre[numchambre="+numChambre+"][numoption="+numOption+"] .sp_lblDureeOptionChambre").hide();}}}
$("#tr_prixOptions").hide();$(".tr_recap_option").hide();if(tabResult.tabTarifs){$("#tr_prixOptions").show();var tabTarifs=tabResult.tabTarifs;for(i=0;i<tabTarifs.length;i++){numOpt=tabTarifs[i].noTarif;prixAdu=tabTarifs[i].prix;$("#td_recap_prixOption_"+numOpt).html(prixAdu);$("#tr_recap_option_"+numOpt).show();}}
$(".td_prixAcompte").html(tabResult.acompte);if(tabResult.taux_commission){$('.td_detailPrix.td_tauxCommission').html(tabResult.taux_commission);}
if(tabResult.assurance){$(".td_prixAssurAnnul").html(tabResult.assurance);if(!tabResult.acompteSansAssurance){$(".tr_prixAssurAnnul").show();}}else{$(".tr_prixAssurAnnul").hide();}
if($('#tr_prixRetrocession').length>0&&tabResult.montantRetro){$('#td_prixRetrocession').html(tabResult.montantRetro);}
$("#sp_code_formule_assurance").html(tabResult.code_formule_assurance);if(tabResult.fraisDossier){$("#td_prixFraisDossier").html(tabResult.fraisDossier);$("#tr_prixFraisDossier:not('.masqueFraisDossier')").show();}else{$("#tr_prixFraisDossier").hide();}
if(tabResult.charges){$("#td_montantCharges").html(tabResult.charges);$("#tr_montantCharges").show();}else{$("#tr_montantCharges").hide();}
$("#td_prixPromotion").html(tabResult.promo);$("#td_prixRemise").html(tabResult.tauxRemise);$('#td_dateEcheance .sp_dateEcheance').html(tabResult.dateLimite);if(tabResult.dateLimite){$('#tr_dateEcheance').show();}else{$('#tr_dateEcheance').hide();}
if($('#div_uneEtape_compoFamilleChambre').length===0||$('.div_uneChambre:visible').find('.inpt_chambre:checked').length>0){$("#table_recapPrix").show();$("#div_recapPrix").show();}
if(tabResult.total==tabResult.acompte)
$(".tr_prixAcompte").hide();else
$(".tr_prixAcompte").show();var montantAssurance=tabResult.assurance;$("#sp_montantAssur").html(montantAssurance);majAssurance(tabResult);if($('#div_uneEtape_fraisDossier').is(':hidden')){$('#div_uneEtape_fraisDossier').show();}
$("#div_recapInfosEtPrix").show();i=0;$("#table_recapPrix tr:visible").each(function(){if(i%2==0){$(this).addClass('pair');$(this).removeClass('impair');}
else{$(this).addClass('impair');$(this).removeClass('pair');}
i++;});if($('#div_uneEtape_optionsSuppl .option.weRelax').length>0){$('#div_uneEtape_optionsSuppl .option.weRelax').remove();}
if($('#tr_recap_option_weRelax').length>0){$('#tr_recap_option_weRelax').remove();}
if(tabResult.htmlOptionWeRelax){if($('#div_uneEtape_optionsSuppl').length>0){$('#div_uneEtape_optionsSuppl table tbody').append(tabResult.htmlOptionWeRelax);}
else{$('#div_uneEtape_compoFamilleGite').after(tabResult.htmlOptionWeRelaxAvecDivSuppl);}
$('.select_optionWeRelax').change(function(){affectOptions();});if(tabResult.htmlRecapOptionWeRelax){$('#tr_prixLocation').after(tabResult.htmlRecapOptionWeRelax);}}
if(tabResult.prixTotalDiffImportante){$('#div_msgPrixTotalDiffImportante').show();}else{$('#div_msgPrixTotalDiffImportante').hide();}
if(tabResult.montant_taxe_sejour){$("#td_montantTaxeSejour").html(tabResult.montant_taxe_sejour);$('#tr_montantTaxeSejour').show();}else{$('#tr_montantTaxeSejour').hide();}
if(tabResult.solde&&$('#td_solde').length>0){$("#td_solde").html(tabResult.solde);$('#td_solde').show();}})(jQuery);}
function affectChambre(numChambre,annulChoix){(function($){var params={type:"affectChambre",numChambre:numChambre,annulChoix:annulChoix}
if(numChambre){params.nbAdultes=$("#select_compoFamilleAdulte_"+numChambre).val();params.nbEnfants=$("#select_compoFamilleEnfant_"+numChambre).val();params.nbBebes=$("#select_compoFamilleBebe_"+numChambre).val();}
$.ajax({type:"POST",url:urlAJAX,async:false,data:params,beforeSend:function(){},success:function(result){var tabResult=XMLToArray(result);if(tabResult.modeResa){manageChangementTypeResa(tabResult,true);}
else if(tabResult.prixChambres){afficheEffaceRecapPrix(tabResult);}
else if($(".inpt_chambre:checked").length==0){$("#div_recapPrix").hide();}}});})(jQuery);}
function affectFamille(type,numChambre){(function($){var nbAdultes,nbEnfants,nbBebes;if(numChambre){nbAdultes=$("#select_compoFamilleAdulte_"+numChambre).val()||0;nbEnfants=$("#select_compoFamilleEnfant_"+numChambre).val()||0;nbBebes=$("#select_compoFamilleBebe_"+numChambre).val()||0;}
else{nbAdultes=$("#select_compoFamilleAdulte").val()||0;nbEnfants=$("#select_compoFamilleEnfant").val()||0;nbBebes=$("#select_compoFamilleBebe").val()||0;var majOptions=false;if($(".option.obligatoire:not(.animal)").length>0)
majOptions=true;if(type=="bebes")
majOptions=false;}
$.ajax({type:"POST",url:urlAJAX,data:{type:"affectFamille",nbAdultes:nbAdultes,nbEnfants:nbEnfants,nbBebes:nbBebes,numChambre:numChambre},beforeSend:function(){var divCompoFamille=$("#select_compoFamilleAdulte").parents('.div_uneEtape');if(numChambre){divCompoFamille=$("#select_compoFamilleAdulte_"+numChambre).parents('.div_uneEtape');}
divCompoFamille.addClass('div_uneEtapeGrisee');$('select, input',divCompoFamille).attr("disabled",true);affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);$('#div_confirmDispos span.confirmSaisie.ko').html('').hide();afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code==='KO'){$('#div_recapInfosEtPrix').hide();invalideSaisieDates(tabResult.msg);}
else{if(numChambre){}
else{try{var compoFamille=tabResult.compoFamillePourControle;var adultesPhp=compoFamille.adultes||0;var adultesHTML=$("#select_compoFamilleAdulte").val()||0;var enfantsPhp=compoFamille.enfants||0;var enfantsHTML=$("#select_compoFamilleEnfant").val()||0;if(adultesPhp!=adultesHTML||enfantsPhp!=enfantsHTML){debugLogJS('foncResa.php affectFamille on a pas la meme compo famille entre html ('+adultesHTML+','+enfantsHTML+') et php ('+adultesPhp+','+enfantsPhp+')');}}
catch(e){}}
if(tabResult.total)
afficheEffaceRecapPrix(tabResult);$("#div_recapInfosEtPrix").show();if(majOptions){affectOptions();}
$("#div_uneEtape_compoFamilleGite").find(".p_recapCompoFamilleGite").html(tabResult.msg);$("#div_recapOptionsObligatoires").html(tabResult.options);$("#div_recapOptionsObligatoires").find("tr:last").addClass("last");}
$(".div_uneEtapeGrisee *").attr("disabled",false);$('.div_uneEtapeGrisee').removeClass('div_uneEtapeGrisee');$("#div_recapInfos").html(tabResult.recapInfos);}
effaceMsgAttenteParDessus("recapPrix");rendChoixCanevasPossible();var capaciteReel;try{var suffixe="";var divParent='.div_uneEtape';if(numChambre){divParent='.div_uneChambre';suffixe="_"+numChambre;}
capaciteReel=parseInt($("#select_compoFamilleAdulte"+suffixe).attr('data-capacite'));if((parseInt(nbAdultes)+parseInt(nbEnfants))>capaciteReel){$("#select_compoFamilleAdulte"+suffixe).parents(divParent).find('.messageSurcapacite').show('fast');}
else{$("#select_compoFamilleAdulte"+suffixe).parents(divParent).find('.messageSurcapacite').hide();}}
catch(e){}
if(tabResult.questionRecalculAuto){questionRecalculAuto();}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function affectSelectionChambres(tabSelectionChambres){(function($){var tabData={};tabData.type='affectSelectionChambres';tabData.tabSelection=tabSelectionChambres;tabData.avecDeuxLibelles=$("#a_btnReserver_packDivDatesTarifs").attr("data-avecDeuxLibelles");if($('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').length>0){var tabAttributs=$('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').attr('data-attributsDiv');var listeAttr=eval('('+tabAttributs+')');tabData.listeAttrDivChambres=listeAttr;}
tabData.estpresentsurfiche=true;$.ajax({type:"POST",url:urlAJAX,data:tabData,beforeSend:function(){},success:function(result){var tabRetour=XMLToArray(result);majDivTarifAPartirDe(tabRetour);majDivChambres_packDivDatesTarifs(tabRetour,false);}});})(jQuery);}
function affectAgeEnfants(numChambre){(function($){var suffixe="";if(numChambre)
suffixe="_"+numChambre;var i=0;var tabAgeEnfants=new Array();$(".select_compoFamilleAgeEnfants"+suffixe+":visible").each(function(){tabAgeEnfants[i]=$(this).val();i++;});$(".select_compoFamilleAgeBebe"+suffixe+":visible").each(function(){tabAgeEnfants[i]=$(this).val();i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"affectAgeEnfants",ageEnfants:tabAgeEnfants,numChambre:numChambre},beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}}});})(jQuery);}
function affectAnimaux(numeroChambre){(function($){if(!numeroChambre){numeroChambre="";}
var nbChats=$("#select_compoAnimauxChat"+numeroChambre).val();var nbChiens=$("#select_compoAnimauxChien"+numeroChambre).val();var nbAnimaux=nbChats+nbChiens;var majOptions=false;if($("tr.animal").length>0){majOptions=true;}
$.ajax({type:"POST",url:urlAJAX,data:{type:"affectAnimaux",nbChats:nbChats,nbChiens:nbChiens,numeroChambre:numeroChambre},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="KO"){$("#div_recapInfosEtPrix").hide();}
else{$("#div_recapInfosEtPrix").show();if(majOptions){affectOptions();}
if($("#div_uneEtapeAnimaux")){$("#div_uneEtapeAnimaux").find(".inpt_validEtape").val("Oui");$("#div_uneEtapeAnimaux").find(".p_recapAnimaux").html(tabResult.msg);$("#div_recapOptionsAnimaux").html(tabResult.options);if(nbAnimaux>0){$("#div_recapOptionsAnimaux").show();}else{$("#div_recapOptionsAnimaux").hide();}
$("#div_recapOptionsAnimaux > table > tbody > tr:last").addClass("last");}
if($("#div_uneEtapeAnimaux"+numeroChambre)){$("#div_uneEtapeAnimaux"+numeroChambre).find(".inpt_validEtape").val("Oui");$("#div_uneEtapeAnimaux"+numeroChambre).find(".p_recapAnimaux").html(tabResult.msg);}}
$("#div_recapInfos").html(tabResult.recapInfos);}
effaceMsgAttenteParDessus("recapPrix");}});})(jQuery);}
function affectAssurance(objParams){var params=objParams||{};params.type="affectAssurance";(function($){var choixAssurance=$("input:radio[name=assur]:checked").val();if(typeof(choixAssurance)!='undefined'){params.choixAssur=choixAssurance;}
$.ajax({type:"POST",url:urlAJAX,data:params,beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(tabResult.recapPrix){$("#div_recapPrix").html(tabResult.recapPrix);}
else{afficheEffaceRecapPrix(tabResult);$("#div_recapInfosEtPrix").show();}
if(estMultiResa()){majObjMultiResa('assurance',params);}}
else if(tabResult.msg=="datesNull"){$("#div_recapInfosEtPrix").hide();}
$("#div_recapInfos").html(tabResult.recapInfos);}
effaceMsgAttenteParDessus("recapPrix");},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function affectOptions(){(function($){var tabOptions=new Array();var i=0;$("#div_uneEtape_optionsSuppl .option, #div_infosOptionsAnimaux .option, #div_infosOptionsObligatoires .option, #div_recapOptionsObligatoires .option").each(function(){if($(this).find("select:not(.select_dureeForOption)").val()>0||$(this).is(".obligatoire")){var numOption;var nbAdultes=0;var nbEnfants=0;if($(this).is(".animal")){numOption=$(this).attr("data-num");nbAdultes=$(this).find("select.select_optionAnimaux").val()||$(this).find("input.inpt_optionAnimaux").val();var nbAnimaux=(parseInt($("#select_compoAnimauxChat").val())+parseInt($("#select_compoAnimauxChien").val()));if(nbAnimaux==0){nbAdultes=0;}
var duree='';if($(this).find('select.select_dureeForOption').length>0&&$(this).is(':visible')){duree=$(this).find('select.select_dureeForOption').val();}else if($('tr[data-num="'+numOption+'"]:visible').length>0){duree=$('tr[data-num="'+numOption+'"]:visible').find('select.select_dureeForOption').val();}
if(nbAdultes>0){tabOptions[i]=new Array(numOption,nbAdultes,nbEnfants,duree);}}
else if($(this).is(":not(.animal):visible")){numOption=$(this).attr("data-num");if($(this).is(".adulte")){nbAdultes=$(this).find("select.select_optionAdultes").val()||$(this).find("input.inpt_optionAdultes").val();if($(this).next().find("input").attr("checked")=="checked"){nbEnfants=$(this).next().find("select.select_optionEnfants").val()||$(this).next().find("input.inpt_optionEnfants").val();}}
else if($(this).is(".enfant")){nbEnfants=$(this).find("select.select_optionEnfants").val()||$(this).find("input.inpt_optionEnfants").val();if($(this).prev().find("input").attr("checked")=="checked"){i--;nbAdultes=$(this).prev().find("select.select_optionAdultes").val()||$(this).prev().find("input.inpt_optionAdultes").val();}
else{nbAdultes=0;}}
else{nbAdultes=$(this).find("select.select_optionAdultes").val()||$(this).find("select.select_optionGroupe").val();if(nbAdultes==undefined){nbAdultes=$(this).find("input.inpt_optionAdultes").val();}}
var duree='';if($(this).find('select.select_dureeForOption').length>0){duree=$(this).find('select.select_dureeForOption').val();}
tabOptions[i]=new Array(numOption,nbAdultes,nbEnfants,duree);}
i++;}});$.ajax({type:"POST",url:urlAJAX,data:{type:"affectOptions",tabOptions:tabOptions},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){afficheEffaceRecapPrix(tabResult);if(tabResult.tabTarifs)
afficheEffaceTarifsOptions(tabResult.tabTarifs);}}
effaceMsgAttenteParDessus("recapPrix");}});})(jQuery);}
function affectOptionsChambre(){(function($){var tabOptions=new Array();var i=0;$(".optionChambre").each(function(){if($(this).find("select").val()>0||$(this).is(".obligatoire")||$(this).find("select").length>1){var numOption=$(this).attr("numOption");var numChambre=$(this).attr("numChambre");var nbAdultes=$(this).find(".select_optionChambre").val();var nbEnfants=$(this).find(".select_optionChambre_enfants").val();if(nbEnfants>0){nbAdultes=nbAdultes+'-'+nbEnfants;}
var duree='';if($(this).find(".select_dureeForOption").length>0){duree=$(this).find(".select_dureeForOption").val();}
if(nbAdultes){tabOptions[i]=new Array(numChambre,numOption,nbAdultes,duree);}
i++;}});$.ajax({type:"POST",url:urlAJAX,data:{type:"affectOptionsChambre",tabOptions:tabOptions},beforeSend:function(){},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{afficheEffaceRecapPrix(tabResult);}}});})(jQuery);}
function afficheEffaceTarifsOptions(tabTarifs){(function($){$(".td_prixOption").html("");$("tr.option").each(function(){var numOption=$(this).attr("data-num");for(var i=0;i<tabTarifs.length;i++){if(numOption==tabTarifs[i].noTarif){$(this).find("td.td_prixOption").html(tabTarifs[i].prix+" \u20ac");break;}}});})(jQuery);}
function etapesValid(){var retour=true;(function($){var replaceOK=false;$("#p_msgErreurs").html("");$("#div_msgErreurs").hide();$('#div_uneEtape_compoFamilleGite').find('.inpt_validEtape').val('Oui');$('#div_uneEtape_compoFamilleChambre').find('.inpt_validEtape').val('Oui');verifNbPax();verifCompoFamilleGiteAdultes();if(!verifSaisieAgeEnfants()||!verifSaisieAgeBebes()){if($('#div_uneEtape_compoFamilleGite').length>0){$('#div_uneEtape_compoFamilleGite').find('.inpt_validEtape').val('Non');}
if($('#div_uneEtape_compoFamilleChambre').length>0){$('#div_uneEtape_compoFamilleChambre').find('.inpt_validEtape').val('Non');}}
if($('.divUneRubriqueCanevas.canevasObligatoire').length>0){var verifCanevasObligatoires=verifQteCanevasOblig();if(!verifCanevasObligatoires){retour=false;}}
if(!verifChoixHeureVoiture()){retour=false;return;}
if(!verifMontantNullResaBureau()){retour=false;return;}
if(!verifSelectionAnimaux()){$("#div_msgErreursNbAnimaux").show();document.location="#div_msgErreursNbAnimaux";retour=false;return;}
retour=verifErreurAjaxEtape1();$(".inpt_validEtape").each(function(){if($(this).val()=="Non"||$(this).val()==undefined){var message=$(this).parents(".div_uneEtape").find(".sp_msgErreur").text();message="- "+message;if($("#div_msgErreurs:visible").length==0){$("#p_msgErreurs").html(message);$("#div_msgErreurs").show();}
else{$("#p_msgErreurs").append("<br />");$("#p_msgErreurs").append(message);}
$(this).parents(".div_uneEtape").addClass('div_uneEtapeAValider');if(!replaceOK){document.location="#div_msgErreurs";replaceOK=true;}
retour=false;}});})(jQuery);return retour;}
function actionsForCompteGdf(){(function($){$('#itea_cnxCptGDFResa_valid').click(function(e){e.preventDefault();validFormConnexionCompteGDFResa();});$('#div_pasdecomptegdf').click(function(e){$('#div_pasdecomptegdf').hide();$('#div_connexioncomptegdf').addClass('hide');$('#div_uneEtape_nouveauClient').show();$('#div_mentionsLegalesCoords').show();$('#div_boutonsResa').show();$('#itea_cnxCptGDFResa_msgInfo').hide();});$('#div_connexioncomptegdf .titre').click(function(e){$('#div_pasdecomptegdf').show();$('#div_connexioncomptegdf').removeClass('hide');$('#div_uneEtape_nouveauClient').hide();$('#div_mentionsLegalesCoords').hide();$('#div_boutonsResa').hide();});$('#form_nouveauClient .remplaceCheckbox').next('input').change(function(e){if($(this).is(':checked')){$(this).prev('.remplaceCheckbox').addClass('active')}else{$(this).prev('.remplaceCheckbox').removeClass('active')}});$('#div_btnConnexionFacebookFede').click(function(){ouvrePopInAuthentificationCompteGdf($(this).attr('data-url-authentification-compte-gdf'));});$('#div_btnConnexionGoogleFede').click(function(){ouvrePopInAuthentificationCompteGdf($(this).attr('data-url-authentification-compte-gdf'));});initMdpOublieCptGDF();initActionPopInAvantagesCompteGdf();})(jQuery);}
function initActionPopInAvantagesCompteGdf(){(function($){$('#a_avantagesCompteGdf').click(function(e){$.fancybox($('#div_avantagesCompteGdf'),{maxWidth:800,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popin_avantagesCptGDF',fitToView:false});});})(jQuery);}
function validFormConnexionCompteGDFResa(){(function($){var nomDivMsgInfo='#itea_cnxCptGDFResa_msgInfo';var $msgInfo=$(nomDivMsgInfo);$msgInfo.html('').hide();var data=$('#frmCnxCptGDFResa').serialize();data+='&type=connexionCompteGdf';$.ajax({type:'POST',url:urlAJAX,data:data,beforeSend:function(){$msgInfo.html('').show();attenteInDiv(nomDivMsgInfo);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='KO'){$msgInfo.html(tabResult.msg).fadeIn();return false;}
var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}});})(jQuery);}
function initEtape2(){(function($){$(document).ready(function(){idSession=getIdSessionInHtml();initGooglePlusResa();initSaisieOccupantsResaBureau();if($('.clientNatABloquer').length>0){lockModifClientNat();}
if($('.dateNaissanceParticipant').length>0){initDatePickerNaissanceParticipant();}});initBtnsFooter();majNumEtapes();if(estResaAvecCompteGdf()){actionsForCompteGdf();var mailClient=$('#inpt_mailClient').val();$('#itea_cnxCptGDFResa_email').val(mailClient);$('#div_connexioncomptegdf .titre').click();}
var tabAValider=[];if(estResaBureauProp()||estResaAilleurs()){tabAValider=getTabChampAValider_bureau();setSuggestionMailCheck($('#inpt_mailClient'));}else{tabAValider=getTabChampAValider();}
$("#div_recupMdp").dialog({autoOpen:false,height:150,width:300,modal:true});$("#a_dejaClientValide").click(function(){$("#div_dejaClientMsgErreur").hide();var mail=$("#inpt_dejaClientMail").val();var mdp=$("#inpt_dejaClientPassword").val();$.ajax({type:"POST",url:urlAJAX,data:{type:"verifDejaClient",mail:mail,mdp:mdp},beforeSend:function(){afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(tabResult.effaceAcompte=="OK"){$(".tr_prixAcompte").hide();}else{$(".tr_prixAcompte").show();}
$("#div_uneEtape_nouveauClient").hide("slow");$("#div_uneEtape_dejaClient").html(tabResult.msg);$('#form_dejaClient').append("<input type='hidden' name='pasDeSaisie' value='1'/>");$("#form_nouveauClient").validationEngine("hide");$("input:hidden[name=inpt_dejaClient]").remove();if(tabResult.vdm||tabResult.saisieIncomplete){$('#a_btnModifierInfosClient').click();}}
else{console.log('eho');$("#div_dejaClientMsgErreurContent").html("<p>"+tabResult.msg+"</p>");$("#div_dejaClientMsgErreur").show("slow");}}},complete:function(){effaceLoaderGlobal_site();}});});$("#inpt_dejaClientPassword").keyup(function(event){if(event.keyCode==13){$("#a_dejaClientValide").click();}});$("#a_btnModifierInfosClient").live("click",function(){document.location.reload();return;$.ajax({type:"POST",url:urlAJAX,data:{type:"recupFormulaireSaisieClient"},beforeSend:function(){},success:function(result){var tabResult=XMLToArray(result);if(tabResult==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{$("#form_dejaClient").html(tabResult.msg);}}});});$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm), #div_btnConfirmer_2 > a:not(.a_btnAttenteConfirm)").unbind('click');$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm), #div_btnConfirmer_2 > a:not(.a_btnAttenteConfirm)").bind('click',function(){$(this).hide();$(".a_btnAttenteConfirm").show();$("#div_msgErreursInfosClient").hide();if($("#div_adresseClient:visible").length>0){tabAValider=[];}
if($('#div_saisieParticipantsCongres').length>0){var tabParticipants=new Array();var nom;var prenom;var naissance;var i=0;$('.div_unParticipant').each(function(){nom=$(this).find('.nomParticipant').val();prenom=$(this).find('.prenomParticipant').val();naissance=$(this).find('.dateNaissanceParticipant').val();tabParticipants[i]=new Array(nom,prenom,naissance);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setParticpantsCongres",tabParticipants:tabParticipants},beforeSend:function(){}});}
if($(this).parent().is('#div_btnConfirmer_2')){var urlHref="etape"+$('#div_btnConfirmer_2').attr('data-idPageNext')+".php";}else{var urlHref="etape"+$('#div_btnConfirmer').attr('data-idPageNext')+".php";}
if(location.search.indexOf("PHPSESSID")>-1){urlHref+=location.search;}else{urlHref+=location.search+"&"+idSession;}
if($("input:hidden[name=inpt_dejaClient]").length>0){location.href=urlHref;}
else if(LiveValidation.massValidate(tabAValider)){var tabInfos=new Array();if(!verifQuestionnairesClient()){$(".a_btnAttenteConfirm").hide();$(this).show();document.location="#div_uneEtape_questionnaires";return;}
enregistreReponsesQuestionnairesClient();if($("#form_nouveauClient:visible").length>0){$(".div_saisieClient:visible").each(function(){var objs=$(this).children(":not(label)");var id,valeur;objs.each(function(){var estInput=$(this).attr('name')||false;if(estInput){id=$(this).attr("name");valeur=$(this).val()||'';}})
tabInfos.push(new Array(id,valeur));});if($("#div_dateNaissanceClient").length>0){var jour=$("#select_jourNaissanceClient").val();var mois=$("#select_moisNaissanceClient").val();var annee=$("#select_anneeNaissanceClient").val();var dateNaissance=jour+"-"+mois+"-"+annee;tabInfos.push(new Array("dateNaissance",dateNaissance));}
if($("#div_saisieClientAncienPassword").length>0){id=$("#inpt_mdpClient").attr("name");valeur=$("#inpt_mdpClient").val();tabInfos.push(new Array(id,valeur));}
id=$("#div_saisieClientOffres").children(":not(label)").attr("name");valeur=$("#div_saisieClientOffres").children(":not(label)").attr("checked");tabInfos.push(new Array(id,valeur));id='backofficeParMail';valeur='O';if($('.input_saisieClientRadioBackoffice').length>0){valeur=$('input[name="backofficeClient"]:checked').val();}
tabInfos.push(new Array(id,valeur));if(estResaAvecCompteGdf()){id=$("#div_saisieClientCreationCompteGdf").children(":not(label)").attr("name");valeur=$("#div_saisieClientCreationCompteGdf").children(":not(label)").attr("checked");tabInfos.push(new Array(id,valeur));}
if($("#inpt_numeroClient").length>0){id='numeroClient';valeur=$("#inpt_numeroClient").val();tabInfos.push(new Array(id,valeur));id='identClientNat';valeur=$("#inpt_identClientNat").val();tabInfos.push(new Array(id,valeur));id='mdpNationalExistant';valeur=$("#inpt_mdpNationalExistant").val();tabInfos.push(new Array(id,valeur));}
if($('#inpt_connectFB').length>0&&$('#inpt_connectFB').val()=='O'){id='facebook';valeur=$('#inpt_connectFB').val();tabInfos.push(new Array(id,valeur));}
if($('#inpt_connectGoogle').length>0&&$('#inpt_connectGoogle').val()=='O'){id='google';valeur=$('#inpt_connectGoogle').val();tabInfos.push(new Array(id,valeur));}
$.ajax({type:"POST",url:urlAJAX,data:{type:"enregistreClient",tabInfos:tabInfos},beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){location.href=urlHref;}
else{}}}});}
else{$(".div_saisieClient:visible").each(function(){var id=$(this).children(":not(label)").attr("name");var valeur=$(this).children(":not(label)").val();tabInfos.push(new Array(id,valeur));});if($("#div_saisieClientOffres:visible").length>0){id=$("#div_saisieClientOffres:visible").children(":not(label)").attr("name");valeur=$("#div_saisieClientOffres:visible").children(":not(label)").attr("checked");tabInfos.push(new Array(id,valeur));}
$.ajax({type:"POST",url:urlAJAX,data:{type:"enregistreClient",tabInfos:tabInfos},beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){location.href=urlHref;}
else{}}}});}}
else{if(typeof(dataLayer)!='undefined'){dataLayer.push({'form_error':true,'event':'form_error'});var champsInvalides='';$('.LV_invalid_field').each(function(){champsInvalides+=$(this).attr('name')+', ';});champsInvalides=champsInvalides.substring(0,champsInvalides.length-2);dataLayer.push({'form_error_field':champsInvalides,'event':'form_error'});}
$(".a_btnAttenteConfirm").hide();$(this).show();$("#div_msgErreursInfosClient").show();document.location="#div_msgErreursInfosClient";}});$('#div_btnConnexionFacebook').click(function(){if($(this).is('.compteGdf')){connexionFacebook(authentificationFacebookCompteGdf,resaFacebookKO);}else{connexionFacebook(resaFacebookOK,resaFacebookKO);}});$('#div_btnConnexionFacebook_creaCptGDF').click(function(){connexionFacebook(checkIfCompteFNGFFacebookExiste,resaFacebookKO);});autocompleteurCpVille($('#inpt_cpClient'),$('#inpt_villeClient'));if($('#inpt_modeResaPROP').length>0||estResaAilleurs()){initAutocompleteClientsExistants(true);}
if($('.inpt_timepicker[type="text"]').length>0){$('.inpt_timepicker').datetimepicker({datepicker:false,format:'H:i',step:30});}
if($(".div_unParticipant").length>0){$("#inpt_nomClient").blur(function(){$("#nomParticipant_1").val($(this).val());});$("#inpt_prenomClient").blur(function(){$("#prenomParticipant_1").val($(this).val());});}
initQuestionnaireClient();initModalTaxeSejour();})(jQuery);}
function initQuestionnaireClient(){(function($){if($(".select_questionClient").length>0){$(".select_questionClient").change(function(){actualiseDependancesQuestionsSelect($(this).data("id"));});}
if($(".inpt_uneQuestionClient_radio").length>0){$(".inpt_uneQuestionClient_radio").change(function(){actualiseDependancesQuestionsRadio($(this).data("id"));});}})(jQuery);}
function actualiseDependancesQuestionsRadio(idInputParent){(function($){$('.div_uneQuestion[data-idparent="'+idInputParent+'"]').each(function(){var idParent=$(this).data("idparent");var valeursParent=$(this).data("valeurparent").toString();var tabValeurParent=valeursParent.split(",");if($.inArray($('input[name="inpt_choixQuestion_'+idParent+'"]:checked').val(),tabValeurParent)!==-1){$(this).show();}else{$(this).hide();effaceValeurFormInDiv(this);actualiseDependancesQuestionnaireClient($(this).data("id"));}})})(jQuery);}
function actualiseDependancesQuestionsSelect(idInputParent){(function($){$('.div_uneQuestion[data-idparent="'+idInputParent+'"]').each(function(){var idParent=$(this).data("idparent");var valeursParent=$(this).data("valeurparent").toString();var tabValeurParent=valeursParent.split(",");if($.inArray($("#select_questionClient_"+idParent).val(),tabValeurParent)!==-1){$(this).show();}else{$(this).hide();effaceValeurFormInDiv(this);actualiseDependancesQuestionsSelect($(this).data("id"));}});})(jQuery);}
function initEtape2_agence(){(function($){$(document).ready(function(){idSession=getIdSessionInHtml();});initBtnsFooter();var tabAValider=[];var nom=new LiveValidation("inpt_nomClient",{validMessage:$("#inpt_msgOk").val()});nom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});tabAValider.push(nom);$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm)").click(function(){$(this).hide();$(".a_btnAttenteConfirm").show();var urlHref="etape"+$('#div_btnConfirmer').attr('data-idPageNext')+".php";if(location.search.indexOf("PHPSESSID")>-1){urlHref+=location.search;}else{urlHref+=location.search+"&"+idSession;}
if(LiveValidation.massValidate(tabAValider)){var tabInfos=new Array();$(".div_saisieClient:visible").each(function(){var objs=$(this).children(":not(label)");var id,valeur;objs.each(function(){var estInput=$(this).attr('name')||false;if(estInput){id=$(this).attr("name");valeur=$(this).val();}})
tabInfos.push(new Array(id,valeur));});$.ajax({type:"POST",url:urlAJAX,data:{type:"enregistreClient_agence",tabInfos:tabInfos},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){location.href=urlHref;}
else{}}}});}
else{$(".a_btnAttenteConfirm").hide();$(this).show();$("#div_msgErreursInfosClient").show();document.location="#div_msgErreursInfosClient";}});autocompleteurCpVille($('#inpt_cpClient'),$('#inpt_villeClient'));})(jQuery);}
function initEtape2_bureau(){(function($){var validerResa=false;$(document).ready(function(){idSession=getIdSessionInHtml();if($('.dateNaissanceParticipant').length>0){initDatePickerNaissanceParticipant();}});initHistoriqueClientsLocalStorage();initBtnsFooter();initModifPrixResaBureau();initSaisieOccupantsResaBureau();var tabAValider=getTabChampAValider_bureau();if(estMultiResa()){autofillFormulaireClient(getClientLocalStoragePourMultiResa());}
$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm), #divBoutonTerminerModification").click(function(){$(this).hide();$(".a_btnAttenteConfirm").show();var urlHref="etape"+$('#div_btnConfirmer').attr('data-idPageNext')+".php";if(location.search.indexOf("PHPSESSID")>-1){urlHref+=location.search;}else{urlHref+=location.search+"&"+idSession;}
if($(this).attr('id')=='divBoutonTerminerModification'){validerResa=true;}
if(LiveValidation.massValidate(tabAValider)){var tabInfos=new Array();if(!verifQuestionnairesClient()){$(".a_btnAttenteConfirm").hide();$(this).show();document.location="#div_uneEtape_questionnaires";return;}
enregistreReponsesQuestionnairesClient();if($('#div_saisieParticipantsCongres').length>0){var tabParticipants=new Array();var nom;var prenom;var naissance;var i=0;$('.div_unParticipant').each(function(){nom=$(this).find('.nomParticipant').val();prenom=$(this).find('.prenomParticipant').val();naissance=$(this).find('.dateNaissanceParticipant').val();tabParticipants[i]=new Array(nom,prenom,naissance);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setParticpantsCongres",tabParticipants:tabParticipants},beforeSend:function(){}});}
var tabInfosLocalStorage={};$(".div_saisieClient:visible, #div_saisieClientPassword").each(function(){var objs=$(this).children(":not(label)");var id,valeur;objs.each(function(){var estInput=$(this).attr('name')||false;if(estInput){id=$(this).attr("name");valeur=$(this).val();}});tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;});$(".div_saisieClientChecks:visible").each(function(){id=$(this).children(":not(label)").attr("name");valeur=$(this).children(":not(label)").attr("checked");tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;});if($('.input_saisieClientRadioBackoffice').length>0){id='backofficeParMail';valeur=$('input[name="backofficeClient"]:checked').val();tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;}
id='numeroClient';valeur=$("#inpt_numeroClient").val();tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;id='identClientNat';valeur=$("#inpt_identClientNat").val();tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;id='mdpNationalExistant';valeur=$("#inpt_mdpNationalExistant").val();tabInfos.push(new Array(id,valeur));tabInfosLocalStorage[id]=valeur;$.ajax({type:"POST",url:urlAJAX,data:{type:"enregistreClient",tabInfos:tabInfos},beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(tabResult.mdpClientPourLocalStorage){tabInfosLocalStorage.mdp=tabResult.mdpClientPourLocalStorage;}
if(estMultiResa()){ajouteClientMultiResaDansLocalStorage(tabInfosLocalStorage);}
else{ajouteClientDansLocalStorage(tabInfosLocalStorage);}
if(validerResa){terminerModifResa();}
else{location.href=urlHref;}}
else{}}}});}else{$(".a_btnAttenteConfirm").hide();$(this).show();$("#div_msgErreursInfosClient").show();document.location="#div_msgErreursInfosClient";}});$('.div_saisieClient input').change(function(){checkChampsImportants();});setSuggestionMailCheck($('#inpt_mailClient'));checkChampsImportants();autocompleteurCpVille($('#inpt_cpClient'),$('#inpt_villeClient'));initAutocompleteClientsExistants(false);})(jQuery);}
function checkChampsImportants(){(function($){if($('#inpt_adresse1Client').val()==''){$('#div_msgInfosChampsSaisis p.adresse').show();}else{$('#div_msgInfosChampsSaisis p.adresse').hide();}
if($('#inpt_telDomClient').val()==''){$('#div_msgInfosChampsSaisis p.tel').show();}else{$('#div_msgInfosChampsSaisis p.tel').hide();}
if($('#inpt_mailClient').val()==''){$('#div_msgInfosChampsSaisis p.mail').show();}else{$('#div_msgInfosChampsSaisis p.mail').hide();}
if($('#div_msgInfosChampsSaisis .p_msgInfosChampsSaisis:visible').length==0){$('#div_msgInfosChampsSaisis').hide();}else{$('#div_msgInfosChampsSaisis').show();}})(jQuery);}
function validFormulaire(){(function($){var tabAValider=[];if(estResaBureauGestloc()||estResaBureauProp()||estResaAilleurs()){tabAValider=getTabChampAValider_bureau();}else{tabAValider=getTabChampAValider();}
LiveValidation.massValidate(tabAValider);})(jQuery);}
function getTabChampAValider(){var patternTel=/^\+?([0-9.-\s]{9,20}|[0-9]{8,20})$/;var retour=[];(function($){var nom=new LiveValidation("inpt_nomClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});nom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(nom);var prenom=new LiveValidation("inpt_prenomClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});prenom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(prenom);var adresse=new LiveValidation("inpt_adresse1Client",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});adresse.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});adresse.add(Validate.Length,{maximum:30,tooLongMessage:$("#inpt_msgSaisieTropLongue").val()});retour.push(adresse);var cp=new LiveValidation("inpt_cpClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});cp.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(cp);var ville=new LiveValidation("inpt_villeClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});ville.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(ville);var tel=new LiveValidation("inpt_telDomClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});tel.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});if($('#inpt_telDomClient').attr('data-typeTel')=='portable'){tel.add(Validate.Format,{pattern:/^0[6-7][\s]?([0-9]{2}[\s]?){3}[0-9]{2}$/,failureMessage:$("#inpt_msgTelPortable").val()});}
else{tel.add(Validate.Format,{pattern:patternTel,failureMessage:$("#inpt_msgTelChiffres").val()});}
tel.add(Validate.Length,{minimum:6,tooShortMessage:$("#inpt_msgTelCourt").val()});tel.add(Validate.Length,{maximum:20,tooLongMessage:$('#inpt_msgTelLong').val()});retour.push(tel);var tel2=new LiveValidation("inpt_telBurClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});tel2.add(Validate.Format,{pattern:patternTel,failureMessage:$("#inpt_msgTelChiffres").val()});tel2.add(Validate.Length,{minimum:6,tooShortMessage:$("#inpt_msgTelCourt").val()});tel2.add(Validate.Length,{maximum:20,tooLongMessage:$('#inpt_msgTelLong').val()});retour.push(tel2);var email=new LiveValidation("inpt_mailClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});var obligatoire=true;if($('#div_saisieClientEmail').find('span.etoile').length===0){obligatoire=false;}
addValidateOnLiveValidationEmail(email,undefined,obligatoire,$("#inpt_msgMailNonValide").val());retour.push(email);if(estResaAvecCompteGdf()){if(!jQuery('#inputIdentClientNat').val()){addValidateOnLiveValidationEmail(email,undefined,true,$('#inpt_msgCompteGdfExistant').val(),'checkEmailClientCompilNotExist');retour.push(email);}}
if($('#inpt_confirmMailClient').length>0){var emailConfirm=new LiveValidation("inpt_confirmMailClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});emailConfirm.add(Validate.Confirmation,{match:"inpt_mailClient",failureMessage:$("#inpt_msgCorresMails").val()});retour.push(emailConfirm);}
if($("#inpt_mdpClient").is(":visible")){var mdp=new LiveValidation("inpt_mdpClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});if(estResaAvecCompteGdf()){mdp.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});}
mdp.add(Validate.Format,{pattern:/^(?=.*[0-9]+.*)(?=.*[A-Z]+.*)(?=.*[a-z]+.*)[0-9a-zA-Z-_]{8,}$/,failureMessage:$("#inpt_msgSeulementChiffresLettres").val()});retour.push(mdp);}
if($('#modeResaPVTrue').length>0&&$('#inpt_commentaireDossier').length>0){var commentaire=new LiveValidation("inpt_commentaireDossier",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});commentaire.add(Validate.Length,{maximum:500,tooLongMessage:$("#inpt_msgCommentaireNonValide").val()});retour.push(commentaire);if($('#inpt_commentaireDossierPourCentrale').length>0){var commentaireCentrale=new LiveValidation("inpt_commentaireDossierPourCentrale",{validMessage:$("#inpt_msgOk").val()});var longeurMax=$('#inpt_commentaireDossierPourCentrale').data('longueurmax');commentaireCentrale.add(Validate.Length,{maximum:parseInt(longeurMax),tooLongMessage:$("#inpt_msgCommentaireNonValide").val()});retour.push(commentaireCentrale);}}
if($('#modeResaPVTrue').length==0&&$('#inpt_modeResaPROP').length==0){email.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});if(emailConfirm){emailConfirm.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});}}})(jQuery);return retour;}
function getTabChampAValider_bureau(){var retour=[];(function($){var categ,ori;if($('#select_categorieClient').hasClass('inputObligatoire')){var categ=new LiveValidation('select_categorieClient',{validMessage:$("#inpt_msgOk").val()});categ.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(categ);}
if($('#select_origineClient').hasClass('inputObligatoire')){var ori=new LiveValidation('select_origineClient',{validMessage:$("#inpt_msgOk").val()});ori.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(ori);}
$("#inpt_nomClient").change(function(){$("#inpt_nomClient").val($("#inpt_nomClient").val().trim());});var nom=new LiveValidation("inpt_nomClient",{validMessage:$("#inpt_msgOk").val()});nom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});retour.push(nom);$("#inpt_prenomClient").change(function(){$("#inpt_prenomClient").val($("#inpt_prenomClient").val().trim());});var prenom=new LiveValidation("inpt_prenomClient",{validMessage:$("#inpt_msgOk").val()});retour.push(prenom);$("#inpt_telDomClient").change(function(){$("#inpt_telDomClient").val($("#inpt_telDomClient").val().trim());});$("#inpt_telBurClient").change(function(){$("#inpt_telBurClient").val($("#inpt_telBurClient").val().trim());});var adresse=new LiveValidation("inpt_adresse1Client",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});adresse.add(Validate.Length,{maximum:30,tooLongMessage:$("#inpt_msgSaisieTropLongue").val()});retour.push(adresse);var tel=new LiveValidation("inpt_telDomClient",{validMessage:$("#inpt_msgOk").val(),onlyOnSubmit:true});tel.add(Validate.Format,{pattern:/(^0[1-9][\s]?([0-9]{2}[\s]?){3}[0-9]{2}$|^00[0-9,\s]+[0-9]$)/,failureMessage:"Num. de tlphone non valide (international : commence par 00, pas de -)"});tel.add(Validate.Length,{maximum:20,tooLongMessage:$('#inpt_msgTelLong').val()});retour.push(tel);var tel2=new LiveValidation("inpt_telBurClient",{validMessage:$("#inpt_msgOk").val(),onlyOnSubmit:true});tel2.add(Validate.Format,{pattern:/(^0[1-9][\s]?([0-9]{2}[\s]?){3}[0-9]{2}$|^00[0-9,\s]+[0-9]$)/,failureMessage:"Num. de tlphone non valide (international : commence par 00, pas de -)"});tel2.add(Validate.Length,{maximum:20,tooLongMessage:$('#inpt_msgTelLong').val()});retour.push(tel2);var email=new LiveValidation("inpt_mailClient",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});addValidateOnLiveValidationEmail(email,undefined,false,$("#inpt_msgMailNonValide").val());retour.push(email);if($('#inpt_mailClientPlus').length>0){var emailPlus=new LiveValidation("inpt_mailClientPlus",{validMessage:$("#inpt_msgOk").val(),onlyOnBlur:true});addValidateOnLiveValidationEmail(emailPlus,undefined,false,$("#inpt_msgMailNonValide").val());retour.push(emailPlus);}
if($('#inpt_commentaireDossier').length>0){var commentaire=new LiveValidation("inpt_commentaireDossier",{validMessage:$("#inpt_msgOk").val()});commentaire.add(Validate.Length,{maximum:500,tooLongMessage:$("#inpt_msgCommentaireNonValide").val()});retour.push(commentaire);}
if($('#inpt_commentaireDossierPourCentrale').length>0){var commentaireCentrale=new LiveValidation("inpt_commentaireDossierPourCentrale",{validMessage:$("#inpt_msgOk").val()});commentaireCentrale.add(Validate.Length,{maximum:parseInt($('#inpt_commentaireDossierPourCentrale').attr('data-longueurMax')),tooLongMessage:$("#inpt_msgCommentaireNonValide").val()});retour.push(commentaireCentrale);}
if($('#inpt_commentaireClientPourCentrale').length>0){var commentaireClientPourCentrale=new LiveValidation("inpt_commentaireClientPourCentrale",{validMessage:$("#inpt_msgOk").val()});commentaireClientPourCentrale.add(Validate.Length,{maximum:parseInt($('#inpt_commentaireClientPourCentrale').attr('data-longueurMax')),tooLongMessage:$("#inpt_msgCommentaireNonValide").val()});retour.push(commentaireClientPourCentrale);}})(jQuery);return retour;}
function verifSaisieDateNaissance(){(function($){var ok=$("#inpt_msgOk").val();var err=$("#inpt_msgVide").val();var xhtml="";$("#div_dateNaissanceClient > span").remove();if($("#select_anneeNaissanceClient").val()!='0'&&$("#select_moisNaissanceClient").val()!='0'&&$("#select_jourNaissanceClient").val()!='0'){xhtml="<span class='LV_validation_message LV_valid'>"+ok+"</span>";}
else{xhtml="<span class='LV_validation_message LV_invalid'>"+err+"</span>";}
$("#div_dateNaissanceClient").append(xhtml);})(jQuery);}
function initEtape3(){(function($){$(document).ready(function(){idSession=getIdSessionInHtml();});initBtnsFooter();initModifPrixResaBureau();$.datepicker.setDefaults($.datepicker.regional[initLangueForDatePicker()]);var avecEnvoiMailPaiement='N';$('#inpt_nouvelleDateLimite').datepicker();if($('#div_valideDocsFiche').length>0){$("#inpt_valideDocFiche").click(function(){$("#div_msgErreursDocs").hide();if($(this).attr("checked")=="checked"&&$("#inpt_valideDocCgv").attr("checked")=="checked"&&$("#inpt_valideDocCga").attr("checked")=="checked")
etapeCourante($("#div_uneEtape_validationReservation"),false);});}
$("#div_recapHeberVoirFiche").click(function(){$("#inpt_valideDocFiche").checked=true;$("#inpt_valideDocFiche").attr("checked",true);});$("#a_valideFiche").click(function(){window.open($("#a_valideFiche").attr("url"),"","toolbar=no,top=50,left=50,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=600,height=700");if($("#inpt_valideDocCgv").length==0&&$("#a_valideCGV").length>0){if($("#inpt_valideDocFiche").attr("data-uneDocVue")=="true"){$("#inpt_valideDocFiche").checked=true;$("#inpt_valideDocFiche").attr("checked",true);}else{$("#inpt_valideDocFiche").attr("data-uneDocVue",'true');}}else if($("#inpt_valideDocFiche").attr("checked")!="checked"){$("#inpt_valideDocFiche").checked=true;$("#inpt_valideDocFiche").attr("checked",true);}});$("#a_valideCGV").click(function(){if($("#inpt_valideDocCgv").length==0){if($("#inpt_valideDocFiche").attr("data-uneDocVue")=="true"){$("#inpt_valideDocFiche").checked=true;$("#inpt_valideDocFiche").attr("checked",true);}else{$("#inpt_valideDocFiche").attr("data-uneDocVue",'true');}}else{$("#inpt_valideDocCgv").checked=true;$("#inpt_valideDocCgv").attr("checked",true);}});$("#a_valideCGA").click(function(){$("#inpt_valideDocCga").checked=true;$("#inpt_valideDocCga").attr("checked",true);});$(".inpt_valideDoc").click(function(){$("#div_msgErreursDocs").hide();if($("#inpt_valideDocFiche").attr("checked")=="checked"){if(($("#inpt_valideDocCga").length==0||($("#inpt_valideDocCga").length>0&&$("#inpt_valideDocCga").attr("checked")=="checked"))&&($("#inpt_valideDocCgv").length==0||($("#inpt_valideDocCgv").length>0&&$("#inpt_valideDocCgv").attr("checked")=="checked")))
{etapeCourante($("#div_uneEtape_validationReservation"),false);}}});$('.inpt_modifPrixChambreResaProp:visible, .inpt_modifPrixChambreCentraleProp:visible, .inpt_modifPrixLocationResaProp:visible, #inpt_modifMontantPercu:visible').change(function(){actualiseMontantRestant();});$('.btnEnvoiLienPaiement').click(function(){avecEnvoiMailPaiement='O';});$('#inpt_resaBureauIntention').change(function(){if($(this).is(':checked')){$('.avecEnvoiMailPaiement').addClass('disabledLink');}else{$('.avecEnvoiMailPaiement').removeClass("disabledLink");}});$("#a_btChoixPaiementOption, #a_btChoixResaLD_sansLienPaiement, #a_btChoixResaLD, #a_btnChoixCentrale, .div_validePaiementSansPaiement>button, .btnEnvoiLienPaiement,.div_valideResaDureeLimitee, .div_valideResaConfirmation").click(function(){$(".a_btChoixPaiement").hide();$('.div_validePaiementSansPaiement>button').hide();$('.div_valideResaConfirmation').hide();$('.div_valideResaDureeLimitee').hide();$(".a_btnAttenteConfirm").show();$('.errSaisie').removeClass('errSaisie');$('#div_btnsResaProp_LD .div_msgErreurs, #div_btnsResaProp_LD .div_msgErreurs p, #div_btnsResaProp_LD .sp_msgErreur').hide();var typeResaProp='';var etatDossierIntention='';var nouveauFraisDossier;var montantsSaisisCorrects=true;var regexMontants=/^[0-9]+[\.,]?[0-9]{0,2}$/;var regexDate=new RegExp('^[0-9]{2}/[0-9]{2}/[0-9]{4}$');var estResaConfirmation=false;var estResaDureeLimitee=false;var forceDossierIntention=false;if($(this).is('.a_btChoixResaLD')||($(this).closest('#div_boutonsResaProp_LD')&&$(this).closest('#div_boutonsResaProp_LD').length>0)){typeResaProp='LD';}else if($(this).is('.a_btnChoixCentrale')||($(this).closest('#div_boutonsResaProp_centrale')&&$(this).closest('#div_boutonsResaProp_centrale').length>0)){typeResaProp='centrale';}
if($(this).is('.avecEnvoiMailPaiement')){avecEnvoiMailPaiement='O';}
if($(this).is('.div_valideResaConfirmation')){if(!valideChampsReservationAvecConfirmation()){return;}
etatDossierIntention='O';forceDossierIntention=true;estResaConfirmation=true;}
if($(this).is('.div_valideResaDureeLimitee')){if(!valideChampsReservationDureeLimitee()){return;}
etatDossierIntention='O';forceDossierIntention=true;estResaDureeLimitee=true;}
if($('#inpt_modifFDResaProp:visible').length>0){nouveauFraisDossier=$('#inpt_modifFDResaProp').val();if(!regexMontants.test(nouveauFraisDossier)){montantsSaisisCorrects=false;$('#inpt_modifFDResaProp').addClass('errSaisie');$('.sp_msgSaisieMontantErronee').show();}
if($('#inpt_modifFDResaProp').attr('data-typeModif')!='A'){if(parseFloat(nouveauFraisDossier)>parseFloat($('#inpt_modifFDResaProp').attr('data-value'))){montantsSaisisCorrects=false;$('#inpt_modifFDResaProp').addClass('errSaisie');$('.sp_msgSaisieMontantErronee').show();}}}
var nouvelAcompte;var montantPercu;var prixLocation;var nouveauxPrixOptions=Array();var tabPrixChambre=new Array();var prixTotal=$('#inpt_prixTotalResaProp').val();var prixLoc=$('#inpt_prixLocResaProp').val();var nouveauPrixTotal=parseFloat(prixTotal)-parseFloat(prixLoc);if($('.inpt_modifPrixLocationResaProp:visible').length>0){prixLocation=$('.inpt_modifPrixLocationResaProp:visible').val();if(!regexMontants.test(prixLocation)){$('.sp_msgSaisieMontantErronee').show();montantsSaisisCorrects=false;$('.inpt_modifPrixLocationResaProp:visible').addClass('errSaisie');}
else if($('.inpt_modifPrixLocationResaProp:visible').attr('id')=='inpt_modifPrixCentraleProp'){var prixLocationReference=$('#inpt_modifPrixCentraleProp').attr('data-prixReference');if(parseFloat(prixLocation)>parseFloat(prixLocationReference)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantSuperieur').show();$(this).addClass('errSaisie');}}
nouveauPrixTotal+=parseFloat(prixLocation);}
if($('.inpt_modifPrixChambreResaProp:visible').length>0||$('.inpt_modifPrixChambreCentraleProp:visible').length>0){prixLocation=0;var nbChambresModif=0;var inputs=$('.inpt_modifPrixChambreResaProp:visible, .inpt_modifPrixChambreCentraleProp:visible');$(inputs).each(function(){var numeroChambre=$(this).attr('data-numeroChambre');var prixChambre=$(this).val();var prixReference=$('#prixChambreCentralePropReference_'+numeroChambre).val();if(!regexMontants.test(prixChambre)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantErronee').show();$(this).addClass('errSaisie');}else if($(this).hasClass('inpt_modifPrixChambreCentraleProp')&&parseFloat(prixChambre)>parseFloat(prixReference)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantSuperieur').show();$(this).addClass('errSaisie');}
else{prixLocation+=parseFloat(prixChambre);tabPrixChambre[nbChambresModif]={numeroChambre:numeroChambre,prixChambre:prixChambre};}
nbChambresModif++;});nouveauPrixTotal+=parseFloat(prixLocation);}
if($('#inpt_modifAcompteResaProp:visible').length>0){nouvelAcompte=$('#inpt_modifAcompteResaProp').val();if(!regexMontants.test(nouvelAcompte)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantErronee').show();$('#inpt_modifAcompteResaProp').addClass('errSaisie');}
if(parseFloat(nouvelAcompte)>parseFloat(nouveauPrixTotal)){montantsSaisisCorrects=false;$('#inpt_modifAcompteResaProp').addClass('errSaisie');$('.sp_msgErrMontantAcomptePrixLoc').show();}
var montantRegltsCB=$('#inpt_modifAcompteResaProp:visible').data('regltcb');if(parseFloat(nouvelAcompte)<parseFloat(montantRegltsCB)){montantsSaisisCorrects=false;$('#inpt_modifAcompteResaProp').addClass('errSaisie');$('.sp_msgErrMontantPercuRegltCB').show();}}
if($('.inpt_modifOptionResaProp:visible').length>0){$('.inpt_modifOptionResaProp:visible').each(function(){var nouveauPrixOption=$(this).val();if(!regexMontants.test(nouveauPrixOption)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantErronee').show();$(this).addClass('errSaisie');}else if(parseFloat(nouveauPrixOption)>parseFloat(nouveauPrixTotal)){montantsSaisisCorrects=false;$('.sp_msgErrMontantAcomptePrixLoc').show();$(this).addClass('errSaisie');}else{var indice=$(this).data('indice');nouveauxPrixOptions.push({indice:indice,montant:nouveauPrixOption});}});}
if($('#inpt_modifMontantPercu:visible').length>0){montantPercu=$('#inpt_modifMontantPercu').val();if(!montantPercu.match(regexMontants)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantErronee').show();$('#inpt_modifMontantPercu').addClass('errSaisie');}
if(parseFloat(montantPercu)>parseFloat(nouveauPrixTotal)){montantsSaisisCorrects=false;$('#inpt_modifMontantPercu').addClass('errSaisie');$('.sp_msgErrMontantPercuPrixLoc').show();}
var montantRegltsCB=$('#inpt_modifMontantPercu:visible').data('regltcb');if(parseFloat(montantPercu)<parseFloat(montantRegltsCB)){montantsSaisisCorrects=false;$('#inpt_modifAcompteResaProp').addClass('errSaisie');$('.sp_msgErrMontantPercuRegltCB').show();}}
if($('#inpt_resaBureauIntention:visible').length>0){if($('#inpt_resaBureauIntention').attr('checked')=='checked'){etatDossierIntention='O';}}else if($('.inpt_resaBureauIntention:visible').length>0){if($('.inpt_resaBureauIntention:visible').attr('checked')==='checked'){etatDossierIntention='O';}}
var nouvelleDateLimite='';if($('#inpt_nouvelleDateLimite:visible').length>0){nouvelleDateLimite=$('#inpt_nouvelleDateLimite').val();if(!regexDate.test(nouvelleDateLimite)){montantsSaisisCorrects=false;$('#inpt_nouvelleDateLimite').addClass('errSaisie');}}
if(casesCochees()===true&&montantsSaisisCorrects){$.ajax({type:"POST",url:urlAJAX,data:{type:"affectAutrePaiement",nouveauFraisDossier:nouveauFraisDossier,nouvelAcompte:nouvelAcompte,nouveauxPrixOptions:nouveauxPrixOptions,montantPercu:montantPercu,typeResaProp:typeResaProp,prixLocation:prixLocation,tabPrixChambre:tabPrixChambre,etatDossierIntention:etatDossierIntention,nouvelleDateLimite:nouvelleDateLimite,avecEnvoiMailPaiement:avecEnvoiMailPaiement,forceDossierIntention:forceDossierIntention},beforeSend:function(){},success:function(result){$('.a_btnAttenteConfirm').hide();$('.a_btChoixPaiement').show();$('.div_validePaiementSansPaiement>button').show();eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(estResaConfirmation){traiteReservationAvecConfirmation();return;}
if(estResaDureeLimitee){traiteReservationDureeLimitee();return;}
if(location.search.indexOf("PHPSESSID")>-1){location.href="etape4.php"+location.search;}else{location.href="etape4.php"+location.search+"&"+idSession;}}
else{alertAMalibu(tabResult.msg);}}}});}
else{$(".a_btnAttenteConfirm").hide();$(".a_btChoixPaiement").show();$('.div_valideResaConfirmation').show();$('.div_validePaiementSansPaiement>button').show();$('#div_btnsResaProp_centrale .div_msgErreurs, #div_btnsResaProp_centrale .div_msgErreurs p').show('fast');$('#div_btnsResaProp_LD .div_msgErreurs, #div_btnsResaProp_LD .div_msgErreurs p').show('fast');$('.div_valideResaConfirmation').show();}});$('.div_validePaiementDemandeResa>button').unbind('click');$('.div_validePaiementDemandeResa>button').bind('click',function(){if(casesCochees()){if(location.search.indexOf("PHPSESSID")>-1){location.href="etape4.php"+location.search+"&DEMANDERESA=1";}else{location.href="etape4.php"+location.search+"&"+idSession+"&DEMANDERESA=1";}}});$('#spanModiferMontantVersement').click(function(){$('#input_montantVersement').removeAttr('disabled');});$('input[name=choixPaiementCB]').click(function(){if($('#div_saisieCB_centralPay').length>0){gereActionsChoixMontantLibre(this);}
else{if($(this).is('#inpt_choixPaiementCB_montantLibre')){$('#input_montantVersement').removeAttr('disabled');}else{$('#input_montantVersement').attr('disabled','disabled');}}});if(typeof gereModifChoixMontantLibre==='function'){gereModifChoixMontantLibre();}
$("#a_btChoixPaiementReserver, #a_btChoixPaiementANCV").click(function(){var typePaiement=$(this).data('typepaiement')||'';valideReservationAvecPaiement(typePaiement);});initPopinConfirmeEANCV();$("#a_btChoixPaiementAcompte, #a_btChoixPaiementAcompteANCV").click(function(){var typePaiement=$(this).data('typepaiement')||'';$(".a_btChoixPaiement").hide();$(".a_btnAttenteConfirm").show();if(casesCochees()===true){$.ajax({type:"POST",url:urlAJAX,data:{type:"affectPaiementCB",choixPaiement:"acompte",typePaiement:typePaiement},beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){majFormPaybox(tabResult);validerFormulairePaybox();}
else{alertAMalibu(tabResult.msg);}}}});}
else{$(".a_btnAttenteConfirm").hide();$(".a_btChoixPaiement").show();}});$("#div_btnConfirmer > a").click(function(){$(this).hide();$(".a_btnAttenteConfirm").show();if(casesCochees()===true){var urlHref="etape"+$('#div_btnConfirmer').attr('data-idPageNext')+".php";if(location.search.indexOf("PHPSESSID")>-1)
urlHref+=location.search;else
urlHref+=location.search+"&"+idSession;document.location=urlHref;}
else{$(".a_btnAttenteConfirm").hide();$(this).show();}});if($('.div_choixResaProp').length>0){$('.div_choixResaProp a').click(function(){$('.div_choixResaProp a').removeClass('actif');$(this).addClass('actif');var divAAfficher=$('#'+$(this).attr('data-div'));var divACacher=$('.'+$('.div_choixResaProp').attr('data-divtohide'));divACacher.hide();divAAfficher.show();majRecapPrixChoixResaProp($(this).data('type'));});}
init_btnsAfficheDetailsMoyensPaiements();if(typeof initSaisieCB_centralPay!=='undefined'){initSaisieCB_centralPay();}
if(typeof initSaisieANCV_CVCO!=='undefined'){initSaisieANCV_CVCO(false);}
if($('.div_unPaiementPossible').length>0){$('.div_unPaiementPossible > div.titre').bind('click',function(){$('.div_unPaiementPossible').removeClass('open');$(this).parent().addClass('open');});}
initChoixPaiementAncv();$('.inpt_modifPrixChambreCentraleProp, #inpt_modifPrixCentraleProp, #inpt_modifFDResaProp').change(function(){updateAffichagePrixBuroProp();});initModalTaxeSejour();initActionsMotMagique(true);})(jQuery);}
function traiteReservationAvecConfirmation(){var tabParams={};(function($){tabParams['processus']=$("input:radio[name='resaConfirmation_processus']:checked").val();tabParams['nbminutes_delai_client']=$('#resaConfirmation_delaiReponseClient').val();tabParams['nbminutes_delai_prop']=$('#resaConfirmation_delaiReponseProp').val();tabParams['type_notif_client']=$("input:radio[name='resaConfirmation_typeNotificationClient']:checked").val();tabParams['notif_client_refus_prop']=$("input:radio[name='resaConfirmation_notifRefus']:checked").val();tabParams['type']='enregistreInfosResaConfirmation';$.ajax({type:"POST",url:urlAJAX,data:tabParams,success:function(result){if(result==='OK'){if(location.search.indexOf("PHPSESSID")>-1){location.href="etape4.php"+location.search;}else{location.href="etape4.php"+location.search+"&"+idSession;}}else{alertAMalibu('La rservation a bien t cre en intention mais une erreur est survenue lors de l\'enregistrement du paramtrage. \n\
                    Vous pouvez paramtr les dlais et le processus depuis le dtail du dossier du bureau ITEA.',location.href="etape4.php"+location.search);}}});})(jQuery);}
function traiteReservationDureeLimitee(){var tabParams={};(function($){tabParams['processus']=$("input:radio[name='resaDureeLimitee_processus']:checked").val();tabParams['nbminutes_delai_client']=$('#resaDureeLimitee_delaiReponseClient').val();tabParams['type_notif_client']=$("input:radio[name='resaDureeLimitee_typeNotificationClient']:checked").val();tabParams['type']='enregistreInfosResaConfirmation';$.ajax({type:"POST",url:urlAJAX,data:tabParams,success:function(result){if(result==='OK'){if(location.search.indexOf("PHPSESSID")>-1){location.href="etape4.php"+location.search;}else{location.href="etape4.php"+location.search+"&"+idSession;}}else{alertAMalibu('La rservation a bien t cre en intention mais une erreur est survenue lors de l\'enregistrement du paramtrage. \n\
                    Vous pouvez paramtr les dlais et le processus depuis le dtail du dossier du bureau ITEA.',location.href="etape4.php"+location.search);}}});})(jQuery);}
function valideChampsReservationAvecConfirmation(){var estValide=true;(function($){if($('#div_paiementPossible_resaConfirmation').length===0){retour=false;}
if($('#resaConfirmation_delaiReponseProp').val()==''||$('#resaConfirmation_delaiReponseClient').val()==''){estValide=false;}
if(!$("input:radio[name='resaConfirmation_typeNotificationClient']").is(":checked")){estValide=false;}
if(!$("input:radio[name='resaConfirmation_processus']").is(":checked")){estValide=false;}
if(estValide){$('#div_msgErreurChampsResaConfirmation').hide();}else{$('#div_msgErreurChampsResaConfirmation').show();$('.div_valideResaConfirmation').show();}})(jQuery);return estValide;}
function valideChampsReservationDureeLimitee(){var estValide=true;(function($){if($('#resaDureeLimitee_delaiReponseClient').val()==''){estValide=false;}
if(!$("input:radio[name='resaDureeLimitee_typeNotificationClient']").is(":checked")){estValide=false;}
if(estValide){$('#div_msgErreurChampsResaDureeLimitee').hide();}else{$('#div_msgErreurChampsResaDureeLimitee').show();$('.div_valideResaDureeLimitee').show();}})(jQuery);return estValide;}
function initChangeMontantsCentralPayByOngletResaProp(){(function($){$('.a_ongletResaProp').on('click',function(){var type=$(this).data('type');if(type==='LD'){updateAffichagePaiementCentralPayBuroPropResaLD();showAndHidePaiementOptionsForPaiementLDSurBuroProp();}else{updateAffichagePrixBuroProp();showAndHidePaiementOptionsForPaiementCentraleSurBuroProp();}});$('.a_ongletResaProp.actif').click();})(jQuery);}
function showAndHidePaiementOptionsForPaiementCentraleSurBuroProp(){(function($){$('.pourPaiementLD').hide();$('input[name="choixPaiementCB"][value="montantlibre"]').closest('div').hide();$('#inpt_valideAutorisationPriseGarantie').closest('div').hide();})(jQuery);}
function showAndHidePaiementOptionsForPaiementLDSurBuroProp(){(function($){$('.pourPaiementLD').show();$('input[name="choixPaiementCB"][value="montantlibre"]').closest('div').show();$('#inpt_valideAutorisationPriseGarantie').closest('div').show();})(jQuery);}
function initChoixPaiementAncv(){(function($){if($('#div_paiementPossibleANCV').length===0){return;}
var width=$(window).width()-100;$('#div_popinPaiementEAncv').dialog({modal:true,autoOpen:false,width:'auto',height:'auto',maxWidth:width});$('input[name="choixTypeAncv"]').on('change',function(){if($('#maintenanceAncvCvco').length===0){return;}
if($(this).val()==='cvco'){$('#maintenanceAncvCvco').show();$('#btn_choixANCV').hide();}else if($(this).val()==='eancv'){$('#maintenanceAncvCvco').hide();$('#btn_choixANCV').show();}});$('#btn_choixANCV').on('click',function(){var typeAncv=$('input[name="choixTypeAncv"]:checked').val();if(typeAncv==='eancv'){$('#div_popinPaiementEAncv').dialog('open');}else if(typeAncv==='cvco'){$('#div_popinPaiementAncvCvco').dialog('open');}});})(jQuery);}
function valideReservationAvecPaiement_old(typePaiement){(function($){$(".a_btChoixPaiement").hide();$(".a_btnAttenteConfirm").show();$('#div_btnsResaProp_LD .div_msgErreurs, #div_btnsResaProp_LD .div_msgErreurs p, #div_btnsResaProp_LD .sp_msgErreur').hide();var nouveauFraisDossier=null,nouveauPrixLocation=null,tabPrixChambre=[];var montantsSaisisCorrects=true;var regexMontants=new RegExp('^[0-9]+\.?[0-9]{0,2}$');if($('#inpt_modifFDResaProp').length>0){nouveauFraisDossier=$('#inpt_modifFDResaProp').val();if(!regexMontants.test(nouveauFraisDossier)){montantsSaisisCorrects=false;$('#inpt_modifFDResaProp').addClass('errSaisie');$('.sp_msgSaisieMontantErronee').show();}
if($('#inpt_modifFDResaProp').attr('data-typemodif')!=='A'){if(parseFloat(nouveauFraisDossier)>parseFloat($('#inpt_modifFDResaProp').attr('data-value'))){montantsSaisisCorrects=false;$('#inpt_modifFDResaProp').addClass('errSaisie');$('.sp_msgSaisieMontantErronee').show();}}}
if($('#inpt_modifPrixCentraleProp').length>0){var prixLocationReference=$('#inpt_modifPrixCentraleProp').attr('data-prixReference');nouveauPrixLocation=$('#inpt_modifPrixCentraleProp').val();if(!regexMontants.test(nouveauPrixLocation)){$('.sp_msgSaisieMontantErronee').show();montantsSaisisCorrects=false;$('#inpt_modifPrixCentraleProp').addClass('errSaisie');}
if(parseFloat(nouveauPrixLocation)>parseFloat(prixLocationReference)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantSuperieur').show();$('#inpt_modifPrixCentraleProp').addClass('errSaisie');}}
if($('.inpt_modifPrixChambreCentraleProp').length>0){var nbChambresModif=0;$('.inpt_modifPrixChambreCentraleProp').each(function(){var numeroChambre=$(this).attr('data-numeroChambre');var prixChambre=$(this).val();var prixReference=$('#prixChambreCentralePropReference_'+numeroChambre).val();if(!regexMontants.test(prixChambre)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantErronee').show();$(this).addClass('errSaisie');}else if(parseFloat(prixChambre)>parseFloat(prixReference)){montantsSaisisCorrects=false;$('.sp_msgSaisieMontantSuperieur').show();$(this).addClass('errSaisie');}
else{tabPrixChambre[nbChambresModif]={numeroChambre:numeroChambre,prixChambre:prixChambre};}
nbChambresModif++;});}
var montantPaiement=null;if($('#input_montantVersement').length>0){montantPaiement=$('#input_montantVersement').val();if(!regexMontants.test(montantPaiement)){montantsSaisisCorrects=false;$('#input_montantVersement').addClass('errSaisie');$('.sp_msgSaisieMontantErronee').show();}
var solde=$('#input_montantVersement').attr('data-solde');if(parseFloat(montantPaiement)>parseFloat(solde)){montantsSaisisCorrects=false;$('#input_montantVersement').addClass('errSaisie');$('.sp_msgSaisieMontantSuperieur').show();}
if(!montantsSaisisCorrects){$('#div_btnPaiementCb .div_msgErreurs').show('fast');}}
var choixPaiement='';if($('.div_choixMontantPayer:visible').length>0){choixPaiement=$('input[name=choixPaiementCB]:visible:checked').val();if(choixPaiement!=='montantlibre'){montantPaiement=null;}}
if(casesCochees()===true&&montantsSaisisCorrects){affectPaiementCB(nouveauPrixLocation,nouveauFraisDossier,tabPrixChambre,montantPaiement,typePaiement,choixPaiement);}
else{$(".a_btnAttenteConfirm").hide();$(".a_btChoixPaiement").show();$('#div_btnsResaProp_centrale .div_msgErreurs, #div_btnsResaProp_centrale .div_msgErreurs p').show('fast');$('#div_boutonsResaProp_centrale .div_msgErreurs, #div_boutonsResaProp_centrale .div_msgErreurs p').show('fast');reactiveBoutonsPaiement();}})(jQuery);}
function valideReservationAvecPaiement(typePaiement){(function($){$(".a_btChoixPaiement").hide();$(".a_btnAttenteConfirm").show();$('#div_btnsResaProp_LD .div_msgErreurs, #div_btnsResaProp_LD .div_msgErreurs p, #div_btnsResaProp_LD .sp_msgErreur').hide();var objPrix={montantsSaisisCorrects:true,nouveauFraisDossier:null,nouveauPrixLocation:null,montantPaiement:null,montantAcompte:null,montantPercu:null,dateLimite:null,choixPaiement:'',tabPrixChambre:[]};var objInputs=getInputsByTypeResa();var inputMontantFD=objInputs.inputsCentrale.montantFd;if(inputMontantFD.length>0){objPrix.nouveauFraisDossier=inputMontantFD.val();getErrSaisieMontantErrone(objPrix.nouveauFraisDossier,objPrix,inputMontantFD);if(inputMontantFD.attr('data-typemodif')!=='A'){var montantReferenceFD=inputMontantFD.attr('data-value');getErrSaisieMontantSuperieur(objPrix.nouveauFraisDossier,montantReferenceFD,objPrix,inputMontantFD);}}
if(estEnPaiementLD()){getNouveauMontantResaProp(objPrix,'nouveauPrixLocation',objInputs.inputsLD.montantLoc);getNouveauPrixLocationChambreResaProp(objPrix,objInputs.inputsLD.montantLocChambre);var prixTotal=(parseFloat($('#inpt_prixTotalResaProp').val())-parseFloat($('#inpt_prixLocResaProp').val()))+parseFloat(objInputs.inputsLD.montantLoc.val());getNouveauMontantResaProp(objPrix,'montantAcompte',objInputs.inputsLD.montantAcompte,prixTotal);getNouveauMontantResaProp(objPrix,'montantPercu',objInputs.inputsLD.montantPercu,prixTotal);if(objInputs.inputsLD.dateLimite.length>0){objPrix.dateLimite=objInputs.inputsLD.dateLimite.val();getErrSaisieDateErrone(objInputs.inputsLD.dateLimite.val(),objPrix,objInputs.inputsLD.dateLimite);}}else{var valReferencePrixLoc=objInputs.inputsCentrale.montantLoc.attr('data-prixReference');getNouveauMontantResaProp(objPrix,'nouveauPrixLocation',objInputs.inputsCentrale.montantLoc,valReferencePrixLoc);getNouveauPrixLocationChambreResaProp(objPrix,objInputs.inputsCentrale.montantLocChambre);}
var inputVersement=$('#input_montantVersement');if(inputVersement.is(':visible')){var valRefVersement=inputVersement.attr('data-solde');getNouveauMontantResaProp(objPrix,'montantPaiement',inputVersement,valRefVersement);if(inputVersement.length>0&&!objPrix.montantsSaisisCorrects){$('#div_btnPaiementCb .div_msgErreurs').show('fast');}}
if($('.div_choixMontantPayer:visible').length>0){objPrix.choixPaiement=$('input[name=choixPaiementCB]:visible:checked').val();if(objPrix.choixPaiement!=='montantlibre'){objPrix.montantPaiement=null;}}
if(casesCochees()===true&&objPrix.montantsSaisisCorrects){affectPaiementCB(objPrix.nouveauPrixLocation,objPrix.nouveauFraisDossier,objPrix.tabPrixChambre,objPrix.montantPaiement,typePaiement,objPrix.choixPaiement,objPrix.montantAcompte,objPrix.montantPercu,objPrix.dateLimite);}else{$(".a_btnAttenteConfirm").hide();$(".a_btChoixPaiement").show();$('#div_btnsResaProp_centrale .div_msgErreurs, #div_btnsResaProp_centrale .div_msgErreurs p').show('fast');$('#div_boutonsResaProp_centrale .div_msgErreurs, #div_boutonsResaProp_centrale .div_msgErreurs p').show('fast');reactiveBoutonsPaiement();}})(jQuery);}
function getNouveauMontantResaProp(objPrix,labelMontant,input,valReference){if(input.length===0){return;}
var val=input.val();objPrix[labelMontant]=val;getErrSaisieMontantErrone(val,objPrix,input);if(!isNullOrUndefinedOrEmpty(valReference)){getErrSaisieMontantSuperieur(val,valReference,objPrix,input);}}
function getNouveauPrixLocationChambreResaProp(objPrix,inputs){(function($){if(inputs.length===0){return;}
var nbChambresModif=0;inputs.each(function(){var numeroChambre=$(this).attr('data-numeroChambre');var prixChambre=$(this).val();objPrix.tabPrixChambre[nbChambresModif]={numeroChambre:numeroChambre,prixChambre:prixChambre};var prixReference=$('#prixChambreCentralePropReference_'+numeroChambre).val();getErrSaisieMontantErrone(prixChambre,objPrix,$(this));getErrSaisieMontantSuperieur(prixChambre,prixReference,objPrix,$(this));nbChambresModif++;});})(jQuery);}
function getErrSaisieMontantErrone(montant,objPrix,input){var regexMontant=new RegExp('^[0-9]+\.?[0-9]{0,2}$');if(!regexMontant.test(montant.toString())){objPrix.montantsSaisisCorrects=false;input.addClass('errSaisie');jQuery('.sp_msgSaisieMontantErronee').show();}}
function getErrSaisieMontantSuperieur(montantSaisi,montantReference,objPrix,input){if(parseFloat(montantSaisi)>parseFloat(montantReference)){objPrix.montantsSaisisCorrects=false;input.addClass('errSaisie');jQuery('.sp_msgSaisieMontantSuperieur').show();}}
function getErrSaisieDateErrone(date,objPrix,input){var regexDate=new RegExp('^[0-9]{2}/[0-9]{2}/[0-9]{4}$');if(!regexDate.test(date)){objPrix.montantsSaisisCorrects=false;input.addClass('errSaisie');}}
function getInputsByTypeResa(){var objInputs={};(function($){var objInputsCentrale={};var objInputsLD={};objInputsCentrale.montantFd=$('#inpt_modifFDResaProp:visible');objInputsCentrale.montantLoc=$('#inpt_modifPrixCentraleProp');objInputsLD.montantLoc=$('#inpt_modifPrixLocationResaProp');objInputsCentrale.montantLocChambre=$('.inpt_modifPrixChambreCentraleProp');objInputsLD.montantLocChambre=$('.inpt_modifPrixChambreResaProp');objInputsLD.montantAcompte=$('#inpt_modifAcompteResaProp:visible');objInputsLD.montantPercu=$('#inpt_modifMontantPercu:visible');objInputsLD.dateLimite=$('#inpt_nouvelleDateLimite:visible');objInputs.inputsCentrale=objInputsCentrale;objInputs.inputsLD=objInputsLD;})(jQuery);return objInputs;}
function estEnPaiementLD(){var estEnPaiementLD=true;(function($){if(!estSurBureauProprietaire()){estEnPaiementLD=false;return;}
if($('#peutFairePaiementLD').length===0){estEnPaiementLD=false;return;}
if($('.div_choixResaProp').length>0&&$('.a_ongletResaProp[data-type="LD"]').hasClass('actif')===false){estEnPaiementLD=false;return;}})(jQuery);return estEnPaiementLD;}
function affectPaiementCB(nouveauPrixLocation,nouveauFraisDossier,tabPrixChambre,montantPaiement,typePaiement,choixPaiement,nouveauMontantAcompte,nouveauMontantPercu,nouvelleDateLimite){(function($){var params={type:"affectPaiementCB"};if(nouveauPrixLocation!==null){params.prixLocation=nouveauPrixLocation;}
if(nouveauFraisDossier!==null){params.nouveauFraisDossier=nouveauFraisDossier;}
if(tabPrixChambre.length>0){params.tabPrixChambre=tabPrixChambre;}
if(montantPaiement){params.MONTANT_PAIEMENT=$('#input_montantVersement').val();}
if(estEnPaiementLD()){params.typeResa='locationDirecte';}
if(nouveauMontantAcompte!==null){params.nouvelAcompte=nouveauMontantAcompte;}
if(nouveauMontantPercu!==null){params.montantPercu=nouveauMontantPercu;}
if(nouvelleDateLimite!==null){params.nouvelleDateLimite=nouvelleDateLimite;}
params.typePaiement=typePaiement;params.choixPaiement=choixPaiement;jQuery.ajax({type:"POST",url:urlAJAX,data:params,beforeSend:function(){afficheLoaderGlobal_site();},success:function(result){eval("var tabResult="+result);effaceLoaderGlobal_site();if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(tabResult.centralPay==='O'){console.log('affectPaiementCB tabResult : ',tabResult);$('#div_saisieCB_centralPay #inpt_idObjet').val(tabResult.idObjet);$('#inpt_idObjetANCV').val(tabResult.idObjet);$('#div_saisieCB_centralPay #inpt_montantCB').val(tabResult.montant);valideSaisieCB_centralPay(tabResult.idObjet,tabResult.montant);lanceTimerVerificationDureeEtatV(tabResult.idObjet);$('#div_paiementPossibleEANCV').hide();$('input[name=choixPaiementCB]').attr('disabled','disabled');}else if(tabResult.ancvCvco==='O'){valideSaisieANCV_CVCO(tabResult);$('.formCentralPay').formCentralPay('setMontantEtIdObjet',tabResult.montant,tabResult.idObjet);}else{majFormPaybox(tabResult);if(window.foncQdFini_redirigePagePaiement){foncQdFini_redirigePagePaiement();}
validerFormulairePaybox();}}
else{if(tabResult.ancvCvco==='O'){afficherErreurInitialisationAncvCvco(tabResult);}else{alertAMalibu(tabResult.msg);}
reactiveBoutonsPaiement();}}}});})(jQuery);}
function creerObjetPayablePourPaiementCentralPay(){valideReservationAvecPaiement('CENTRALPAY');}
function majObjetPayablePourPaiementCentralPay(){valideReservationAvecPaiement('CENTRALPAY');}
function creerObjetPayablePourPaiementAncvCVCO(){valideReservationAvecPaiement('ANCV_CVCO');}
function lanceTimerVerificationDureeEtatV(idObjet){if(modifieResaExistante()){return;}
setTimeout(function(){verificationDureeEtatV(idObjet);},60000);}
function verificationDureeEtatV(idObjet){var tabIdObjet=idObjet.split('_');var instance=tabIdObjet[0];var exercice=tabIdObjet[2];jQuery.ajax({type:'POST',url:'/lib_2/ajax/passerelleBureauLocal.php',data:{url:'lib_bureau/ajax/centralPay.php',instance:instance,exercice:exercice,idObjet:idObjet,action:'verificationDureeEtatV'},success:function(result){if(result==='KO'){var urlEtape4='etape4.php'+location.search+'&CentralPay=KO&dureeEtatV=KO';if(location.search.indexOf("PHPSESSID")<=-1){urlEtape4+='&'+idSession;}
location.href=urlEtape4;}
if(result==='ETAT_OK'){var urlEtape4='etape4.php'+location.search;if(location.search.indexOf("PHPSESSID")<=-1){urlEtape4+='&'+idSession;}
location.href=urlEtape4;}},error:function(repJSON){console.log(repJSON);},complete:function(){lanceTimerVerificationDureeEtatV(idObjet);}});}
function retourValidationPaiementCB_centralPay(params){afficheLoaderGlobal_site();var query='centralPay=OK';if(params===true||params.pbCaution===true){query+='&pbCaution=O';}
if((jQuery('#inpt_valideAutorisationDebitSolde')&&jQuery('#inpt_valideAutorisationDebitSolde').is(':checked'))||params.avecDebitSoldeAuto){query+='&avecDebitSolde=O';}
if((jQuery('#inpt_valideAutorisationPriseDeCaution')&&jQuery('#inpt_valideAutorisationPriseDeCaution').is(':checked'))||params.avecCaution){query+='&avecCaution=O';}
if(!estSurResa()){var urlReload=location.href;if(location.search.length===0){urlReload+='?'+query;}else{urlReload+='&'+query;}
location.href=urlReload;return;}
var urlEtape4='etape4.php'+location.search+'&'+query;if(location.search.indexOf("PHPSESSID")<=-1){urlEtape4+='&'+idSession;}
location.href=urlEtape4;}
function retourValidationPaiementANCV_CVCO(montantPaye){afficheLoaderGlobal_site();if(!estSurResa()){getPopinConfirmationPaiementCompteCli(montantPaye);var urlReload=location.href;if(location.search.length===0){urlReload+='?ancvCvco=OK';}else{urlReload+='&ancvCvco=OK';}
location.href=urlReload;return;}
var urlEtape4='etape4.php'+location.search+'&ancvCvco=OK';if(location.search.indexOf("PHPSESSID")<=-1){urlEtape4+='&'+idSession;}
location.href=urlEtape4;}
function envoiMailControlCentralPaySurCompteCli(){(function($){$.ajax({type:"POST",url:urlAJAX,data:{type:'envoiMailControlCentralPaySurCompteCli',idObjCentralPayCompteCli:$('#inpt_idObjet').val()}});})(jQuery);}
function retourErreurPaiementCB_centralPay(sourceErreur){if(estSurFlux()){var urlReload=location.href;if(location.search.length===0){urlReload+='?centralPay=KO';}else{urlReload+='&centralPay=KO';}
location.href=urlReload;return;}
if(!estSurResa()){return;}
afficheLoaderGlobal_site();var urlEtape4='etape4.php'+location.search+'&centralPay=KO&sourceErreur='+sourceErreur;if(location.search.indexOf("PHPSESSID")<=-1){urlEtape4+='&'+idSession;}
location.href=urlEtape4;}
function initPopinConfirmeEANCV(){(function($){$("#a_btChoixPaiementPopinEANCV").fancybox({maxWidth:800,maxHeight:600,fitToView:false,width:'90%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});$("#a_btChoixPaiementPopinEANCVacompte").fancybox({maxWidth:800,maxHeight:600,fitToView:false,width:'90%',autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none'});$(".a_btnConfirmeChoixEANCV").click(function(){$("#a_btChoixPaiementANCV").trigger('click');$.fancybox.close();});$(".a_btnConfirmeChoixEANCVacompte").click(function(){$("#a_btChoixPaiementAcompteANCV").trigger('click');$.fancybox.close();});$(".a_btnAnnuleChoixEANCV").click(function(){if($('#div_popinPaiementAncvCvco')){$('#div_popinPaiementAncvCvco').dialog('close');}
$.fancybox.close();});$(".a_btnAnnuleChoixEANCV_etPayeCB").click(function(){if($('#div_popinPaiementAncvCvco')){$('#div_popinPaiementAncvCvco').dialog('close');}
$("#a_btChoixPaiementReserver").trigger('click');$.fancybox.close();});$(".a_btnAnnuleChoixEANCV_etPayeCBacompte").click(function(){if($('#div_popinPaiementAncvCvco')){$('#div_popinPaiementAncvCvco').dialog('close');}
$("#a_btChoixPaiementAcompte").trigger('click');$.fancybox.close();});})(jQuery);}
function initEtape3_vendeur(){(function($){if($('.inputMontantReglementPV').length>0){$('.inputMontantReglementPV').each(function(){var id=$(this).attr('id');validate=new LiveValidation(id,{validMessage:'Ok'});validate.add(Validate.Custom,{against:function(value,args){var val=value;var pattern=/^[0-9]+(?:\.[0-9]+)?$/;if(val.match(pattern)){return true;}
return false;},failureMessage:'Entrez un montant valide'});});$('.inputMontantReglementPV').keyup(function(){verifReglementPV(this);});}
$('.a_btValideResaVendeur[data-moderesa="resa"]').click(function(){$('.a_btValideResaVendeur').hide();if(verifReglementPV()&&$('.LV_invalid_field').length==0){if(casesCochees()===true){$('.a_btnAttenteConfirm').show();var query=$('#formPaiementPV').serialize();valideResaVendeur(query);}}
else{$('.a_btValideResaVendeur').show();}});$('.a_btValideResaVendeur[data-moderesa="option"]').click(function(){$('.a_btValideResaVendeur').hide();$('.a_btnAttenteConfirm').show();if(casesCochees()===true){valideResaVendeur();}});$('.a_btValideResaVendeur[data-moderesa="devis"]').click(function(){$('.a_btValideResaVendeur').hide();$('.a_btnAttenteConfirm').show();valideResaVendeur();});})(jQuery);}
function valideResaVendeur(query){(function($){var params=query||'';params+='&type=valideResaVendeur';$.ajax({type:"POST",url:urlAJAX,data:params,beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(!tabResult.cle&&!$('#inputPaiementCB').val()){if(location.search.indexOf("PHPSESSID")>-1){location.href="etape4.php"+location.search;}else{location.href="etape4.php"+location.search+"&"+idSession;}}
else{majFormPaybox(tabResult);validerFormulairePaybox();}}
else{alertAMalibu(tabResult.msg);}}}});})(jQuery)}
function verifReglementPV(input){var out=true;(function($){$('#div_msgErreursNombreReglementsCB').hide();$('#div_msgErreursNombreReglements').hide();$('#div_msgErreursTotalReglement').hide();$('#div_msgErreursTotalSupReglement').hide();var elemCurr=input||null;var prix=parseFloat($('#formPaiementPV').attr('data-montant'));var total=0;var nbPaiementsCB=0;var nbPaiements=0;$('.inputMontantReglementPV').each(function(){if($(this).val().length>0){if($(this).attr('name')=='paiementCB'||$(this).attr('name')=='paiementPV_PVB'){nbPaiementsCB++;}
nbPaiements++;var value=parseFloat($(this).val());total+=Math.round(value*100);}});if(nbPaiementsCB>1){if(elemCurr){$(elemCurr).val('');}
$('#div_msgErreursNombreReglementsCB').show();}
else{if(nbPaiements>4){$('#div_msgErreursNombreReglements').show();out=false;}
else{if((prix-total)<0){$('#div_msgErreursTotalSupReglement').show();out=false;}
else{$('#inputTotalReglementPV').val(total);$('#spanTotalReglementPV').html(total/100);$('#inputResteReglementPV').val(prix-total);$('#spanResteReglementPV').html((prix-total)/100);if((prix-total)!==0){out=false;if(!elemCurr){$('#div_msgErreursTotalReglement').show();}}}}}})(jQuery);return out;}
function initEtape3_agence(){(function($){$(document).ready(function(){idSession=getIdSessionInHtml();});initBtnsFooter();$('#inpt_mailAgence').keyup(function(){var regex=new RegExp("[^@\s]+@[-a-z0-9]*\\.[a-z]{2,}");var mail=$(this).val();if(regex.test(mail)){$('.sp_msgMailAgence.ok').show();$('.sp_msgMailAgence.ko').hide();}else{$('.sp_msgMailAgence.ko').show();$('.sp_msgMailAgence.ok').hide();}});$(".a_btValideResaAgence").click(function(){$(".a_btValideResaAgence").hide();$(".a_btnAttenteConfirm").show();if(!verifQuestionnairesClient()){$(".a_btnAttenteConfirm").hide();$(this).show();document.location="#div_uneEtape_questionnaires";return;}
enregistreReponsesQuestionnairesClient();var modeResa=$(this).attr('data-moderesa');var mailAgence=$('#inpt_mailAgence').val();var regex=new RegExp("[^@\s]+@[-a-z0-9]*\\.[a-z]{2,}");if(!regex.test(mailAgence)){mailAgence='';}
var nomClient='';if($('#inpt_nomClient').length>0){var tabValidation=[];var nom=new LiveValidation("inpt_nomClient",{validMessage:$("#inpt_msgOk").val()});nom.add(Validate.Presence,{failureMessage:$("#inpt_msgVide").val()});tabValidation.push(nom);if(!LiveValidation.massValidate(tabValidation)){$(".a_btnAttenteConfirm").hide();$(".a_btValideResaAgence").show('fast');$("#div_msgErreursInfosClient").show('fast');document.location="#div_msgErreursInfosClient";return false;}
nomClient=$('#inpt_nomClient').val();}
var nouveauPrix;if($('#inpt_modifPrixLocationResaAgence').length>0||$('.inputModifPrixChambre').length>0){var tabValidation=[];var inputs=$('#inpt_modifPrixLocationResaAgence')[0]||$('.inputModifPrixChambre');var nouveauPrix;var erreurDeSaisie=false;$(inputs).each(function(){if($(this).val()!==''){var prixBase=$(this).attr('data-prix');if(!$(this).val().match(/^[0-9]{1,}(\.|,){0,1}[0-9]{0,2}$/g)||parseFloat(prixBase)<parseFloat($(this).val())){$(".a_btnAttenteConfirm").hide();$(".a_btValideResaAgence").show('fast');if(!$(this).val().match(/^[0-9]{1,}(\.|,){0,1}[0-9]{0,2}$/g)){$("#div_msgErreursFormatLocation").show('fast');}
if(parseFloat(prixBase)<parseFloat($(this).val())){$("#div_msgErreursMontantLocation").show('fast');}
document.location="#div_msgErreursMontantLocation";erreurDeSaisie=true;}
if($(this).attr('id')=='inpt_modifPrixLocationResaAgence'){nouveauPrix=$('#inpt_modifPrixLocationResaAgence').val();}
else{nouveauPrix=nouveauPrix||{};nouveauPrix[$(this).attr('data-numChambre')]=$(this).val();}}});}
if(erreurDeSaisie){return false;}
$.ajax({type:"POST",url:urlAJAX,data:{type:"valideResaAgence",modeResa:modeResa,mailAgence:mailAgence,nomClient:nomClient,nouveauPrix:nouveauPrix},success:function(result){eval("var tabResult="+result);if(tabResult.code==errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}
else{if(tabResult.code=="OK"){if(location.search.indexOf("PHPSESSID")>-1)
location.href="etape4.php"+location.search;else
location.href="etape4.php"+location.search+"&"+idSession;}
else{alertAMalibu(tabResult.msg);}}}});});initQuestionnaireClient();})(jQuery);}
function casesCochees(){var retour=false;(function($){if($("#inpt_valideDocFiche").length>0&&$("#inpt_valideDocFiche").attr("checked")!="checked"){$("#div_msgErreursDocs").show();$("#sp_msgErreurFiche").show();if(typeof(dataLayer)!='undefined'){dataLayer.push({'ErrorMessage':'Descriptif_Hebergement','event':'resa3_erreur'});}}else{$("#sp_msgErreurFiche").hide();}
if($("#inpt_valideDocCgv").length>0&&$("#inpt_valideDocCgv").attr("checked")!="checked"){$("#div_msgErreursDocs").show();$("#sp_msgErreurCgv").show();if(typeof(dataLayer)!='undefined'){dataLayer.push({'ErrorMessage':'CGV','event':'resa3_erreur'});}}else{$("#sp_msgErreurCgv").hide();}
if($("#inpt_valideDocCga").length>0&&$("#inpt_valideDocCga").attr("checked")!="checked"){$("#div_msgErreursDocs").show();$("#sp_msgErreurCga").show();if(typeof(dataLayer)!='undefined'){dataLayer.push({'ErrorMessage':'CGA','event':'resa3_erreur'});}}else{$("#sp_msgErreurCga").hide();}
if($("#sp_msgErreurFiche").is(':hidden')&&$("#sp_msgErreurCgv").is(':hidden')&&$("#sp_msgErreurCga").is(':hidden')){retour=true;}else{$('html, body').animate({scrollTop:0},1000);}})(jQuery);return retour;}
function initEtape4(){(function($){$(document).ready(function(){idSession=getIdSessionInHtml();});initBtnsFooter();if(estMultiResa()){window.addEventListener('message',function(event){var retour=JSON.parse(event.data)||false;if(retour.link){$('#a_btnSuiteMultiResa').attr('data-link',retour.link);$('#div_btnRetourSite').hide();$('#div_btnSuiteMultiResa').show('fast');}},false);var ident=$('#a_btnSuiteMultiResa').attr('data-prodBooked');window.opener.postMessage(JSON.stringify({prodBooked:ident}),'*');$('#a_btnSuiteMultiResa').click(function(){var link=$(this).attr('data-link')||false;if(link){document.location=link;}});}
if($("#a_btnRetourBureauItea").length>0){$("#a_btnRetourBureauItea").click(function(){window.close();});}
if($("#div_btnModifPrix").length>0){$("#div_btnModifPrix").hide();}
initModalTaxeSejour();})(jQuery);}
function getXHTML_recapOptionsAnimaux(){var xhtml="";(function($){$(".option.animal:has(input:checked)").each(function(){xhtml+="<li>";xhtml+="<span>"+$(this).find("label").html()+"</span>";xhtml+="<span>"+$(this).find("td.td_prixOption").html()+"</span>";xhtml+="</li>";});})(jQuery);return xhtml;}
function getXHTML_recapOptionsObligatoires(){var xhtml="";(function($){$(".option.obligatoire:not(.animal)").each(function(){xhtml+="<li>";xhtml+="<span>"+$(this).find("label").html()+"</span>";xhtml+="<span>"+$(this).find("td.td_prixOption").html()+"</span>";xhtml+="</li>";});})(jQuery);return xhtml;}
function refreshBandeauEtapes(bandeau){(function($){$('#ul_etapesResa').html(bandeau);})(jQuery);}
function manageChangementTypeResa(retour,modifChambre){(function($){if(retour.modeResa=='demandeNres'&&typeof(dataLayer)!='undefined'){dataLayer.push({'event':'resa_datesProches'});}
rechargementPageMAJ();if(modifChambre===true){var textenok='Annuler';var texteok='Valider';if(retour.motscles.annuler){textenok=retour.motscles.annuler;}
if(retour.motscles.valider){texteok=retour.motscles.valider;}
$("<div id='dialogMessageInfoModeResa'><p>"+retour.msgInfoModeResa+"</p></div>").dialog({dialogClass:'modaleChangeTypeResa',modal:true,closeOnEscape:false,buttons:[{text:textenok,click:function(){var numChambre=retour.numChambre;$('#inpt_chambre_1').attr('data-annulChoix','OK');$('#select_compoFamilleAdulte_'+numChambre).val(0).change();$(this).dialog('close');}},{text:texteok,click:function(){var paramsURL=location.search;if(paramsURL.indexOf("PHPSESSID")>-1){location.href=location.pathname+paramsURL;}
else{location.href=location.pathname+paramsURL+"&"+idSession;}}}]});}
else{var paramsURL=location.search;if(paramsURL.indexOf("PHPSESSID")>-1){location.href=location.pathname+paramsURL;}else{location.href=location.pathname+paramsURL+"&"+idSession;}}})(jQuery);}
function afficheMsgErrTechnq(msg,titre,ident,avecFormulaire,destinataire){(function($){var dateDeb=$('#inpt_resaDateDeb').val();var dateFin=$('#inpt_resaDateFin').val();$("<div id='dialogMessageErrTechnq'><p>"+msg+"</p></div>").dialog({modal:true,buttons:{"Ok":function(){$(this).dialog('close');if(avecFormulaire){var dest=destinataire||'centrale';var quePourCentrale='N';var pourCentrale='O';if(dest=='centrale'){quePourCentrale='O';}
else{pourCentrale='N';}
sendThisToProp(ident,800,600,titre,pourCentrale,quePourCentrale,dateDeb,null,dateFin);}}}});})(jQuery);}
function initAssurance(){(function($){$("input:radio[name=assur]").click(function(){affectAssurance();if($(this).val()=="Avec"){$(".sp_recapSansAssurAnnul").hide();$(".sp_recapAvecAssurAnnul").show();}
else{$(".sp_recapAvecAssurAnnul").hide();$(".sp_recapSansAssurAnnul").show();}
etapeCourante($("#div_uneEtape_assuranceAnnul"),true);});$('input[name="inputTypeClientAssurance"]').each(function(){if($(this).is(':checked')){$('.divFormuleAssurance').hide();$('.divFormuleAssuranceType'+$(this).val()).show();}});var tagChoixAssurance='choixAssuranceEffectue'+getIdSessionInHtml();$('input[name="inputTypeClientAssurance"]').click(function(){$('.divFormuleAssurance').hide();$('.divFormuleAssuranceType'+$(this).val()).show();var assurancePrecochee=$('input.inpt_choixFormuleAssurance[data-precochage="O"]',$('.divFormuleAssuranceType'+$(this).val()));if(assurancePrecochee.length>0){var yaAssuranceDejaChoisie=sessionStorage.getItem(tagChoixAssurance)||false;if(!yaAssuranceDejaChoisie){setFormuleAssurance(assurancePrecochee);}}});if($('input.inpt_choixFormuleAssurance').length>0){$('input[name="formuleAssurance"]').click(function(){sessionStorage.setItem(tagChoixAssurance,true);setFormuleAssurance(this);});}})(jQuery);}
function initPaiementVersementCompteClient(){if($('input_paiement_cbVersPbx')){$('input_paiement_cbSoldePbx').onclick=function(){$("inpt_vers_cptClient").value=0;$("inpt_vers_cptClient").setAttribute('disabled','true');$('a_boutonValiderCptClientPbx').show();};$('input_paiement_cbVersPbx').onclick=function(){$("inpt_vers_cptClient").removeAttribute('disabled');$('a_boutonValiderCptClientPbx').hide();}
var elem=$("inpt_vers_cptClient");elem.onchange=function(evt){var val=elem.value;var pattern='^[0-9]+([.]{1}[0-9]{1,2})?$';var reg=new RegExp(pattern);var test=reg.test(val);if(test){var solde=parseFloat($("inpt_solde_cptCliPbx").value);var total=parseFloat(val)*100;if((solde-total)<0){$('a_boutonValiderCptClientPbx').hide();alertAMalibu('Le montant saisi est suprieur au solde de la rservation.');}
else{if(total<100){$('a_boutonValiderCptClientPbx').hide();alertAMalibu('Le montant saisi doit tre suprieur  1 euro.');}
else{$('a_boutonValiderCptClientPbx').show();}}}
else{if(val.length!=0){alertAMalibu('Le montant saisi doit tre numrique et les dcimales spares par un point.');}}}}}
function verifMontantVersement(){var pattern='^[0-9]+([.]{1}[0-9]{1,2})?$';var elem=$("inpt_vers_cptClient");var reg=new RegExp(pattern);return reg.test(elem.value);}
function initCanevasResaCouplee(reinitCanevas){var forceReinit=reinitCanevas||false;if(!forceReinit){initActionsCanevas();rendChoixCanevasPossible();}
else{getCanevasPossibles();}}
function getCanevasPossibles(){(function($){var numEtape=parseInt($('#div_uneEtape_canevas').prev('.div_uneEtape').find('.sp_numEtape').text())+1;var data='TYPE=verifCanevasResaGP_html&numetape='+numEtape;if(!gestprod){data='TYPE=verifCanevasResaCouplee_html&numetape='+numEtape;}
$.ajax({dataType:'html',url:urlAJAX,data:data,beforeSend:function(){affMsgAttenteParDessusInDiv('div_uneEtape_canevas','canevas',txtAttente);},complete:function(){effaceMsgAttenteParDessus('canevas');},success:function(html){if(html.length===0){hideDivEtapeCanevas();return;}
$('#div_uneEtape_canevas').html(html);showDivEtapeCanevas();initActionsCanevas();numEtape++;$('#div_uneEtape_canevas').nextAll('.div_uneEtape').each(function(){$(this).find('.sp_numEtape').text(numEtape);numEtape++;});rendChoixCanevasPossible();if(typeof foncQdFini_chargeCanevas!=='undefined'){foncQdFini_chargeCanevas();}
if(typeof foncQdFini_verifCanevas!=='undefined'){foncQdFini_verifCanevas();}},error:function(data){alertAJquery(data);}});})(jQuery);}
function getCanevasPossibles_OLD(){(function($){var numEtape=$("#div_uneEtape_canevas").prev(".div_uneEtape").find(".sp_numEtape").text();numEtape=parseInt(numEtape)+1;var data='';if(!gestprod){data="TYPE=verifCanevasResaCouplee&numetape="+numEtape;}else{data="TYPE=verifCanevasResaGP&numetape="+numEtape;}
$.ajax({type:"POST",dataType:"xml",url:urlAJAX,data:data,beforeSend:function(){affMsgAttenteParDessusInDiv("div_uneEtape_canevas","canevas",txtAttente);},complete:function(){effaceMsgAttenteParDessus("canevas");},success:function(xml){var code=$(xml).find("code").text();if(code=="OK"){var html=$(xml).find('HTML').text();$('#div_uneEtape_canevas').html(html);initActionsCanevas();if($("#div_uneEtape_canevas").css("display")=='none'){showDivEtapeCanevas();}
numEtape++;$("#div_uneEtape_canevas").nextAll(".div_uneEtape").each(function(){$(this).find(".sp_numEtape").text(numEtape);numEtape++;});rendChoixCanevasPossible();if(typeof foncQdFini_chargeCanevas!=='undefined'){foncQdFini_chargeCanevas();}}else{hideDivEtapeCanevas();}
if(typeof foncQdFini_verifCanevas!=='undefined'){foncQdFini_verifCanevas();}},error:function(data){alertAJquery(data);}});})(jQuery)}
function initActionsCanevas(){(function($){showDivEtapeCanevas();$('#div_recapInfosEtPrix').click(function(e){var element=$(e.target);if(($(e.target).hasClass('spanSupprimerTarifSupplement'))){var ligneFacture=$(e.target).get(0);var identifiantSupplementPossible='';var regex=new RegExp('^[0-9]+_[0-9]+_[0-9]+_'+$(ligneFacture).attr('data-idtarif')+'$');var selectAMettreAJour=null;$('.lstChoixSupplQte').each(function(){if(regex.test($(this).attr('data-identifiant'))){identifiantSupplementPossible=$(this).attr('data-identifiant');selectAMettreAJour=$(this);}});if(identifiantSupplementPossible){$(ligneFacture).attr('data-identifiant',identifiantSupplementPossible);majChoixCanevas(ligneFacture);selectAMettreAJour.val(0);}}});$(".lstChoixSupplQte").change(function(){majChoixCanevas(this);if($(this).parents('.tarifElementRubriqueCanevas').is('.nonCumulable')){majRubriqueCanevasAvecElementNonCumulable($(this));}});$(".inpt_choixQteCanevas_forfait").change(function(){majChoixCanevas(this);if($(this).parents('.tarifElementRubriqueCanevas').is('.nonCumulable')){majRubriqueCanevasAvecElementNonCumulable($(this));}});$(".select_heureVoiture").change(function(){var element=$(this).attr("data-identifiant");var qte=parseInt($(".lstChoixSupplQte[data-identifiant='"+element+"']").val());if(qte>0){majChoixCanevas($(".lstChoixSupplQte[data-identifiant='"+element+"']"));}});$(".lstChoixSupplDate").change(function(){var dates=$(this).val();var element=$(this).attr("data-identifiant");$(".inputChoixSupplDate[data-identifiant='"+element+"']").val(dates);var qte=parseInt($(".lstChoixSupplQte[data-identifiant='"+element+"']").val());if(qte>0||(qte==0&&$('.tr_prixSupplements').length>0)){majChoixCanevas($(".lstChoixSupplQte[data-identifiant='"+element+"']"));}});if($('.divRubriqueCanevasVoiture').length>0){initActionsCanevasVoiture();}
if(jQuery('.viewWithQtip').length>0){jQuery('.viewWithQtipTohide').hide()
jQuery('.viewWithQtip').each(function(){if(jQuery(this).attr('data-qhelp')&&jQuery("#"+jQuery(this).attr('data-qhelp'))){jQuery(this).qtip({content:{text:jQuery("#"+jQuery(this).attr('data-qhelp')).html(),title:{text:jQuery(this).attr('data-qtitle')}},show:'mouseover',hide:'mouseout'})}})}
$(".a_canevasAfficheDetail").fancybox({maxWidth:800,maxHeight:600,fitToView:false,width:'70%',height:'70%',autoSize:false,closeClick:false,openEffect:'none',closeEffect:'none'});$(".bouton_ajouter_canevas").toggle(function(){$(this).parents(".divUneRubriqueCanevas").children(".liste_tarifs_de_la_rubrique").show('fast');},function(){$(this).parents(".divUneRubriqueCanevas").children(".liste_tarifs_de_la_rubrique").hide('fast');});$("#aToggleChoixCanevas").toggle(function(){$('.divListeRubriquesDuCanevas .divUneRubriqueCanevas:not(".canevasObligatoire")').hide('fast');$(this).children('#spanCanevasCache').hide();$(this).children('#spanCanevasAffiche').show();},function(){$('.divListeRubriquesDuCanevas .divUneRubriqueCanevas').show('fast');$(this).children('#spanCanevasAffiche').hide();$(this).children('#spanCanevasCache').show();});if($('.divUneRubriqueCanevas.canevasObligatoire').length>0){}
initFancyBoxDeBase();})(jQuery)}
function initActionsCanevasVoiture(){(function($){$('.divRubriqueCanevasVoiture').delegate('.inputCanevasTarifVoiture','change',function(){var element=$(this).data('identifiant');var identifiantRubrique=$(this).data("identifiant_rub_canevas_stock");var params={element:element,quantite:1,dateDeb:$('#inpt_resaDateDebCanevas_'+$(this).data('canevas')+'_'+$(this).data('rubrique')).val(),dateFin:$('#inpt_resaDateFinCanevas_'+$(this).data('canevas')+'_'+$(this).data('rubrique')).val(),heureDebVoiture:$('.inputHeureDebVoiture[data-identifiant="'+identifiantRubrique+'"]').val(),heureFinVoiture:$('.inputHeureFinVoiture[data-identifiant="'+identifiantRubrique+'"]').val(),libelleRub:$(this).parents('.divUneRubriqueCanevas').children('input.inputLibelleRubrique').val()};var affichageBoutonSupprimerSupplement=function(){$('.spanEnleverSupplementDuDossier[data-identifiant="'+element+'"]').show();};setCanevas(params,affichageBoutonSupprimerSupplement);});$('.divRubriqueCanevasVoiture').delegate('.spanEnleverSupplementDuDossier','click',function(){var element=$(this).data('identifiant');var params={element:element,quantite:0};setCanevas(params);});$('.inpt_resaDateFinCanevas').each(function(){var identifiantRubrique=$(this).data('identifiant');var element=this;var minDate=$('.inpt_resaDateDebCanevas[data-identifiant="'+identifiantRubrique+'"]').val();$(this).datepicker({dateFormat:'dd/mm/yy',minDate:minDate,dayNamesMin:$.datepicker._defaults.dayNamesMin,beforeShowDay:function(jour){return beforeShowDayCanevasVoiture(jour,element);},onSelect:function(dateFin){var dateDeb=$('.inpt_resaDateDebCanevas[data-identifiant="'+identifiantRubrique+'"]').val();genereListeStocksRubriqueCanevasVoiture(identifiantRubrique,dateDeb,dateFin);}});});$('.inpt_resaDateDebCanevas').each(function(){var identifiant=$(this).data('identifiant');var element=this;$(this).datepicker({dateFormat:'dd/mm/yy',minDate:0,dayNamesMin:$.datepicker._defaults.dayNamesMin,beforeShowDay:function(jour){return beforeShowDayCanevasVoiture(jour,element);},onSelect:function(dateDeb){$('.inpt_resaDateFinCanevas[data-identifiant="'+identifiant+'"]').val('');},onClose:function(dateText,inst){$('.inpt_resaDateFinCanevas[data-identifiant="'+identifiant+'"]').focus();}});});$('.divRubriqueCanevasVoiture').delegate('.spanBoutonModifierDatesCanevasVoiture','click',function(){$(this).parents('.divRecapDatesCanevasVoiture').slideUp();$(this).parents('.divRubriqueCanevasVoiture').children('.choixDatesVoiture').slideDown();var identifiant=$(this).data('identifiant');$('.divListeTarifsCanevas[data-identifiant="'+identifiant+'"]').hide();});$('.divRubriqueCanevasVoiture').delegate('.spanBoutonModifierHeuresCanevasVoiture','click',function(){var identifiant=$(this).data('identifiant');$('.divSelectHeure','.divUnStockRubriqueCanevas[data-identifiant="'+identifiant+'"]').slideDown();$(this).parents('.divRecapHeuresStockRubriqueCanevasVoiture').slideUp();$('.divListeTarifsByStockRubriqueCanevas','.divUnStockRubriqueCanevas[data-identifiant="'+identifiant+'"]').slideUp();$('.inputHeureVoiture','.divUnStockRubriqueCanevas[data-identifiant="'+identifiant+'"').each(function(){var heuresAutorisees=$(this).data('heures_autorisees');$(this).datetimepicker({datepicker:false,format:'H:i',step:30,validateOnBlur:false,allowTimes:heuresAutorisees});});});$('.divRubriqueCanevasVoiture').delegate('.btnValiderHeuresStockRubriqueCanevas','click',function(){var heureDeb=$('.inputHeureDebVoiture[data-identifiant="'+$(this).data('identifiant')+'"]').val();var heureFin=$('.inputHeureFinVoiture[data-identifiant="'+$(this).data('identifiant')+'"]').val();genereListeTarifsByStockRubriqueCanevasVoiture($(this).data('identifiant'),$(this).data('datedeb'),$(this).data('datefin'),heureDeb,heureFin);});})(jQuery);}
function beforeShowDayCanevasVoiture(jour,input){var out=(function($){var classe='';var moisJs=(jour.getMonth()+1).toString();if(moisJs.length===1){moisJs='0'+moisJs;}
var j=jour.getDate().toString();if(j.length===1){j='0'+j;}
var dateDuJour=j+'/'+moisJs+'/'+jour.getFullYear();var tabDatesOk=$(input).data('dates_autorisees')||[];if($(input).val()===dateDuJour){if($(input).hasClass('inpt_resaDateDebCanevas')){classe+=' dateArrivee';}
else{classe+=' dateFin';}}
if(tabDatesOk.indexOf(dateDuJour)<0){classe+=' occupe';return[false,classe];}
else{classe+=' cliquable';return[true,classe];}})(jQuery);return out;}
function genereListeStocksRubriqueCanevasVoiture(identifiantRubriqueCanevas,dateDeb,dateFin){(function($){$('.divListeTarifsCanevas[data-identifiant="'+identifiantRubriqueCanevas+'"').hide('fast');if(!dateDeb||!dateFin){return;}
var infosCanevas=identifiantRubriqueCanevas.split('_');var params={TYPE:'getTarifsRubriqueCanevasVoiture',canevas:infosCanevas[0],rubrique:infosCanevas[1],dateDeb:dateDeb,dateFin:dateFin}
$.ajax({type:'POST',dataType:'xml',url:urlAJAX,data:params,beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaContenu","contenu",txtAttente);},complete:function(){effaceMsgAttenteParDessus("contenu");},success:function(xml){var data=XMLToArray(xml);if(!data.html&&data.msg){$('.divListeTarifsCanevas[data-identifiant="'+identifiantRubriqueCanevas+'"]').html('<p>'+data.msg+'</p>');}
else{$('.divListeTarifsCanevas[data-identifiant="'+identifiantRubriqueCanevas+'"]').html(decodeURIComponent(data.html));$('.divRecapDatesCanevasVoiture[data-identifiant="'+identifiantRubriqueCanevas+'"]').html(decodeURIComponent(data.recapDatesCanevas));}
$('.divListeTarifsCanevas[data-identifiant="'+identifiantRubriqueCanevas+'"]').show('fast');$('.divRecapDatesCanevasVoiture[data-identifiant="'+identifiantRubriqueCanevas+'"]').show('fast');$('.choixDatesVoiture[data-identifiant="'+identifiantRubriqueCanevas+'"]').hide('fast');if(data.maj){rechargementPageMAJ();}}});})(jQuery);}
function genereListeTarifsByStockRubriqueCanevasVoiture(identifiantStockRubriqueCanevas,dateDeb,dateFin,heureDeb,heureFin){(function($){var infos=identifiantStockRubriqueCanevas.split('_');var params={type:'getListeTarifsByStockRubriqueCanevasVoiture',canevas:infos[0],rubrique:infos[1],stock:infos[2],dateDeb:dateDeb,dateFin:dateFin,heureDeb:heureDeb,heureFin:heureFin};$.ajax({type:'POST',dataType:'xml',url:urlAJAX,data:params,beforeSend:function(){attenteInDiv($('.divChoixHeuresStockRubriqueCanevasVoiture[data-identifiant="'+identifiantStockRubriqueCanevas+'"]'));},complete:function(){effaceAttenteInDiv();},success:function(xml){var data=XMLToArray(xml);$('.divSelectHeure','.divUnStockRubriqueCanevas[data-identifiant="'+identifiantStockRubriqueCanevas+'"]').slideUp();if(!data.html&&data.msg){$('.divListeTarifsByStockRubriqueCanevas','.divUnStockRubriqueCanevas[data-identifiant="'+identifiantStockRubriqueCanevas+'"]').html('<p>'+data.msg+'</p>');}
else{$('.divListeTarifsByStockRubriqueCanevas','.divUnStockRubriqueCanevas[data-identifiant="'+identifiantStockRubriqueCanevas+'"]').replaceWith($.parseHTML(data.html));}
$('.divListeTarifsByStockRubriqueCanevas','.divUnStockRubriqueCanevas[data-identifiant="'+identifiantStockRubriqueCanevas+'"]').slideDown();}});})(jQuery);}
function majChoixCanevas(obj){(function($){var element=$(obj).attr("data-identifiant");var quantite;if($(obj).is(':checkbox')){quantite=0;if($(obj).is(':checked')){var codeProd=$(obj).parents('.divListeRubriquesDuCanevas').attr('data-codeProd');$('.select_compoNbPers_'+codeProd).each(function(){var elem=$(this);quantite+=parseInt(elem.val());});}}else{quantite=$(obj).val();}
var dates=$(".inputChoixSupplDate[data-identifiant='"+element+"']").val();var tabDates=dates.split('_');var dateDeb=tabDates[0];var dateFin=tabDates[1];var params={element:element,quantite:quantite,dateDeb:dateDeb,dateFin:dateFin};if($(".select_heureVoiture[data-identifiant='"+element+"']").length>0){if(quantite>0){$(".sp_choixHeureVoiture[data-identifiant='"+element+"']").show();}else{$(".sp_choixHeureVoiture[data-identifiant='"+element+"']").hide();}
params.heureVoiture=$(".select_heureVoiture[data-identifiant='"+element+"']").val();params.libelleRub=$(obj).parents('.divUneRubriqueCanevas').children('input.inputLibelleRubrique').val();}
setCanevas(params);})(jQuery)}
function setCanevas(params,callback){if(typeof params!=='object'){return;}
console.log('setCanevas params ',params);params.type='affectCanevasResaGP';if(!gestprod){params.type='affectCanevasResaCouplee';}
(function($){$.ajax({type:"POST",dataType:'xml',url:urlAJAX,data:params,beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaContenu","contenu",txtAttente);},complete:function(){effaceMsgAttenteParDessus("contenu");},success:function(data){var xml=$(data);var tabResult=XMLToArray(xml);if(tabResult['code']=="OK"){if(tabResult["maj"]!=undefined){rechargementPageMAJ();}
else{$('.choixSupplements_prixTotal[data-identifiant="'+params.element+'"]').html(tabResult["prixDuSupplement"]);$('#div_recapPrix').html(tabResult['recapPrix']);var htmlAssurance=tabResult['htmlAssurance'];if(tabResult['choixAssurance']){htmlAssurance=tabResult['choixAssurance'];}
majAssurance(null,htmlAssurance,tabResult['prixAssurance']);if(typeof(callback)!=='undefined'){callback(tabResult);}}}
else{if(tabResult['htmlErreur']){alertAJquery(tabResult['htmlErreur']);}else if(tabResult['msg']){alertAJquery(tabResult['msg']);}
else{alertAJquery('Une erreur 5168 s\'est produite');}}},error:function(data){alert(data);}});})(jQuery)}
function rendChoixCanevasPossible(){(function($){if($("#div_recapInfosFamille").length>0||$('.div_uneEtape_prodGP').length>0){$("#div_uneEtape_canevas").find("*:not(.inpt_choixQteCanevas_forfait)").attr("disabled",false);$("#div_uneEtape_canevas").removeClass('div_uneEtapeGrisee');$('.divListeRubriquesDuCanevas .divUneRubriqueCanevas').show('fast');$('#aToggleChoixCanevas').children('#spanCanevasAffiche').hide();$('#aToggleChoixCanevas').children('#spanCanevasCache').show();}
else{$("#div_uneEtape_canevas").addClass('div_uneEtapeGrisee');$("#div_uneEtape_canevas *").find("*:not(.inpt_choixQteCanevas_forfait)").attr("disabled",true);$('.divListeRubriquesDuCanevas .divUneRubriqueCanevas:not(".canevasObligatoire")').hide('fast');$('#aToggleChoixCanevas').children('#spanCanevasCache').hide();$('#aToggleChoixCanevas').children('#spanCanevasAffiche').show();}
if($('.divUneRubriqueCanevas.canevasObligatoire').length>0){if($('.divUneRubriqueCanevas:not(.canevasObligatoire)').length==0){$('#div_uneEtape_canevas > .div_titreEtape').hide();}
majNumEtapes();}
$(".lstChoixSupplQte").each(function(){if($(this).parents('.tarifElementRubriqueCanevas').is('.nonCumulable')){if($(this).is(':checked')||($(this).val()!=0&&$(this).val()!=null)){$(this).parents('.tarifElementRubriqueCanevas').addClass('selected');$(this).parents('.liste_tarifs_de_la_rubrique').find('.tarifElementRubriqueCanevas:not(.selected) *').attr("disabled",true);}}});})(jQuery)}
function majLstCanevasOblig(nbPers){(function($){if($('.divUneRubriqueCanevas.canevasObligatoire').length>0){$('.divUneRubriqueCanevas.canevasObligatoire').each(function(){$(this).attr('data-nbPers',nbPers);var lstQte=$(this).find('.lstChoixSupplQte');lstQte.each(function(){if($(this).val()>nbPers){majChoixCanevas($(this));}
$(this).find('option').each(function(){var valOption=parseInt($(this).val())
if(valOption>nbPers){$(this).hide();}else{$(this).show();}});});});}
if(nbPers==0){$('.inpt_choixQteCanevas_forfait:checked').each(function(){$(this).attr('checked',false);$(this).change();});}else{$('.inpt_choixQteCanevas_forfait:checked').each(function(){$(this).change();});}
if(typeof foncQdFini_majLstCanevasOblig=='function'){foncQdFini_majLstCanevasOblig();}})(jQuery);}
function verifQteCanevasOblig(){var retour=false;(function($){var nbPers;var qte=0;var verifCanevasOblig=null;$('.divUneRubriqueCanevas.canevasObligatoire').each(function(){nbPers=$(this).attr('data-nbpers');$(this).find('.lstChoixSupplQte').each(function(){if($(this).val()!=null){qte+=parseInt($(this).val());}});if(qte==nbPers||$(this).find('.inpt_choixQteCanevas_forfait:checked').length>0){if(verifCanevasOblig===null){verifCanevasOblig=true;}
$(this).removeClass('rubriqueAValider');}else{$('#div_uneEtape_canevas').find('.inpt_validEtape').val('Non');if(verifCanevasOblig===null||verifCanevasOblig===true){verifCanevasOblig=false;}
$(this).addClass('rubriqueAValider');}
qte=0;});if(verifCanevasOblig===true){$('#div_uneEtape_canevas').find('.inpt_validEtape').val('Oui');retour=true;}else{$('#div_uneEtape_canevas').find('.inpt_validEtape').val('Non');}})(jQuery);return retour;}
function rechargementPageMAJ(tabRetour){affMsgAttenteParDessusInDiv("div_resaContenu","contenu",txtAttente);var tabParam=tabRetour||[];if(tabParam.url){location.href=tabParam.url;return;}
var paramsURL=location.search;if(tabParam.ident){paramsURL="?ident="+tabRetour.ident;}
if(paramsURL.indexOf("PHPSESSID")==-1)
paramsURL+="&"+idSession;if(tabParam.ancre){paramsURL+="#"+tabParam.ancre;}
var oldHref=location.href;var tabInfosHref=oldHref.split('/');var nomFichier=tabInfosHref.pop();var dossierResa=tabInfosHref.pop();var pathname=dossierResa+'/'+nomFichier;if(pathname!=location.pathname+paramsURL){location.href=location.pathname+paramsURL;}
else{window.location.reload();}
return;}
function majAssurance(objResult,htmlResult,montantResult){(function($){var htmlAssurance=false;var montantAssurance=false;if(objResult){htmlAssurance=objResult.htmlAssurance;}else if(htmlResult){htmlAssurance=htmlResult;}
if(htmlAssurance&&$('#div_assuranceAnnul').length>0){$('#div_assuranceAnnul').html(htmlAssurance);if(objResult){montantAssurance=objResult.assurance;}else if(montantResult){montantAssurance=montantResult;}
if(montantAssurance){var montantReelAssurance=montantAssurance.replace('&euro;','');montantReelAssurance=montantReelAssurance.replace(' ','');try{montantReelAssurance=parseInt(montantReelAssurance);}
catch(e){montantReelAssurance=1;}
if(montantReelAssurance>0){if($("#sp_montantAssur").length>0){$("#sp_montantAssur").html(montantAssurance);}else{$(".sp_montantAssur:visible").html(montantAssurance);}}}
initAssurance();}else{$('#div_assuranceAnnul').html('');}
if($('#div_assuranceAnnul').find('.inpt_validEtape').length==0){$('#div_uneEtape_assuranceAnnul').hide('fast');}
else{$('#div_uneEtape_assuranceAnnul').show('fast');}
if($("#inpt_assurOui").is(':visible:checked')&&$('#div_uneEtape_assuranceAnnul').find('.inpt_validEtape').val()=='Non'){$("#inpt_assurOui").click();}})(jQuery)}
function initEtape1_GP(){(function($){$.ajaxSetup({timeout:100000});gestprod=true;initLangue();idSession=getIdSessionInHtml();ajoutePHPSESSID_history();nbMois=$("#inpt_nbMoisCalend").val();if(!nbMois){nbMois=2;}
initBtnsFooter();$.datepicker.setDefaults($.datepicker.regional[lang]);$(".div_uneEtapeRecap:hidden:first").parent().addClass('div_uneEtapeCurr');$(".sp_fermerCal").click(function(){$(this).parents(".div_calendDateDebFin").hide();});$("#inpt_resaDateDeb").click(function(){$("#div_calendrierDeb").show().addClass("open");$("#div_msgErreursDateDeb").hide();$("#div_calendrierFin").hide().removeClass("open");$.ajax({type:"POST",url:urlAJAX,async:false,data:{type:"getPlanningDeb_GP"},beforeSend:function(){$("#div_roueDatepickerDeb").show();afficheLoaderGlobal_site();},success:function(result){eval("var tabDispos="+result);if(tabDispos.code==errDossierNull){retourEtape1(tabDispos.msg);}
else if(tabDispos.errTechnq){afficheMsgErrTechnq(tabDispos.msg,tabDispos.titre,tabDispos.ident,true);}
else if(tabDispos.code=="OK"){chainePlanning=tabDispos.chaineDispo;dateDebPlanning=tabDispos.dateDeb;dateFinPlanning=tabDispos.dateFin;infoBulles=tabDispos.infoBulle;initDatePickerDeb();}
else{$("#div_confirmDispos").find(".ko").text(tabDispos.msg).show();$("#div_calendrierDeb").hide().removeClass("open");$("#div_uneEtape_date").find(".inpt_validEtape").val("Non");rendChoixCanevasPossible();}
$("#div_roueDatepickerDeb").hide();},complete:function(){effaceLoaderGlobal_site();}});return false;});$(".div_uneEtapeGrisee *").attr("disabled",true);if($("#div_uneEtape_hotelChoixChambre").length>0){setEventsForHotel();}
if($('#div_uneEtape_locatChoixChambre').length>0){setEventsForLocat();}
if($('#div_uneEtape_billetChoixPresta').length>0){setEventsForBillet();}
if($("#div_uneEtape_choixNDate").length>0){setEventsForNDate();}
if($("#div_uneEtape_packageChoixTarif").length>0){setEventsForPack();}
if($('#div_uneEtape_voitureChoixPresta').length>0){setEventsForVoiture();}
$("#inpt_resaDateFin").click(function(){var regDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");$("#div_calendrierDeb").hide();if(regDate.test($("#inpt_resaDateDeb").val())){$("#div_calendrierFin").show().addClass("open");}
else{$("#div_msgErreursDateDeb").show();}});initAssurance();initModifEtape();$("#inpt_motMagique").blur(function(){if($("#inpt_motMagique").val()!=""){verifMotMagique(true,false);}});initPrixLibre();$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm), #div_btnConfirmer_1 > a:not(.a_btnAttenteConfirm)").click(function(){if($('.div_uneEtapeMsgErreur').length>0){return false;}
$(this).hide();$(".a_btnAttenteConfirm").show();traiteNdatePrixLibre();if(etapesValid()){if($(this).is('#div_btnConfirmer > a:not(.a_btnAttenteConfirm)')){var paramsURL=location.search.replace(/&panier=[^&]+/,'');var numeroEtape='2';if($('#divNumeroProchaineEtape').length>0){numeroEtape=$('#divNumeroProchaineEtape').attr('data-prochaineEtape');}
if(paramsURL.indexOf("PHPSESSID")>-1){location.href='etape'+numeroEtape+'.php'+paramsURL;}
else{location.href='etape'+numeroEtape+'.php'+paramsURL+"&"+idSession;}}else{$('#div_btnConfirmer_2 > a:not(.a_btnAttenteConfirm)').click();}}
$(".a_btnAttenteConfirm").hide();$(this).show();});})(jQuery);}
function setEventsForHotel(){(function($){verifAllNbPaxCodeStock_hotel();$(".select_nbAdultesHotel").live("change",function(){var nbPersMaxi=$(this).parents('.tr_tarifHotel').attr('data-nbmaxtotal');var nbAdultes=$(this).val();var nbEnfantsMax=parseInt(nbPersMaxi)-parseInt(nbAdultes);var listeEnfants=$(this).parents('.tr_tarifHotel').find('.select_nbEnfantsHotel');if(nbAdultes==0){listeEnfants.val(0);listeEnfants.change();}else{$(this).parents('.tr_tarifHotel').removeClass('invalide');$(this).parents('.tr_tarifHotel').find('.sp_msgErreurAdultes').hide();}
if(nbEnfantsMax==0){listeEnfants.hide();}else{listeEnfants.show();listeEnfants.find('option').each(function(){if($(this).val()>nbEnfantsMax){$(this).hide();}else{$(this).show();}});}
var codeStock=$(this).parents('.tr_tarifHotel').attr('data-codestock');verifNbPaxCodeStock_hotel(codeStock);var nbAdultesTot=0;$('.select_nbAdultesHotel:visible').each(function(){if($(this).val()>0){nbAdultesTot+=$(this).val();}});if(nbAdultesTot==0){$('#div_uneEtape_hotelChoixChambre').find('.inpt_validEtape').val('Non');$('#div_recapPrix').hide();$('#div_recapInfosFamille').remove();}
else{setLignesFactures_hotel();}
majListesSupplementsHotel();});$(".select_nbEnfantsHotel").live("change",function(){var nbEnfants=$(this).val();var nbAdultes=$(this).parents('.tr_tarifHotel').find('.select_nbAdultesHotel').val();var nbPersMaxi=$(this).parents('.tr_tarifHotel').attr('data-nbmaxtotal');var nbAdultesMax=parseInt(nbPersMaxi)-parseInt(nbEnfants);var listeAdultes=$(this).parents('.tr_tarifHotel').find('.select_nbAdultesHotel');listeAdultes.find('option').each(function(){if($(this).val()>nbAdultesMax){$(this).hide();}else{$(this).show();}});if(nbAdultes>0){setLignesFactures_hotel();}
majListesSupplementsHotel();});setEventsSupplements(setLignesFactures_hotel);$('.a_btnChoixTarif').live('click',function(){var div=$(this).attr('data-div');var divTarif=$('.'+div+'.divDeBase').clone();$(this).parents('.div_uneChambre_choixTarif').after(divTarif);divTarif.removeClass('divDeBase').show();$(this).parents('.div_uneChambre_choixTarif').hide();});$('.a_modifTarif').live('click',function(){$(this).parents('.div_uneChambreTarifs').siblings('.div_uneChambre_choixTarif:not(".divDeBase")').show();$(this).parents('.div_uneChambreTarifs').remove();setLignesFactures_hotel();});})(jQuery);}
function verifAllNbPaxCodeStock_hotel(){(function($){$('.tr_tarifHotel').each(function(){verifNbPaxCodeStock_hotel($(this).attr('data-codestock'));});})(jQuery);}
function gestionMultiTarifs(elemListe){(function($){var nbTarifs=elemListe.val();if(nbTarifs>0){var nbDivChoix=elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").length;if(nbDivChoix>nbTarifs){var diff=nbDivChoix-nbTarifs;for(var i=1;i<=diff;i++){if(elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last().next().is('.div_uneChambreTarifs:not(.divDeBase)')){elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last().next().remove();}
elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last().remove();}}else{for(var i=1;i<=nbTarifs;i++){if(i>nbDivChoix){if(elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last().next().is('.div_uneChambreTarifs:not(.divDeBase)')){ajouteDivChoixTarif(elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last().next(),i);}else{var lastDiv;if(nbDivChoix==0){lastDiv=elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif.divDeBase");}else{lastDiv=elemListe.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").last();}
ajouteDivChoixTarif(lastDiv,i);}}}}
if(nbTarifs==1){$('.p_lblChoixTarif').hide();}else{$('.p_lblChoixTarif').show();}}else{elemListe.parents('.div_uneChambreContent').find('.div_uneChambre_choixTarif:not(.divDeBase)').remove();elemListe.parents('.div_uneChambreContent').find('.div_uneChambreTarifs:not(.divDeBase)').remove();}})(jQuery);}
function ajouteDivChoixTarif(lastDiv,numChoix){(function($){var divChoixTarif=lastDiv.parents('.div_uneChambreContent').find('.div_uneChambre_choixTarif.divDeBase');divChoixTarif.find('.sp_numChoix').text(numChoix);var htmlChoixTarif=divChoixTarif.html();htmlChoixTarif='<div class="div_uneChambre_choixTarif">'+htmlChoixTarif+'</div>';var nbDivVisible=lastDiv.parents(".div_uneChambreContent").find(".div_uneChambre_choixTarif").not(".divDeBase").length;if(nbDivVisible==0){divChoixTarif.after(htmlChoixTarif);}else{lastDiv.after(htmlChoixTarif);}})(jQuery);}
function gestionMonoTarif(elemListe){(function($){if(elemListe.val()>0){var contentDiv=elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs.divDeBase").html();contentDiv="<div class='div_uneChambreTarifs'>"+contentDiv+"</div>";var nbDivVisible=elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs").not(".divDeBase").length;var i;if(elemListe.val()>nbDivVisible){var nbAAjouter=elemListe.val()-nbDivVisible;for(i=0;i<nbAAjouter;i++){if(nbDivVisible==0){elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs.divDeBase").after(contentDiv);}
else{elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs").not(".divDeBase").last().after(contentDiv);}}}
else{var nbASupprimer=nbDivVisible-elemListe.val();for(i=0;i<nbASupprimer;i++){elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs").not(".divDeBase").last().remove();}
setLignesFactures_hotel();}}
else{elemListe.parents(".div_uneChambreContent").find(".div_uneChambreTarifs").not(".divDeBase").remove();var nbPers=0;$('.select_compoFamille:visible').each(function(){if(elemListe.val()>0){nbPers=1;return false;}});if(nbPers==0){$('#div_uneEtape_hotelChoixChambre').find('.inpt_validEtape').val('Non');$('#div_recapPrix').hide();$('#div_recapInfosFamille').remove();}
else{setLignesFactures_hotel();}}})(jQuery);}
function setLignesFactures_hotel(){(function($){var lignesFactures=new Array();var i=0;$(".tr_tarifHotel:visible").each(function(){var tarifs=new Array();var nbAdultes=0;var nbEnfants=0;var codeStock=$(this).attr("data-codestock");var idTarif=$(this).attr("data-idtarif");var j=0;nbAdultes=$(this).find(".select_nbAdultesHotel").val();if($(this).find(".select_nbEnfantsHotel").length>0){nbEnfants=$(this).find(".select_nbEnfantsHotel").val();}else{nbEnfants=0;}
var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
if(nbAdultes>0){lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs);i++;}});$(".tr_tarifSupplement:visible").each(function(){var tarifs=new Array();var nbAdultes=0;var nbEnfants=0;var codeStock='';var idTarif=$(this).attr("data-idtarif");var j=0;if($(this).find(".select_qteSupplement").length>0){nbAdultes=$(this).find(".select_qteSupplement").val();nbEnfants=0;}else if($(this).find(".select_supplementForfaitaire").length>0){nbAdultes=$(this).find(".select_supplementForfaitaire").val();nbEnfants=0;}
var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs,null,null,true);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
verifAllNbPaxCodeStock_hotel();effaceMsgAttenteParDessus("recapPrix");}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures(){(function($){var lignesFactures=new Array();var i=0;$(".div_uneChambreTarifs:visible").each(function(){var tarifs=new Array();var nbAdultes=0;var nbEnfants=0;var codeStock=$(this).find(".inpt_codeStock").val();var divTarifs=$(this).children(".div_tarif");var j=0;var nbAduDec;var nbEnfDec;var commLF='';divTarifs.each(function(){$(this).removeClass('invalide');var idTarif=$(this).find(".inpt_idTarif").val();if($(this).find(".select_compoQte").length>0){nbAduDec=$(this).find(".select_compoQte").val();nbEnfDec=0;}else if($(this).find(".inpt_supplementForfaitaire").length>0){if($(this).find(".inpt_supplementForfaitaire").is(':checked')){nbAduDec=1;nbEnfDec=0;}else{nbAduDec=0;nbEnfDec=0;}}else{nbAduDec=$(this).find(".select_compoFamilleAdulte").val();if($(this).find(".select_compoFamilleEnfant").length>0){nbEnfDec=$(this).find(".select_compoFamilleEnfant").val();}else{nbEnfDec=0;}}
var nbPax=parseInt(nbAduDec)+parseInt(nbEnfDec);if(!$(this).hasClass("supplement")){nbAdultes=nbAduDec;nbEnfants=nbEnfDec;}
if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
if($(this).find('.sp_choixHeureVoiture').length>0){commLF=$(this).find('.select_heureVoiture').val();}});lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs,commLF);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}}else{effaceMsgAttenteParDessus("recapPrix");}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures_locat(){(function($){var lignesFactures=new Array();var i=0;$(".tr_tarifLocat:visible").each(function(){var tarifs=new Array();var nbAdultes=0;var nbEnfants=0;var codeStock=$(this).attr("data-codestock");var idTarif=$(this).attr("data-idtarif");var noLigne=$(this).attr("data-noLigne");var j=0;nbAdultes=$(this).find(".select_nbAdultesLocat").val();if($(this).find(".select_nbEnfantsLocat").length>0){nbEnfants=$(this).find(".select_nbEnfantsLocat").val();}else{nbEnfants=0;}
var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
$('.tr_tarifSupplement').each(function(){if($(this).attr('data-idtarifprod')==idTarif&&$(this).attr('data-noligne')==noLigne){var nbPaxSuppl=0;var idTarifSuppl=$(this).attr('data-idtarif');if($(this).find(".select_qteSupplement").length>0){nbPaxSuppl=$(this).find(".select_qteSupplement").val();}else if($(this).find(".select_supplementForfaitaire").length>0){nbPaxSuppl=$(this).find(".select_supplementForfaitaire").val();}
if(nbPaxSuppl>0){tarifs[j]=new Array(idTarifSuppl,nbPaxSuppl);j++;}}});if(nbAdultes>0){lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs);i++;}});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){$('.spanErreurAjax','.div_uneEtape_prodGP').remove();if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
effaceMsgAttenteParDessus("recapPrix");}else{effaceMsgAttenteParDessus("recapPrix");afficheMsgErreurSetLignesFactures(tabResult);}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures_billet(){(function($){var lignesFactures=new Array();var i=0;$(".tr_tarifBillet:visible").each(function(){var tarifs=new Array();var codeStock=$(this).attr("data-codestock");var idTarif=$(this).attr("data-idtarif");var nbAdultes=0;var nbEnfants=0;var j=0;if($(this).find(".select_qteBillet").length>0){nbAdultes=$(this).find(".select_qteBillet").val();nbEnfants=0;}
var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){$('.spanErreurAjax','.div_uneEtape_prodGP').remove();if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
effaceMsgAttenteParDessus("recapPrix");}else{effaceMsgAttenteParDessus("recapPrix");$('#div_selectionBillet select').val(0);$('#div_selectionBillet select').change();afficheMsgErreurSetLignesFactures(tabResult)}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function afficheMsgErreurSetLignesFactures(tabResult){(function($){$("#p_msgErreurs").html(tabResult.msg);$("#div_msgErreurs").show();$('html, body').animate({scrollTop:0},1000);$("#div_recapPrix").html(tabResult.msg).show();$('.div_uneEtape_prodGP').append('<span style="display:none;" class="spanErreurAjax" >'+tabResult.msg+'</span>');hideDivEtapeCanevas();})(jQuery);}
function verifNbPax(){(function($){var etapeValide=true;var div=$('.div_uneEtape_prodGP').attr('id');if(typeof div==='undefined'){div=$('#div_uneEtape_compoFamilleChambre').attr('id');}
var divTarifs;var qte;switch(div){case'div_uneEtape_hotelChoixChambre':etapeValide=false;$('.tr_tarifHotel').each(function(){$(this).find('.sp_msgErreurAdultes').hide();$(this).removeClass('invalide');var nbAdultes=$(this).find('.select_nbAdultesHotel').val();var nbEnfants=0;if($(this).find('.select_nbEnfantsHotel').length>0){nbEnfants=$(this).find('.select_nbEnfantsHotel').val();}
if(nbAdultes==0&&nbEnfants>0){$(this).addClass('invalide');$(this).find('.sp_msgErreurAdultes').show();}
if(nbAdultes>0){etapeValide=true;}});break;case'div_uneEtape_locatChoixChambre':etapeValide=false;$('.tr_tarifLocat').each(function(){$(this).removeClass('invalide');var nbAdultes=$(this).find('.select_nbAdultesLocat').val();var nbEnfants=0;if($(this).find('.select_nbEnfantsLocat').length>0){nbEnfants=$(this).find('.select_nbEnfantsLocat').val();}
if(nbAdultes==0&&nbEnfants>0){$(this).addClass('invalide');}
if(nbAdultes>0){etapeValide=true;}});break;case'div_uneEtape_choixNDate':if($('.tarifNDatePrixLibre').length>0){if(verifMontantLibreCorrect($('.tarifNDatePrixLibre').val())){etapeValide=true;}
else{etapeValide=false;}
break;}
qte=0;$('.td_ndateQuantite select').each(function(){qte+=$(this).val();});if(qte==0){etapeValide=false;}else{etapeValide=true;}
break;case'div_uneEtape_billetChoixPresta':divTarifs=$('#'+div);qte=0;$('.tr_tarifBillet').each(function(){qte+=$(this).find('.select_qteBillet').val();});if(qte==0){etapeValide=false;}else{etapeValide=true;}
break;case'div_uneEtape_voitureChoixPresta':etapeValide=false;$('.tr_tarifVoiture').each(function(){$(this).removeClass('invalide');var qte=$(this).find('.select_qteVoiture').val();if(qte>0){etapeValide=true;}else{$(this).addClass('invalide');}});if($('.inputTarifVoiture:checked').length>0){etapeValide=true;}
break;case'div_uneEtape_packageChoixTarif':qte=0;$('#'+div).find('.select_compoNbPers').each(function(){qte+=$(this).val();});if(qte==0){etapeValide=false;}else{etapeValide=true;}
break;case'div_uneEtape_compoFamilleChambre':etapeValide=true;var nbAdultes=0;$('#div_uneEtape_compoFamilleChambre .select_compoFamilleAdulte').each(function(){nbAdultes+=parseInt($(this).val());});if(nbAdultes===0){etapeValide=false;break;}
break;}
var recapPrixOk=true;if($('#div_recapPrix #p_msgErreur').length>0||$("#p_msgErreurs").is(':visible')){recapPrixOk=false;}
if(etapeValide&&recapPrixOk){$('#'+div).find('.inpt_validEtape').val('Oui');}else{$('#'+div).find('.inpt_validEtape').val('Non');}})(jQuery);}
function verifMontantNullResaBureau(){var verif=true;(function($){if($('#input_prixModifieBureau')&&$('#input_okPrixModifieBureau')){var val=$('#input_prixModifieBureau').val();var forcage=$('#input_okPrixModifieBureau').val();if(val<=0&&forcage==0){$("#div_confirmMontantNullResaBureau").dialog({autoOpen:false,width:500,modal:true});$('#div_confirmMontantNullResaBureau').dialog("option","buttons",{"Continuer":function(){$('#input_okPrixModifieBureau').val(1);$("#div_btnConfirmer > a:not(.a_btnAttenteConfirm)").click();$(this).dialog("close");},"Annuler":function(){$(this).dialog("close");}});$('#div_confirmMontantNullResaBureau').dialog('open');verif=false;}}})(jQuery);return verif;}
function verifChoixHeureVoiture(){var verif=true;(function($){if($('.select_heureVoiture:visible').length>0){$('.select_heureVoiture:visible').each(function(){if($(this).val()==0){var identifiant=$(this).attr('data-identifiant');var message=$('.sp_msgErrHeureVoiture[data-identifiant="'+identifiant+'"]').text();message="- "+message;if($("#div_msgErreurs:visible").length==0){$("#p_msgErreurs").html(message);$("#div_msgErreurs").show();}
else{$("#p_msgErreurs").append("<br />");$("#p_msgErreurs").append(message);}
document.location="#div_msgErreurs";verif=false;}});}
verifHeuresVoiture();})(jQuery);return verif;}
function initModifEtape(){(function($){$(".a_modifEtape").click(function(){$(this).siblings("h3").find(".sp_lblEtape").validationEngine("hide");$(this).parents(".div_uneEtape").find(".div_uneEtapeRecap").hide("slow");$(".div_uneEtapeCurr").removeClass('div_uneEtapeCurr');$(this).parents(".div_uneEtape").addClass('div_uneEtapeCurr');$(this).parents(".div_uneEtape").find(".div_uneEtapeContent").show("slow",function(){$(this).parents(".div_uneEtape").find(".div_uneEtapeContent").css("overflow","");});$(this).hide();});})(jQuery);}
function setEventsForNDate(){(function($){initDescTarifQTip();$('.td_ndateQuantite select').change(function(){var qte=0;$('.td_ndateQuantite select').each(function(){qte+=$(this).val();});if(qte==0){majLstCanevasOblig(0);activeCanevasAvecTarifForfaitaire();}else{setLignesFactures_ndate();}});if($("#div_uneEtape_canevas").length>0){initCanevasResaCouplee(1);}})(jQuery);}
function setEventsForPack(dateLigneFacture){(function($){$('.select_compoNbPers').live('change',function(){var qte=$(this).find('option:selected').attr('data-qte');if(qte>0&&$(this).parents('.div_unTarifContent').find('.div_unTarifComposants').children('.div_unComposantConsultable').length>0){$(this).parents('.div_unTarifContent').find('.div_unTarifComposants').show();}else{$(this).parents('.div_unTarifContent').find('.div_unTarifComposants').hide();}
var qteTotal=0;$('.select_compoNbPers').each(function(){qteTotal+=parseInt($(this).find('option:selected').attr('data-qte'));});if(qteTotal>0){setLignesFactures_package(dateLigneFacture);}else{$('#div_recapPrix').hide();}});$('.a_choixAlternatives').live('click',function(){var divARemplir=$(this).parents('.div_unComposant').find('.div_unComposantAlternatives');var divDetailComposant=$(this).parents('.div_unComposant').find('.div_detailComposant');if(divARemplir.html().length>0){if(divARemplir.is(':visible')){divARemplir.hide();divDetailComposant.show();}else{divARemplir.show();selectionneTarifSelectDansAlternatives(divARemplir);divDetailComposant.hide();}}else{var btnsAlternatives=$(this).parents('.div_unTarifComposants').find('.a_choixAlternatives');btnsAlternatives.each(function(){var idTarif=$(this).parents('.div_unTarif').find('.inpt_idTarif').val();var idComposant=$(this).parents('.div_unComposant').attr('data-idcomposant');var divAlternative=$(this).parents('.div_unComposant').find('.div_unComposantAlternatives');$.ajax({type:'POST',url:urlAJAX,data:{type:'getHTML_choixAlternatives',idTarif:idTarif,idComposant:idComposant},beforeSend:function(){divDetailComposant.hide();divARemplir.show();divARemplir.html(txtAttente);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='OK'){divAlternative.html(tabResult.html);selectionneTarifSelectDansAlternatives(divARemplir);}}});});}});$('.a_btnChoixAlternative').live('click',function(){affecteAlternative($(this));setLignesFactures_package();});$(".affichePlusAlternative a").live('click',function(){$(".div_detailAlternative.masque").show();$(this).hide();});$(".a_linkDetailAlternativeFancyBox").fancybox({fitToView:false,width:'80%',height:'80%',autoSize:false,closeClick:false,closeEffect:'none'});})(jQuery);}
function selectionneTarifSelectDansAlternatives(divAlternatives){(function($){var idTarifComposant=divAlternatives.parents('.div_unComposant').attr('data-idtarif');divAlternatives.find('.div_detailAlternative').each(function(){var idTarif=$(this).find('.a_btnChoixAlternative').attr('data-idtarif')
if(idTarif==idTarifComposant){$(this).addClass('selected');}else{$(this).removeClass('selected');}});})(jQuery);}
function affecteAlternative(elemBtn){(function($){var libelleComposant=elemBtn.attr('data-libelle');var nomComposant=elemBtn.attr('data-nom');var idComposant=elemBtn.attr('data-idtarif');var srcImage=elemBtn.attr('data-image');var linkToFiche=elemBtn.attr('data-linkfiche');var prix=elemBtn.attr('data-prix');elemBtn.parents('.div_unComposantAlternatives').hide();if(elemBtn.parents('.div_unComposant').attr('data-idtarif')!=idComposant){elemBtn.parents('.div_unComposant').attr('data-idtarif',idComposant);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.titreComposantNomLibelle').text(libelleComposant);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.titreComposantNom').text(nomComposant);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.div_composantVignette img').attr('src',srcImage);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.a_lnkToFiche').attr('href',linkToFiche);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.a_linkDetailAlternativeFancyBox').attr('href',linkToFiche);elemBtn.parents('.div_unComposant').find('.div_detailComposant').find('.sp_prixComposant').text(prix);}
elemBtn.parents('.div_unComposant').find('.div_detailComposant').show();})(jQuery);}
function setEventsForVoiture(){(function($){$('.select_qteVoiture').live('change',function(){var qte=$(this).val();if(qte>0){setLignesFactures_voiture();}else{$('#div_recapPrix').hide();}});$('.select_heureVoiture').live('change',function(){setLignesFactures_voiture();});$(document).delegate('.inputTarifVoiture','change',function(){if(!setLignesFactures_voitureNew()){return false;}});$(document).delegate('.inputHeureVoiture','change',function(){var dateFin=$("#inpt_resaDateFin").val();var dateDeb=$("#inpt_resaDateDeb").val();var heuresByStock={};$('.inputHeureVoiture').each(function(){var codeStock=$(this).data('codestock');heuresByStock[codeStock]=heuresByStock[codeStock]||{};if($(this).hasClass('inputHeureDebVoiture')){heuresByStock[codeStock].HEUREDEB=$(this).val();}
if($(this).hasClass('inputHeureFinVoiture')){heuresByStock[codeStock].HEUREFIN=$(this).val();}});var tabData={type:"verifDates_GP",dateDeb:dateDeb,dateFin:dateFin,HEURESVOITUREBYSTOCK:heuresByStock}
ajaxVerifDates(tabData);});})(jQuery);}
function verifHeuresVoiture(){return(function($){if($('.inputHeureDebVoiture').length===0){return true;}
if($('.inputTarifVoiture:checked').length===0){return true;}
var dateFin=$("#inpt_resaDateFin").val();var dateDeb=$("#inpt_resaDateDeb").val();if(!dateFin||!dateDeb){return false;}
var tabValidation=[];var regexHeure=/^[0-9]{2}:[0-9]{2}$/;var typePlan=$('.inputTarifVoiture:checked').data('codestock');var heureDeb=new LiveValidation('inputHeureDebVoiture_'+typePlan,{validMessage:$('#inpt_msgOk').val()});heureDeb.add(Validate.Presence,{failureMessage:$('#inpt_msgVide').val()});heureDeb.add(Validate.Format,{pattern:regexHeure,failureMessage:'format 00:00'});heureDeb.add(Validate.Custom,{against:function(value,args){var heuresAutorisees=$('#inputHeureDebVoiture_'+typePlan).data('heures_autorisees');if(heuresAutorisees.indexOf(value)<0){return false;}
return true;},failureMessage:$('.inpt_msgHeuresIncoherentes:first').val()});tabValidation.push(heureDeb);var heureFin=new LiveValidation('inputHeureFinVoiture_'+typePlan,{validMessage:$('#inpt_msgOk').val()});heureFin.add(Validate.Presence,{failureMessage:$('#inpt_msgVide').val()});heureFin.add(Validate.Format,{pattern:regexHeure,failureMessage:'format 00:00'});heureFin.add(Validate.Custom,{against:function(value,args){if(dateDeb===dateFin){var valDeb=$('#inputHeureDebVoiture_'+typePlan).val();var heureDeb=valDeb.replace(':','');var heureFin=value.replace(':','');if(parseInt(heureDeb)>=parseInt(heureFin)){return false;}
var heuresAutorisees=$('#inputHeureFinVoiture_'+typePlan).data('heures_autorisees');if(heuresAutorisees.indexOf(value)<0){return false;}}
return true;},failureMessage:$('#inpt_msgHeuresIncoherentes').val()});tabValidation.push(heureFin);if(!LiveValidation.massValidate(tabValidation)){$("#div_uneEtape_date .div_uneEtapeRecap").hide();if($("#inpt_avecRepli").length>0){$("#div_uneEtape_date .div_uneEtapeContent").show();}
return false;}
return true;})(jQuery);}
function setLignesFactures_package(dateLigneFacture){(function($){var lignesFactures=new Array();var i=0;$(".div_unTarifComposants").each(function(){var tarifs=new Array();var decomptes=new Array();var nbEnfants=0;var listeNbPers=$(this).parents('.div_unTarifContent').find(".div_unTarifSelection .select_compoNbPers");var nbAdultes=listeNbPers.val();var nbPax=nbAdultes;var qte=listeNbPers.find('option:selected').attr('data-qte');var codeStock='';var idTarif=$(this).find('.inpt_idTarif').val();var divComposants=$(this).find(".div_unComposant");var j=0;divComposants.each(function(){var idComposant=$(this).attr('data-idcomposant');var idTarifCompo=$(this).attr('data-idtarif');decomptes[j]=new Array(idComposant,idTarifCompo);j++;});tarifs[0]=new Array(idTarif,nbPax,qte,decomptes);lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures,dateLigneFacture:dateLigneFacture},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){$("#div_msgErreurs").hide();$('.spanErreurAjax','.div_uneEtape_prodGP').remove();if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
$('.div_unTarifComposants').each(function(){if($(this).children('.div_unComposant:visible').length==0){$(this).hide();}});showDivEtapeCanevas();}else{afficheMsgErreurSetLignesFactures(tabResult);}
effaceMsgAttenteParDessus("recapPrix");},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures_ndate(){(function($){var lignesFactures=new Array();var i=0;var appelAsync=true;$('.tr_tarifNDate').each(function(){var tarifs=new Array();var codeStock=$(this).find(".inpt_codeStock").val();var idTarif=$(this).find(".inpt_idTarif").val();var qte;if($('.tarifNDatePrixLibre',this).length>0){appelAsync=false;qte=1;var montantPrixLibre=$(this).find('.tarifNDatePrixLibre').val();tarifs[0]={0:idTarif,1:qte,prixLibre:montantPrixLibre};}
else{qte=$(this).find(".td_ndateQuantite select").val();tarifs[0]=new Array(idTarif,qte);}
var codeProd=$(this).find(".inpt_codeProd").val();lignesFactures[i]=new Array(codeStock,qte,0,tarifs,'',codeProd);i++;});$('.spanErreurAjax','.div_uneEtape_prodGP').remove();$.ajax({async:appelAsync,type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
effaceMsgAttenteParDessus("recapPrix");}
else{$("#div_recapPrix").html('<p>'+tabResult.msg+'</p>').show();$('.div_uneEtape_prodGP').append('<span style="display:none;" class="spanErreurAjax" >'+tabResult.msg+'</span>');}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures_voiture(){(function($){var lignesFactures=new Array();var i=0;$(".tr_tarifVoiture:visible").each(function(){var tarifs=new Array();var codeStock=$(this).attr("data-codestock");var idTarif=$(this).attr("data-idtarif");var nbAdultes=0;var nbEnfants=0;var j=0;var commLF='';if($(this).find(".select_qteVoiture").length>0){nbAdultes=$(this).find(".select_qteVoiture").val();nbEnfants=0;}
var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);if(nbPax>0){tarifs[j]=new Array(idTarif,nbPax);j++;}
if($(this).find('.td_heurePriseVoiture').length>0){commLF+=$(this).find('.td_heurePriseVoiture .select_heureVoiture').val();}
if($(this).find('.td_heureDepotVoiture').length>0){commLF+='-';commLF+=$(this).find('.td_heureDepotVoiture .select_heureVoiture').val();}
lignesFactures[i]=new Array(codeStock,nbAdultes,nbEnfants,tarifs,commLF);i++;});$.ajax({type:"POST",url:urlAJAX,data:{type:"setLignesFactures",lignesFactures:lignesFactures},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
effaceMsgAttenteParDessus("recapPrix");}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setLignesFactures_voitureNew(){if(!verifHeuresVoiture()){return false;}
(function($){var lignesFactures=new Array();var i=0;var heures={};var params={type:"setLignesFactures"};$('.inputTarifVoiture:checked').each(function(){var tarifs=new Array();var codeStock=$(this).attr('data-codestock');var idTarif=$(this).attr('data-idtarif');tarifs[0]=new Array(idTarif,1);lignesFactures[i]=new Array(codeStock,1,0,tarifs);heures[idTarif]={deb:$('#inputHeureDebVoiture_'+codeStock).val(),fin:$('#inputHeureFinVoiture_'+codeStock).val()}
i++;});params.lignesFactures=lignesFactures;params.heures=heures;$.ajax({type:"POST",url:urlAJAX,data:params,beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",txtAttente);afficheLoaderGlobal_site();},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code=="OK"){if(tabResult.recapPrix){afficheEffaceRecapPrix_Prod(tabResult);}else{$("#div_recapInfos").html(tabResult.recapInfos);$("#div_recapPrix").hide();}
if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);}
effaceMsgAttenteParDessus("recapPrix");}},complete:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function setEventsForLocat(){(function($){$('.select_nbCodeStock').live('change',function(){var codeStock=$(this).attr('data-codestock');var nbCodeStock=$(this).val();$('.tr_tarifLocat[data-codestock="'+codeStock+'"]').hide();$('.enteteCodeStock[data-codestock="'+codeStock+'"][data-noligne!="1"]').hide();for(var i=1;i<=nbCodeStock;i++){$('.enteteCodeStock[data-codestock="'+codeStock+'"][data-noligne="'+i+'"]').show();$('.tr_tarifLocat[data-codestock="'+codeStock+'"][data-noligne="'+i+'"]').show();}
setLignesFactures_locat();afficheMasqueHeaderLocat();});$(".select_nbAdultesLocat").live('change',function(){var nbPersMaxi=$(this).parents('.tr_tarifLocat').attr('data-nbmaxi');var nbAdultes=$(this).val();var nbEnfantsMax=parseInt(nbPersMaxi)-parseInt(nbAdultes);var listeEnfants=$(this).parents('.tr_tarifLocat').find('.select_nbEnfantsLocat');var idTarif=$(this).parents('.tr_tarifLocat').attr('data-idtarif');var noLigne=$(this).parents('.tr_tarifLocat').attr('data-noligne');$('.tr_supplementsTarif').each(function(){if($(this).attr('data-idtarifprod')==idTarif&&$(this).attr('data-noligne')==noLigne){if(nbAdultes>0){$(this).show();}else{$(this).hide();}}});if(nbEnfantsMax==0){listeEnfants.hide();}else{listeEnfants.show();listeEnfants.find('option').each(function(){if($(this).val()>nbEnfantsMax){$(this).hide();}else{$(this).show();}});}
var nbAdultesTot=0;$('.select_nbAdultesLocat:visible').each(function(){if($(this).val()>0){nbAdultesTot+=$(this).val();}});if(nbAdultesTot==0){$('#div_uneEtape_locatChoixChambre').find('.inpt_validEtape').val('Non');$('#div_recapPrix').hide();$('#div_recapInfosFamille').remove();}
else{setLignesFactures_locat();}
var nbEnfants=listeEnfants.val();var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);majListesSupplementsLocat(idTarif,nbPax);});$(".select_nbEnfantsLocat").live('change',function(){var nbEnfants=$(this).val();var nbAdultes=$(this).parents('.tr_tarifLocat').find('.select_nbAdultesLocat').val();var nbPersMaxi=$(this).parents('.tr_tarifLocat').attr('data-nbmaxi');var nbAdultesMax=parseInt(nbPersMaxi)-parseInt(nbEnfants);var listeAdultes=$(this).parents('.tr_tarifLocat').find('.select_nbAdultesLocat');listeAdultes.find('option').each(function(){if($(this).val()>nbAdultesMax){$(this).hide();}else{$(this).show();}});if(nbAdultes>0){setLignesFactures_locat();}
var idTarif=$(this).parents('.tr_tarifLocat').attr('data-idtarif');var nbPax=parseInt(nbAdultes)+parseInt(nbEnfants);majListesSupplementsLocat(idTarif,nbPax);});setEventsSupplements(setLignesFactures_locat);$('.a_btnChoixTarif').live('click',function(){var div=$(this).attr('data-div');var divTarif=$('.'+div+'.divDeBase').clone();$(this).parents('.div_uneChambre_choixTarif').after(divTarif);divTarif.removeClass('divDeBase').show();$(this).parents('.div_uneChambre_choixTarif').hide();});$('.a_modifTarif').live('click',function(){$(this).parents('.div_uneChambreTarifs').prev().show();$(this).parents('.div_uneChambreTarifs').remove();});})(jQuery);}
function afficheMasqueHeaderLocat(){var totalSelect=0;jQuery('.select_nbCodeStock').each(function(){totalSelect+=jQuery(this).val();});if(totalSelect>0){jQuery('#div_selectionLocatif > table > thead').show();}else{jQuery('#div_selectionLocatif > table > thead').hide();}}
function setEventsForBillet(){(function($){$(".select_qteBillet").live("change",function(){setOnChangeStock(this);var nbPers=0;$('.select_qteBillet:visible').each(function(){if($(this).val()>0){nbPers+=$(this).val();}});if(nbPers==0){$('#div_uneEtape_billetChoixPresta').find('.inpt_validEtape').val('Non');$('#div_recapPrix').hide();$('#div_recapInfosFamille').remove();}
else{setLignesFactures_billet();}});})(jQuery);}
function setOnChangeStock(select){(function($){var codestock=$(select).closest('.ligneTarif').attr('data-codestock');var currentStock=$(select).closest('.ligneTarif').attr('data-nbstock');$(".ligneTarif[data-codestock='"+codestock+"']").find('.td_qte select').each(function(){currentStock=currentStock-$(this).val();});$(".ligneTarif[data-codestock='"+codestock+"']").find('.td_qte select').each(function(){if(this===select){return true;}
var currentVal=$(this).val();$(this).find('option').remove();var maxOptions=parseInt(currentStock)+parseInt(currentVal);for(var i=0;i<=maxOptions;i++){var selected='';if(i==currentVal){selected='selected="selected"';}
$(this).append('<option value="'+i+'" '+selected+'>'+i+'</option>');}});})(jQuery);}
function majNumEtapes(){(function($){var numEtape=1;$('.sp_numEtape:visible').each(function(){$(this).text(numEtape);numEtape++;});})(jQuery);}
function initEtape1_panier(){(function($){idSession=getIdSessionInHtml();var demandePrix=false;$('.td_ndateQuantite > select').each(function(){if($(this).val()>0){demandePrix=true;}});if(demandePrix){$('.td_ndateQuantite').first().find('select').change();}})(jQuery);}
function afficheEffaceRecapPrix_Prod(tabResult){(function($){var html_recapPrix=tabResult.recapPrix;var html_choixAssurance=tabResult.choixAssurance;$("#div_recapPrix").html(html_recapPrix).show();$("#div_recapInfosEtPrix").show();majAssurance(null,html_choixAssurance);majNumEtapes();initAssurance();initModifEtape();$("#div_recapInfos").html(tabResult.recapInfos);if($("#div_uneEtape_assuranceAnnul").not(':visible')){$('.p_recapInfosAssur').hide();}
$(".div_uneEtapeGrisee *:not(.obligatoire)").attr("disabled",false);$('.div_uneEtapeGrisee').removeClass('div_uneEtapeGrisee');if(tabResult.nbPers){majLstCanevasOblig(tabResult.nbPers);activeCanevasAvecTarifForfaitaire();if($('#div_uneEtape_canevas').length>0){$('.divListeRubriquesDuCanevas .divUneRubriqueCanevas').show('fast');$('#aToggleChoixCanevas').children('#spanCanevasAffiche').hide();$('#aToggleChoixCanevas').children('#spanCanevasCache').show();}}
if(tabResult.motsMagiques=='Oui'){$('#div_uneEtape_motMagique').show();}
var messageDevis=tabResult.msgInfoModeResa||'';if(messageDevis){$('.infosModeResa').html(messageDevis);$('.infosModeResa').show();$('#sp_lblRecapDates').parent().hide();}})(jQuery);}
function majRubriqueCanevasAvecElementNonCumulable(obj){(function($){if(obj.is(':checked')||(obj.val()!=0&&obj.val()!=null)){obj.parents('.tarifElementRubriqueCanevas').addClass('selected');obj.parents('.liste_tarifs_de_la_rubrique').find('.tarifElementRubriqueCanevas:not(.selected) *').attr("disabled",true);}else{obj.parents('.tarifElementRubriqueCanevas').removeClass('selected');obj.parents('.liste_tarifs_de_la_rubrique').find('.tarifElementRubriqueCanevas *').attr("disabled",false);}})(jQuery);}
function activeCanevasAvecTarifForfaitaire(){(function($){if($("#div_uneEtape_canevas").length>0){var nbPers=$('.divUneRubriqueCanevas').first().attr('data-nbpers');if(nbPers>0){$('.inpt_choixQteCanevas_forfait').not('.obligatoire').attr('disabled',false);}else{$('.inpt_choixQteCanevas_forfait').attr('disabled',true);}}})(jQuery);}
function majFormClientResa_reseauSocial(tabInfosUser){(function($){if(tabInfosUser.email){$('#inpt_mailClient').val(tabInfosUser.email);$('#inpt_confirmMailClient').val(tabInfosUser.email);}
if(tabInfosUser.nom){$('#inpt_nomClient').val(tabInfosUser.nom);}
if(tabInfosUser.prenom){$('#inpt_prenomClient').val(tabInfosUser.prenom);}
if(tabInfosUser.civilite){$('#select_civiliteClient').val(tabInfosUser.civilite);}
if(tabInfosUser.pays){}
if(tabInfosUser.ville){$('#inpt_villeClient').val(tabInfosUser.ville);}})(jQuery);}
function ouvrePopInAuthentificationCompteGdf(adr){(function($){window.open(adr,"Authentification Compte Gtes de France","top=50,left=50,width=260,height=50,scrollbars=yes,resizable=yes");if(getVersionIE()<12){var i=j=0;while(i<=20){j=5000+j;setTimeout(function(){$.ajax({type:'POST',url:urlAJAX,data:'type=clientConnecteCompteGdf',success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='OK'){var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}}});},j);i++;}}
else{window.addEventListener('message',function(message){if(message.data=='reload'){var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}
else{$('#itea_cnxCptGDFResa_msgInfo').html(message.data);$('#itea_cnxCptGDFResa_msgInfo').fadeOut().fadeIn();}},false);}})(jQuery);}
function resaFacebookOK(tabInfosUser){(function($){$('.div_connexionReseau').hide();$('#div_msgChoixReseauxSociauxOuSaisieFormulaire').hide();majFormClientResa_reseauSocial(tabInfosUser);})(jQuery);}
function resaFacebookKO(){(function($){$('.div_connexionReseau').show();$('#div_msgChoixReseauxSociauxOuSaisieFormulaire').show();})(jQuery);}
function chargeAlternatives(){(function($){var btnsAlternatives=$('.a_choixAlternatives');btnsAlternatives.each(function(){var divARemplir=$(this).parents('.div_unComposant').find('.div_unComposantAlternatives');var idTarif=$(this).parents('.div_unTarif').find('.inpt_idTarif').val();var idComposant=$(this).parents('.div_unComposant').attr('data-idcomposant');var divAlternative=$(this).parents('.div_unComposant').find('.div_unComposantAlternatives');$.ajax({type:'POST',url:urlAJAX,data:{type:'getHTML_choixAlternatives',idTarif:idTarif,idComposant:idComposant},beforeSend:function(){divARemplir.html(txtAttente);},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='OK'){divAlternative.html(tabResult.html);}}});});})(jQuery);}
function setEventsSupplements(foncPrix){(function($){$(".select_qteSupplement").live('change',function(){foncPrix();});$('.select_supplementForfaitaire').live('change',function(){foncPrix();});})(jQuery);}
function majListesSupplementsHotel(){(function($){var nbPax=0;var nbAdultes;var nbEnfants;var nbPaxSelected;var htmlOption;var selected='';$('.select_nbAdultesHotel').each(function(){nbAdultes=parseInt($(this).val());nbPax+=nbAdultes;});$('.select_nbEnfantsHotel').each(function(){nbEnfants=parseInt($(this).val());nbPax+=nbEnfants;});$('.select_qteSupplement').each(function(){nbPaxSelected=$(this).val();$(this).html('');if(nbPaxSelected>nbPax){nbPaxSelected=nbPax;}
for(var i=0;i<=nbPax;i++){if(i==nbPaxSelected){selected='selected="selected"';}else{selected='';}
htmlOption='<option value="'+i+'" '+selected+'>'+i+'</option>';$(this).append(htmlOption);}});})(jQuery);}
function majListesSupplementsLocat(idTarif,nbPax){(function($){var nbPaxSelected;var selected;var htmlOption;$('.tr_tarifSupplement').each(function(){if($(this).attr('data-idtarifprod')==idTarif){if($(this).find('.select_qteSupplement').length>0){$(this).find('.select_qteSupplement').each(function(){nbPaxSelected=$(this).val();$(this).html('');for(var i=0;i<=nbPax;i++){if(i==nbPaxSelected){selected='selected="selected"';}else{selected='';}
htmlOption='<option value="'+i+'" '+selected+'>'+i+'</option>';$(this).append(htmlOption);}});}}});})(jQuery);}
function verifNbPaxCodeStock_hotel(codestock){(function($){var stockDispoTotal=null;var nbAdultes;var nbEnfants;var nbPax;var stockDispo;var nbChambres;var nbMaxChambre;$('.tr_tarifHotel').each(function(){if($(this).attr('data-codestock')==codestock){nbAdultes=$(this).find('.select_nbAdultesHotel').val();if($(this).find('.select_nbEnfantsHotel').length>0){nbEnfants=$(this).find('.select_nbEnfantsHotel').val();}else{nbEnfants=0;}
nbPax=parseInt(nbAdultes)-parseInt(nbEnfants);nbMaxChambre=parseInt($(this).attr('data-nbmaxchambre'));nbChambres=Math.ceil(nbPax/nbMaxChambre);stockDispo=$(this).attr('data-stockdispo');if(stockDispoTotal===null){stockDispoTotal=stockDispo-nbChambres;}else{stockDispoTotal=stockDispoTotal-nbChambres;}
if(nbChambres>0){$(this).addClass('selected');}else{$(this).removeClass('selected');}}});$('.tr_tarifHotel').each(function(){if($(this).attr('data-codestock')==codestock&&!$(this).hasClass('selected')){nbMaxChambre=parseInt($(this).attr('data-nbmaxchambre'));var nbPersMax=nbMaxChambre*stockDispoTotal;if(stockDispoTotal<=0){$(this).find('input,select').attr('disabled',true);$(this).addClass('chambreGrisee');}else{$(this).find('input,select').attr('disabled',false);$(this).removeClass('chambreGrisee');$(this).find('select').children().each(function(){if($(this).val()>nbPersMax){$(this).hide();}else{$(this).show();}});}}});})(jQuery);}
function initDescTarifQTip(){(function($){if($('.img_descTarifAvecQTip').length>0){$('.viewWithQtipTohide').hide();$('.img_descTarifAvecQTip').each(function(){if($(this).attr('data-text')&&$("#"+$(this).attr('data-text'))){$(this).qtip({content:{text:$("#"+$(this).attr('data-text')).html(),title:{text:$(this).attr('data-titre')}},show:'mouseover',hide:'mouseout'});}});}})(jQuery);}
function initEtape1_2(){(function($){$.ajaxSetup({timeout:100000});initEtape2();majNumEtapes();if($('#div_uneEtape_compoFamilleGite').length>0&&$('#div_uneEtape_compoFamilleGite').find('.inpt_validEtape').val()!='Oui'){$('#div_uneEtape_dejaClient').addClass('div_uneEtapeGrisee');$('#div_uneEtape_nouveauClient').addClass('div_uneEtapeGrisee');}
if($('#div_uneEtape_compoFamilleChambre').length>0&&$('#div_uneEtape_compoFamilleChambre').find('.inpt_validEtape').val()!='Oui'){$('#div_uneEtape_dejaClient').addClass('div_uneEtapeGrisee');$('#div_uneEtape_nouveauClient').addClass('div_uneEtapeGrisee');}
$('#div_btnConfirmer_2etapes').click(function(){$('#div_btnConfirmer_1 > a').click();});})(jQuery);}
function setHeuresArriveeDepart(){(function($){var heureArrivee=$('#inpt_heureArrivee').val();var heureDepart=$('#inpt_heureDepart').val();var pattern=/([0-9]{1,2}[h|H][0-9]{0,2})/;var regex=new RegExp(pattern);if(regex.test(heureArrivee)&&regex.test(heureDepart)){$('#sp_msgErrHoraires').hide();$.ajax({type:'POST',url:urlAJAX,data:{type:'setHeuresArriveeDepart',heureArrivee:heureArrivee,heureDepart:heureDepart},success:function(result){eval('var tabRetour='+result);$('#div_recapInfos').html(tabRetour.recapInfos);}});}else{$('#sp_msgErrHoraires').show();}})(jQuery);}
function initModifPrixResaBureau(){(function($){if($('#div_btnModifPrix').length>0){$("#div_modifPrixResaBureau").dialog({autoOpen:false,width:500,modal:true});$("#div_modifPrixResaBureauDangereux").dialog({autoOpen:false,width:500,modal:true});$('#div_btnModifPrix a').live('click',function(){$.ajax({type:'POST',url:urlAJAX,data:{type:'getHTML_popinModifPrixResaBureau'},success:function(result){var tabRetour=XMLToArray(result);$('#div_modifPrixResaBureau').html(tabRetour.html);$('#div_modifPrixResaBureau').dialog('open');initDatepickerDateLimite();initCalculsModifPrixResaBureau();calculsModifPrixResaBureau();}});});initDialogModifPrixResaBureau();initDialogModifPrixResaBureauDangereux();}})(jQuery);}
function initDialogModifPrixResaBureau(){(function($){$('#div_modifPrixResaBureau').dialog("option","buttons",{"Annuler":function(){$(this).dialog("close");},"Valider":function(){verifFraisDossier();if(prixResaBureauDangereux()){$('#div_modifPrixResaBureauDangereux').dialog('open');return false;}
enregistreNouveauxPrix();}});})(jQuery);}
function prixResaBureauDangereux(){var prixDangereux=false;(function($){var html='<div class="alert alert-danger">';if(parseFloat($('.inpt_modifPrixResaBureau[name="prixLocation"]').val())===0){html+='Le prix de location est dfini  0.<br />';prixDangereux=true;}
if($('.inpt_modifPrixResaBureau[name="tauxAcompte"]').length>0&&parseFloat($('.inpt_modifPrixResaBureau[name="tauxAcompte"]').val())===0){html+='Le taux de l\'acompte est dfini  0.<br />';prixDangereux=true;}
if(parseFloat($('.inpt_modifPrixResaBureau[name="tauxCommission"]').val())===0){html+='Le taux de commission est dfini  0.<br />';prixDangereux=true;}
if($('.inpt_modifPrixResaBureau[name="fraisDossier"]').hasClass('erreur')){html+='Les frais de dossier sont suprieurs au prix de la location et ont t dfini  0';prixDangereux=true;}
html+='</div>';$('#div_modifPrixResaBureauDangereux').html(html);})(jQuery);return prixDangereux;}
function enregistreNouveauxPrix(){(function($){if($('.inpt_modifPrixResaBureau[name="fraisDossier"]').val()==''){$('.inpt_modifPrixResaBureau[name="fraisDossier"]').val(0);}
var tabPrix=new Array();var i=0;$('.inpt_modifPrixResaBureau').each(function(){var nom=$(this).attr('name');var valeur=$(this).val();tabPrix[i]=new Array(nom,valeur);i++;});$.ajax({type:'POST',url:urlAJAX,data:{type:'enregistreNouveauxPrix',tabPrix:tabPrix},success:function(result){var tabResult=XMLToArray(result);if(tabResult.code==='KO'){if(tabResult.msg.length>0){$('#div_msgErreurModifPrix p.p_msgErrResaProp').html(tabResult.msg);$('#div_msgErreurModifPrix').show();return false;}
$('#div_modifPrixResaBureau').dialog("close");}
afficheEffaceRecapPrix(tabResult);$('#div_modifPrixResaBureau').dialog("close");}});})(jQuery);}
function initDialogModifPrixResaBureauDangereux(){(function($){$('#div_modifPrixResaBureauDangereux').dialog("option","buttons",{"Annuler":function(){$(this).dialog("close");},"Valider":function(){enregistreNouveauxPrix();$(this).dialog('close');}});})(jQuery);}
function initDatepickerDateLimite(){(function($){$('.inpt_modifPrixResaBureau[name="dateLimite"]').datepicker({minDate:0});})(jQuery);}
function calculsModifPrixFraisDossier(){(function($){var fraisDossier=recalculPrixFraisDossier();var textFraisDossier='recalcul: '+fraisDossier+' ';$('#sp_prixFraisDossier').text(textFraisDossier);$('#sp_prixFraisDossier').removeAttr('hidden');$('.inpt_modifPrixFraisDossier[name="fraisDossier"]').val(fraisDossier);})(jQuery);}
function recalculPrixFraisDossier(){var total=0;(function($){var prixLocation=0;if($('.inpt_modifPrixResaBureau[name="prixLocation"]').length>0){prixLocation=getValeurChampModifPrix('prixLocation');}else if($('.inpt_modifPrixResaBureau.prixChambre').length>0){$('.inpt_modifPrixResaBureau.prixChambre').each(function(){prixLocation+=getValeurChampModifPrix($(this).attr('name'));});}
var min=$('.inpt_minFraisDossier[name="minFraisDossier"]').val();var max=$('.inpt_maxFraisDossier[name="maxFraisDossier"]').val();var taux=$('.inpt_tauxFraisDossier[name="tauxFraisDossier"]').val();var montant=$('.inpt_montantFixeFraisDossier[name="montantFixeFraisDossier"]').val();if(montant>0){total=montant;}else{total=prixLocation*taux/100;if(total<min){total=min;}
else if(max>0&&total>max){total=max;}}})(jQuery);return Number.parseFloat(total).toFixed(2);}
function initCalculsModifPrixResaBureau(){(function($){$('.inpt_modifPrixResaBureau').live('keyup',function(){calculsModifPrixResaBureau();calculsModifPrixFraisDossier();});})(jQuery);}
function calculsModifPrixResaBureau(){(function($){var total=recalculPrixTotalResaBureau();$('#sp_prixTotalModif').text(total);$('.inpt_modifPrixResaBureau[name="total"]').val(total);if($('.inpt_modifPrixResaBureau[name="prixLocation"]').length>0){if(getValeurChampModifPrix('promotion')>0){$('.inpt_modifPrixResaBureau[name="tauxRemise"]').attr('disabled','disabled');}else{$('.inpt_modifPrixResaBureau[name="tauxRemise"]').removeAttr('disabled');}
if(getValeurChampModifPrix('tauxRemise')>0){$('.inpt_modifPrixResaBureau[name="promotion"]').attr('disabled','disabled');}else{$('.inpt_modifPrixResaBureau[name="promotion"]').removeAttr('disabled');}}})(jQuery);}
function recalculPrixTotalResaBureau(){var total=0;(function($){var prixLocation=0;if($('.inpt_modifPrixResaBureau[name="prixLocation"]').length>0){prixLocation=getValeurChampModifPrix('prixLocation');}else if($('.inpt_modifPrixResaBureau.prixChambre').length>0){$('.inpt_modifPrixResaBureau.prixChambre').each(function(){prixLocation+=getValeurChampModifPrix($(this).attr('name'));});}
var assurAnnul=getValeurChampModifPrix('assurAnnul');var fraisDossier=getValeurChampModifPrix('fraisDossier');var charges=getValeurChampModifPrix('charges');var promotion=getValeurChampModifPrix('promotion');var remise=getValeurChampModifPrix('tauxRemise')*prixLocation/100;var totalOption=0;$('.inpt_modifPrixResaBureau[name^=prixOption]').each(function(){totalOption+=getValeurChampModifPrix($(this).attr('name'));});total=prixLocation+assurAnnul+fraisDossier+charges+totalOption-promotion-remise;total=Math.round(total*100)/100;})(jQuery);return total;}
function recalculPrixAcompteResaBureau(){var acompte;var total=getValeurChampModifPrix('total');var tauxAcompte=getValeurChampModifPrix('tauxAcompte');acompte=total*tauxAcompte/100;acompte=Math.floor(acompte);return acompte;}
function getValeurChampModifPrix(nomChamp){var valeur=0;(function($){if($('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').length>0&&$('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').val()!=''&&($('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').is(':visible')||nomChamp=='total')){var valeurAvantParse=$('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').val();var regexFloat=new RegExp(/^[0-9]*[\.|,]?[0-9]{0,2}$/);if(regexFloat.test(valeurAvantParse)){$('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').removeClass('erreur');valeur=parseFloat(valeurAvantParse.replace(',','.'));var tabNomChamp=nomChamp.split('_');if(tabNomChamp[0]=='prixOption'){valeur=valeur*parseFloat($('#coeffOption_'+tabNomChamp[1]).val());}
if($('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').hasClass('pourcentage')){if(valeur<0||valeur>100){$('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').addClass('erreur');valeur=0;}}}else{$('.inpt_modifPrixResaBureau[name="'+nomChamp+'"]').addClass('erreur');valeur=0;}}})(jQuery);return valeur;}
function initAutocompleteClientsExistants(avecDpt){(function($){var date;var timeKeyUp;var xhr;$('#inpt_nomClient, #inpt_prenomClient, #inpt_mailClient, #inpt_cpClient, #inpt_telDomClient').keyup(function(){if($('#inpt_prenomClient').val()!=''){if($('#inpt_nomClient').val()==''&&$('#inpt_mailClient').val()==''&&$('#inpt_cpClient').val()==''&&$('#inpt_telDomClient').val()==''){return false;}}
date=new Date();timeKeyUp=date.getTime();setTimeout(function(){date=new Date();var time=date.getTime();var delai=time-timeKeyUp;if(delai>=800){xhr=lanceAutocompleteClients(avecDpt);}},800);});$('#inpt_nomClient, #inpt_prenomClient, #inpt_mailClient, #inpt_cpClient, #inpt_telDomClient').keypress(function(){if(xhr!==undefined){xhr.abort();}});})(jQuery);}
function lanceAutocompleteClients(avecDpt,pourMiniCatalogue){return(function($){if(pourMiniCatalogue){var nom=$('.div_champMiniCatalogue .nom').val();var prenom=$('.div_champMiniCatalogue .prenom').val();var mail=$('#div_envoiAmiContent #email1').val();var cp=$('.div_champMiniCatalogue .cp').val();var tel=$('.div_champMiniCatalogue .teldom').val();var url='./ajax/appelsAjax.php';}else{var nom=$('#inpt_nomClient').val();var prenom=$('#inpt_prenomClient').val();var mail=$('#inpt_mailClient').val();var cp=$('#inpt_cpClient').val();var tel=$('#inpt_telDomClient').val();var url=urlAJAX;}
var data={nom:nom,prenom:prenom,mail:mail,cp:cp,tel:tel,avecDpt:avecDpt};if(pourMiniCatalogue){data['action']='getHTML_listeClientsForAutocomplete';}else{data['type']='getHTML_listeClientsForAutocomplete';}
var xhr;if(nom.length>=3||prenom.length>=4||mail.length>=4||cp.length>=2||tel.length>=6){xhr=$.ajax({type:'POST',url:url,data:data,beforeSend:function(){$('#div_autocompleteClients').show();if(pourMiniCatalogue){$('#div_sendMailToFriend #div_saisieInfosClientPourMiniCata .div_saisieInfosClient').css('width','40%');}
$('#div_autocompleteClients').html('<img src="/config_v3/imgs_defaut/loading/loader.gif" />');},success:function(result){$('#div_autocompleteClients').html(result);$('#div_autocompleteClients').show();initChargeClientExistant();},complete:function(){}});}else{if(pourMiniCatalogue){$('#div_autocompleteClients').hide();$('#div_sendMailToFriend #div_saisieInfosClientPourMiniCata .div_saisieInfosClient').css('width','50%');}
$('#div_autocompleteClients').html('');}
return xhr;})(jQuery);}
function initChargeClientExistant(){(function($){$('.li_autocompleteurClient').click(function(){var nom=$(this).find('.inpt_autocompleteClient.nomClient').val();var prenom=$(this).find('.inpt_autocompleteClient.prenomClient').val();var mail=$(this).find('.inpt_autocompleteClient.mailClient').val();var instance=$(this).find('.inpt_autocompleteClient.instance').val();var civilite;var CP='';var ville='';var adresse1='';var adresse2='';var telDom='';var telBur='';var mdp='';var pays='';var numeroClient='';var identClientNat='';var mdpNationalExistant;var commentaireClient='';if($(this).find('.inpt_autocompleteClient.villeClient').length===0&&instance.length>0&&$('#div_saisieInfosClientPourMiniCata').length===0){$.ajax({type:'POST',url:urlAJAX,async:false,data:{type:'getDetailClient',nom:nom,prenom:prenom,mail:mail,instance:instance},success:function(result){var tabResult=XMLToArray(result);civilite=tabResult.civilite;CP=tabResult.code_postal;ville=tabResult.ville;adresse1=tabResult.adresse;adresse2=tabResult.lieu_dit;telDom=tabResult.tel1;telBur=tabResult.tel2;mdp=tabResult.mdp;pays=tabResult.pays||'';numeroClient=tabResult.numeroClient;identClientNat=tabResult.identClientnat;commentaireClient=tabResult.commentaire||'';}});}else{civilite=$(this).find('.inpt_autocompleteClient.civilite').val();CP=$(this).find('.inpt_autocompleteClient.CPClient').val();ville=$(this).find('.inpt_autocompleteClient.villeClient').val();adresse1=$(this).find('.inpt_autocompleteClient.adresse1Client').val();adresse2=$(this).find('.inpt_autocompleteClient.adresse2Client').val();telDom=$(this).find('.inpt_autocompleteClient.tel1Client').val();telBur=$(this).find('.inpt_autocompleteClient.tel2Client').val();mdp=$(this).find('.inpt_autocompleteClient.mdp').val();pays=$(this).find('.inpt_autocompleteClient.pays').val()||'';numeroClient=$(this).find('.inpt_autocompleteClient.numeroClient').val();if($(this).find('.inpt_autocompleteClient.identClientNat').length>0){identClientNat=$(this).find('.inpt_autocompleteClient.identClientNat').val();mdpNationalExistant=$(this).find('.inpt_autocompleteClient.mdpNationalExistant').val();}
commentaireClient=$(this).find('.inpt_autocompleteClient.commentaireClient').val()||'';}
$('#select_civiliteClient, .div_champMiniCatalogue .civilite').val(civilite);$('#inpt_nomClient, .div_champMiniCatalogue .nom').val(nom);$('#inpt_prenomClient, .div_champMiniCatalogue .prenom').val(prenom);$('#inpt_cpClient, .div_champMiniCatalogue .cp').val(CP);$('#inpt_villeClient, .div_champMiniCatalogue .ville').val(ville);$('#inpt_mailClient').val(mail);$('#div_envoiAmiContent #email1').val(mail);$('#inpt_adresse1Client, .div_champMiniCatalogue .adresse1').val(adresse1);$('#inpt_adresse2Client, .div_champMiniCatalogue .adresse2').val(adresse2);$('#inpt_telDomClient, .div_champMiniCatalogue .teldom').val(telDom);$('#inpt_telBurClient, .div_champMiniCatalogue .telbur').val(telBur);$('#inpt_mdpClient, .div_champMiniCatalogue .mdp').val(mdp);$('#inpt_numeroClient').val(numeroClient);if(estResaBureauGestloc()){$('#inpt_commentaireClientPourCentrale').text(commentaireClient);}
$('#inpt_identClientNat').val(identClientNat);if(identClientNat&&identClientNat.length>0){$('.ipt_clientExistant').attr('disabled',true);$('#div_saisieClientEmail .i_helperInfoBulle').show();var htmlAlerte="<div class='row'><strong><i class='fa fa-exclamation-triangle' aria-hidden='true'></i></strong>"+" Ce client possde un compte client National";if(estSurBureauITEA()){htmlAlerte+="<input class='btn btn-primary pull-right' type='button' value='Modifier les coordonnes' onclick='actionBtnDelierCptNat(this);'>";}
htmlAlerte+="</div>";$('#alerte_inputsClientDisabled').html(htmlAlerte);$('#alerte_inputsClientDisabled').show();}else{$('.ipt_clientExistant').attr('disabled',false);$('#div_saisieClientEmail .i_helperInfoBulle').hide();$('#alerte_inputsClientDisabled').hide();}
$('#inpt_mdpNationalExistant').val(mdpNationalExistant);if(pays){$('option',$('#select_pays')).attr('selected',false);$('option[data-code="'+pays+'"]',$('#select_pays')).attr('selected',true);$('.div_champMiniCatalogue .pays').val(pays);}
validFormulaire();checkChampsImportants();});})(jQuery);}
function lockModifClientNat(){(function($){$('.ipt_clientExistant').attr('disabled',true);$('#div_saisieClientEmail .i_helperInfoBulle').show();var htmlAlerte="<div class='row'>"+"<strong><i class='fa fa-exclamation-triangle' aria-hidden='true'></i></strong>"+" Ce client est rattach  un compte client National, il n'est pas possible de le modifier."+" </div>";$('#alerte_inputsClientDisabled').html(htmlAlerte);$('#alerte_inputsClientDisabled').show();})(jQuery);}
function actionBtnDelierCptNat(element){(function($){var htmlPopIn='<div id="popInModifCompteClientNat">';htmlPopIn+="<i class='fa fa-exclamation-triangle' aria-hidden='true'></i>";htmlPopIn+='Attention les modifications impacteront les coordonnes sur le compte national du client !';htmlPopIn+='</div>';$('#alerte_inputsClientDisabled').after(htmlPopIn);var popin=$('#popInModifCompteClientNat').dialog({modal:true,autoOpen:true,width:550,dialogClass:'popinLienCgi',position:{my:"center top",at:"center top",of:'body'},open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog|ui).hide();},buttons:[{text:"Annuler","class":'ui-state-information',click:function(){$(this).dialog("close");$('#popInModifCompteClientNat').remove();}},{text:"Valider","class":'ui-state-information',click:function(){$('.ipt_clientExistant').attr('disabled',false);$(this).dialog("close");$('#popInModifCompteClientNat').remove();$('#inpt_mailClient').attr('disabled',true);$('#alerte_inputsClientDisabled').hide();}}]});})(jQuery);}
function estResaAvecCompteGdf(){if(jQuery('#inputCompteGdf').length>0){return true;}
return false;}
function estResaBureauProp(){if(jQuery('#inputTypeClientResaProp').length>0){return true;}
return false;}
function estResaAilleurs(){if(jQuery('#modeResaAilleurs').length>0){return true;}
return false;}
function estResaBureauGestloc(){if(jQuery('#inputTypeClientVendeurBureau').length>0){return true;}
return false;}
function estResaGP(){if(jQuery('#inputTypeClientGP').length>0){return true;}
return false;}
function ajouteOuRemplaceDansDataLayer(objGA){if(typeof(dataLayer)=='undefined'||typeof(objGA)=='undefined'||typeof(objGA.event)=='undefined'){return false;}
var eventName=objGA.event;jQuery.each(dataLayer,function(id,elemDataLayer){if(typeof(elemDataLayer)!='undefined'&&typeof(elemDataLayer.event)!='undefined'&&elemDataLayer.event==eventName){dataLayer.splice(id,1);}})
dataLayer.push(objGA);return true;}
function enregistrePrixLocationProp(prixLocationProp){(function($){$.ajax({type:'POST',url:urlAJAX,async:true,data:{type:'enregistrePrixLocationProp',prixLocation:prixLocationProp},success:function(result){var tabRetour=XMLToArray(result);afficheEffaceRecapPrix(tabRetour);}});})(jQuery);}
function reinitSelectionLignesFactures(){(function($){var nbAdultesTot=0;if($('.selectQuantitePourReinit:visible').length>0){$('.selectQuantitePourReinit:visible').each(function(){if($(this).val()>0){nbAdultesTot+=$(this).val();}});}
if($('.inputTarifVoiture:checked').length>0){nbAdultesTot=1;}
var id=$('.div_uneEtape_prodGP').attr('id');if(nbAdultesTot===0){$('#'+id).find('.inpt_validEtape').val('Non');$('#div_recapPrix').hide();$('#div_recapInfosFamille').remove();}
else{switch(id){case'div_uneEtape_hotelChoixChambre':setLignesFactures_hotel();break;case'div_uneEtape_choixNDate':setLignesFactures_ndate();break;case'div_uneEtape_packageChoixTarif':setLignesFactures_package();break;case'div_uneEtape_voitureChoixPresta':if($('.inputTarifVoiture:checked').length>0){setLignesFactures_voitureNew();}
else{setLignesFactures_voiture();}
break;case'div_uneEtape_locatChoixChambre':setLignesFactures_locat();break;case'div_uneEtape_billetChoixPresta':setLignesFactures_billet();break;}}})(jQuery);}
function verifErreurAjaxEtape1(){var verif=true;(function($){if($('.spanErreurAjax','.div_uneEtape_prodGP').length>0){if($("#p_msgErreurs").text().length>0){$("#p_msgErreurs").append("<br />");}
var text=$('.spanErreurAjax','.div_uneEtape_prodGP').text();$("#p_msgErreurs").append(text);$("#div_msgErreurs").show();verif=false;}})(jQuery);return verif;}
function actualiseRecapPrix(dateDeb,dateFin){(function($){idSession=getIdSessionInHtml();var tabData={type:"verifDates",dateDeb:dateDeb,dateFin:dateFin};$.ajax({type:'POST',url:urlAJAX,data:tabData,success:function(result){var tabRetour=XMLToArray(result);if(tabRetour.modeResa!=undefined){manageChangementTypeResa(tabRetour);return;}else{if(tabRetour.code=='OK'){afficheEffaceRecapPrix(tabRetour);}}}});})(jQuery);}
function initSaisieOccupantsResaBureau(){(function($){if($('#div_saisieOccupantsResaBureau').length==0){return;}
initLangue();$.datepicker.setDefaults($.datepicker.regional[lang]);$('.btn_saisieOccupants').click(function(){$('#div_saisieOccupantsResaBureau').dialog('open');$('#div_saisieOccupantsResaBureau').trigger('setClient');});$('.btn_ajoutOccupant').click(function(){var ligneDefaut=$('#div_saisieOccupantsResaBureau_content').find('tr.ligneDefaut').clone();ligneDefaut.removeClass('ligneDefaut');$('#div_saisieOccupantsResaBureau_content tbody').append(ligneDefaut);});$('#div_saisieOccupantsResaBureau').one('setClient',function(){var nom=$('#inpt_nomClient').val();var prenom=$('#inpt_prenomClient').val();var civilite=$('#select_civiliteClient').val();var pays=$('#select_pays').val();var $ligne=$(this).find('table tr').not('.ligneDefaut').not('.tr_ligneTitre').first();if($ligne.find('.inpt_nomOccupant').val()||$ligne.find('.inpt_prenomOccupant').val()){return false;}
$ligne.find('.inpt_nomOccupant').val(nom);$ligne.find('.inpt_prenomOccupant').val(prenom);$ligne.find('.select_civiliteOccupant').val(civilite);$ligne.find('.select_paysOccupant').val(pays);});$('#div_saisieOccupantsResaBureau_content .inpt_naissanceOccupant').datepicker({changeMonth:true,changeYear:true,yearRange:'-100:+00'});var titrePopin=$('#inpt_titrePopinSaisieOccupants').val();$('#div_saisieOccupantsResaBureau').dialog({autoOpen:false,modal:true,title:titrePopin,buttons:{"Ok":function(){var tabOccupants=new Array();var i=0;$('#div_saisieOccupantsResaBureau_content tr').not('.ligneDefaut , .tr_ligneTitre').each(function(){var nom=$(this).find('.inpt_nomOccupant').val();if(nom==''){return;}
var civilite=$(this).find('.select_civiliteOccupant').val();var prenom=$(this).find('.inpt_prenomOccupant').val();var naissance=$(this).find('.inpt_naissanceOccupant').val();var pays=$(this).find('.select_paysOccupant').val();tabOccupants[i]=new Array(civilite,nom,prenom,naissance,pays);i++;});$.ajax({type:'POST',url:urlAJAX,data:{type:'enregistreOccupants',tabOccupants:tabOccupants},success:function(result){eval('var tabResult='+result);if(tabResult.code=='OK'){$('#div_saisieOccupantsResaBureau').dialog('close');}else{}}});},"Annuler":function(){$(this).dialog("close");}},minWidth:1150});})(jQuery);}
function actualiseMontantRestant(){(function($){var prixLocation=0;var montantPercu=0;if($('.inpt_modifPrixLocationResaProp:visible').length>0){prixLocation=parseFloat($('.inpt_modifPrixLocationResaProp:visible').val());}else if($('.inpt_modifPrixChambreResaProp:visible').length>0||$('.inpt_modifPrixChambreCentraleProp:visible').length>0){var inputs=$('.inpt_modifPrixChambreResaProp:visible, .inpt_modifPrixChambreCentraleProp:visible');$(inputs).each(function(){var prixChambre=$(this).val();prixLocation+=parseFloat(prixChambre);});}
if($('#inpt_modifMontantPercu:visible').length>0){montantPercu=parseFloat($('#inpt_modifMontantPercu').val());}
var prixTotal=parseFloat($('#td_prixTotal').data('montant'));var prixLocationCalcule=parseFloat($('#td_prixLocation').data('montant'));var nouveauMontantRestant;if(prixLocation>0){nouveauMontantRestant=prixTotal-prixLocationCalcule+prixLocation-montantPercu;nouveauMontantRestant=Math.round(nouveauMontantRestant*100)/100;}
$('.sp_montantRestant.valeur').text(nouveauMontantRestant);})(jQuery);}
function verifCompoFamilleGiteAdultes(){(function($){if($('#select_compoFamilleAdulte').length==0){return;}
if($('#select_compoFamilleAdulte').val()==0){$("input.inpt_validEtape","#div_uneEtape_compoFamilleGite").val("Non");}})(jQuery);}
function verifSaisieAgeEnfants(){if(estResaBureauProp()||estResaBureauGestloc()){return true;}
var retour=true;(function($){$('.inpt_dateNaissance.enfant:visible').each(function(){if($(this).val()===''){retour=false;}else if(!estDateNaissanceValide($(this).val(),'enfant')){retour=false;}});})(jQuery);return retour;}
function verifSaisieAgeBebes(){if(estResaBureauProp()||estResaBureauGestloc()){return true;}
var retour=true;(function($){$('.inpt_dateNaissance.bebe:visible').each(function(){if($(this).val()===''){retour=false;}else if(!estDateNaissanceValide($(this).val(),'bebe')){retour=false;}});})(jQuery);return retour;}
function corrigeSaisieDateNaissance(inputDate,enfantOuBebe){(function($){if($(inputDate).val()===''){return;}
var qTipText='Date reformate';var qTipTextDateMin="Date modifie pour respecter le paramtrage de l'ge maximum";var qTipTextDateMax="Date modifie pour respecter le paramtrage de l'ge minimum";var patterns=[/^[0-9]{6,8}$/,/^[0-9]{2}\/[0-9]{2}\/[0-9]{2,4}$/,/^[0-9]{2}-[0-9]{2}-[0-9]{2,4}$/,/^[0-9]{2}\.[0-9]{2}\.[0-9]{2,4}$/];var objDate=null;patterns.forEach(function(pattern){if($(inputDate).val().match(pattern)){objDate=new OBJDate($(inputDate).val());}});var dateMin=getObjDateNaissanceMin(enfantOuBebe);var dateMax=getObjDateNaissanceMax(enfantOuBebe);var nouvelleValeur=null;console.log('objDate : ',objDate);if(objDate===null&&$(inputDate).val().match(/^[0-9]{4}$/)){var annee=$(inputDate).val();if(annee<dateMin.getAnnee()){qTipText=qTipTextDateMin;nouvelleValeur=dateMin.toString('dd/mm/yyyy');}else if(annee>dateMax.getAnnee()){qTipText=qTipTextDateMax;nouvelleValeur=dateMax.toString('dd/mm/yyyy');}else{nouvelleValeur='31/12/'+annee;}}else if(objDate===null){qTipText=qTipTextDateMin;nouvelleValeur=dateMin.toString('dd/mm/yyyy');}else if(!$(inputDate).val().match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){nouvelleValeur=objDate.toString('dd/mm/yyyy');}
if(nouvelleValeur){if(dateMin.estApres(nouvelleValeur)){qTipText=qTipTextDateMin;nouvelleValeur=dateMin.toString('dd/mm/yyyy');}else if(dateMax.estAvant(nouvelleValeur)){qTipText=qTipTextDateMax;nouvelleValeur=dateMax.toString('dd/mm/yyyy');}}else{if(dateMin.estApres($(inputDate).val())){qTipText=qTipTextDateMin;nouvelleValeur=dateMin.toString('dd/mm/yyyy');}else if(dateMax.estAvant($(inputDate).val())){qTipText=qTipTextDateMax;nouvelleValeur=dateMax.toString('dd/mm/yyyy');}}
if(nouvelleValeur===null){return;}
$(inputDate).val(nouvelleValeur);$(inputDate).qtip({content:{text:qTipText},position:{my:'bottom center',at:'top center',target:$(inputDate)},show:{event:false,ready:true},hide:{inactive:5000},style:{width:$(inputDate).width()}});})(jQuery);}
function getObjDateNaissanceMin(enfantOuBebe){if(enfantOuBebe==='enfant'){return getObjDateNaissanceMinEnfant();}else if(enfantOuBebe==='bebe'){return getObjDateNaissanceMinBebe();}
return null;}
function getObjDateNaissanceMinEnfant(){var ageMaxEnfants=parseInt(jQuery('#inpt_ageMaxEnfants').val());var dateNaissanceMinEnfants=new OBJDate(jQuery('#inpt_resaDateDeb').val());dateNaissanceMinEnfants.retireMois(12*(ageMaxEnfants+1));dateNaissanceMinEnfants.ajoutJour(1);return dateNaissanceMinEnfants;}
function getObjDateNaissanceMinBebe(){var ageMaxBebes=parseInt(jQuery('#inpt_ageMaxBebes').val());var dateNaissanceMinBebes=new OBJDate(jQuery('#inpt_resaDateDeb').val());dateNaissanceMinBebes.retireMois(12*(ageMaxBebes+1));dateNaissanceMinBebes.ajoutJour(1);return dateNaissanceMinBebes;}
function getObjDateNaissanceMax(enfantOuBebe){if(enfantOuBebe==='enfant'){return getObjDateNaissanceMaxEnfant();}else if(enfantOuBebe==='bebe'){return getObjDateNaissanceMaxBebe();}
return null;}
function getObjDateNaissanceMaxEnfant(){var ageMaxBebes=parseInt(jQuery('#inpt_ageMaxBebes').val());var dateNaissanceMaxEnfants=new OBJDate(jQuery('#inpt_resaDateDeb').val());dateNaissanceMaxEnfants.retireMois(12*(ageMaxBebes+1));return dateNaissanceMaxEnfants;}
function getObjDateNaissanceMaxBebe(){var dateNaissanceMaxBebes=new OBJDate();return dateNaissanceMaxBebes;}
function estDateNaissanceValide(date,type){var dateNaissanceMinEnfants=getObjDateNaissanceMin('enfant');var dateNaissanceMaxEnfants=getObjDateNaissanceMax('enfant');var dateNaissanceMinBebes=getObjDateNaissanceMin('bebe');var dateNaissanceMaxBebes=getObjDateNaissanceMax('bebe');if(type==='enfant'){if(dateNaissanceMinEnfants.estAvant(date)&&dateNaissanceMaxEnfants.estApres(date)){return true;}
return false;}else if(type==='bebe'){if(dateNaissanceMinBebes.estAvant(date)&&dateNaissanceMaxBebes.estApres(date)){return true;}
return false;}else{return false;}}
function verifMontantLibreCorrect(valeur){if(valeur.match(/^[0-9]{1,5}$/)){return true;}
return false;}
function traiteNdatePrixLibre(){(function($){if($('.tarifNDatePrixLibre').length>0){setLignesFactures_ndate();}})(jQuery);}
function initPrixLibre(){(function($){$('.tarifNDatePrixLibre').blur(function(){traiteNdatePrixLibre();});})(jQuery);}
function testYoann(){(function($){$.ajax({type:'POST',url:urlAJAX,data:{type:'testYoann'}});})(jQuery);}
function verifQuestionnairesClient(){verif=true;(function($){if($('#div_uneEtape_questionnaires').length==0){return;}
$('.div_uneQuestion.obligatoire').removeClass('erreur');$('.div_uneQuestion.obligatoire:visible').each(function(){var idQuestion=$(this).attr('data-id');var reponse=getReponseClientByTypeQuestion($('.inpt_uneQuestionClient[data-id="'+idQuestion+'"]:first'));if(reponse===''||!reponse){$(this).addClass('erreur');verif=false;}});})(jQuery);return verif;}
function getReponseClientByTypeQuestion(inptQuestion){var reponse='';(function($){var idQuestion=inptQuestion.attr('data-id');if(inptQuestion.is('input[type="radio"]')){reponse=$('.inpt_uneQuestionClient[data-id="'+idQuestion+'"]:checked').val();}else if(inptQuestion.is('input[type="checkbox"]')){$('.inpt_uneQuestionClient[data-id="'+idQuestion+'"]:checked').each(function(){reponse+=$(this).val()+' - ';});reponse=reponse.substr(0,reponse.length-3);}else{reponse=inptQuestion.val();}})(jQuery);return reponse;}
function enregistreReponsesQuestionnairesClient(){(function($){if($('#div_uneEtape_questionnaires').length==0){return;}
var tabReponses=new Array();$('.div_uneQuestion').each(function(){var idQuestion=$(this).attr('data-id');var reponse=getReponseClientByTypeQuestion($('.inpt_uneQuestionClient[data-id="'+idQuestion+'"]:first'));var infosReponse={'ID':idQuestion,'reponse':reponse};tabReponses.push(infosReponse);});$.ajax({type:'POST',url:urlAJAX,data:{type:"enregistreReponsesQuestionnairesClient",tabReponses:tabReponses},beforeSend:function(){}});})(jQuery);}
function initHistoriqueClientsLocalStorage(){(function($){var histoClients=JSON.parse(localStorage.getItem('histoClients'));if(histoClients===null){$('#select_histoClients').hide();return;}
var htmlSelect='<option value="defaut">Historique clients</option>';$.each(histoClients,function(index,tabInfos){var libelle=tabInfos.nom+' '+tabInfos.prenom+' '+tabInfos.mail;htmlSelect+='<option value="'+index+'">'+libelle+'</option>';});$('#select_histoClients').html(htmlSelect);$('#select_histoClients').show();$('#select_histoClients').unbind('change');$('#select_histoClients').bind('change',function(){saisieClientsAvecHistorique($(this).val());});$('#form_nouveauClient').find('button[type="reset"]').click(function(){$('#select_histoClients').val('defaut');});})(jQuery);}
function saisieClientsAvecHistorique(indexSelect){(function($){var tabInfosSelect={};var histoClients=JSON.parse(localStorage.getItem('histoClients'));if(histoClients===null){histoClients={};}
$.each(histoClients,function(index,tabInfos){if(index==indexSelect){tabInfosSelect=tabInfos;}});autofillFormulaireClient(tabInfosSelect);})(jQuery);}
function ajouteClientDansLocalStorage(tabInfos){(function($){var histoClients;histoClients=JSON.parse(localStorage.getItem('histoClients'));if(histoClients===null){histoClients={};}
var remove=0;if(histoClients.length>10){remove=1;}
Array.prototype.splice.call(histoClients,histoClients.length,remove,tabInfos);localStorage.setItem('histoClients',JSON.stringify(histoClients));})(jQuery);}
function autofillFormulaireClient(tabInfos){if(!tabInfos){return;}
(function($){$('#select_civiliteClient').val(tabInfos.civilite);$('#select_categorieClient').val(tabInfos.categorie);$('#select_origineClient').val(tabInfos.origine);$('#inpt_nomClient').val(tabInfos.nom);$('#inpt_prenomClient').val(tabInfos.prenom);$('#inpt_cpClient').val(tabInfos.cp);$('#inpt_villeClient').val(tabInfos.ville);$('#inpt_mailClient').val(tabInfos.mail);$('#inpt_mailClientPlus').val(tabInfos.mailPlus);$('#inpt_adresse1Client').val(tabInfos.adresse1);$('#inpt_adresse2Client').val(tabInfos.adresse2);$('#inpt_telDomClient').val(tabInfos.telDom);$('#inpt_telBurClient').val(tabInfos.telBur);$('#inpt_mdpClient').val(tabInfos.mdp);$('#inpt_numeroClient').val(tabInfos.numeroClient);$('#inpt_identClientNat').val(tabInfos.identClientNat);$('#inpt_mdpNationalExistant').val(tabInfos.mdpNationalExistant);$('#select_langueContratClient').val(tabInfos.langueContrat);if(tabInfos.pays){$('option',$('#select_pays')).attr('selected',false);$('option[data-code="'+tabInfos.pays+'"]',$('#select_pays')).attr('selected',true);}})(jQuery);}
function estMultiResa(){return(function($){var multiResa=$('#divHiddenMultiResa');if(multiResa.length>0){return true;}
return false;})(jQuery);}
function getClientLocalStoragePourMultiResa(){return(function($){var histoClients=JSON.parse(localStorage.getItem('histoClients'));if(histoClients===null){return;}
var clientResa=false;$.each(histoClients,function(index,tabInfos){var estClientPourMultiResa=tabInfos.clientMultiResa||false;if(estClientPourMultiResa){clientResa=tabInfos;return false;}});return clientResa;})(jQuery);}
function ajouteClientMultiResaDansLocalStorage(tabInfosClient){(function($){tabInfosClient.clientMultiResa=true;var histoClients=JSON.parse(localStorage.getItem('histoClients'))||false;if(!histoClients||!getClientLocalStoragePourMultiResa()){ajouteClientDansLocalStorage(tabInfosClient);return;}
$.each(histoClients,function(index,client){var clientMultiResa=client.clientMultiResa||false;if(clientMultiResa){histoClients[index]=tabInfosClient;localStorage.setItem('histoClients',JSON.stringify(histoClients));return false;}});})(jQuery);}
function verifFraisDossier(){(function($){var prixLoc=parseFloat($('.inpt_modifPrixResaBureau[name="prixLocation"]').val());var frais=parseFloat($('.inpt_modifPrixResaBureau[name="fraisDossier"]').val());if(frais>prixLoc){$('.inpt_modifPrixResaBureau[name="fraisDossier"]').addClass('erreur');$('.inpt_modifPrixResaBureau[name="fraisDossier"]').val(0);}else{$('.inpt_modifPrixResaBureau[name="fraisDossier"]').removeClass('erreur');}})(jQuery);}
function questionRecalculAuto(){(function($){if($('#divQuestionRecalculAuto').length==0){return;}
$('#divQuestionRecalculAuto').dialog({modal:true,title:'Recalcul automatique',buttons:{"Oui":function(){$.ajax({type:'POST',url:urlAJAX,data:{type:'recalculAutomatique'},beforeSend:function(){affMsgAttenteParDessusInDiv("div_resaRecap","recapPrix",'Recalcul en cours');$('#div_confirmDispos span.confirmSaisie.ko').html('').hide();},success:function(result){var tabRetour=XMLToArray(result);if(tabRetour.code=='OK'){afficheEffaceRecapPrix(tabRetour);}else{}
effaceMsgAttenteParDessus("recapPrix");},error:function(jqXHR,textStatus,errorThrown){alert(textStatus);alert(errorThrown);}});$(this).dialog("close");},"Non":function(){$(this).dialog("close");effaceMsgAttenteParDessus("recapPrix");}}});})(jQuery);}
function terminerModifResa(){(function($){$.ajax({type:"POST",url:urlAJAX,async:false,dataType:'json',data:{type:'validerModifResa'},success:function(result){if(result.code==='OK'){location.href='etape4.php'+location.search;}
else{afficheMsgErrTechnq(result.msg,result.titre);effaceMsgAttenteParDessus('contenu');}},beforeSend:function(){affMsgAttenteParDessusInDiv('div_resaContenu','contenu','Enregistrement en cours');}});})(jQuery);}
function majObjMultiResa(propriete,infos){var storage=localStorage.getItem('OBJMULTIRESA')||'{}';var objMultiResa=JSON.parse(storage);objMultiResa[propriete]=infos;localStorage.setItem('OBJMULTIRESA',JSON.stringify(objMultiResa));}
function gereInfosMultiResa(){if(!estMultiResa()){return;}
var dateDeb=new OBJDate(objDateDeb.toLocaleDateString());var queryStringSejourPourMultiResa='jour='+dateDeb.getJour()+'&mois='+dateDeb.getMois()+'&annee='+dateDeb.getAnnee();queryStringSejourPourMultiResa+='&duree='+ecartDate(objDateFin,objDateDeb);localStorage.setItem('queryStringMultiResa',queryStringSejourPourMultiResa);var objMultiResa=localStorage.getItem('OBJMULTIRESA')||'{}';objMultiResa=JSON.parse(objMultiResa);if(objMultiResa.assurance){affectAssurance(objMultiResa.assurance);}}
function setFormuleAssurance(inputSelected){(function($){if(!inputSelected){return;}
var value=$(inputSelected).val();affectAssurance({action:'majChoixFormuleAssurance',value:value});etapeCourante($("#div_uneEtape_assuranceAnnul"),true);if($(inputSelected).val()){$(".sp_recapSansAssurAnnul").hide();$(".sp_recapAvecAssurAnnul").show();}
else{$(".sp_recapAvecAssurAnnul").hide();$(".sp_recapSansAssurAnnul").show();}})(jQuery);}
function modifieResaExistante(){if(jQuery('.inpt_modifResa').length>0){return true;}
return false;}
function gereDivAlertResaJoursIdentiques(htmlAlertResasJoursIdentiques){(function($){if(htmlAlertResasJoursIdentiques){if($('#div_alertResaJoursIdentiques').length>0){$('#div_alertResaJoursIdentiques').replaceWith(htmlAlertResasJoursIdentiques);}else{$('#div_choixDates').append(htmlAlertResasJoursIdentiques);}}else{$('#div_alertResaJoursIdentiques').remove();}})(jQuery);}
function gereDivAlertHorairesBloquants(htmlAlertHorairesBloquants){(function($){if(htmlAlertHorairesBloquants){if($('#div_alertHorairesBloquants').length>0){$('#div_alertHorairesBloquants').replaceWith(htmlAlertHorairesBloquants);}else{$('#div_choixDates').append(htmlAlertHorairesBloquants);}}else{$('#div_alertHorairesBloquants').remove();}})(jQuery);}
function gereDivModifHoraires(htmlModifHoraires){if(htmlModifHoraires===undefined){return;}
(function($){if($('.div_modifHoraires').length>0){$('.div_modifHoraires').remove();}
$('.div_modifHoraire_arrivee').replaceWith(htmlModifHoraires.arrivee);$('.div_modifHoraire_depart').replaceWith(htmlModifHoraires.depart);initChangeHeureDebFin();})(jQuery);}
function init_btnModifierDates(){(function($){if($("#a_afficheModifDate").length>0){$("#a_afficheModifDate").click(function(){$('#'+$(this).data("divaffiche")).show();$('#'+$(this).data("divmasque")).hide();});}})(jQuery);}
function init_btnsAfficheDetailsMoyensPaiements(){(function($){if($(".a_txtModePaiement").length>0){$(".a_txtModePaiement").each(function(){if($(this).prev(".sp_txtModePaiement").html().length===0){$(this).hide();}});$(".a_txtModePaiement").click(function(){if($(this).prev(".sp_txtModePaiement").is(":hidden")){$(this).prev(".sp_txtModePaiement").show();$(this).text($(this).data("lblmasque"));}else{$(this).prev(".sp_txtModePaiement").hide();$(this).text($(this).data("lblaffiche"));}});}})(jQuery);}
function enregistreElementsAvantValidationEtape1(){(function($){$.ajaxSetup({async:false});affecteDatesNaissanceAvecCoherence();if($('#inpt_provenance').length>0){var enregistrementProvenance=false;$.ajax({type:"POST",url:urlAJAX,async:false,dataType:'json',data:{type:"setProvenance",provenance:$('#inpt_provenance').val()},success:function(result){if(result.code==='OK'){enregistrementProvenance=true;}}});if(!enregistrementProvenance){afficheMsgErrTechnq('Nous n\'avons pas pu enregistrer le champ Provenance, veuillez recommencer ou contacter ITEA','Problme lors de l\'enregistrement.');}}
$.ajaxSetup({async:true});})(jQuery);}
function affecteAnneesEnfantsAvecCoherence(){(function($){var tabChambres={};$('.div_uneChambreSelection,#div_uneEtape_compoFamilleGite').each(function(){var tabAnnees=construireTableauAnneesEnfants(this);var index=$(this).data('num_idch')||'gite';tabChambres[index]=tabAnnees;});var params={type:'affectAnneesEnfantsAvecCoherence',tabChambres:tabChambres};$.ajax({type:"POST",url:urlAJAX,async:false,data:params,beforeSend:function(){},success:function(result){eval("var tabResult="+result);if(tabResult.code===errDossierNull){retourEtape1(tabResult.msg);}
else if(tabResult.errTechnq){afficheMsgErrTechnq(tabResult.msg,tabResult.titre,tabResult.ident,true);}}});})(jQuery);}
function construireTableauAnneesEnfants(element){var tabOut=[];(function($){var nb=parseInt($('.select_compoFamilleEnfant',element).val());var age;for(var i=1;i<=nb;i++){age=$('.select_compoFamilleAgeEnfants[data-id="'+i+'"]',element).val();if(parseInt(age)>0){tabOut.push(age);}}
nb=parseInt($('.select_compoFamilleBebe',element).val());for(var i=1;i<=nb;i++){age=$('.select_compoFamilleAgeBebe[data-id="'+i+'"]',element).val();if(parseInt(age)>0){tabOut.push(age);}}})(jQuery);return tabOut;}
function estResaVoiture(){if(jQuery('#div_uneEtape_voitureChoixPresta').length>0){return true;}
return false;}
function estResaVoitureNouveauScript(){if(jQuery('#inpt_nouveauScriptVoiture').length>0){return true;}
return false;}
function afficheInfosVerifDateITEA(tabRetour){(function($){if($('#divInfosResaITEA').length>0&&tabRetour.resultReqITEA){var htmlInfosITEA='';$.map(tabRetour.resultReqITEA,function(obj){var htmlResultatITEA='<div><h3>'+obj.libelle;if(parseInt(obj.erreur)>0){htmlResultatITEA+=' erreur : '+obj.erreur;}
htmlResultatITEA+='</h3>';htmlResultatITEA+='<p>'+obj.info+'</p>';if(obj.resultat){htmlResultatITEA+='<h4>Infos requete : </h4>';var props=Object.keys(obj.resultat);$(props).each(function(prop){htmlResultatITEA+='<p><span class="infoITEAResultatRequete">'+this+'</span><span>'+obj.resultat[this]+'</span></p>';});}
htmlResultatITEA+='</div>';htmlInfosITEA+=htmlResultatITEA;});$('#divInfoVerifDate').html(htmlInfosITEA);}})(jQuery);}
function desactiveBoutonsPaiement(){desactiveBoutonValidationCentralPay();}
function reactiveBoutonsPaiement(){reactiveBoutonValidationCentralPay();if(typeof reactiveBoutonValidationANCV_CVCO!=='undefined'){reactiveBoutonValidationANCV_CVCO();if(jQuery('#div_popinPaiementAncvCvco').length>0){jQuery('#div_popinPaiementAncvCvco').dialog('close');}}}
function updateAffichagePrixBuroProp(){(function($){var prixLocation=0;var acompte=0;var fraisDossier=0;var prixTotal=0;if($('.inpt_modifPrixLocationResaProp:visible').length>0){prixLocation=parseFloat($('.inpt_modifPrixLocationResaProp:visible').val());var tdPrixGite=$('.td_detailPrix[id="td_prixLocation"]');if(tdPrixGite!==undefined&&tdPrixGite.length>0){tdPrixGite.html(getNumberFormatLikePrix(prixLocation.toString().replace('.',','))+' ');}}else if($('.inpt_modifPrixChambreCentraleProp:visible').length>0){var inputs=$('.inpt_modifPrixChambreCentraleProp:visible');$(inputs).each(function(){var prixChambre=$(this).val();var numChambre=$(this).data('numerochambre');prixLocation+=parseFloat(prixChambre.replace(',','.'));var tdPrixChambre=$('.tr_prixChambre[id="tr_prixChambre_'+numChambre+'"]').find('.td_prixChambre');if(tdPrixChambre!==undefined&&tdPrixChambre.length>0){tdPrixChambre.html(getNumberFormatLikePrix(prixChambre.toString().replace('.',','))+' ');}});}
$('#div_msgInfoRecalculFdTs').show();if($('#inpt_modifFDResaProp').length>0){fraisDossier=parseFloat($('#inpt_modifFDResaProp').val());$('.td_prixFraisDossier').html(getNumberFormatLikePrix(fraisDossier.toString().replace('.',','))+' ');}else{fraisDossier=parseFloat($('#td_prixFraisDossier').val());}
prixLocation=prixLocation||0;fraisDossier=fraisDossier||0;acompte=getAcompteByPrixLocEtFraisDossierBuroProp(prixLocation,fraisDossier);$('.td_prixAcompte').html(getNumberFormatLikePrix(acompte.toString().replace('.',','))+' ');prixTotal=prixLocation+fraisDossier;prixTotal+=parseFloat($('#td_montantTaxeSejour').html().replace(',','.'));var stringPrixTotal=prixTotal.toString().replace('.',',');$('.td_prixTotal').attr('data-montant',prixTotal);$('.td_prixTotal').html(getNumberFormatLikePrix(stringPrixTotal)+' ');updateAffichagePaiementCentralPayBuroProp(acompte,prixTotal);})(jQuery);}
function updateAffichagePaiementCentralPayBuroPropResaLD(){(function($){console.log('PASSE updateAffichagePaiementCentralPayBuroPropResaLD');var prixLocation=0;var acompte=0;var montantPercu=0;var prixTotal=0;if($('.inpt_modifPrixLocationResaProp:visible').length>0){prixLocation=parseFloat($('.inpt_modifPrixLocationResaProp:visible').val());}else if($('.inpt_modifPrixChambreResaProp:visible').length>0){var inputs=$('.inpt_modifPrixChambreResaProp:visible');$(inputs).each(function(){var prixChambre=$(this).val();prixLocation+=parseFloat(prixChambre.replace(',','.'));});}
if($('#inpt_modifMontantPercu').length>0&&!isNullOrUndefinedOrEmpty($('#inpt_modifMontantPercu').val())){montantPercu=parseFloat($('#inpt_modifMontantPercu').val());}
prixTotal=prixLocation-montantPercu;if($('#inpt_modifAcompteResaProp').length>0&&!isNullOrUndefinedOrEmpty($('#inpt_modifAcompteResaProp').val())){acompte=parseFloat($('#inpt_modifAcompteResaProp').val());}else{acompte=getAcompteByPrixLocEtFraisDossierBuroProp(prixTotal,0);}
updateAffichagePaiementCentralPayBuroProp(acompte,prixTotal);})(jQuery);}
function updateAffichagePaiementCentralPayBuroProp(acompte,prixTotal){(function($){if(acompte===0&&prixTotal===0){return;}
var montantARegler=0;var inputAcompte=$('input[name="choixPaiementCB"][value="acompte"]');if(inputAcompte!==undefined&&inputAcompte.length>0&&acompte>0){var acompteActuel=getNumberFormatLikePrix(inputAcompte.attr('data-montant').replace('.',','))||'0';var stringAcompte=getNumberFormatLikePrix(acompte.toString().replace('.',','));var texteAcompte=inputAcompte.siblings('span:not(.infoSupMontantPaiement)').text();inputAcompte.siblings('span:not(.infoSupMontantPaiement)').html(texteAcompte.replace(acompteActuel.trim(),stringAcompte.trim()));inputAcompte.attr('data-montant',acompte);if(inputAcompte.prop('checked')){montantARegler=acompte;}}
var inputPrixTotal=$('input[name="choixPaiementCB"][value="solde"]');if(inputPrixTotal!==undefined&&inputPrixTotal.length>0&&prixTotal>0){var prixTotalActuel=getNumberFormatLikePrix(inputPrixTotal.attr('data-montant').replace('.',','))||'0';var stringPrixTotal=getNumberFormatLikePrix(prixTotal.toString().replace('.',','));var textePrixTotal=inputPrixTotal.siblings('span:not(.infoSupMontantPaiement)').text();inputPrixTotal.siblings('span:not(.infoSupMontantPaiement)').html(textePrixTotal.replace(prixTotalActuel.trim(),stringPrixTotal.trim()));inputPrixTotal.attr('data-montant',prixTotal);if(inputPrixTotal.prop('checked')){montantARegler=prixTotal;}}
if(montantARegler>0){$('#inpt_montantCB').val(montantARegler);}})(jQuery);}
function getAcompteByPrixLocEtFraisDossierBuroProp(prixLocation,fraisDossier){var tauxAcompte=jQuery('.td_prixAcompte').data('tauxacompte')||25;var acompte=(prixLocation/100)*tauxAcompte+fraisDossier;acompte=Math.round(acompte*100)/100;return acompte;}
function getNumberFormatLikePrix(number){if(number.match(/^\d+(,|\.)\d$/)){number+='0';}
return number;}
function verifSelectionAnimaux(){var verif=true;(function($){$("#div_msgErreursNbAnimaux").hide();$('.div_uneEtapeAnimaux').each(function(){if($(this).find('.div_infoCompoAnimauxReponse > input:checked').val()==='Oui'){if($(this).find('.select_compoAnimauxChien').val()==="0"&&$(this).find('.select_compoAnimauxChat').val()==="0"){verif=false;}}});})(jQuery);return verif;}
function majRecapPrixChoixResaProp(typeResa){(function($){if(typeResa==='LD'){$('.tr_prixFraisDossier').hide();if($('.td_prixTotalSansFraisService').length>0){$('.td_prixTotal').hide();$('.td_prixTotalSansFraisService').show();}}else if(typeResa==='centrale'){$('.tr_prixFraisDossier').show();if($('.td_prixTotalSansFraisService').length>0){$('.td_prixTotal').show();$('.td_prixTotalSansFraisService').hide();}}})(jQuery);}
function initActionsMotMagique(reload){(function($){$("#div_motMagique a, #div_motMagique button").click(function(){if($("#inpt_motMagique").val()!=""){verifMotMagique(true,reload);}});$("#inpt_motMagique").blur(function(){if($("#inpt_motMagique").val()!=""){verifMotMagique(true,reload);}});})(jQuery);}
function invalideSaisieDates(msgErr){(function($){$("#div_confirmDispos").find(".ko").text(msgErr).show();$("#div_uneEtape_date .div_uneEtapeRecap").hide();if($("#inpt_avecRepli").length>0){$("#div_uneEtape_date .div_uneEtapeContent").show();}
$("#div_uneEtape_date").find(".inpt_validEtape").val("Non");})(jQuery);}
function updateSelectCapacite(capacite){(function($){var isSafari=false;var ua=navigator.userAgent.toLowerCase();if(ua.indexOf('safari')!=-1){if(ua.indexOf('chrome')>-1){var isSafari=false;}else{var isSafari=true;}}
if(isSafari==true){console.log('on est sur safari');$('#widgetFNGF_selectCapacite option').remove();}else{$('#widgetFNGF_selectCapacite option').hide();}
console.log('on met a jour la capacit : ',capacite);for(var i=1;i<=capacite;i++){if(isSafari==true){$('#widgetFNGF_selectCapacite').append($('#widgetFNGF_selectCapacite_copie option[value="'+i+'"]').get());}else{$('#widgetFNGF_selectCapacite option[value="'+i+'"]').show();}}
if(capacite>=2){$('.widgetFNGF_divSelectCapacite select option[value="2"]').prop('selected',true);}else{$('.widgetFNGF_divSelectCapacite select option[value="1"]').prop('selected',true);}
$('.widgetFNGF_divSelectCapacite').show();})(jQuery);}
function updatePrixResa(){(function($){$('#widgetFNGF_selectCapacite').attr('updated','O');var tabData={type:'verifDates',dateDeb:$('#inpt_resaDateDebCal').val(),dateFin:$('#inpt_resaDateFinCal').val(),estPresentSurFiche:true,instance:$('#div_choixDates_packDivDatesTarifs').attr('data-instance'),ident:$('#div_choixDates_packDivDatesTarifs').attr('data-ident'),exercice:$('#div_choixDates_packDivDatesTarifs').attr('data-exercice'),};if($('#widgetFNGF_selectChambre').length>0){tabData['numChambre']=$('#widgetFNGF_selectChambre option:selected').val();tabData['annulChoix']=true;tabData['removeChambres']='O';}
ajaxVerifDates(tabData);})(jQuery);}
function showDivEtapeCanevas(){(function($){if($('#div_uneEtape_canevas').find('.div_uneEtapeContent').length>0){$('#div_uneEtape_canevas').addClass('div_uneEtape').show();}})(jQuery);}
function hideDivEtapeCanevas(){(function($){$('#div_uneEtape_canevas').removeClass('div_uneEtape').hide();})(jQuery);}window.enterNewsletter=0;var inscriptionOK=false;function initInscriptionNewsletter(){(function($){if($(".formIteaNewsletter").length>0){$(".itea_inscriptionNewsletterInput").bind("keypress",function(event){var keycode=(event.keyCode?event.keyCode:event.which);if(keycode=='13'){if(window.enterNewsletter==0){widget_valideNewsletter($(this).parent());window.enterNewsletter++;}}});$(".itea_inscriptionNewsletterButton").click(function(){widget_valideNewsletter($(this).parent());});$(".itea_inscriptionNewsletterFDInput").bind("keypress",function(event){var keycode=(event.keyCode?event.keyCode:event.which);if(keycode=='13'){widget_openNewsletterFD($(this).parent());}});$(".itea_inscriptionNewsletterFDButton").click(function(){widget_openNewsletterFD($(this).parent());});$("#div_inscriptionNewletter_infoscomp #btnValid, .div_newsletterBtnConfirm input, .div_newsletterBtnPasseEtape input, #div_inscriptionNewletter_infoscompV3 #btnFormInfosPersoNewsletterFD").click(function(){valideNewsletterFD($(this).parents("form"));});if($("#inpt_ouverturePopinNewsletterFD").length>0){affichePopinNewsletterFD();}
$('#div_inscriptionNewletter_infoscompV3 #btnConfirmerNewsletterFD').click(function(){widget_majInfosCompNewsletterFDv3();});}})(jQuery)}
function widget_valideNewsletter(form){(function($){$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:form.serialize(),success:function(result){form.next(".itea_inscriptionNewsletter_msgInfo").html(result.msg);form.next(".itea_inscriptionNewsletter_msgInfo").show();if(result.code=="OK"){form.next(".itea_inscriptionNewsletter_msgInfo.echec").removeClass('echec');form.next(".itea_inscriptionNewsletter_msgInfo").addClass('reussite');form.hide();if(window.widget_valideNewsletterQdFini)widget_valideNewsletterQdFini();if(typeof(dataLayer)!='undefined'){dataLayer.push({'event':'Newsletter'});}}
else{form.next(".itea_inscriptionNewsletter_msgInfo.reussite").removeClass('reussite');form.next(".itea_inscriptionNewsletter_msgInfo").addClass('echec');window.enterNewsletter=0;}}});})(jQuery)}
function widget_openNewsletterFD(form){(function($){$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:form.serialize(),success:function(result){form.next(".itea_inscriptionNewsletter_msgInfo").html(result.msg);form.next(".itea_inscriptionNewsletter_msgInfo").show();if(result.code=="OK"){affichePopinNewsletterFD();}
else{form.next(".itea_inscriptionNewsletter_msgInfo.reussite").removeClass('reussite');form.next(".itea_inscriptionNewsletter_msgInfo").addClass('echec');window.enterNewsletter=0;}}});})(jQuery);}
function affichePopinNewsletterFD(){if(estInscriptionNewsletterFdV2()){widget_affichePopinNewsletterFDv2();}else if(estInscriptionNewsletterFdV3()){widget_affichePopinNewsletterFDv3();}else{widget_affichePopinNewsletterFD();}}
function widget_affichePopinNewsletterFD(){(function($){var divHref="#div_inscriptionNewletter_infoscomp";jQuery.fancybox($(divHref),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0});$('#inpt_email').val($('.formIteaNewsletter .itea_inscriptionNewsletterFDInput').val());$(".fancybox-wrap").attr("id","div_fancyBoxFormNewsletter");})(jQuery)}
function widget_affichePopinNewsletterFDv2(){(function($){$(".itea_inscriptionNewsletter_msgInfo").removeClass('echec');$(".itea_inscriptionNewsletter_msgInfo").addClass('reussite');$(".itea_inscriptionNewsletter_msgInfo").html('');var divHref="#div_inscriptionNewletter_infoscompV2";jQuery.fancybox($(divHref),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,fitToView:false,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popinNewsletterFdV2'});$('#inpt_emailNewsletterFD').val($('.formIteaNewsletter .itea_inscriptionNewsletterFDInput').val());})(jQuery)}
function widget_affichePopinNewsletterFDv3(){(function($){var divHref="#div_inscriptionNewletter_infoscompV3";jQuery.fancybox($(divHref),{maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,fitToView:false,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popinNewsletterFdV3'});$('#inpt_email').val($('.formIteaNewsletter .itea_inscriptionNewsletterFDInput').val());$(".fancybox-wrap").attr("id","div_fancyBoxFormNewsletter");})(jQuery)}
function valideNewsletterFD(form){if(estInscriptionNewsletterFdV2()){widget_valideNewsletterFDv2();}else if(estInscriptionNewsletterFdV3()){widget_valideNewsletterFDv3();}else{widget_valideNewsletterFD(form);}}
function widget_valideNewsletterFD(form){(function($){widget_addTraitementEnCours();var tabInfosPersos=getTabInfosPerso();var tabCI=getTabCentresInterets();var tabPS=getTabPeriodesSejour();var tabTD=getTabTypesDestination();var tabTH=getTabTypesHebergement();var tabTS=getTabTypesSejours();var inpt_legal='';if($('#inpt_legal').is(':checked')){inpt_legal='on';}
$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:{action:'insereNewsletterFD',inpt_legal:inpt_legal,infosPersos:tabInfosPersos,tabCI:tabCI,tabPS:tabPS,tabTD:tabTD,tabTH:tabTH,tabTS:tabTS},success:function(result){$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);if(result.code=="OK"){$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('echec');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").html('Inscription enregistre');$("#div_inscriptionNewletter_infoscomp #btnValid").attr("value","FERMER");$("#div_inscriptionNewletter_infoscomp #btnValid").slideDown();inscriptionOK=true;}
else{$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('echec');$("#div_inscriptionNewletter_infoscomp #btnValid").slideDown();}}});})(jQuery)}
function widget_valideNewsletterFDv2(){(function($){var tabInfosPersos={};var tabCI=getTabCentresInterets();var tabPS=getTabPeriodesSejour();var tabTD=getTabTypesDestination();var tabTH=getTabTypesHebergement();var tabTS=getTabTypesSejours();tabInfosPersos.email=$('#inpt_emailNewsletterFD').val();$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:{action:'ajoutHabitudesVoyageNewsFD',infosPersos:tabInfosPersos,tabCI:tabCI,tabPS:tabPS,tabTD:tabTD,tabTH:tabTH,tabTS:tabTS},success:function(result){$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);if(result.code=="OK"){$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('echec');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").html('Inscription enregistre');$.fancybox.close(true);var divHref="#div_inscriptionNewletter_msgValidationV2";jQuery.fancybox($(divHref),{width:650,autoHeight:true,autoWidth:true,autoResize:true,fitToView:false,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,wrapCSS:'popinNewsletterFdV2 msgValidation'});inscriptionOK=true;}
else{$(".itea_inscriptionNewsletter_msgInfo").html(result.msg);$(".itea_inscriptionNewsletter_msgInfo.reussite").removeClass('reussite');$(".itea_inscriptionNewsletter_msgInfo").addClass('echec');$(".div_newsletterBtnConfirm, .div_newsletterBtnPasseEtape").slideDown();}}});})(jQuery)}
function widget_valideNewsletterFDv3(){(function($){widget_addTraitementEnCours();var tabInfosPersos=getTabInfosPerso();$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:{action:'insertInfosPersoNewsFD',infosPersos:tabInfosPersos},success:function(result){$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);if(result.code==="OK"){$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('echec');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('reussite');$('#divFormInfosPersoNewsletterFD').hide();if($('#div_inscriptionNewletter_infoscompV3').attr('data-mobile')==='O'){afficherEtape1MobileNewsletterFD();initNavigationMobileNewsletterFDv3();}else{$('#divFormInfosCompNewsletterFD').show();}}
else{$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('echec');$("#div_inscriptionNewletter_infoscomp #btnValid").slideDown();}}});})(jQuery);}
function widget_majInfosCompNewsletterFDv3(){(function($){widget_addTraitementEnCours();var tabInfosPersos=getTabInfosPerso();var tabCI=getTabCentresInterets();var tabPS=getTabPeriodesSejour();var tabTD=getTabTypesDestination();var tabTH=getTabTypesHebergement();var tabTS=getTabTypesSejours();$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',dataType:'JSON',data:{action:'ajoutHabitudesVoyageNewsFD',infosPersos:tabInfosPersos,tabCI:tabCI,tabPS:tabPS,tabTD:tabTD,tabTH:tabTH,tabTS:tabTS},success:function(result){$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);if(result.code==="OK"){close_formNewsletterFD();}
else{$(".itea_inscriptionNewsletterFD_msgInfo").html(result.msg);$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('echec');$("#div_inscriptionNewletter_infoscomp #btnValid").slideDown();}}});})(jQuery);}
function initNavigationMobileNewsletterFDv3(){(function($){$('#divFormInfosCompNewsletterFD').swipe({swipeLeft:function(){var currentEtape=$('#btnNextEtapeMobileNewsletterFD').attr('data-currentetape');switch(currentEtape){case'1':afficherEtape2MobileNewsletterFD();break;case'2':afficherEtape3MobileNewsletterFD();break;default:return;}},swipeRight:function(){var currentEtape=$('#btnNextEtapeMobileNewsletterFD').attr('data-currentetape');switch(currentEtape){case'2':afficherEtape1MobileNewsletterFD();break;case'3':afficherEtape2MobileNewsletterFD();break;default:return;}}});$('#btnNextEtapeMobileNewsletterFD').click(function(){var currentEtape=$(this).attr('data-currentetape');switch(currentEtape){case'1':afficherEtape2MobileNewsletterFD();break;case'2':afficherEtape3MobileNewsletterFD();break;default:return;}});})(jQuery);}
function close_formNewsletterFD(){jQuery.fancybox.close();}
function desabonneNewsletter(email){(function($){$.ajax({url:'lib_2/ajax/gereNewsletter.php',type:'POST',data:{action:'desabonneNewsletter',email:email},success:function(result){$.fancybox({maxWidth:650,autoHeight:true,autoWidth:true,autoResize:true,autoSize:true,closeClick:false,openEffect:'none',closeEffect:'none',padding:0,content:result,wrapCSS:'popin_compteGDF popin_modifInfosConnexion_cptGDF'});}});})(jQuery);}
function estInscriptionNewsletterFdV2(){if(jQuery("#inpt_inscriptionNewsFdV2").length>0){return true;}
return false;}
function estInscriptionNewsletterFdV3(){if(jQuery("#inpt_inscriptionNewsFdV3").length>0){return true;}
return false;}
function widget_addTraitementEnCours(){(function($){$(".itea_inscriptionNewsletterFD_msgInfo.reussite").removeClass('echec');$(".itea_inscriptionNewsletterFD_msgInfo").addClass('reussite');$(".itea_inscriptionNewsletterFD_msgInfo").html('Traitement en cours');$(".div_newsletterBtnConfirm, .div_newsletterBtnPasseEtape, #div_inscriptionNewletter_infoscomp #btnValid").slideUp();})(jQuery);}
function getTabInfosPerso(){return(function($){var tabInfosPersos={};tabInfosPersos.civilite=$('input[name="civilite"]:checked').val();tabInfosPersos.nom=$('#inpt_nom').val();tabInfosPersos.prenom=$('#inpt_prenom').val();tabInfosPersos.email=$('#inpt_email').val();if($('#inpt_dateaa').val().length>0&&$('#inpt_datemm').val().length>0&&$('#inpt_datejj').val().length>0){tabInfosPersos.date_naissance=$('#inpt_dateaa').val()+'-'+$('#inpt_datemm').val()+'-'+$('#inpt_datejj').val();}
tabInfosPersos.adresse=$('#inpt_adresse').val();tabInfosPersos.ville=$('#inpt_ville').val();tabInfosPersos.cp=$('#inpt_cp').val();tabInfosPersos.tel=$('#inpt_tel').val();if($('#inpt_legal').is(':checked')){tabInfosPersos.newsletter_part='O';}
return tabInfosPersos;})(jQuery);}
function getTabCentresInterets(){return(function($){var tabCI=new Array();$('.div_centresInteretsNewsletter input').each(function(){if($(this).is(':checked')){tabCI.push(($(this).val()));}});return tabCI;})(jQuery);}
function getTabPeriodesSejour(){return(function($){var tabPS=new Array();$('.div_periodesSejoursNewsletter input').each(function(){if($(this).is(':checked')){tabPS.push(($(this).val()));}});return tabPS;})(jQuery);}
function getTabTypesDestination(){return(function($){var tabTD=new Array();$('.div_typesDestinationsNewsletter input').each(function(){if($(this).is(':checked')){tabTD.push(($(this).val()));}});return tabTD;})(jQuery);}
function getTabTypesHebergement(){return(function($){var tabTH=new Array();$('.div_typesHebergementsNewsletter input').each(function(){if($(this).is(':checked')){tabTH.push(($(this).val()));}});return tabTH;})(jQuery);}
function getTabTypesSejours(){return(function($){var tabTS=new Array();$('.div_typesSejoursNewsletter input').each(function(){if($(this).is(':checked')){tabTS.push(($(this).val()));}});return tabTS;})(jQuery);}
function afficherEtape1MobileNewsletterFD(){(function($){$('#divVoyagesNewsletterFD').show();$('#btnNextEtapeMobileNewsletterFD').show();$('#divPeriodesNewsletterFD').hide();$('#divDestinationsNewsletterFD').hide();$('#btnConfirmerNewsletterFD').hide();$('#btnTerminerNewsletterFD').hide();$('btnNextEtapeMobileNewsletterFD').attr('data-currentetape','1');})(jQuery);}
function afficherEtape2MobileNewsletterFD(){(function($){$('#divPeriodesNewsletterFD').show();$('#btnNextEtapeMobileNewsletterFD').show();$('#divVoyagesNewsletterFD').hide();$('#divDestinationsNewsletterFD').hide();$('#btnConfirmerNewsletterFD').hide();$('#btnTerminerNewsletterFD').hide();$('btnNextEtapeMobileNewsletterFD').attr('data-currentetape','2');})(jQuery);}
function afficherEtape3MobileNewsletterFD(){(function($){$('#divDestinationsNewsletterFD').show();$('#btnConfirmerNewsletterFD').show();$('#btnTerminerNewsletterFD').show();$('#btnNextEtapeMobileNewsletterFD').hide();$('#divVoyagesNewsletterFD').hide();$('#divPeriodesNewsletterFD').hide();$('btnNextEtapeMobileNewsletterFD').attr('data-currentetape','3');})(jQuery);}function connexionEspaceProp(id){return(function($){var formulaire=$('#connexionProp_'+id).serializeArray();var rep=false;$.ajax({url:"/lib_2/ajax/gereProprietaire.php",data:formulaire,async:false,success:function(reponse){if(reponse==='OK'){rep=true;$(".widgetConnexionProp_erreur").hide();}else{$(".widgetConnexionProp_erreur").show();}}});return rep;})(jQuery);}
function onChangeWidgetSelectDpt(){(function($){if($('#selectWidgetListeDep option:selected').val()===""){return;}
window.location.href=window.location.protocol+'//'+window.location.host+'/'+$('#selectWidgetListeDep option:selected').val()+'.html';})(jQuery);}
function initWidgetTopActivites(){(function($){if($('#selectWidgetListeDep').length>0){jQuery("#selectWidgetListeDep").bind('change selectmenuchange',function(){if($('#selectWidgetListeDep option:selected').val()===""){return;}
window.location.href=window.location.protocol+'//'+window.location.host+'/'+$('#selectWidgetListeDep option:selected').val()+'.html';});}})(jQuery);}
var LiveValidation=function(element,optionsObj){this.initialize(element,optionsObj);}
LiveValidation.VERSION='1.4 standalone';LiveValidation.TEXTAREA=1;LiveValidation.TEXT=2;LiveValidation.PASSWORD=3;LiveValidation.CHECKBOX=4;LiveValidation.SELECT=5;LiveValidation.FILE=6;LiveValidation.massValidate=function(validations){var returnValue=true;for(var i=0,len=validations.length;i<len;++i){var valid=validations[i].validate();if(returnValue)returnValue=valid;}
return returnValue;}
LiveValidation.prototype={validClass:'LV_valid',invalidClass:'LV_invalid',messageClass:'LV_validation_message',validFieldClass:'LV_valid_field',invalidFieldClass:'LV_invalid_field',initialize:function(element,optionsObj){var self=this;if(!element)throw new Error("LiveValidation::initialize - No element reference or element id has been provided!");this.element=element.nodeName?element:document.getElementById(element);if(!this.element)throw new Error("LiveValidation::initialize - No element with reference or id of '"+element+"' exists!");this.validations=[];this.elementType=this.getElementType();this.form=this.element.form;var options=optionsObj||{};this.validMessage=options.validMessage||'Thankyou!';var node=options.insertAfterWhatNode||this.element;this.insertAfterWhatNode=node.nodeType?node:document.getElementById(node);this.onlyOnBlur=options.onlyOnBlur||false;this.wait=options.wait||0;this.onlyOnSubmit=options.onlyOnSubmit||false;this.beforeValidation=options.beforeValidation||function(){};this.beforeValid=options.beforeValid||function(){};this.onValid=options.onValid||function(){this.insertMessage(this.createMessageSpan());this.addFieldClass();};this.afterValid=options.afterValid||function(){};this.beforeInvalid=options.beforeInvalid||function(){};this.onInvalid=options.onInvalid||function(){this.insertMessage(this.createMessageSpan());this.addFieldClass();};this.afterInvalid=options.afterInvalid||function(){};this.afterValidation=options.afterValidation||function(){};if(this.form){this.formObj=LiveValidationForm.getInstance(this.form);this.formObj.addField(this);}
this.oldOnFocus=this.element.onfocus||function(){};this.oldOnBlur=this.element.onblur||function(){};this.oldOnClick=this.element.onclick||function(){};this.oldOnChange=this.element.onchange||function(){};this.oldOnKeyup=this.element.onkeyup||function(){};this.element.onfocus=function(e){self.doOnFocus(e);return self.oldOnFocus.call(this,e);}
if(!this.onlyOnSubmit){switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick=function(e){self.validate();return self.oldOnClick.call(this,e);}
case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=function(e){self.validate();return self.oldOnChange.call(this,e);}
break;default:if(!this.onlyOnBlur)this.element.onkeyup=function(e){self.deferValidation();return self.oldOnKeyup.call(this,e);}
this.element.onblur=function(e){self.doOnBlur(e);return self.oldOnBlur.call(this,e);}}}},destroy:function(){if(this.formObj){this.formObj.removeField(this);this.formObj.destroy();}
this.element.onfocus=this.oldOnFocus;if(!this.onlyOnSubmit){switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick=this.oldOnClick;case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=this.oldOnChange;break;default:if(!this.onlyOnBlur)this.element.onkeyup=this.oldOnKeyup;this.element.onblur=this.oldOnBlur;}}
this.validations=[];this.removeMessageAndFieldClass();},add:function(validationFunction,validationParamsObj){this.validations.push({type:validationFunction,params:validationParamsObj||{}});return this;},remove:function(validationFunction,validationParamsObj){var victimless=[];for(var i=0,len=this.validations.length;i<len;i++){var v=this.validations[i];if(v.type!=validationFunction&&v.params!=validationParamsObj)victimless.push(v);}
this.validations=victimless;return this;},deferValidation:function(e){if(this.wait>=300)this.removeMessageAndFieldClass();var self=this;if(this.timeout)clearTimeout(self.timeout);this.timeout=setTimeout(function(){self.validate()},self.wait);},doOnBlur:function(e){this.focused=false;this.validate(e);},doOnFocus:function(e){this.focused=true;this.removeMessageAndFieldClass();},getElementType:function(){var nn=this.element.nodeName.toUpperCase();var nt=this.element.type.toUpperCase();switch(true){case(nn=='TEXTAREA'):return LiveValidation.TEXTAREA;case(nn=='INPUT'&&nt=='TEXT'):return LiveValidation.TEXT;case(nn=='INPUT'&&(nt=='EMAIL'||nt=='TEL'||nt=='NUMBER'||nt=='RANGE')):return LiveValidation.TEXT;case(nn=='INPUT'&&nt=='PASSWORD'):return LiveValidation.PASSWORD;case(nn=='INPUT'&&nt=='CHECKBOX'):return LiveValidation.CHECKBOX;case(nn=='INPUT'&&nt=='FILE'):return LiveValidation.FILE;case(nn=='SELECT'):return LiveValidation.SELECT;case(nn=='INPUT'):throw new Error('LiveValidation::getElementType - Cannot use LiveValidation on an '+nt.toLowerCase()+' input!');default:throw new Error('LiveValidation::getElementType - Element must be an input, select, or textarea - '+nn.toLowerCase()+' was given!');}},doValidations:function(){this.validationFailed=false;for(var i=0,len=this.validations.length;i<len;++i){this.validationFailed=!this.validateElement(this.validations[i].type,this.validations[i].params);if(this.validationFailed)return false;}
this.message=this.validMessage;return true;},validateElement:function(validationFunction,validationParamsObj){switch(validationFunction){case Validate.Presence:case Validate.Confirmation:case Validate.Acceptance:this.displayMessageWhenEmpty=true;break;case Validate.Custom:if(validationParamsObj.displayMessageWhenEmpty)this.displayMessageWhenEmpty=true;break;}
var value=(this.elementType==LiveValidation.SELECT)?this.element.options[this.element.selectedIndex].value:this.element.value;if(validationFunction==Validate.Acceptance){if(this.elementType!=LiveValidation.CHECKBOX)throw new Error('LiveValidation::validateElement - Element to validate acceptance must be a checkbox!');value=this.element.checked;}
var isValid=true;try{validationFunction(value,validationParamsObj);}catch(error){if(error instanceof Validate.Error){if(value!==''||(value===''&&this.displayMessageWhenEmpty)){this.validationFailed=true;this.message=error.message.split('\n')[0];isValid=false;}}else{throw error;}}finally{return isValid;}},validate:function(){if(!this.element.disabled){this.beforeValidation();var isValid=this.doValidations();if(isValid){this.beforeValid();this.onValid();this.afterValid();return true;}else{this.beforeInvalid();this.onInvalid();this.afterInvalid();return false;}
this.afterValidation();}else{return true;}},enable:function(){this.element.disabled=false;return this;},disable:function(){this.element.disabled=true;this.removeMessageAndFieldClass();return this;},createMessageSpan:function(){var span=document.createElement('span');var textNode=document.createTextNode(this.message);span.appendChild(textNode);return span;},insertMessage:function(elementToInsert){this.removeMessage();if(!this.validationFailed&&!this.validMessage)return;if((this.displayMessageWhenEmpty&&(this.elementType==LiveValidation.CHECKBOX||this.element.value==''))||this.element.value!=''){var className=this.validationFailed?this.invalidClass:this.validClass;elementToInsert.className+=' '+this.messageClass+' '+className;var parent=this.insertAfterWhatNode.parentNode;if(this.insertAfterWhatNode.nextSibling){parent.insertBefore(elementToInsert,this.insertAfterWhatNode.nextSibling);}else{parent.appendChild(elementToInsert);}}},addFieldClass:function(){this.removeFieldClass();if(!this.validationFailed){if(this.displayMessageWhenEmpty||this.element.value!=''){if(this.element.className.indexOf(this.validFieldClass)==-1)this.element.className+=' '+this.validFieldClass;}}else{if(this.element.className.indexOf(this.invalidFieldClass)==-1)this.element.className+=' '+this.invalidFieldClass;}},removeMessage:function(){var nextEl;var el=this.insertAfterWhatNode;while(el.nextSibling){if(el.nextSibling.nodeType===1){nextEl=el.nextSibling;break;}
el=el.nextSibling;}
if(nextEl&&nextEl.className.indexOf(this.messageClass)!=-1)this.insertAfterWhatNode.parentNode.removeChild(nextEl);},removeFieldClass:function(){var cn=this.element.className;if(cn.indexOf(this.invalidFieldClass)!=-1)this.element.className=cn.split(this.invalidFieldClass).join('');if(cn.indexOf(this.validFieldClass)!=-1)this.element.className=cn.split(this.validFieldClass).join(' ');},removeMessageAndFieldClass:function(){this.removeMessage();this.removeFieldClass();}}
var LiveValidationForm=function(element){this.initialize(element);}
LiveValidationForm.instances={};LiveValidationForm.getInstance=function(element){if(!element)throw new Error("LiveValidationForm::getInstance - No element reference or element id has been provided!");var el=element.nodeName?element:document.getElementById(element);var rand=Math.random()*Math.random();if(!el.id)el.id='formId_'+rand.toString().replace(/\./,'')+new Date().valueOf();if(!LiveValidationForm.instances[el.id])LiveValidationForm.instances[el.id]=new LiveValidationForm(el);return LiveValidationForm.instances[el.id];}
LiveValidationForm.prototype={beforeValidation:function(){},onValid:function(){},onInvalid:function(){},afterValidation:function(){},initialize:function(element){this.name=element.id;this.element=element;this.fields=[];this.oldOnSubmit=this.element.onsubmit||function(){};var self=this;this.element.onsubmit=function(e){var ret=false;self.beforeValidation(),self.valid=LiveValidation.massValidate(self.fields);self.valid?self.onValid():self.onInvalid();self.afterValidation();if(self.valid)ret=self.oldOnSubmit.call(this,e||window.event)!==false;if(!ret)return ret;}},addField:function(newField){this.fields.push(newField);},removeField:function(victim){var victimless=[];for(var i=0,len=this.fields.length;i<len;i++){if(this.fields[i]!==victim)victimless.push(this.fields[i]);}
this.fields=victimless;},destroy:function(force){if(this.fields.length!=0&&!force)return false;this.element.onsubmit=this.oldOnSubmit;LiveValidationForm.instances[this.name]=null;return true;}}
var Validate={Presence:function(value,paramsObj){var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Can't be empty!";if(value===''||value===null||value===undefined)Validate.fail(message);return true;},Numericality:function(value,paramsObj){var suppliedValue=value;var value=Number(value);var paramsObj=paramsObj||{};var minimum=((paramsObj.minimum)||(paramsObj.minimum==0))?paramsObj.minimum:null;;var maximum=((paramsObj.maximum)||(paramsObj.maximum==0))?paramsObj.maximum:null;var is=((paramsObj.is)||(paramsObj.is==0))?paramsObj.is:null;var notANumberMessage=paramsObj.notANumberMessage||"Must be a number!";var notAnIntegerMessage=paramsObj.notAnIntegerMessage||"Must be an integer!";var wrongNumberMessage=paramsObj.wrongNumberMessage||"Must be "+is+"!";var tooLowMessage=paramsObj.tooLowMessage||"Must not be less than "+minimum+"!";var tooHighMessage=paramsObj.tooHighMessage||"Must not be more than "+maximum+"!";if(!isFinite(value))Validate.fail(notANumberMessage);if(paramsObj.onlyInteger&&(/\.0+$|\.$/.test(String(suppliedValue))||value!=parseInt(value)))Validate.fail(notAnIntegerMessage);switch(true){case(is!==null):if(value!=Number(is))Validate.fail(wrongNumberMessage);break;case(minimum!==null&&maximum!==null):Validate.Numericality(value,{tooLowMessage:tooLowMessage,minimum:minimum});Validate.Numericality(value,{tooHighMessage:tooHighMessage,maximum:maximum});break;case(minimum!==null):if(value<Number(minimum))Validate.fail(tooLowMessage);break;case(maximum!==null):if(value>Number(maximum))Validate.fail(tooHighMessage);break;}
return true;},Format:function(value,paramsObj){var value=String(value);var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Not valid!";var pattern=paramsObj.pattern||/./;var negate=paramsObj.negate||false;if(!negate&&!pattern.test(value))Validate.fail(message);if(negate&&pattern.test(value))Validate.fail(message);return true;},Email:function(value,paramsObj){var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Must be a valid email address!";Validate.Format(value,{failureMessage:message,pattern:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i});return true;},Length:function(value,paramsObj){var value=String(value);var paramsObj=paramsObj||{};var minimum=((paramsObj.minimum)||(paramsObj.minimum==0))?paramsObj.minimum:null;var maximum=((paramsObj.maximum)||(paramsObj.maximum==0))?paramsObj.maximum:null;var is=((paramsObj.is)||(paramsObj.is==0))?paramsObj.is:null;var wrongLengthMessage=paramsObj.wrongLengthMessage||"Must be "+is+" characters long!";var tooShortMessage=paramsObj.tooShortMessage||"Must not be less than "+minimum+" characters long!";var tooLongMessage=paramsObj.tooLongMessage||"Must not be more than "+maximum+" characters long!";switch(true){case(is!==null):if(value.length!=Number(is))Validate.fail(wrongLengthMessage);break;case(minimum!==null&&maximum!==null):Validate.Length(value,{tooShortMessage:tooShortMessage,minimum:minimum});Validate.Length(value,{tooLongMessage:tooLongMessage,maximum:maximum});break;case(minimum!==null):if(value.length<Number(minimum))Validate.fail(tooShortMessage);break;case(maximum!==null):if(value.length>Number(maximum))Validate.fail(tooLongMessage);break;default:throw new Error("Validate::Length - Length(s) to validate against must be provided!");}
return true;},Inclusion:function(value,paramsObj){var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Must be included in the list!";var caseSensitive=(paramsObj.caseSensitive===false)?false:true;if(paramsObj.allowNull&&value==null)return true;if(!paramsObj.allowNull&&value==null)Validate.fail(message);var within=paramsObj.within||[];if(!caseSensitive){var lowerWithin=[];for(var j=0,length=within.length;j<length;++j){var item=within[j];if(typeof item=='string')item=item.toLowerCase();lowerWithin.push(item);}
within=lowerWithin;if(typeof value=='string')value=value.toLowerCase();}
var found=false;for(var i=0,length=within.length;i<length;++i){if(within[i]==value)found=true;if(paramsObj.partialMatch){if(value.indexOf(within[i])!=-1)found=true;}}
if((!paramsObj.negate&&!found)||(paramsObj.negate&&found))Validate.fail(message);return true;},Exclusion:function(value,paramsObj){var paramsObj=paramsObj||{};paramsObj.failureMessage=paramsObj.failureMessage||"Must not be included in the list!";paramsObj.negate=true;Validate.Inclusion(value,paramsObj);return true;},Confirmation:function(value,paramsObj){if(!paramsObj.match)throw new Error("Validate::Confirmation - Error validating confirmation: Id of element to match must be provided!");var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Does not match!";var match=paramsObj.match.nodeName?paramsObj.match:document.getElementById(paramsObj.match);if(!match)throw new Error("Validate::Confirmation - There is no reference with name of, or element with id of '"+paramsObj.match+"'!");if(value!=match.value)Validate.fail(message);return true;},Acceptance:function(value,paramsObj){var paramsObj=paramsObj||{};var message=paramsObj.failureMessage||"Must be accepted!";if(!value)Validate.fail(message);return true;},Custom:function(value,paramsObj){var paramsObj=paramsObj||{};var against=paramsObj.against||function(){return true;};var args=paramsObj.args||{};var message=paramsObj.failureMessage||"Not valid!";if(!against(value,args))Validate.fail(message);return true;},now:function(validationFunction,value,validationParamsObj){if(!validationFunction)throw new Error("Validate::now - Validation function must be provided!");var isValid=true;try{validationFunction(value,validationParamsObj||{});}catch(error){if(error instanceof Validate.Error){isValid=false;}else{throw error;}}finally{return isValid}},fail:function(errorMessage){throw new Validate.Error(errorMessage);},Error:function(errorMessage){this.message=errorMessage;this.name='ValidationError';}}
function init_packDivDatesTarifs(){(function($){initSelectionTypeTarifs_packDivDatesTarifs();initSelectionMois_packDivDatesTarifs();initNavigationMois_packDivDatesTarifs();initSelectionPeriode_packDivDatesTarifs();checkAfficheBoutonWeekEnd_packDivDatesTarifs();checkAfficheBoutonMidWeek_packDivDatesTarifs();initCalendrierDatesFiche_packDivDatesTarifs();init_detailChambreAfficheTarifs();init_detailChambreAfficheDispo();init_detailChambreSelectNbPers();if(!jQuery('#inpt_resaDateDebCal')){initEventClickBoutonReserver_packDivDatesTarifs();}
initEventClickBoutonContactProp_packDivDatesTarifs();if(!dateDebEtFin_VideOuDefault()){lanceCalculPrixSejour();}
$(document).ready(function(){$('#widgetFNGF_selectChambre').on('change',function(){$('#div_loaderUnload').show();var capacite=$('#widgetFNGF_selectChambre option[value="'+$(this).val()+'"]').attr('capacite');updateSelectCapacite(capacite);updatePrixResa();$('#div_loaderUnload').hide();});$('#widgetFNGF_selectCapacite').on('change',function(){$('#div_loaderUnload').show();updatePrixResa();$('#div_loaderUnload').hide();});});})(jQuery);}
function initSelectionTypeTarifs_packDivDatesTarifs(){(function($){$('.tarifsAvecDispo_choixDuree li span').bind('click',function(){var liParent=$(this).parent('li');if(liParent.hasClass('indisponible')){return;}
var typeTarif=$(this).parent('li').attr('data-duree-tarif');if(typeTarif=='autre'){ouvreDatePickerDateDeb_packDivDatesTarifs();$(this).parent('li').addClass("opened");}else{$('.tarifsAvecDispo_choixDuree li').removeClass('active');liParent.addClass('active');$('.tarifsAvecDispo_detailUnMois .tarifsAvecDispo_detailUnMois_tarifUneDuree').hide();$('.tarifsAvecDispo_detailUnMois .tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="'+typeTarif+'"]').show();}
return false;});})(jQuery);}
function initNavigationMois_packDivDatesTarifs(){(function($){$('.tarifsAvecDispo_choixMoisNext a').bind('click',function(){if(!$('.tarifsAvecDispo_listeMois li:visible').first().is('.active')){$('.tarifsAvecDispo_listeMois li:visible').first().hide();$('.tarifsAvecDispo_listeMois li:visible').last().next().show();$('.tarifsAvecDispo_choixMoisPrev').css('visibility','visible');}
var liMoisActifNext=$('.tarifsAvecDispo_listeMois li.active').next();selectionneMois_packDivDatesTarifs(liMoisActifNext);});$('.tarifsAvecDispo_choixMoisPrev a').bind('click',function(){if(!$('.tarifsAvecDispo_listeMois li:visible').last().is('.active')){$('.tarifsAvecDispo_listeMois li:visible').last().hide();$('.tarifsAvecDispo_listeMois li:visible').first().prev().show();$('.tarifsAvecDispo_choixMoisNext').css('visibility','visible');}
var liMoisPrev=$('.tarifsAvecDispo_listeMois li.active').prev();selectionneMois_packDivDatesTarifs(liMoisPrev);});})(jQuery);}
function initSelectionMois_packDivDatesTarifs(){(function($){$('.tarifsAvecDispo_listeMois li').bind('click',function(){selectionneMois_packDivDatesTarifs($(this));});})(jQuery);}
function selectionneMois_packDivDatesTarifs(liMois){(function($){if(liMois.hasClass('active')&&liMois.is(':first-child, :last-child')){return false;}
$('.tarifsAvecDispo_listeMois li').removeClass('active');liMois.addClass('active');if(liMois.not(':visible')){$('.tarifsAvecDispo_listeMois li').hide();liMois.show();if(liMois.prev().length>0){liMois.prev().show();}
if(liMois.is(':first-child')){$('.tarifsAvecDispo_choixMoisPrev').css('visibility','hidden');}else{$('.tarifsAvecDispo_choixMoisPrev').css('visibility','visible');}
if(liMois.next().length>0){liMois.next().show();}
if(liMois.is(':last-child')){$('.tarifsAvecDispo_choixMoisNext').css('visibility','hidden');}else{$('.tarifsAvecDispo_choixMoisNext').css('visibility','visible');}}
var moisAnnee=liMois.attr('data-moisAnnee');$('.tarifsAvecDispo_detailUnMois').hide();$('.tarifsAvecDispo_detailUnMois[data-moisAnnee="'+moisAnnee+'"]').show();checkAfficheBoutonWeekEnd_packDivDatesTarifs();checkAfficheBoutonMidWeek_packDivDatesTarifs();})(jQuery);}
function initSelectionPeriode_packDivDatesTarifs(){(function($){$('.tarifsAvecDispo_detailUnMois_tarifUneDuree td.libre').bind('click',function(){$('.tarifsAvecDispo_detailUnMois_tarifUneDuree td').removeClass('select');$(this).addClass('select');setInputDates_packDivDatesTarifs($(this).attr('data-deb'),$(this).attr('data-nbj'));lanceCalculPrixSejour();});$('.tarifsAvecDispo_detailUnMois_tarifUneDuree td.partiellementDispo').bind('click',function(){if(typeof(ouvreDatePicker_partiellementDispo_foncAvant)=='function'){ouvreDatePicker_partiellementDispo_foncAvant();}
var dateDebAvant=$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateDeb').val();;var dateFinAvant=$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateFin').val();setInputDates_packDivDatesTarifs($(this).attr('data-deb'),$(this).attr('data-nbj'),true);ouvreDatePickerDateDeb_packDivDatesTarifs();$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateDeb').val(dateDebAvant);$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateFin').val(dateFinAvant);return false;});})(jQuery);}
function setInputDates_packDivDatesTarifs(dateDeb,duree,invisible){(function($){var objDate=new OBJDate(dateDeb);objDate.ajoutJour(duree);var dateFin=objDate.toString();var objDateDeb=new Date();objDateDeb.setFullYear(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));objDateDeb.setHours(0);objDateDeb.setMinutes(0);objDateDeb.setSeconds(0);var objDateFin=new Date();objDateFin.setFullYear(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));if(invisible){$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateDeb').attr('data-dateposition',dateDeb);$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateFin').attr('data-dateposition',dateFin);}else{$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateDeb').val(dateDeb);$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateFin').val(dateFin);}
if(window.setInputDates_packDivDatesTarifs_foncQdFini){setInputDates_packDivDatesTarifs_foncQdFini();}})(jQuery);}
function lanceCalculPrixSejour(avecSelectionChambres){(function($){var dateDeb=$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateDeb').val();var dateFin=$('#div_choixDates_packDivDatesTarifs .inpt_moteurDatesDateFin').val();if($('#div_choixModeResaGEGS').length>0){var modeResa=$('.inpt_modeVte:checked').val();}
if(dateDeb&&dateFin){var tabData={type:'verifDates',dateDeb:dateDeb,dateFin:dateFin,avecQTipFD:$('#sp_infoBulleAideFraisDossiers').length,modeResa:modeResa};modeCalculPrixSurFiche=true;if(avecSelectionChambres===true){ajaxVerifDates(tabData,affectSelectionChambres_fiche);}else{ajaxVerifDates(tabData);}}})(jQuery);}
function checkAfficheBoutonWeekEnd_packDivDatesTarifs(){(function($){var btnWeekEnd=$('.tarifsAvecDispo_choixDuree').find('li[data-duree-tarif="week-end"]');var divMoisSelect=$('.tarifsAvecDispo_detailUnMois:visible');var tableDureeWeekEnd=divMoisSelect.find('table.tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="week-end"]');if(tableDureeWeekEnd.find('td').not('.indisponible').length>0){btnWeekEnd.removeClass('indisponible').attr("title","");}else{btnWeekEnd.addClass('indisponible').attr("title",btnWeekEnd.attr("data-titlepasTarif"));if(btnWeekEnd.is('.active')){$('.tarifsAvecDispo_choixDuree li[data-duree-tarif="semaine"] span').trigger('click');}}})(jQuery);}
function checkAfficheBoutonMidWeek_packDivDatesTarifs(){(function($){var btnMidWeek=$('.tarifsAvecDispo_choixDuree').find('li[data-duree-tarif="mid-week"]');var divMoisSelect=$('.tarifsAvecDispo_detailUnMois:visible');var tableDureeMidWeek=divMoisSelect.find('table.tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="mid-week"]');if(tableDureeMidWeek.find('td').not('.indisponible').length>0){btnMidWeek.removeClass('indisponible').attr("title","");}else{btnMidWeek.addClass('indisponible').attr("title",btnMidWeek.attr("data-titlepasTarif"));if(btnMidWeek.is('.active')){$('.tarifsAvecDispo_choixDuree li[data-duree-tarif="semaine"] span').trigger('click');}}})(jQuery);}
function initCalendrierDatesFiche_packDivDatesTarifs(){(function($){var tabParam=new Array();tabParam.ident=jQuery('#div_choixDates_packDivDatesTarifs').attr('data-ident');tabParam.instance=jQuery('#div_choixDates_packDivDatesTarifs').attr('data-instance');tabParam.exercice=jQuery('#div_choixDates_packDivDatesTarifs').attr('data-exercice');tabParam.modeFicheV8=true;afficherMasquerCalendrier(tabParam);})(jQuery);}
function majDivTarifAPartirDe(tabRetour){(function($){if($('#div_choixDates_packDivDatesTarifs')&&$('#div_choixDates_packDivDatesTarifs').attr('data-impweb')==='N'&&!tabRetour.htmlTarifFicheApartirDe&&$('#widgetGNGF').length==0){if(tabRetour.planVente&&$('#div_choixDates_packDivDatesTarifs').attr('data-planvente')!==tabRetour.planVente){var tabInfosActualisation={deb:$('#inpt_resaDateDebCal').val(),fin:$('#inpt_resaDateFinCal').val()};actualisePageFiche(tabInfosActualisation);return;}}
$('#div_msgErreurRetourVerifDates').html('');if(tabRetour.msgErreurCalculPrix){$('.tarifFicheApartirDe').hide();if($('#div_msgErreurRetourVerifDates').length>0){$('#div_msgErreurRetourVerifDates').replaceWith(tabRetour.msgErreurCalculPrix);}else{$('.tarifFicheApartirDe').before(tabRetour.msgErreurCalculPrix);}}else if(tabRetour.htmlTarifFicheApartirDe){$('#div_msgErreurRetourVerifDates').hide();$('.tarifFicheApartirDe').html(tabRetour.htmlTarifFicheApartirDe);$('.tarifFicheApartirDe').show();if(tabRetour.prixChambres){tabRetour.prixChambres.forEach(function(chambre){var div=$('.div_tarifUneChambre_infosTarifs[data-num_idch="'+chambre['numChambre']+'"]');div.find('.sp_prixSejour_prix').html(chambre['prixAdu']);div.find('.sp_lblApresPrix').hide();});}
setEventForQtip();}else{$('.tarifFicheApartirDe').hide();}
if(tabRetour.msgInfoDemandeParMail){if($('#div_msgInfoDemandeParMail').length>0){$('#div_msgInfoDemandeParMail').replaceWith(tabRetour.msgInfoDemandeParMail);}else{$('.tarifFicheApartirDe').after(tabRetour.msgInfoDemandeParMail);}}else{$('#div_msgInfoDemandeParMail').hide();}
if(tabRetour.htmlBoutonReserver){if($('.divWrapperBoutonReserverContact').length>0){$('.divWrapperBoutonReserverContact').html(tabRetour.htmlBoutonReserver);}
else if($('.div_btnResa').length>0){$('.div_btnResa').html(tabRetour.htmlBoutonReserver);}
else{$('#btResa').html(tabRetour.htmlBoutonReserver);}
majHrefBoutonReserver();initEventClickBoutonReserver_packDivDatesTarifs();}
if(tabRetour.location){var prixLocation=tabRetour.location.replace(' &euro;','');$('#a_btnReserver_packDivDatesTarifs').attr('data-prix',prixLocation);}
if(tabRetour.changeMsgBtnReserver){var titleDemandeResa=$('#a_btnReserver_packDivDatesTarifs').attr('data-titleDemandeResa');$('#a_btnReserver_packDivDatesTarifs').attr('title',titleDemandeResa);$('#a_btnReserver_packDivDatesTarifs .sp_lblReserver').each(function(){var lblDemandeResa=$(this).attr('data-lblDemandeResa');$(this).text(lblDemandeResa);$('#a_btnReserver_packDivDatesTarifs').addClass('demandeDeResa');});}})(jQuery);}
function majDivChambres_packDivDatesTarifs(tabRetour,avecFondQdFini){if(tabRetour.htmlDivChambres){for(var numIdCh in tabRetour.htmlDivChambres){var div=jQuery('.div_tarifUneChambre_infosTarifs[data-num_idch="'+numIdCh+'"]');if(div.length===0){continue;}
var html=tabRetour.htmlDivChambres[numIdCh];div.replaceWith(html);var dateDeb=jQuery('.inpt_moteurDatesDateDeb').val();changeMoisCalendrierPHP(jQuery('.divWrapperInfosChambre_packDivDatesTarifs[data-num_idch="'+numIdCh+'"]'),dateDeb);jQuery('.div_tarifUneChambre_lancerResa').removeClass('sansDates');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"]').removeClass('disabled');jQuery('.divWrapperInfosChambre_packDivDatesTarifs[data-num_idch="'+numIdCh+'"]').removeClass('indisponible');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').removeAttr('disabled');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').next('.ui-selectmenu-button').removeClass('ui-selectmenu-disabled');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').next('.ui-selectmenu-button').removeClass('ui-state-disabled');if(jQuery('.div_tarifUneChambre_infosTarifs[data-num_idch="'+numIdCh+'"]').hasClass('indisponible')){jQuery('.divWrapperInfosChambre_packDivDatesTarifs[data-num_idch="'+numIdCh+'"]').addClass('indisponible');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"]').addClass('disabled');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').attr('disabled','');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').next('.ui-selectmenu-button').addClass('ui-selectmenu-disabled');jQuery('.div_tarifUneChambre_selectNbPers[data-numIdch="'+numIdCh+'"] .select_nbPers').next('.ui-selectmenu-button').addClass('ui-state-disabled');}}
init_detailChambreAfficheTarifs();init_detailChambreAfficheDispo();jQuery(".a_lblConnaitredispos").text(jQuery(".a_lblConnaitredispos").data("lblavecdates"));if(avecFondQdFini!==false&&window.majDivChambres_packDivDatesTarifs_foncQdFini){majDivChambres_packDivDatesTarifs_foncQdFini();}}
if(tabRetour.htmlDatesSejoursAlternatifs){jQuery('.divWrapperInfosChambre_packDivDatesTarifs').each(function(){var numIdch=jQuery(this).data('num_idch');if(jQuery(this).find('.div_sejoursAlternatifs').length>0){jQuery(this).find('.div_sejoursAlternatifs').remove();}
if(tabRetour.htmlDatesSejoursAlternatifs[numIdch]!==''){jQuery(this).find('.div_tarifUneChambre_lancerResa').hide();jQuery(this).append(tabRetour.htmlDatesSejoursAlternatifs[numIdch]);}else{jQuery(this).find('.div_tarifUneChambre_lancerResa').show();}});}}
function majHrefBoutonReserver(sansPlanning){(function($){if($('#a_btnReserver_packDivDatesTarifs').attr('data-accesResa')=='O'||sansPlanning){var lienResa=$('#a_btnReserver_packDivDatesTarifs').attr('data-lienResa');$('#a_btnReserver_packDivDatesTarifs').attr('href',lienResa);$('#a_btnReserver_packDivDatesTarifs').attr('target',$('#a_btnReserver_packDivDatesTarifs').attr('data-target'));if(typeof(waDecorateLink)=="function"){lienResa=waDecorateLink(lienResa);}
$('#a_btnReserver_packDivDatesTarifs').attr('href',lienResa);}})(jQuery);}
function verifDatePickerFiche(){var ok=true;(function($){if(dateDebEtFin_VideOuDefault()){ouvreDatePickerDateDeb_packDivDatesTarifs();ok=false;}})(jQuery);return ok;}
function initEventClickBoutonReserver_packDivDatesTarifs(){(function($){$('#a_btnReserver_packDivDatesTarifs').unbind('click');$('#a_btnReserver_packDivDatesTarifs').bind('click',function(){if(!verifDatePickerFiche()){return false;}
majHrefBoutonReserver(true);var tabParamsGTM=$(this).attr('data-paramsTrackEvent');var listeParams=eval('('+tabParamsGTM+')');if(window.dataLayer){dataLayer.push({'Label_Event':listeParams.label,'Categorie_Event':listeParams.categorie,'event':listeParams.action});var prix=$(this).attr('data-prix');var TransactionId=listeParams.prefixe+listeParams.label;dataLayer.push({'Transaction_Id':TransactionId,'Product_Id':listeParams.ident,'Price':prix,'event':'Criteo_Contact'});}else if(window.ga){ga('send','event',listeParams.categorie,listeParams.action,listeParams.label);}else if(typeof(_gaq)!='undefined'){_gaq.push(['_trackEvent',listeParams.categorie,listeParams.action,listeParams.label]);}});})(jQuery);}
function initEventClickBoutonContactProp_packDivDatesTarifs(){(function($){$('#a_btnContactProp_packDivDatesTarifs').click(function(){if(!verifDatePickerFiche()){return false;}
$('#a_btnContactProp_forStatMe').trigger('click');});$('#a_btnContactProp_forStatMe').click(function(){var valDateDeb=getValInputDateDebFiche();sendThisToProp($(this).data('ident'),'800','600',$(this).data('titre'),'N','N',valDateDeb,$('#moteur_datePickerDeb').data('duree'));if(window.dataLayer){var tabParamsGTM=$(this).attr('data-paramsTrackEvent');var listeParams=eval('('+tabParamsGTM+')');dataLayer.push({'Label_Event':listeParams.label,'Categorie_Event':listeParams.categorie,'event':listeParams.event});}});})(jQuery);}
function initEventQTipInfoCalculTaxeSejour(){(function($){if($('.btnDetailCalculTaxeSejour').length>0){var text=$('.detailCalculTaxeSejour').html();$('.btnDetailCalculTaxeSejour').qtip({content:text});}})(jQuery);}
function ouvreDatePickerDateDeb_packDivDatesTarifs(){if(jQuery('#div_choixDates').length>0){if(jQuery('#div_choixDates #inpt_resaDateDeb').length>0){jQuery('#div_choixDates #inpt_resaDateDeb').trigger('click');}
else if(jQuery('#div_choixDates #inpt_resaDateDebCal').length>0){jQuery('#div_choixDates #inpt_resaDateDebCal').trigger('click');}}else{if(jQuery('#div_choixDates_packDivDatesTarifs #inpt_resaDateDeb').length>0){jQuery('#div_choixDates_packDivDatesTarifs #inpt_resaDateDeb').trigger('click');}
else if(jQuery('#div_choixDates_packDivDatesTarifs #inpt_resaDateDebCal').length>0){jQuery('#div_choixDates_packDivDatesTarifs #inpt_resaDateDebCal').trigger('click');}}
if(window.ouvreDatePickerDateDeb_packDivDatesTarifs_foncQdFini){ouvreDatePickerDateDeb_packDivDatesTarifs_foncQdFini();}}
function majTarifsSelectionne(dateDeb,dateFin){(function($){var objDateDeb=new OBJDate(dateDeb);var objDateFin=new OBJDate(dateFin);var moisAnnee=objDateDeb.getMois()+'-'+objDateDeb.getAnnee();var nbj=objDateDeb.getNbJourEcartWithOBJDate(objDateFin);var liMoisASelect=$('.tarifsAvecDispo_listeMois li[data-moisannee="'+moisAnnee+'"]');var divMoisSelect=$('.tarifsAvecDispo_detailUnMois[data-moisannee="'+moisAnnee+'"]');selectionneMois_packDivDatesTarifs(liMoisASelect);$('.tarifsAvecDispo_detailUnMois_tarifUneDuree td').removeClass('select');if(objDateDeb.getJourSemaine()==6&&nbj==7){$('.tarifsAvecDispo_choixDuree li[data-duree-tarif="semaine"] span').trigger('click');divMoisSelect.find('.tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="semaine"] td[data-deb="'+dateDeb+'"]').addClass('select');}else if(objDateDeb.getJourSemaine()==5&&nbj==2){$('.tarifsAvecDispo_choixDuree li[data-duree-tarif="week-end"] span').trigger('click');divMoisSelect.find('.tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="week-end"] td[data-deb="'+dateDeb+'"]').addClass('select');}else if(objDateDeb.getJourSemaine()==1&&nbj==7){$('.tarifsAvecDispo_choixDuree li[data-duree-tarif="mid-week"] span').trigger('click');divMoisSelect.find('.tarifsAvecDispo_detailUnMois_tarifUneDuree[data-duree-tarif="mid-week"] td[data-deb="'+dateDeb+'"]').addClass('select');}})(jQuery);}
function init_detailChambreAfficheTarifs(){(function($){$(".a_btVoirPrixChambre").click(function(){var numChambre=$(this).attr("data-chambre");if($(this).hasClass("closed")){$('.div_tarifUneChambre_tarifs[data-chambre="'+numChambre+'"]').show();$(this).removeClass("closed").addClass("opened");}
else{$('.div_tarifUneChambre_tarifs[data-chambre="'+numChambre+'"]').hide();$(this).addClass("closed").removeClass("opened");}});})(jQuery);}
function click_btnResaUneChambre(){(function($){var href=$("#a_btnReserver_packDivDatesTarifs").attr("href");window.open(href,'_blank');})(jQuery);}
function init_detailChambreAfficheDispo(){(function($){var avecPlanning=true;if($('.a_btVoirDispoChambre').attr('data-planning')=='false'){avecPlanning=false;}
$(".a_btVoirDispoChambre").click(function(){$('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').attr('data-numidchselect','');if(avecPlanning){ouvreDatePickerDateDeb_packDivDatesTarifs();}
else{alert("Pour connaitre les disponibilits veuillez contacter le propritaire.");}
return false;});$('.div_tarifUneChambre_lancerResa > *').unbind('click');if($('.div_tarifUneChambre_lancerResa.sansDates').length>0&&avecPlanning){$('.div_tarifUneChambre_lancerResa.sansDates > *').bind('click',function(){$('#div_fiche_bloc_tarif_chmb_packDivDatesTarifs').attr('data-numidchselect',$(this).parents('.div_tarifUneChambre').data('num_idch'));ouvreDatePickerDateDeb_packDivDatesTarifs();return false;});}})(jQuery);}
function init_detailChambreSelectNbPers(){(function($){if($('.div_tarifUneChambre_selectNbPers').length==0){return;}
$('.div_tarifUneChambre_selectNbPers').find('.select_nbPers').bind('change selectmenuchange',function(){majListesSelect_packDivTarifs($(this).parents('.div_tarifUneChambre_selectNbPers '));var numIdch=$(this).attr('data-numIdch');if($(this).is('.select_nbEnfants')||$(this).is('.select_nbEnfants')){if(verifNbAdultes(numIdch)){majTarifsFiche_packDivTarifs();}else{$(this).val(0);if($(this).is(':hidden')){$(this).selectmenu('refresh');}}}else{$('.div_tarifUneChambre_saisirAdultes[data-numIdch="'+numIdch+'"]').hide();majTarifsFiche_packDivTarifs();}});})(jQuery);}
function verifNbAdultes(numIdch){var verif=false;(function($){if($('.select_nbAdultes[data-numIdch="'+numIdch+'"]').val()==0&&($('.select_nbEnfants[data-numIdch="'+numIdch+'"]').val()>0||$('.select_nbBebes[data-numIdch="'+numIdch+'"]').val()>0)){$('.div_tarifUneChambre_saisirAdultes[data-numIdch="'+numIdch+'"]').show();verif=false;}else{$('.div_tarifUneChambre_saisirAdultes[data-numIdch="'+numIdch+'"]').hide();verif=true;}})(jQuery);return verif;}
function majListesSelect_packDivTarifs(div){(function($){var capacite=div.find('.select_nbAdultes').children().length-1;var nbAdultes=parseInt(div.find('.select_nbAdultes').val());var nbEnfantsMax=capacite-nbAdultes;var nbEnfants=parseInt(div.find('.select_nbEnfants').val());if(nbEnfants>nbEnfantsMax){div.find('.select_nbEnfants').val(0);nbEnfants=0;}
var nbAdultesMax=capacite-nbEnfants;var elemListeEnfants=div.find('.select_nbEnfants');var valeurDernierElementListeEnfants=div.find('.select_nbEnfants').find('option:last-child').val();if(valeurDernierElementListeEnfants<nbEnfantsMax){var i=parseInt(valeurDernierElementListeEnfants);while(i<nbEnfantsMax){i++;elemListeEnfants.append("<option value='"+(i)+"'>"+(i)+"</option>");}}else{while(elemListeEnfants.find('option:last-child').val()>nbEnfantsMax){elemListeEnfants.find('option:last-child').remove();}}
div.find('.select_nbEnfants').children().each(function(){if($(this).val()>nbEnfantsMax){$(this).hide();}else{$(this).show();}});if(nbAdultes>0){div.find('.select_nbAdultes').children().each(function(){if($(this).val()>nbAdultesMax){$(this).hide();}else{$(this).show();}});}
if(div.find('.select_nbAdultes').is(':hidden')){div.find('.select_nbAdultes').selectmenu('refresh');}
if(div.find('.select_nbEnfants').is(':hidden')){div.find('.select_nbEnfants').selectmenu('refresh');}})(jQuery);}
function majTarifsFiche_packDivTarifs(){(function($){lanceCalculPrixSejour(true);})(jQuery);}
function affectSelectionChambres_fiche(){var tabPersSelect=getTabPersSelect_packDivTarifs();affectSelectionChambres(tabPersSelect);}
function getTabPersSelect_packDivTarifs(){var tabPersSelect=[];(function($){if($('.div_tarifUneChambre_selectNbPers').length==0){return;}
$('.div_tarifUneChambre_selectNbPers').each(function(){var tabSelect={};tabSelect.numeroChambre=$(this).attr('data-numeroChambre');tabSelect.numIdch=$(this).attr('data-numIdch');;tabSelect.nbAdultes=$(this).find('.select_nbAdultes').val();tabSelect.nbEnfants=$(this).find('.select_nbEnfants').val();tabSelect.nbBebes=$(this).find('.select_nbBebes').val();tabPersSelect.push(tabSelect);});})(jQuery);return tabPersSelect;}
function reinitDatepickers_packDivTarifs(){(function($){if($('#inpt_resaDateDeb').length>0){var dateDebDefault=$('#inpt_resaDateDeb').attr('data-lblDefautArrivee');$('#inpt_resaDateDeb').val(dateDebDefault);}else if($('#inpt_resaDateDebCal').length>0){var dateDebDefault=$('#inpt_resaDateDebCal').attr('data-lblDefautArrivee');$('#inpt_resaDateDebCal').val(dateDebDefault);}
if($('#inpt_resaDateFin').length>0){var dateFinDefault=$('#inpt_resaDateFin').attr('data-lblDefautDepart');$('#inpt_resaDateFin').val(dateFinDefault);}else if($('#inpt_resaDateFinCal').length>0){var dateFinDefault=$('#inpt_resaDateFinCal').attr('data-lblDefautDepart');$('#inpt_resaDateFinCal').val(dateFinDefault);}})(jQuery);}
function initBtDescPlusMoins(){(function($){if($(".a_VoirPlusDescEnvir").length>0){$(".a_VoirPlusDescEnvir").toggle(function(){$(".descEnvirSecond").show();$(".descEnvirFirstSuite").hide();$(this).text($(this).attr("data-lblLireMoins"));},function(){$(".descEnvirSecond").hide();$(".descEnvirFirstSuite").show();$(this).text($(this).attr("data-lblLirePlus"));})}
if($('.div_descriptionComplete[data-afficheplus="true"]').length>0){var objDiv=$('.div_descriptionComplete[data-afficheplus="true"]');var objDivContent=$('.div_descriptionComplete[data-afficheplus="true"]').children('.div_descriptionCompleteContent');if($(objDivContent).outerHeight()>$(objDiv).outerHeight()){$(objDiv).addClass('reduced');$(objDiv).next('.div_descriptionComplete_btnPlus').show();$(objDiv).css("max-height",$(objDivContent).outerHeight());$('.div_descriptionComplete_btnPlus a').off('click');$('.div_descriptionComplete_btnPlus a').click(function(){if($(objDiv).hasClass('reduced')){$(objDiv).removeClass('reduced');var $elem=jQuery(this);$(this).fadeOut(500,function(){$(this).text($(this).data('lblmoins'));$(this).fadeIn(500);});addEventGa('affichageDescription','affiche',$(this).data('labelevent'));}
else{$(objDiv).addClass('reduced');$(this).fadeOut(500,function(){$(this).text($(this).data('lblplus'));$(this).fadeIn(500);});addEventGa('affichageDescription','masque',$(this).data('labelevent'));}})}else{$('.div_descriptionComplete.reduced').removeClass('reduced');}}})(jQuery);}
function afficheFormSignalPlanningLDPasAJour(ref,dest){(function($){$.ajax({type:'POST',url:'/lib_2/ajax/gereFiche.php',data:{action:'getHTML_formSignalPlanningLDPasAJour',ref:ref,dest:dest},datatype:'json',beforeSend:function(){},success:function(result){var tabRetour=XMLToArray(result);afficheDivAvecTransparence(tabRetour.html,800,600,null,tabRetour.titre);initFormSignalPlanningLDPasAJour();}});})(jQuery);}
function initFormSignalPlanningLDPasAJour(){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);$("#div_formSignalPlanningLDPasAJour .datepicker").datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1});$("#inpt_formSignalDateDeb").datepicker("option","onSelect",function(selectedDate){var dateDebut=new OBJDate(selectedDate);$("#inpt_formSignalDateFin").datepicker("option","minDate",dateDebut.toString());$('#inpt_formSignalDateFin').datepicker("setDate",dateDebut.toString());delete dateDebut;setTimeout(function(){$('#inpt_formSignalDateFin').focus();},0);});$("#inpt_formSignalDateFin").datepicker("option","onSelect",function(selectedDate){var dateFin=new OBJDate(selectedDate);$("#inpt_formSignalDateDeb").datepicker("option","maxDate",dateFin.toString());delete dateFin;});initActionBtnReloadCaptcha();})(jQuery);}
function verifEtEnvoiMailSignalPlanningLDPasAJour(){(function($){var langue=$("body").attr("data-langue");var tabMessages=getTabMessagesValidationFormulaireByLangue(langue);var email=new LiveValidation("inpt_formSignalEmail",{validMessage:tabMessages.valid,onlyOnSubmit:true});addValidateOnLiveValidationEmail(email,langue,true);var dateDeb=new LiveValidation("inpt_formSignalDateDeb",{validMessage:tabMessages.valid,onlyOnSubmit:true});dateDeb.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});dateDeb.add(Validate.Format,{pattern:/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/,failureMessage:tabMessages.dates});var dateFin=new LiveValidation("inpt_formSignalDateFin",{validMessage:tabMessages.valid,onlyOnSubmit:true});dateFin.add(Validate.Presence,{failureMessage:tabMessages.obligatoire});dateFin.add(Validate.Format,{pattern:/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/,failureMessage:tabMessages.dates});var tabAValider=new Array(email,dateDeb,dateFin);if($('#captcha').length>0){tabAValider.push(getLiveValidationCaptcha());}
LiveValidation.massValidate(tabAValider);if($(".LV_invalid").length==0){envoiMailSignalPlanningLDPasAJour();}})(jQuery);}
function envoiMailSignalPlanningLDPasAJour(){(function($){var ref=$('#inpt_formSignalRef').val();var dest=$('#inpt_formSignalDest').val();var dateDebut=$('#inpt_formSignalDateDeb').val();var dateFin=$('#inpt_formSignalDateFin').val();var mail=$('#inpt_formSignalEmail').val();var message=$('#inpt_formSignalMessage').val();var captcha='';if($('#captcha').length>0){captcha=$('#captcha').val();}
$.ajax({type:'POST',url:'/lib_2/ajax/envoiMail.php',data:{typeMail:'mailSignalPlanningLDPasAJour',ref:ref,dest:dest,dateDebut:dateDebut,dateFin:dateFin,mail:mail,message:message,captcha:captcha},dataType:'json',beforeSend:function(){$('#div_formSignalPlanningLDPasAJour .div_messageErreurSaisie').hide();$('#form_signalPlanningLDPasAJour *').attr('disabled','disabled');$('#div_formSignalPlanningLDPasAJour_validation').hide();},success:function(result){if(result.code=='OK'){$('#div_formSignalPlanningLDPasAJour .div_messageRetour.OK').show();}else{$('#div_formSignalPlanningLDPasAJour .div_messageRetour.KO').show();$('#form_signalPlanningLDPasAJour *').attr('disabled',false);$('#div_formSignalPlanningLDPasAJour_validation').show();}}});})(jQuery);}
function initAvisClientAfnor(){(function($){if($(".a_afficheDetailCertification").length>0){$(".a_afficheDetailCertification").click(function(){var struct=$(this).data("structure");$('.div_avisClientCertificationAccroche[data-structure="'+struct+'"]').hide();$('.div_avisClientCertificationDetail[data-structure="'+struct+'"]').show();})}
if($(".a_masqueDetailCertification").length>0){$(".a_masqueDetailCertification").click(function(){var struct=$(this).data("structure");$('.div_avisClientCertificationAccroche[data-structure="'+struct+'"]').show();$('.div_avisClientCertificationDetail[data-structure="'+struct+'"]').hide();})}
if($(window).width()<=750){$(".btn_ouvre_avisAfnorPopin").fancybox({maxWidth:634,fitToView:false,width:'100%',height:'100%',autoSize:false,closeClick:false,openEffect:'fade',closeEffect:'fade',openSpeed:500,closeSpeed:500,wrapCSS:'fancyboxAfnor',scrolling:'yes',helpers:{title:null}});}
else{$(".btn_ouvre_avisAfnorPopin").fancybox({maxWidth:634,fitToView:false,width:'85%',autoSize:true,closeClick:false,openEffect:'fade',closeEffect:'fade',openSpeed:500,closeSpeed:500,wrapCSS:'fancyboxAfnor',scrolling:'no',helpers:{title:null}});}})(jQuery);}
function actualisePageFiche(tabInfos){var paramsUrl=getVarsFromUrl()||{};var url=location.pathname;url+='?';var sejourIdentique=false;for(var prop in paramsUrl){if(prop&&prop!='deb'&&prop!='nbj'&&prop!='exe'&&prop!='reload'){url+=prop+'='+paramsUrl[prop]+'&';}else if(prop=='deb'&&tabInfos.deb==paramsUrl['deb']&&((tabInfos.fin&&tabInfos.fin==paramsUrl['fin'])||tabInfos.nbj==paramsUrl['nbj'])){sejourIdentique=true;}}
if(sejourIdentique){return false;}
if(tabInfos.deb){url+='&deb='+tabInfos.deb;}
if(tabInfos.fin){url+='&fin='+tabInfos.fin;}
if(tabInfos.nbj){url+='&nbj='+tabInfos.nbj;}
if(tabInfos.exe){url+='&exe='+tabInfos.exe;}
url+='&reload=true';location.href=url;}
function initSejoursAlternatifs(){(function($){$('.a_listeTarifsParJourArriveeSansDateDefinie').click(function(){ouvreDatePickerDateDeb_packDivDatesTarifs();});})(jQuery);}var tabInputsPrisEnCompte=['PBX_SITE','PBX_RANG','PBX_IDENTIFIANT','PBX_TOTAL','PBX_DEVISE','PBX_CMD','PBX_AUTOSEULE','PBX_PORTEUR','PBX_RETOUR','PBX_MODE','PBX_EFFECTUE','PBX_REFUSE','PBX_ANNULE','PBX_REPONDRE_A','PBX_LANGUE','PBX_TIME','PBX_HASH','PBX_HMAC','PBX_TYPEPAIEMENT','PBX_TYPECARTE','PBX_DIFF'];function majFormPaybox(tabParams){if(tabParams.paramsPaybox){return majFormPaybox2(tabParams.paramsPaybox);}
(function($){var params=tabParams||{};try{if($('#form_formPbx').length!=1){debugLogJS('majFormPaybox on a pas de formulaire!!');}
for(var prop in params){if(prop=='ouverture_paybox'){$('#form_formPbx').attr('target',params[prop]);continue;}
if(tabInputsPrisEnCompte.indexOf(prop)>=0){$('#form_formPbx').append('<input type="hidden" name="'+prop+'" value="'+params[prop]+'" />');}}
var yaHmac=params.PBX_HMAC||false;if(yaHmac){var url='https://tpeweb.paybox.com/cgi/MYchoix_pagepaiement.cgi';if(params.PBX_TYPEPAIEMENT==='LIMONETIK'){url='https://tpeweb.paybox.com/php/';}
if(params.PBX_SITE=='1999888'||params.PBX_SITE=='1666666'){url='https://preprod-tpeweb.paybox.com/php/';}
var yaVersionMobile=params.VERSION_MOBILE||false;if(yaVersionMobile&&params.PBX_TYPEPAIEMENT!=='LIMONETIK'){url='https://tpeweb.paybox.com/cgi/ChoixPaiementMobile.cgi';if(params.PBX_SITE=='1999888'||params.PBX_SITE=='1666666'){url='https://preprod-tpeweb.paybox.com/php/';}}
$('#form_formPbx').attr('action',url);}}
catch(err){debugLogJS('majFormPaybox erreur JS');}})(jQuery);}
function majFormPaybox2(params_paiement){(function($){var params=params_paiement;try{if($('#form_formPbx').length!=1){debugLogJS('majFormPaybox on a pas de formulaire!!');}
for(var prop in params){$('#form_formPbx').append('<input type="hidden" name="'+prop+'" value="'+params[prop]+'" />');}
var url='https://tpeweb.paybox.com/cgi/MYchoix_pagepaiement.cgi';if(params.PBX_TYPEPAIEMENT==='LIMONETIK'){url='https://tpeweb.paybox.com/php/';}
if(params.PBX_SITE=='1999888'||params.PBX_SITE=='1666666'){url='https://preprod-tpeweb.paybox.com/php/';}
$('#form_formPbx').attr('action',url);}
catch(err){debugLogJS('majFormPaybox erreur JS');}})(jQuery);}
function validerFormulairePaybox(){(function($){if($('input',"#form_formPbx").length<2){debugLogJS('validerFormulairePaybox on a pas d inputs!');}
try{var urlMobile='https://tpeweb.paybox.com/cgi/ChoixPaiementMobile.cgi';if($('input[name="PBX_TYPEPAIEMENT"]','#form_formPbx').val()!=='LIMONETIK'&&$('#form_formPbx').data('version_mobile')==='1'){$("#form_formPbx").attr('action',urlMobile);}}
catch(err){debugLogJS('validerFormulairePaybox erreur JS');}
$("#form_formPbx").submit();})(jQuery);}var _idBtnConnexionGoogle;var _fctGooglePlusOK;var _fctGooglePlusKO;function connexionFacebook(fonctionOK,fonctionKO){FB.login(function(response){if(response.authResponse){FB.api('me?fields=email,gender,last_name,first_name,locale,id',function(obj){fonctionOK(getTabInfosFacebook(obj));});}else{fonctionKO();}},{scope:'public_profile,email'});}
function getTabInfosFacebook(obj){var tabInfos={site:'facebook'};if(obj.email){tabInfos.email=obj.email;}
if(obj.gender){var civilite=getCiviliteByGenre(obj.gender);if(civilite){tabInfos.civilite=civilite;}}
if(obj.last_name){tabInfos.nom=obj.last_name;}
if(obj.first_name){tabInfos.prenom=obj.first_name;}
if(obj.locale){tabInfos.pays=obj.locale.substr(obj.locale.indexOf('_')+1);}
if(obj.id){tabInfos.photo='https://graph.facebook.com/'+obj.id+'/picture';}
return tabInfos;}
function getVilleFacebook(location){var ville=location.name;if(ville.indexOf(',')!==-1){ville=ville.substr(0,ville.indexOf(','));}
return ville;}
function getCiviliteByGenre(genre){var civilite;if(genre==='male'){civilite=1;}else if(genre==='female'){civilite=2;}
return civilite;}
function initActionsAuthentification(){}
function initBtnGooglePlus(){(function($){var googleAppID=$('#'+_idBtnConnexionGoogle).data('appid');gapi.signin.render(_idBtnConnexionGoogle,{'clientid':googleAppID,'cookiepolicy':'single_host_origin','requestvisibleactions':'http://schemas.google.com/AddActivity','scope':'https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/plus.me','callback':'connexionGooglePlus'});})(jQuery);}
function connexionGooglePlus(retour){if(retour['access_token']){gapi.client.load('plus','v1',function(){gapi.client.plus.people.get({'userId':'me'}).execute(function(objPers){_fctGooglePlusOK(retour['access_token'],getTabInfosGooglePlus(objPers));});});}else if(retour['error']){_fctGooglePlusKO(retour['error']);}}
function getTabInfosGooglePlus(obj){var tabInfos={site:'google'};(function($){if(obj.emails){$.each(obj.emails,function(i,objEmail){if(objEmail.type==='account'){tabInfos.email=objEmail.value;return false;}});}
if(obj.gender){var civilite=getCiviliteByGenre(obj.gender);if(civilite){tabInfos.civilite=civilite;}}
if(obj.name){tabInfos.nom=obj.name.familyName;tabInfos.prenom=obj.name.givenName;}
if(obj.placesLived){$.each(obj.placesLived,function(i,objVille){if(objVille.primary){tabInfos.ville=objVille.value;return false;}});}
if(obj.birthday){tabInfos.date_naissance=obj.birthday;}
if(obj.image){if(obj.image.isDefault===false){tabInfos.photo=obj.image.url;}}})(jQuery);return tabInfos;}
function deconnecteGooglePlus(accessToken,fonctionOK,fonctionKO){(function($){var revokeUrl='https://accounts.google.com/o/oauth2/revoke?token='+accessToken;$.ajax({type:'GET',url:revokeUrl,async:false,contentType:'application/json',dataType:'jsonp',success:function(nullResponse){if(typeof fonctionOK!=='undefined'){fonctionOK();}},error:function(e){if(typeof fonctionKO!=='undefined'){fonctionKO();}}});})(jQuery);}
function authentificationFacebookCompteGdf(tabInfos){(function($){var data='email='+tabInfos.email+'&type=connexionCompteGdf';if($('#div_btnConnexionFacebookFede').data('sessid')){data+='&phpsessid='+$('#div_btnConnexionFacebookFede').data('sessid');}
if($('#div_btnConnexionFacebookFede').data('idsrv')){data+='&idsrv='+$('#div_btnConnexionFacebookFede').data('idsrv');}
data+='&connectFacebook=1';$.ajax({type:'POST',url:urlAJAX,data:data,success:function(result){var tabResult=XMLToArray(result);retourConnexionCompteGdf(tabResult);}});})(jQuery);}
function authentificationGoogleCompteGdf(accessToken,tabInfosUser){(function($){var data='email='+tabInfosUser.email+'&type=connexionCompteGdf';if($('#div_btnConnexionGoogleFede').data('sessid')){data+='&phpsessid='+$('#div_btnConnexionGoogleFede').data('sessid');}
if($('#div_btnConnexionGoogleFede').data('idsrv')){data+='&idsrv='+$('#div_btnConnexionGoogleFede').data('idsrv');}
data+='&connectGoogle=1';$.ajax({type:'POST',url:urlAJAX,data:data,success:function(result){var tabResult=XMLToArray(result);retourConnexionCompteGdf(tabResult);}});})(jQuery);}
function retourConnexionCompteGdf(tabResult){(function($){if(tabResult.code==='KO'){if(window.opener&&window.location.host!=window.opener.location.host){window.opener.postMessage(tabResult.msg,'*');}else{if(tabResult.attenteMiseEnLigne=='true'){$('#itea_cnxCptGDFResa_msgInfo').html(tabResult.msg);$('#itea_cnxCptGDFResa_msgInfo').fadeOut().fadeIn();}else{var lienCreaCpt='<a href="javascript:void(0)" id="lienCreaCpt">'+tabResult.msg_creaCpt+' '+tabResult.type+' '+tabResult.msg_creaCpt2+'</a>';$('#itea_cnxCptGDFResa_msgInfo').html(tabResult.msg+lienCreaCpt);$('#itea_cnxCptGDFResa_msgInfo').fadeOut().fadeIn();if(tabResult.type=='Facebook'){var handler=function(){$('#div_pasdecomptegdf').click();connexionFacebook(creaCptGDFFacebook,resaFacebookKO);}}else{var handler=function(){$('#div_pasdecomptegdf').click();$('#div_btnConnexionGoogle_creaCptGDF').click();}}
$('#lienCreaCpt').click(handler);}}}
else{if(window.opener&&window.location.host!=window.opener.location.host){window.opener.postMessage('reload','*');}else{var urlHref=location.search+"&"+getIdSessionInHtml();location.href=urlHref;}}
if(window.opener&&window.location.host!=window.opener.location.host){window.close();}})(jQuery);}
function authentificationGoogleCompteGdfKO(){console.log('authentificationGoogleCompteGdfKO');}
function initAuthentificationGoogleForCompteGdf(){_idBtnConnexionGoogle='div_btnConnexionGoogleFede';_fctGooglePlusOK=authentificationGoogleCompteGdf;_fctGooglePlusKO=authentificationGoogleCompteGdfKO;}
function clickBtnGoogleCompteGdf(){(function($){$('#div_btnConnexionGoogleFede').click();})(jQuery);}
function initDatePickers_datesSejour(){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);})(jQuery);jQuery('#inpt_resaDateDebCal').unbind('click');jQuery('#inpt_resaDateDebCal').bind('click',function(e){ouvreDatepickerDeb();e.stopPropagation();});jQuery('#inpt_resaDateFinCal').unbind('click');jQuery('#inpt_resaDateFinCal').bind('click',function(e){var dateArrivee=jQuery('#inpt_resaDateDebCal').val();var regexDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");if(regexDate.test(dateArrivee)){ouvreDatepickerFin();}else{ouvreDatepickerDeb();}
e.stopPropagation();});if(jQuery('#inpt_resaDateFinCal').length===0){initInputDateDeb();initInputDateFin();}}
function initInputDateDeb(){var langue=initLangueForDatePicker();jQuery.datepicker.setDefaults(jQuery.datepicker.regional[langue]);ouvreDatepickerDeb();return false;}
function ouvreDatepickerDeb(){(function($){var params={action:'getPlanningDebPourDatepicker',ident:$('#div_choixDates_packDivDatesTarifs').attr('data-ident')};if($('.inpt_modeVte').length>0){params.modeResa=$('input[name="modeResa"]:checked').val();}
if(window.location.href.indexOf('modeResa=G')>0){params.modeResa='G';}
if(window.location.href.indexOf('modeResa=H')>0){params.modeResa='H';}
$.ajax({type:'POST',url:'/lib_2/ajax/gereCalendrier.php',dataType:'json',data:params,beforeSend:function(){$('#div_calendrierFin').hide().removeClass('open');$('#div_roueDatepickerDeb').show();},complete:function(){$('#div_calendrierDeb').show().addClass('open');$('#div_roueDatepickerDeb').hide();},success:function(JSONResult){initDatepickerDateDeb(JSONResult);jQuery('#inpt_resaDateDebCal').addClass("focus");jQuery('#inpt_resaDateFinCal').removeClass("focus");},error:function(xhr,errorText,errorStatus){$('#div_calendrierDeb').hide().removeClass('open');$('#div_roueDatepickerDeb').hide();}});})(jQuery);}
function initInputDateFin(){(function($){var langue=initLangueForDatePicker();$.datepicker.setDefaults($.datepicker.regional[langue]);var dateArrivee=$('#inpt_resaDateDebCal').val();var regexDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");if(regexDate.test(dateArrivee)){ouvreDatepickerFin();}else{ouvreDatepickerDeb();}
return false;})(jQuery);}
function ouvreDatepickerFin(){(function($){$('#div_calendrierDeb').hide().removeClass('open');var params={action:'getPlanningFinPourDatepicker',ident:$('#div_choixDates_packDivDatesTarifs').attr('data-ident'),dateDeb:$('#inpt_resaDateDebCal').val()};if($('.inpt_modeVte').length>0){params.modeResa=$('input[name="modeResa"]:checked').val();}
if(window.location.href.indexOf('modeResa=G')>0){params.modeResa='G';}
if(window.location.href.indexOf('modeResa=H')>0){params.modeResa='H';}
$.ajax({type:'POST',url:'/lib_2/ajax/gereCalendrier.php',dataType:'json',data:params,beforeSend:function(){$('#div_roueDatepickerFin').show();},complete:function(){$('#div_roueDatepickerFin').hide();$('#div_calendrierFin').show().addClass('open');},success:function(JSONResult){initDatepickerDateFin(JSONResult);jQuery('#inpt_resaDateDebCal').removeClass("focus");jQuery('#inpt_resaDateFinCal').addClass("focus");},error:function(xhr,errorText,errorStatus){$('#div_calendrierFin').hide().removeClass('open');$('#div_roueDatepickerFin').hide();}});})(jQuery);}
function initDatepickerDateDeb(JSONResult){(function($){var date=$('#inpt_resaDateDebCal').val();if($('#inpt_resaDateDebCal').attr('data-dateposition')){date=$('#inpt_resaDateDebCal').attr('data-dateposition');}
$('#div_datepickerDeb').datepicker('destroy');$('#div_datepickerDeb').addClass('notranslate');$('#div_datepickerDeb').datepicker({numberOfMonths:[1,1],dateFormat:'dd/mm/yy',minDate:JSONResult.dateDeb,maxDate:JSONResult.dateFin,defaultDate:date,beforeShowDay:function(date){var objDateFin=new Date(JSONResult.dateFin.substr(6,4),JSONResult.dateFin.substr(3,2)-1,JSONResult.dateFin.substr(0,2));if(date.getTime()>objDateFin.getTime()){return'';}
return setJourDatepicker(date,JSONResult.dateDeb,JSONResult.chaineDispo,true);},onSelect:function(dateDeb){setInputDateDeb(dateDeb);}});})(jQuery);}
function initDatepickerDateFin(JSONResult){(function($){var dateDeb=$('#inpt_resaDateDebCal').val();var objDateDeb=new Date(dateDeb.substr(6,4),parseInt(dateDeb.substr(3,2))-1,parseInt(dateDeb.substr(0,2))+1);$("#div_datepickerFin").datepicker('destroy');$('#div_datepickerFin').addClass('notranslate');$("#div_datepickerFin").datepicker({numberOfMonths:[1,1],dateFormat:'dd/mm/yy',minDate:objDateDeb,maxDate:JSONResult.dateFin,beforeShowDay:function(date){var objDateFin=new Date(JSONResult.dateFin.substr(6,4),JSONResult.dateFin.substr(3,2)-1,JSONResult.dateFin.substr(0,2));if(date.getTime()>objDateFin.getTime()){return'';}
return setJourDatepicker(date,JSONResult.dateDeb,JSONResult.chaineDispo);},onSelect:function(dateFin){setInputDateFin(dateFin);if(typeof foncQdFiniSelectDatepickerDateFin==='function'){foncQdFiniSelectDatepickerDateFin();}}});})(jQuery);}
function setJourDatepicker(date,dateDebPlanning,chainePlanning,datepickerDeb){var objDateDebPlanning=new Date(dateDebPlanning.substr(6,4),dateDebPlanning.substr(3,2)-1,dateDebPlanning.substr(0,2));var ecart=Math.round(ecartDate(date,objDateDebPlanning));var caractere=chainePlanning.charAt(ecart);var sejour='';var dateDeb=jQuery('#inpt_resaDateDeb').val();var dateFin=jQuery('#inpt_resaDateFin').val();if(jQuery('#inpt_resaDateDebCal').length>0){dateDeb=jQuery('#inpt_resaDateDebCal').val();dateFin=jQuery('#inpt_resaDateFinCal').val();}
var autoriseClicSejourNonReservable=true;if(jQuery('#inpt_resaDateDebCal').length>0&&jQuery('#inpt_resaDateDebCal').attr('data-autoriseDemandeNonReservable')=='false'){autoriseClicSejourNonReservable=false;}
var regexDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");if(regexDate.test(dateDeb)&&regexDate.test(dateFin)){var objDateDeb=new Date(dateDeb.substr(6,4),dateDeb.substr(3,2)-1,dateDeb.substr(0,2));var objDateFin=new Date(dateFin.substr(6,4),dateFin.substr(3,2)-1,dateFin.substr(0,2));var ecartDateDeb=Math.round(ecartDate(objDateDeb,objDateDebPlanning));var ecartDateFin=Math.round(ecartDate(objDateFin,objDateDebPlanning));if(ecartDateDeb<=ecart&&ecartDateFin>=ecart){sejour='sejour';if(ecart===ecartDateDeb){sejour+=' dateArrivee';}
if(ecart===ecartDateFin){sejour+=' dateFin';}}}
var classe=sejour+' ';var caracterePrecedent=chainePlanning.charAt(ecart-1);var caractereSuivant=chainePlanning.charAt(ecart+1);var tabCaracteresNonCliquables=['i','o','r','n','d','e'];if(caractere.length>0&&caracterePrecedent.length>0){if(datepickerDeb===true&&(!jQuery('#inpt_affichePlanningsIdentiques')||jQuery('#inpt_affichePlanningsIdentiques').length===0)){if(jQuery.inArray(caractere,tabCaracteresNonCliquables)>-1&&jQuery.inArray(caracterePrecedent,tabCaracteresNonCliquables)===-1){classe+='debutResa ';}
if(jQuery.inArray(caractere,tabCaracteresNonCliquables)===-1&&jQuery.inArray(caracterePrecedent,tabCaracteresNonCliquables)>-1){classe+='finResa ';}}else{if(jQuery.inArray(caractere,tabCaracteresNonCliquables)===-1&&jQuery.inArray(caractereSuivant,tabCaracteresNonCliquables)>-1){classe+='debutResa ';}
if(jQuery('#inpt_affichePlanningsIdentiques').length>0&&jQuery.inArray(caractere,tabCaracteresNonCliquables)===-1&&jQuery.inArray(caracterePrecedent,tabCaracteresNonCliquables)>-1){classe+='finResa ';}}}
var nonCliquable=estSurBureauPropOuITEA();var nonCliquableExeNonOuvertWeb=estSurBureauITEA()||estResaBureauProp();if(caractere==='A'||caractere==='.'){classe+='cliquable';return[true,classe];}else if(caractere==='L'||caractere==='l'){classe+='libre';return[autoriseClicSejourNonReservable,classe];}else if(caractere==='?'||caractere==='a'){classe+='inconnu';return[true,classe];}else if(caractere==='r'||caractere==='R'){classe+='resa';return[nonCliquable,classe];}else if(caractere==='o'||caractere==='O'){classe+='option';return[nonCliquable,classe];}else if(caractere==='i'){classe+='intention';return[nonCliquable,classe];}else if(caractere==='n'||caractere==='e'||caractere==='d'){classe+='occupe';return[nonCliquable,classe];}else if(caractere==="j"){classe+='dateArrivee';return[nonCliquable,classe];}else if(caractere=="f"){classe+='forcage';return[true,classe];}else if(!caractere&&ecart>=chainePlanning.length){classe+='occupe plusDePlanning';return[nonCliquableExeNonOuvertWeb,classe];}else if(ecart>=0){return[nonCliquable,"inconnu"];}else{return[nonCliquable,"avantDatesPossibles"];}}
function setInputDateDeb(date){(function($){$('#inpt_resaDateDebCal').val(date);jQuery('#inpt_resaDateDebCal').removeClass("focus");ouvreDatepickerFin();})(jQuery);}
function setInputDateFin(date){(function($){$('#inpt_resaDateFinCal').val(date);$('#div_calendrierFin').hide().removeClass('open');jQuery('#inpt_resaDateFinCal').removeClass("focus");var dateDeb=$('#inpt_resaDateDebCal').val();var dateFin=date;if($('#div_choixDates_packDivDatesTarifs').attr('data-gestprod')){$('.div_btnResa a').each(function(){var href=$(this).attr('href')+'&date_deb='+dateDeb.toString()+'&date_fin='+dateFin.toString();$(this).attr('href',href);});return;}
if($('#div_choixModeResaGEGS').length>0){var modeResa=$('.inpt_modeVte:checked').val();}
var tabData={type:'verifDates',dateDeb:dateDeb,dateFin:dateFin,ident:$('#div_choixDates_packDivDatesTarifs').attr('data-ident'),instance:$('#div_choixDates_packDivDatesTarifs').attr('data-instance'),exercice:$('#div_choixDates_packDivDatesTarifs').attr('data-exercice'),estPresentSurFiche:true,avecQTipFD:$('#sp_infoBulleAideFraisDossiers').length,modeResa:modeResa};modeCalculPrixSurFiche=true;if($('#widgetFNGF_selectCapacite').length>0){$('#widgetFNGF_selectCapacite').attr('updated','N');}
ajaxVerifDates(tabData);})(jQuery);}
function getValInputDateDebFiche(){if(jQuery('#inpt_resaDateDeb').length>0){return jQuery('#inpt_resaDateDeb').val();}
return jQuery('#inpt_resaDateDebCal').val();}
function getValInputDateFinFiche(){if(jQuery('#inpt_resaDateFin').length>0){return jQuery('#inpt_resaDateFin').val();}
return jQuery('#inpt_resaDateFinCal').val();}
function dateDebEtFin_VideOuDefault(){if(jQuery('#inpt_resaDateDeb').length==0&&jQuery('#inpt_resaDateDebCal').length==0){return false;}
if(jQuery('#inpt_resaDateFin').length==0&&jQuery('#inpt_resaDateFinCal').length==0){return false;}
if(jQuery('#inpt_resaDateDeb').length>0){var dateDebDefault=jQuery('#inpt_resaDateDeb').attr('data-lblDefautArrivee');}else if(jQuery('#inpt_resaDateDebCal').length>0){var dateDebDefault=jQuery('#inpt_resaDateDebCal').attr('data-lblDefautArrivee');}
if(jQuery('#inpt_resaDateFin').length>0){var dateFinDefault=jQuery('#inpt_resaDateFin').attr('data-lblDefautDepart');}else if(jQuery('#inpt_resaDateFinCal').length>0){var dateFinDefault=jQuery('#inpt_resaDateFinCal').attr('data-lblDefautDepart');}
if(getValInputDateDebFiche()==""||getValInputDateFinFiche()==""||getValInputDateDebFiche()==dateDebDefault||getValInputDateFinFiche()==dateFinDefault){return true;}
return false;}
function btnReserverFicheCalendrier(element){(function($){if(dateDebEtFin_VideOuDefault()){initInputDateDeb();}else{majHrefBoutonReserver(true);if(window.dataLayer){var tabParamsGTM=JSON.parse($(element).attr('data-paramsTrackEvent'));dataLayer.push({'Label_Event':tabParamsGTM.label,'Categorie_Event':tabParamsGTM.categorie,'event':tabParamsGTM.action});var prix=$(element).attr('data-prix');var TransactionId=tabParamsGTM.prefixe+tabParamsGTM.label;dataLayer.push({'Transaction_Id':TransactionId,'Product_Id':tabParamsGTM.ident,'Price':prix,'event':'Criteo_Contact'});}}})(jQuery);}
function initDatepickersResa(){jQuery('#inpt_resaDateDeb').unbind('click');jQuery('#inpt_resaDateDeb').bind('click',function(e){ouvreDatepickerDebResa();e.stopPropagation();});jQuery('#inpt_resaDateFin').unbind('click');jQuery('#inpt_resaDateFin').bind('click',function(e){ouvreDatepickerFinResa();e.stopPropagation();});jQuery('.sp_fermerCal').click(function(){jQuery(this).parents(".div_calendDateDebFin").hide();});initDatepickersDateNaissance();}
function initDatepickersDateNaissance(){if(jQuery('.inpt_dateNaissance').length===0){return;}
jQuery('.inpt_dateNaissance').datepicker('destroy');if(jQuery('#inpt_resaDateDeb').val()===''||jQuery('#inpt_resaDateDeb').val()==='Arrive'){return;}
var dateNaissanceMinEnfants=getObjDateNaissanceMin('enfant');var dateNaissanceMaxEnfants=getObjDateNaissanceMax('enfant');var dateNaissanceMinBebes=getObjDateNaissanceMin('bebe');var dateNaissanceMaxBebes=getObjDateNaissanceMax('bebe');var paramsBouton={};if(estResaBureauProp()||estResaBureauGestloc()){paramsBouton={showOn:'button',buttonImage:'/css_defaut/v5/resa/bureau/images/calend.png',buttonImageOnly:true,buttonText:'Slectionner une date'};}
jQuery('.inpt_dateNaissance.enfant').datepicker(jQuery.extend({},{numberOfMonths:[1,2],dateFormat:'dd/mm/yy',minDate:dateNaissanceMinEnfants.toString('dd/mm/yyyy'),maxDate:dateNaissanceMaxEnfants.toString('dd/mm/yyyy'),changeMonth:true,changeYear:true,yearRange:dateNaissanceMinEnfants.getAnnee()+':'+dateNaissanceMaxEnfants.getAnnee(),beforeShow:function(){jQuery('#ui-datepicker-div').addClass('notranslate');}},paramsBouton));jQuery('.inpt_dateNaissance.bebe').datepicker(jQuery.extend({},{numberOfMonths:[1,2],dateFormat:'dd/mm/yy',minDate:dateNaissanceMinBebes.toString('dd/mm/yyyy'),maxDate:dateNaissanceMaxBebes.toString('dd/mm/yyyy'),changeMonth:true,changeYear:true,yearRange:dateNaissanceMinBebes.getAnnee()+':'+dateNaissanceMaxBebes.getAnnee(),beforeShow:function(){jQuery('#ui-datepicker-div').addClass('notranslate');}},paramsBouton));if(estResaBureauProp()||estResaBureauGestloc()){jQuery('.inpt_dateNaissance.enfant').unbind('change');jQuery('.inpt_dateNaissance.enfant').bind('change',function(){corrigeSaisieDateNaissance(this,'enfant');});}}
function ouvreDatepickerDebResa(){(function($){$("#div_calendrierDeb").show().addClass('open');$("#div_calendrierFin").hide().removeClass("open");$.ajax({type:'POST',url:urlAJAX,data:{type:'getPlanningDebResa',modeResa:$('input:radio[name=modeResa]:checked').val()},dataType:'json',beforeSend:function(){$('#div_roueDatepickerDeb').show();},success:function(JSONResult){if(JSONResult.code=='dossierNull'){retourEtape1(JSONResult.msg);}else if(JSONResult.errTechnq){afficheMsgErrTechnq(JSONResult.msg,JSONResult.titre,JSONResult.ident,true);}else if(JSONResult.code=='OK'){initDatePickerDebResa(JSONResult);}else{alertAMalibu(JSONResult.msg);$("#div_calendrierDeb").hide().removeClass("open");$("#div_uneEtape_date").find(".inpt_validEtape").val("Non");}
$("#div_roueDatepickerDeb").hide();}});})(jQuery);}
function fermeDatepickerDebResa(){(function($){$("#div_calendrierDeb").hide().removeClass('open');})(jQuery);}
function ouvreDatepickerFinResa(){(function($){var regexDate=new RegExp("[0-9]{2}\/[0-9]{2}\/[0-9]{4}");if(!regexDate.test($('#inpt_resaDateDeb').val())){ouvreDatepickerDebResa();return;}
$('#div_calendrierDeb').hide().removeClass('open');$("#div_calendrierFin").show().addClass('open');$.ajax({type:'POST',url:urlAJAX,dataType:'json',async:false,data:{type:'getPlanningFinResa',dateDeb:$('#inpt_resaDateDeb').val()},beforeSend:function(){$('#div_roueDatepickerFin').show();},complete:function(){$('#div_roueDatepickerFin').hide();$('#div_calendrierFin').show().addClass('open');},success:function(JSONResult){initDatePickerFinResa(JSONResult);},error:function(xhr,errorText,errorStatus){$('#div_calendrierFin').hide().removeClass('open');$('#div_roueDatepickerFin').hide();}});})(jQuery);}
function fermeDatepickerFinResa(){(function($){$("#div_calendrierFin").hide().removeClass('open');})(jQuery);}
function initDatePickerDebResa(JSONResult){(function($){$('#div_datepickerDeb').datepicker('destroy');$('#div_datepickerDeb').datepicker({numberOfMonths:[1,2],dateFormat:'dd/mm/yy',minDate:JSONResult.dateDeb,maxDate:JSONResult.dateFin,defaultDate:$('#inpt_resaDateDeb').val(),beforeShowDay:function(date){return setJourDatepicker(date,JSONResult.dateDeb,JSONResult.chaineDispo);},onSelect:function(dateDeb){setInputDateDebResa(dateDeb);initDatepickersDateNaissance();}});})(jQuery);}
function setInputDateDebResa(date){(function($){$('#inpt_resaDateDeb').val(date);ouvreDatepickerFinResa();})(jQuery);}
function initDatePickerFinResa(JSONResult){(function($){var dateDeb=$('#inpt_resaDateDeb').val();var objDateDeb=new Date(dateDeb.substr(6,4),parseInt(dateDeb.substr(3,2))-1,parseInt(dateDeb.substr(0,2))+1);$("#div_datepickerFin").datepicker('destroy');$("#div_datepickerFin").datepicker({numberOfMonths:[1,2],dateFormat:'dd/mm/yy',minDate:objDateDeb,defaultDate:objDateDeb,maxDate:JSONResult.dateFin,beforeShowDay:function(date){return setJourDatepicker(date,JSONResult.dateDeb,JSONResult.chaineDispo);},onSelect:function(dateFin){setInputDateFinResa(dateFin);}});})(jQuery);}
function setInputDateFinResa(date){(function($){$('#inpt_resaDateFin').val(date);$('#div_calendrierFin').hide().removeClass('open');var dateDeb=$('#inpt_resaDateDeb').val();var dateFin=date;var tabData={type:'verifDates',dateDeb:dateDeb,dateFin:dateFin};ajaxVerifDates(tabData);})(jQuery);}
function initDatepickersLies(idElemDateDeb,idElemDateFin,tabOptions){(function($){if(!idElemDateDeb||$('#'+idElemDateDeb).length===0||!idElemDateFin||$('#'+idElemDateFin).length===0){return;}
$.datepicker.setDefaults($.datepicker.regional[initLangueForDatePicker()]);if(tabOptions.dateDeb){var objDateDeb=new OBJDate(tabOptions.dateDeb);$('#'+idElemDateDeb).val(objDateDeb.toString());if(tabOptions.dureeSejour){var objDateFin=new OBJDate(tabOptions.dateDeb);objDateFin.ajoutJour(tabOptions.dureeSejour);$('#'+idElemDateFin).val(objDateFin.toString());delete objDateFin;}}
$('#'+idElemDateDeb).datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1});$('#'+idElemDateFin).datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1});if(objDateDeb){$('#'+idElemDateFin).datepicker('option','minDate',objDateDeb.toString());}
$('#'+idElemDateDeb).datepicker('option','onSelect',function(selectedDate){var dateDebut=new OBJDate(selectedDate);dateDebut.ajoutJour(1);$('#'+idElemDateFin).datepicker('option','minDate',dateDebut.toString());delete dateDebut;setTimeout(function(){$('#'+idElemDateFin).focus();},0);});$('.datepicker').datepicker({minDate:0,dateFormat:'dd/mm/yy',firstDay:1});})(jQuery);}
function test_alljs_20190430_4(){console.log('ok test_alljs_20190430_4');}
var _leafletMap;var _leafletMarkerGroup;var _leafletMarkerFocusGroup;var _leafletAjax;function leaflet_loadLeafletAssets(cmdName,typegmap){console.log('foncMapLeaflet.js leaflet_loadLeafletAssets() cmdName ',cmdName,' typegmap ',typegmap);loadScriptCss('/lib_2/js/api/leaflet_1.3.1/leaflet.css');loadScriptCss('/css_defaut/v5/leaflet/leaflet.css');loadScriptCss('/lib_2/js/api/leaflet-markercluster-1.4.1/MarkerCluster.css');loadScriptCss('/lib_2/js/api/leaflet-markercluster-1.4.1/MarkerCluster.Default.css');loadScriptCss('/lib_2/js/api/leaflet-gesturehandling-1.1.8/leaflet-gesture-handling.css');loadScriptJs('/lib_2/js/api/leaflet_1.3.1/leaflet.js',function(){loadScriptJs('/lib_2/js/api/leaflet-providers-1.5.0/leaflet-providers.js',function(){loadScriptJs('/lib_2/js/api/leaflet-bing-layer-1.0.0/leaflet-bing-layer.js',function(){loadScriptJs('/lib_2/js/api/leaflet-google/Google.js',function(){loadScriptJs('/lib_2/js/api/leaflet-smoothmarkerbouncing-1.3.0/leaflet-smoothmarkerbouncing.js',function(){loadScriptJs('/lib_2/js/api/leaflet-markercluster-1.4.1/leaflet.markercluster.js',function(){loadScriptJs('/lib_2/js/api/leaflet-gesturehandling-1.1.8/leaflet-gesture-handling.js',function(){jQuery.ajax({url:'/lib_2/ajax/leaflet_map.php',data:{typegmap:typegmap,cmd:cmdName},dataType:'json',success:function(params){leaflet_initMap(params,cmdName);}});});});});});});});});}
function leaflet_initMap(params){console.log('foncMapLeaflet.js leaflet_initMap');(function($){console.log('idDivMap : '+params.idDivMap);if($('div#'+params.idDivMap)!==null&&$('div#'+params.idDivMap).length!==0&&$('div#'+params.idDivMap).data('modeleaflet')===1){leaflet_createMap(params);leaflet_loadProvider(_leafletMap,params);leaflet_getMapPoints(params);}else{leaflet_setupMapListeHebergementsButtons(params);console.log('foncMapLeaflet.js leaflet_initMap : On ne cr pas de carte car la div '+params.idDivMap+' est absente.');}})(jQuery);}
function leaflet_createMap(params){console.log('foncMapLeaflet.js leaflet_createMap');leaflet_resizeDivMap(params);jQuery(window).resize(function(){leaflet_resizeDivMap(params);});if(_leafletMap!==undefined&&typeof _leafletMap.remove==='function'){_leafletMap.remove();_leafletMarkerGroup=undefined;}
_leafletMap=L.map(params.idDivMap,{gestureHandling:params.gestureHandling}).setView([params.x,params.y],params.z);_leafletMap.options.maxZoom=params.maxZoom;_leafletMap.options.scrollWheelZoom=params.scrollWheelZoom;_leafletMap.fitBounds([[-62.321249,-127.999093],[77.628943,178.395100]]);L.Marker.setBouncingOptions({exclusive:true});jQuery('#'+params.idDivMap).attr("oncontextmenu","return false;");jQuery('#'+params.idDivMap).mouseup(function(evt){if(evt.which===3){if(evt.originalEvent.detail===2){_leafletMap.setZoom(_leafletMap.getZoom()-1);}}});if(params.typeMap==='liste_heber'){leaflet_applyMapListeParameters(params);}}
function leaflet_loadProvider(map,params){if(params.typeMap==='liste_heber'){if(estPageGestProd(params.cgis)){params.autoupdate_checkbox='non';params.autoupdate='non';}
createUpdateCheckbox(params,false);}
if(params.provider.length===0&&(!params.hasOwnProperty('apiKey')||params.apiKey.length===0)){params.provider='openstreetmap';}else if(params.provider.length===0&&params.apiKey.length!==0){params.provider='googlemaps';}
switch(params.provider){case'googlemaps':jQuery.getScript("https://maps.googleapis.com/maps/api/js?key="+params.apiKey,function(){var roads=new L.gridLayer.googleMutant({type:'roadmap'}).addTo(map);});break;case'here':var roadLayer=L.tileLayer.provider('HERE',{app_id:params.appId,app_code:params.appCode});var satelliteLayer=L.tileLayer.provider('HERE.hybridDay',{app_id:params.appId,app_code:params.appCode});roadLayer.addTo(map);map.layers=[roadLayer,satelliteLayer];var baseLayers={"Standard":roadLayer,"Satellite":satelliteLayer};L.control.layers(baseLayers).addTo(map);break;case'openstreetmap':L.tileLayer.provider('OpenStreetMap').addTo(map);break;case'bingmaps':L.tileLayer.bing(params.apiKey).addTo(map);break;case'openstreetmapitea':L.tileLayer('https://maps.itea.fr/osm_tiles/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(map);break;default:break;}}
function leaflet_getMapPoints(params){if(params.typeMap==='liste_heber'){if(!estPageGestProd(params.cgis)){leaflet_chargePointsListeHeber(params,true);return;}}else{jQuery.ajax({url:'/lib_2/ajax/leaflet_map.php',data:{cmd:params.getPointsCmd},dataType:'json',success:function(tabPoints){var tabPointsToDisplay=new Array();for(var i=0;i<tabPoints.length;i++){if(tabPoints[i].show==='O'){leaflet_addPoint(tabPoints[i]);tabPointsToDisplay.push(tabPoints[i]);}}
leaflet_centerMap(tabPointsToDisplay);}});return;}}
function leaflet_addPoint(point){console.log('foncMapLeaflet.js leaflet_addPoints');if(point.latitude===''||point.longitude===''){return;}
var icon=L.icon({iconUrl:point.imgPoint,iconSize:getImgDimensions(point.imgPoint),iconAnchor:[10,26],popupAnchor:[0,-26]});var marker=L.marker([point.latitude,point.longitude],{icon:icon,riseOnHover:true});marker.addTo(_leafletMap);marker.bindPopup('Chargement...').setLatLng([point.latitude,point.longitude]);marker.on('click',function(event){leaflet_setupPopUp(event,point);});}
function leaflet_setupPopUp(evt,point){console.log('point : ',point);var popUp=evt.target.getPopup();console.log('id_tour : ',point.id_tour);jQuery.ajax({url:'/lib_2/ajax/leaflet_map.php',type:'POST',async:false,data:{CMD:'getPopUpSquelette',idTour:point.id_tour},success:function(html){popUp.options.maxWidth=500;popUp.setContent(html);popUp.update();}});}
function leaflet_centerMap(tabPoints){if(tabPoints===undefined){tabPoints=null;}
if(tabPoints===null&&_leafletMarkerFocusGroup!==null){setTimeout(function(){_leafletMap.invalidateSize();},400);}else if(_leafletMap!==null&&tabPoints!==null){_leafletMarkerFocusGroup=tabPoints;_leafletMap.fitBounds([[Math.min.apply(Math,tabPoints.map(function(point){return point.latitude;})),Math.min.apply(Math,tabPoints.map(function(point){return point.longitude;}))],[Math.max.apply(Math,tabPoints.map(function(point){return point.latitude;})),Math.max.apply(Math,tabPoints.map(function(point){return point.longitude;}))]]);}
if(tabPoints.length===1){_leafletMap.setZoom(_leafletMap.getZoom()-8);}}
function leaflet_resizeDivMap(params){(function($){$('div#'+params.idDivMap).css('width',params.mapWidth);$('div#'+params.idDivMap).css('height',params.mapheight);})(jQuery);}
function leaflet_resetMap(){_leafletMap.remove();_leafletMap=undefined;_leafletMarkerGroup=undefined;_leafletAjax=undefined;_leafletMarkerFocusGroup=undefined;}
function leaflet_resetMap(){_leafletMap.remove();_leafletMap=undefined;_leafletMarkerGroup=undefined;_leafletAjax=undefined;_leafletMarkerFocusGroup=undefined;}
function getImgDimensions(url){var img=new Image();var dimensions=new Array();img.src=url;img.onload=function(){dimensions.push(this.width);dimensions.push(this.height);};return dimensions;}
function leaflet_applyMapListeParameters(params){jQuery('#bodyPage').on('click','.updateListButton',function(){var page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);if(estPageGestProd(params.cgis)){params.autoupdate_checkbox='non';params.autoupdate='non';}
createUpdateCheckbox(params,true);});leaflet_setupMapListeHebergementsButtons(params);}
function leaflet_ecouteZoomEtDeplacementCarte(params){if(!_leafletMap._events.dragend){_leafletMap.on('zoomend dragend',function(){if(jQuery('.autoupdate').length>0){if(jQuery('.autoupdate').prop('checked')===true){page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);}else{createUpdateButton(params);}}else if(params.autoupdate==='oui'&&jQuery('.updateListButton').length===0){page=1;params.mapMoved=1;leaflet_updateCgi(leaflet_bindSurvol,page,params);}});}}
function leaflet_updateCgi(callback,page,params){jQuery('.hideOnRefreshMap').hide();var bounds=_leafletMap.getBounds();var param={MINLNG:bounds.getWest(),MINLAT:bounds.getSouth(),MAXLNG:bounds.getEast(),MAXLAT:bounds.getNorth(),ZOOM:999,CENTREX:(parseFloat(bounds.getNorth())+parseFloat(bounds.getSouth()))/2,CENTREY:(parseFloat(bounds.getEast())+parseFloat(bounds.getWest()))/2,PAGE:page,MODECARTO:parseInt(params.modecarto,10),MAPMOVED:params.mapMoved,LNO:params.cgis.LNO};refreshListProdWithNewGMParams(param,callback,page);}
function leaflet_bindSurvol(){jQuery(".li_elemListe,.li_elemPanier").bind('mouseover mouseout',function(event){var ident=jQuery(this).attr('data-ident');_leafletMarkerGroup.eachLayer(function(marker){if(marker.properties.ident===ident){if(event.type==='mouseover'&&marker.hasOwnProperty('_icon')&&marker._icon!==null){marker.bounce();marker.setZIndexOffset(250);}else if(marker.hasOwnProperty('_icon')&&marker._icon!==null){marker.stopBouncing();marker.setZIndexOffset(0);}else{_leafletMap.eachLayer(function(cluster){var polygonContainsMarker=false;if(event.type==='mouseover'&&cluster.hasOwnProperty('_bounds')&&cluster.hasOwnProperty('_icon')){var clusterPolygonCoordinates=cluster.getConvexHull();polygonContainsMarker=leaflet_isMarkerInsidePolygon(marker,clusterPolygonCoordinates);for(var i=0;i<clusterPolygonCoordinates.length;i++){if(clusterPolygonCoordinates[i].lat===marker.getLatLng().lat&&clusterPolygonCoordinates[i].lng===marker.getLatLng().lng){polygonContainsMarker=true;}}
if(polygonContainsMarker&&!jQuery('.selectedCluster').length){jQuery(cluster._icon).addClass('selectedCluster');if(leaflet_getPolygonArea(clusterPolygonCoordinates)>=0.005){_leafletMarkerGroup._showCoverage({layer:cluster});}}}else if(cluster.hasOwnProperty('_bounds')&&cluster.hasOwnProperty('_icon')){jQuery(cluster._icon).removeClass('selectedCluster');_leafletMarkerGroup._hideCoverage({layer:cluster});}});}}});});}
function createUpdateButton(params){var updateButton='<div class="leaflet-control updatemanager">'+'<button class="updateListButton">'+params.updateButtonLabel+'</button>'+'</div>';if(jQuery('.updatemanager').length){jQuery('.updatemanager').replaceWith(updateButton);}else{jQuery(".leaflet-top.leaflet-right").html(updateButton);}}
function leaflet_setupMapListeHebergementsButtons(params){var page=1;params.mapMoved=0;(function($){$('#bodyPage').on('click','.button_next_page',function(){if($('div#divgmap3').length===0||$('div#divgmap3:visible')===null||$('div#divgmap3:visible').length===0||$('div#divgmap3').data('modeleaflet')!==1){afficheLoaderGlobal_site();document.location.href=$('.button_next_page').data('url');}else{if(!isNaN(parseInt($('#current_page').text(),10))&&parseInt($('#current_page').text(),10)!==page){page=parseInt($('#current_page').text(),10);}
page++;leaflet_updateCgi(leaflet_bindSurvol,page,params);if($('#contentListeGaucheCarte').scrollTop()!==0){$('#contentListeGaucheCarte').animate({scrollTop:0},750);}else{$('html, body').animate({scrollTop:0},750);}
if($('.btnSwitchCarte > .itea_aOnglet').length!==0){var regex=/page=\d+/i;var href=$('.btnSwitchCarte > .itea_aOnglet').attr('href');var newhref=href.replace(regex,'page='+page);$('.btnSwitchCarte > .itea_aOnglet').attr('href',newhref);}}});$('#bodyPage').on('click','.button_prev_page',function(){if($('div#divgmap3').length===0||$('div#divgmap3:visible')===null||$('div#divgmap3:visible').length===0||$('div#divgmap3').data('modeleaflet')!==1){document.location.href=$('.button_prev_page').data('url');}else{if(!isNaN(parseInt($('#current_page').text(),10))&&parseInt($('#current_page').text(),10)!==page){page=parseInt($('#current_page').text(),10);}
page--;leaflet_updateCgi(leaflet_bindSurvol,page,params);if($('#contentListeGaucheCarte').scrollTop()!==0){$('#contentListeGaucheCarte').animate({scrollTop:0},750);}else{$('html, body').animate({scrollTop:0},750);}
if($('.btnSwitchCarte > .itea_aOnglet').length!==0){var regex=/page=\d+/i;var href=$('.btnSwitchCarte > .itea_aOnglet').attr('href');var newhref=href.replace(regex,'page='+page);$('.btnSwitchCarte > .itea_aOnglet').attr('href',newhref);}}});})(jQuery);}
function leaflet_chargePointsListeHeber(params,fitResults){if(_leafletAjax!==undefined){effaceMsgAttenteParDessus('_carte');_leafletAjax.abort();}
if(typeof params.cgis.LNO!=='undefined'){params.modecarto="2";}
affMsgAttenteParDessusInDiv(params.idDivMap,'_carte');var bounds=_leafletMap.getBounds();if(params.modecarto==='1'){fitResults=false;var tabParamsAjax={zoom:999,minLat:bounds.getSouth(),minLng:bounds.getWest(),maxLat:bounds.getNorth(),maxLng:bounds.getEast(),afficherquelistesurcarto:false,queryCgi:encodeURIComponent(jQuery('#itea_page_contentListe').attr('data-cgi')),modecarto:2};_leafletAjax=jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',data:tabParamsAjax,type:'POST',dataType:'json',async:false,success:function(points){leaflet_fitResults(points,params);}});}
var tabParamsAjax={zoom:999,minLat:bounds.getSouth(),minLng:bounds.getWest(),maxLat:bounds.getNorth(),maxLng:bounds.getEast(),afficherquelistesurcarto:false,queryCgi:encodeURIComponent(jQuery('#itea_page_contentListe').attr('data-cgi')),modecarto:params.modecarto};_leafletAjax=jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',data:tabParamsAjax,type:'POST',dataType:'json',async:false,success:function(points){if(points!==null){leaflet_affichePointsListeHeber(points,fitResults,params);}else{jQuery('#divChargementParDessus_carte').hide();}}});jQuery.ajax({url:'/lib_2/ajax/google_map.php',data:{cmd:'getCircleAroundCity',typegmap:'classique'},dataType:'json',success:function(cityCircle){if(cityCircle.length!==0&&cityCircle.radius!==0){L.circle([cityCircle.lat,cityCircle.lng],{radius:cityCircle.radius,color:'#d1d1d1',opacity:0.8,fillColor:'#d1d1d1',fillOpacity:0.4}).addTo(_leafletMap);}}});}
function leaflet_refreshPointsListeHeber(){jQuery.ajax({url:'/lib_2/ajax/leaflet_map.php',data:{cmd:'getParamsGoogleMap',typegmap:'classique'},dataType:'json',success:function(params){_leafletMap.eachLayer(function(layer){if(layer._mRadius!==undefined){layer.remove();}});leaflet_chargePointsListeHeber(params,true);}});}
function leaflet_affichePointsListeHeber(points,fitResults,params){if(_leafletMarkerGroup===undefined){_leafletMarkerGroup=new L.MarkerClusterGroup({maxClusterRadius:50});_leafletMarkerGroup.addTo(_leafletMap);}else if(!leaflet_yaPopupOuverte()){leaflet_clearMarkers();}
if(!Array.isArray(points)){return;}
if(points.length===1&&(points[0].filtre==='region'||points[0].filtre==='dpt')){cartoZoomTo(points[0].latitude,points[0].longitude,7);}
if(typeof params.cgis.LNO!=='undefined'){var newpoint=[];var lnoArray=params.cgis.LNO.split(',');points.forEach(function(point){var ref=point.ident.split('.');lnoArray.forEach(function(unLno){if(typeof ref[2]!=='undefined'&&ref[2].toLowerCase()===unLno.toLowerCase()){newpoint.push(point);}});});points=newpoint;}
points.forEach(function(point){leaflet_addPointLstHeber(point);});leaflet_bindSurvol();if(fitResults){leaflet_fitResults(points,params);}
effaceMsgAttenteParDessus('_carte');}
function leaflet_addPointLstHeber(point){if(point.classe==='gite'){var icon=L.icon({iconUrl:point.img,iconSize:[19,26],iconAnchor:[10,26],popupAnchor:[0,-26]});var marker=L.marker([point.latitude,point.longitude],{icon:icon,riseOnHover:true});marker.properties={};marker.properties.filtre=point.filtre;marker.properties.filtreValue=point.filtreValue;if(point.ident!==undefined&&point.ident!==''){marker.properties.ident=point.ident;}
if(point.departement!==undefined){marker.properties.departement=point.departement;}
if(point.moy_x!==undefined){marker.properties.moy_x=point.moy_x;}
if(point.moy_y!==undefined){marker.properties.moy_y=point.moy_y;}
var addedMarker=marker.addTo(_leafletMarkerGroup);addedMarker.bindPopup('Chargement...');addedMarker.on('click',leaflet_affichePopup);}}
function leaflet_affichePopup(ev){var bounds=_leafletMap.getBounds();var popup=ev.target.getPopup();jQuery.ajax({url:'/lib_2/ajax/traiteMarkerOnGmap.php',type:'POST',async:false,data:{CMD:'XHTML',ident:ev.target.properties.ident,departement:ev.target.properties.departement,moy_x:ev.target.properties.moy_x,moy_y:ev.target.properties.moy_y,filtre:ev.target.properties.filtre,filtreValue:ev.target.properties.filtreValue,zoom:_leafletMap.getZoom(),minLng:bounds.getWest(),minLat:bounds.getSouth(),maxLng:bounds.getEast(),maxLat:bounds.getNorth(),positionMarkerLat:ev.latlng.lat,positionMarkerLng:ev.latlng.lng,leaflet:1,modecarto:"2"},success:function(html){popup.options.maxWidth=500;popup.setContent(html);popup.update();cartoSetActionSurNavigListeCarte();}});}
function cartoSetActionSurNavigListeCarte(){if($('gbulle_spanlist_next')&&$('gbulle_spanlist_prev')){var spanSuivant=$('gbulle_spanlist_prev');var divList=$($(spanSuivant.parentNode).nextSiblings())[0];var ulListCarte=divList.childElements()[0];if(ulListCarte){ulListCarte.id="ulLstDetailCarte";}
setScrollHorizontalOnDiv(divList.id,ulListCarte.id,{"nextButton":$('gbulle_spanlist_next'),"prevButton":$('gbulle_spanlist_prev'),"scrollSansEffet":"true"});}}
function createUpdateCheckbox(params,desactiveParUtilisateur){if(params.autoupdate_checkbox!=='non'){var checkboxdiv='<div class="leaflet-control updatemanager updatemanagerauto">'+'<input id="autoupdatecheck" class="autoupdate" type="checkbox" name="autoupdate" value="autoupdate"><label for="autoupdatecheck">'+params.autoupdateLabel+'</label>'+'</div>';if(jQuery('.updatemanager').length){jQuery('.updatemanager').replaceWith(checkboxdiv);}else{jQuery(".leaflet-top.leaflet-right").html(checkboxdiv);}
if(params.autoupdate==='oui'&&!desactiveParUtilisateur){jQuery('.autoupdate').attr('checked',true);}}}
function leaflet_clearMarkers(){if(_leafletMarkerGroup===undefined){return;}
_leafletMarkerGroup.clearLayers();}var urlPanierV2='/lib_2/ajax/gerePanierV2.php?';function initGestionPanier(){gestprod=true;initEventAjoutPanier();initEventRecapPanier();initEventViderPanier();majRecapPanier();}
function initEventRecapPanier(){(function($){$('#span_fiche_btnVoirPanier').on('click',function(event){var instance=$(this).attr('data-instance');var exercice=$(this).attr('data-exercice');var ident=$(this).attr('data-ident');var date=$('#inpt_datePickerDeb').val();event.preventDefault();afficheLoaderGlobal_site();var data='type=getHTMLRecapPanierV2&instance='+instance+'&exercice='+exercice+'&ident='+ident+'&datedeb='+date;$.ajax({url:urlPanierV2,data:data,success:function(data){effaceLoaderGlobal_site();data=JSON.parse(data);if(data.code==='KO'){return;}
affichePopinRecapPanier(data.message);},error:function(){effaceLoaderGlobal_site();}});});})(jQuery);}
function initEventAjoutAutreDate(){(function($){$('#ajouterAutreDate').on('click',function(event){ajouterUneAutreDate();});})(jQuery);}
function initEventSupprimeLignefacture(){(function($){$('.supprimeLigneFacture').off('click');$('.supprimeLigneFacture').on('click',function(event){supprimeLigneFacture(this);});})(jQuery);}
function initEventModifieLignefacture(){(function($){$('.modifieLigneFacture').off('click');$('.modifieLigneFacture').on('click',function(event){modifieLigneFacture(this);});})(jQuery);}
function initEventViderPanier(){(function($){$('#span_fiche_btnViderPanier, .span_fiche_btnViderPanier').on('click',function(event){var instance=$(this).attr('data-instance');var exercice=$(this).attr('data-exercice');var ident=$(this).attr('data-ident');var date=$('#inpt_datePickerDeb').val();if(!date){}
event.preventDefault();afficheLoaderGlobal_site();var data='type=videPanier&instance='+instance+"&"+getIdSessionInHtml();$.ajax({url:urlPanierV2,data:data,success:function(data){$('#ficheRecapPanier').html('').removeClass('panierNonVide');jQuery.fancybox.close();effaceLoaderGlobal_site();},error:function(){effaceLoaderGlobal_site();}});});})(jQuery);}
function initEventAjoutPanier(){(function($){if($('#span_fiche_btnResaPanier').length>0){$('#span_fiche_btnResaPanier').on('click',function(event){var instance=$(this).attr('data-instance');var exercice=$(this).attr('data-exercice');var ident=$(this).attr('data-ident');var date=$('#inpt_datePickerDeb').val();if(!date){$('#inpt_datePickerDeb').datepicker('show');return;}
event.preventDefault();afficheLoaderGlobal_site();var data='type=getHtmlPopinPanier&instance='+instance+'&exercice='+exercice+'&ident='+ident+'&datedeb='+date;$.ajax({url:urlPanierV2,data:data,dataType:'json',success:function(json){effaceLoaderGlobal_site();if(json.code==='KO'){if(json.message==='ERR_PANIER_IDENT'){affichePopinPanierEnCours(json.html);}
return;}
affichePopinPanier(json.message,date);initEventAjoutAutreDate();initEventSupprimeLignefacture();effaceLoaderGlobal_site();},error:function(){effaceLoaderGlobal_site();}});});}})(jQuery);}
function affichePopinPanier(html,date){(function($){affichePopinFancyBox(html,null,{closeClick:majRecapPanier()});setEventsForPack(date);initActionsCanevas();})(jQuery);}
function affichePopinRecapPanier(html){(function($){affichePopinFancyBox(html);})(jQuery);}
function majRecapPanier(){(function($){var instance=$('#ficheRecapPanier').attr('data-instance');var exercice=$('#ficheRecapPanier').attr('data-exercice');var ident=$('#ficheRecapPanier').attr('data-ident');var data='type=getHTMLRecapPanierV2&instance='+instance+'&exercice='+exercice+'&ident='+ident;$.ajax({url:urlPanierV2,data:data,dataType:'json',beforeSend:function(){afficheLoaderGlobal_site();},success:function(json){effaceLoaderGlobal_site();if(json.code==='KO'){if(json.message==='ERR_PANIER_IDENT'){affichePopinPanierEnCours(json.html);}
return;}
if(json.message===''){$('#ficheRecapPanier').html(json.message).removeClass('panierNonVide');}else{$('#ficheRecapPanier').html(json.message).addClass('panierNonVide');initEventSupprimeLignefacture();initEventModifieLignefacture();}},error:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function ajouterUneAutreDate(){majRecapPanier();jQuery.fancybox.close();if(typeof foncQdFini_ajouterUneAutreDate==='function'){foncQdFini_ajouterUneAutreDate();}}
function supprimeLigneFacture(element){if(!$(element)){return;}
(function($){var data='type=supprimeLigneFacture&identifiant='+$(element).attr('data-identifiant');$.ajax({url:'/lib_2/ajax/gereResa.php',data:data,dataType:'json',beforeSend:function(){afficheLoaderGlobal_site();},success:function(){effaceLoaderGlobal_site();majRecapPanier();},error:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function modifieLigneFacture(element){if(!$(element)){return;}
(function($){var ident=$('#ficheRecapPanier').attr('data-ident');var data='type=getHtmlPopinPanier&datedeb='+$(element).attr('data-identifiant')+'&ident='+ident;$.ajax({url:urlPanierV2,data:data,dataType:'json',beforeSend:function(){afficheLoaderGlobal_site();},success:function(json){if(json.code==='KO'){return;}
affichePopinPanier(json.message,$(element).attr('data-identifiant'));initEventAjoutAutreDate();effaceLoaderGlobal_site();},error:function(){effaceLoaderGlobal_site();}});})(jQuery);}
function affichePopinPanierEnCours(html){affichePopinFancyBox(html);initEventViderPanier();}